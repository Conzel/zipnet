use ml::convolutions::*;
use ml::transposed_convolutions::*;
use ndarray::{array, Array, Array4, Dimension};

// This file has been automatically generated by Jinja2 via the
// script generate_tests_torch.py.
// Please do not change this file by hand.
use ml::convolutions::*;
use ndarray::{array, Array, Array4, Dimension};

fn arr_allclose<D: Dimension>(arr1: &Array<f32, D>, arr2: &Array<f32, D>) -> bool {
    (arr1 - arr2).map(|x| (*x as f32).abs()).sum() < 1e-3
}

#[test]
fn test_py_implementation_random_arrays_conv2d() {
    let test_input1 = array![[
        [
            0.17014849, 0.43056882, 0.5715329, 0.06520256, 0.12669588, 0.75015649, 0.98379819,
            0.55574155
        ],
        [
            0.04181346, 0.23677547, 0.51154924, 0.02844254, 0.60484786, 0.72306337, 0.22177844,
            0.16487044
        ],
        [
            0.46672951, 0.54035134, 0.69223571, 0.27845532, 0.66966338, 0.41083884, 0.45831479,
            0.70402897
        ],
        [
            0.61773261, 0.92697753, 0.56033562, 0.90980128, 0.26970649, 0.24242379, 0.79448488,
            0.75231163
        ],
        [
            0.96925828, 0.12854726, 0.91485179, 0.33565241, 0.37189406, 0.55898563, 0.5888119,
            0.44166553
        ],
        [
            0.90343251, 0.2795916, 0.75676637, 0.85028299, 0.96145765, 0.55666793, 0.84558665,
            0.04742411
        ],
        [
            0.23985275, 0.07658575, 0.71978642, 0.13313323, 0.69580542, 0.12692, 0.38484825,
            0.77533601
        ],
        [
            0.52113837, 0.43646371, 0.14352315, 0.89971072, 0.64410552, 0.04471071, 0.76767201,
            0.43464628
        ]
    ]];

    let kernel1: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.16569944, 0.18875163, 0.12285258, 0.27811149, 0.53907282, 0.50665719, 0.97435566,
            0.39133722, 0.7964828, 0.98891903, 0.35985747, 0.00756764, 0.53660642, 0.8659267,
            0.8576183, 0.81628793, 0.94803988, 0.45711016, 0.89837223, 0.8462714, 0.70536446,
            0.92891332, 0.0067116, 0.65220493, 0.72789614, 0.00785977, 0.32536872, 0.09833383,
            0.1022715, 0.7567798, 0.23972042, 0.38848336, 0.00744711, 0.87157013, 0.07988323,
            0.62830051, 0.82418534, 0.16570753, 0.64872344, 0.14438818, 0.62861935, 0.34163022,
            0.03235205, 0.25922647, 0.59344524, 0.9308157, 0.22162326, 0.91818294,
        ],
    )
    .unwrap();
    let conv_layer1 = ConvolutionLayer::new(kernel1, 1, Padding::Valid);
    let target_output1 = array![
        [
            [4.36458492, 4.0769701, 4.08218241, 4.12710238, 4.17105293],
            [4.73845387, 4.55738878, 4.6947546, 3.8852365, 3.89627862],
            [5.3473444, 5.66634989, 5.10445929, 4.82188702, 4.60343838],
            [4.40539169, 4.08239794, 4.60514736, 4.52855015, 4.69468451],
            [4.13129663, 4.55937481, 4.81079388, 4.72528076, 4.2266798]
        ],
        [
            [3.04722667, 3.26905847, 3.85219979, 3.4082253, 4.42724657],
            [2.92373943, 4.39063787, 3.85313678, 3.76073217, 3.86343694],
            [5.29387617, 4.42712688, 5.14526224, 4.50264359, 3.99246693],
            [4.60723686, 4.80126333, 4.03428745, 4.45680904, 4.33516836],
            [4.73019934, 3.4815774, 5.15223455, 4.60670424, 3.90422988]
        ],
        [
            [3.63437605, 3.2515676, 3.58583021, 3.52380776, 3.87971401],
            [3.39367247, 3.88449478, 3.8272748, 3.48537683, 3.52510762],
            [4.37691784, 4.97853565, 4.19348145, 4.78110647, 3.60646129],
            [4.29473591, 3.36125159, 3.86601067, 3.75463319, 3.75679517],
            [3.61603689, 3.7671845, 3.80879259, 4.35807562, 3.94183469]
        ]
    ];
    let current_output1 = conv_layer1.convolve(&test_input1);

    assert!(
        arr_allclose(&current_output1, &target_output1),
        "{:?} was not equal to {:?}",
        current_output1,
        target_output1
    );

    let test_input2 = array![[
        [
            0.97700956, 0.18019114, 0.775954, 0.14120784, 0.34261811, 0.5417864, 0.77682263,
            0.34603763
        ],
        [
            0.61141032, 0.97160413, 0.51576948, 0.50755494, 0.66598025, 0.62932201, 0.60627973,
            0.27978492
        ],
        [
            0.28792505, 0.75477028, 0.0509604, 0.10449678, 0.89887627, 0.65723281, 0.69558298,
            0.36264111
        ],
        [
            0.37613921, 0.92412781, 0.39898983, 0.69086773, 0.55113011, 0.36253916, 0.3678665,
            0.88718722
        ],
        [
            0.69587743, 0.48700338, 0.71353725, 0.98625484, 0.22876499, 0.75677498, 0.56175294,
            0.55667271
        ],
        [
            0.70358317, 0.92333792, 0.85647198, 0.36252776, 0.93732308, 0.01684272, 0.34317795,
            0.92199302
        ],
        [
            0.36392413, 0.7462054, 0.7556754, 0.31284245, 0.40316649, 0.73762665, 0.79263411,
            0.36348056
        ],
        [
            0.84374106, 0.03665259, 0.23846497, 0.82509994, 0.97324104, 0.96826524, 0.77620416,
            0.84270752
        ]
    ]];

    let kernel2: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.4298905, 0.76771309, 0.54514445, 0.78783929, 0.21897991, 0.97565903, 0.73295322,
            0.69994045, 0.86701023, 0.76087948, 0.62354497, 0.14890751, 0.86106661, 0.21943341,
            0.16440929, 0.60892437, 0.86124849, 0.02602104, 0.30423533, 0.50874046, 0.16869895,
            0.33294667, 0.17949399, 0.33126613, 0.11996287, 0.21606163, 0.87119263, 0.33579683,
            0.2313126, 0.25765271, 0.37489849, 0.30113343, 0.8142977, 0.42324699, 0.8179498,
            0.92175004, 0.21606776, 0.19149331, 0.42403409, 0.14780204, 0.46443273, 0.00207204,
            0.359202, 0.90198509, 0.21363449, 0.6390296, 0.59770577, 0.81350477,
        ],
    )
    .unwrap();
    let conv_layer2 = ConvolutionLayer::new(kernel2, 1, Padding::Valid);
    let target_output2 = array![
        [
            [4.79194117, 4.7988615, 4.1809392, 5.16499138, 5.58133507],
            [5.40459251, 5.03080511, 5.30069637, 6.08374977, 4.83164787],
            [5.30901194, 5.84005022, 5.13486338, 5.16777229, 5.55685568],
            [6.16624308, 6.12334871, 5.9440074, 4.64548588, 5.04200315],
            [6.45272636, 5.72385788, 5.41533041, 5.41301298, 5.69311333]
        ],
        [
            [2.80123496, 2.27596045, 3.25440788, 2.87311959, 2.84850717],
            [2.98594236, 3.52340341, 2.93446922, 3.00093818, 2.92116404],
            [2.98031664, 3.73682547, 2.5708952, 2.60488343, 3.25570631],
            [3.36092448, 3.40178847, 3.08620787, 2.53865433, 3.03773761],
            [3.54151797, 3.00397491, 3.21517563, 3.93310404, 3.24127388]
        ],
        [
            [3.96782398, 4.04143953, 4.14594746, 3.94246173, 4.31231022],
            [4.67436743, 4.89939833, 4.51570702, 4.3952136, 4.74126148],
            [4.23872137, 4.71271229, 4.01934147, 4.30990791, 4.36684227],
            [4.57661963, 5.25192118, 3.90695858, 3.9883554, 4.95291853],
            [4.75269508, 4.64118528, 5.64692307, 5.48682833, 4.74422455]
        ]
    ];
    let current_output2 = conv_layer2.convolve(&test_input2);

    assert!(
        arr_allclose(&current_output2, &target_output2),
        "{:?} was not equal to {:?}",
        current_output2,
        target_output2
    );

    let test_input3 = array![[
        [
            0.36853562, 0.90738844, 0.78289449, 0.98120834, 0.67269244, 0.46724817, 0.17302094,
            0.39839588
        ],
        [
            0.78055173, 0.85763607, 0.73359811, 0.52934056, 0.95292788, 0.78965247, 0.46750202,
            0.08403921
        ],
        [
            0.73126567, 0.34934824, 0.34592319, 0.54770445, 0.68714256, 0.29283326, 0.53392634,
            0.88501508
        ],
        [
            0.69093564, 0.44388365, 0.9043074, 0.99497239, 0.64743849, 0.36691285, 0.53965846,
            0.53726039
        ],
        [
            0.47547423, 0.44373917, 0.34716286, 0.21774843, 0.94379529, 0.51856594, 0.15765554,
            0.93507128
        ],
        [
            0.86233215, 0.81734436, 0.65661539, 0.38794869, 0.28848995, 0.58141308, 0.06870039,
            0.78543747
        ],
        [
            0.47194286, 0.12733267, 0.61117267, 0.25675833, 0.74741314, 0.45714312, 0.96499193,
            0.57969916
        ],
        [
            0.52087113, 0.93666833, 0.13247306, 0.7087714, 0.17877894, 0.40766998, 0.69067845,
            0.96753695
        ]
    ]];

    let kernel3: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.224454, 0.28950994, 0.75431514, 0.99582965, 0.81208641, 0.95363239, 0.77037488,
            0.683158, 0.16371862, 0.42877796, 0.73003109, 0.94567369, 0.05700503, 0.19623296,
            0.44457256, 0.5512328, 0.15101007, 0.25140873, 0.2031063, 0.55377507, 0.36415587,
            0.70193703, 0.27669304, 0.85076063, 0.00186597, 0.3316532, 0.15485734, 0.35000806,
            0.42372493, 0.03995521, 0.50671971, 0.38907994, 0.37287286, 0.21294773, 0.86463558,
            0.10154326, 0.75313084, 0.7910046, 0.15368015, 0.25977604, 0.40315585, 0.635939,
            0.25689794, 0.13678746, 0.43744904, 0.6658951, 0.56468201, 0.70429956,
        ],
    )
    .unwrap();
    let conv_layer3 = ConvolutionLayer::new(kernel3, 1, Padding::Valid);
    let target_output3 = array![
        [
            [6.40857887, 6.5523572, 5.61354685, 4.95342064, 4.86772728],
            [5.36473799, 5.76759768, 5.51797247, 4.88006878, 4.63849068],
            [4.8751893, 5.48756075, 5.37069178, 4.49427652, 5.15180349],
            [4.9850359, 4.88535404, 4.61947536, 4.38210201, 5.18517733],
            [4.44844103, 4.7602849, 4.53084898, 4.20152903, 5.29194212]
        ],
        [
            [4.04408312, 4.11108637, 3.61942601, 3.29038668, 2.83930421],
            [2.96544528, 3.41621399, 3.220541, 2.87220192, 3.09921098],
            [3.3914485, 3.41542768, 3.07732105, 2.93419933, 2.88696957],
            [2.84133434, 3.00309825, 2.90686011, 2.66202903, 3.67238402],
            [2.60258508, 3.16767406, 2.36762071, 2.4655652, 3.34694791]
        ],
        [
            [5.1136961, 5.38654852, 4.83922911, 4.58561516, 3.9085052],
            [3.96636939, 4.14103079, 4.57467985, 4.37878609, 4.20957708],
            [4.12905312, 3.91971922, 4.2421751, 3.69728661, 3.85444903],
            [3.96047544, 4.19183159, 3.70699739, 3.95852947, 4.42453241],
            [3.98066831, 3.42531395, 3.62348485, 3.34813094, 3.92573571]
        ]
    ];
    let current_output3 = conv_layer3.convolve(&test_input3);

    assert!(
        arr_allclose(&current_output3, &target_output3),
        "{:?} was not equal to {:?}",
        current_output3,
        target_output3
    );

    let test_input4 = array![[
        [
            0.67241763, 0.15790685, 0.25059524, 0.6432024, 0.60438922, 0.45131882, 0.96080875,
            0.40131756
        ],
        [
            0.60942906, 0.70350941, 0.64735606, 0.05433872, 0.7478619, 0.24740443, 0.35665986,
            0.00020906
        ],
        [
            0.23741228, 0.57013199, 0.63988189, 0.71328582, 0.90739846, 0.82469879, 0.1319153,
            0.68764621
        ],
        [
            0.84672896, 0.18134635, 0.90260192, 0.54676576, 0.33139232, 0.83673465, 0.05539654,
            0.55546729
        ],
        [
            0.91498041, 0.9791666, 0.90003225, 0.6329186, 0.30872978, 0.30553623, 0.04431259,
            0.52872152
        ],
        [
            0.3358437, 0.72178565, 0.72704844, 0.85191243, 0.07464863, 0.86783801, 0.58492021,
            0.14913943
        ],
        [
            0.18325551, 0.40498126, 0.75359419, 0.01821492, 0.59172363, 0.91982274, 0.52876538,
            0.71512849
        ],
        [
            0.38420153, 0.517026, 0.51501412, 0.26934662, 0.73560452, 0.97902701, 0.63627543,
            0.27803295
        ]
    ]];

    let kernel4: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.32063981, 0.83432082, 0.78711735, 0.28247103, 0.78126878, 0.52701458, 0.4719829,
            0.47535484, 0.23715672, 0.44046767, 0.90286418, 0.66611386, 0.02649495, 0.31939759,
            0.1660805, 0.5121102, 0.17436478, 0.313714, 0.47244505, 0.99067805, 0.90646706,
            0.29454134, 0.99321058, 0.12515199, 0.17643406, 0.16320723, 0.48754973, 0.53866875,
            0.63589709, 0.8935865, 0.82249757, 0.92702304, 0.10556214, 0.2828355, 0.14977625,
            0.53714937, 0.06378802, 0.44972161, 0.79292246, 0.53001659, 0.68762497, 0.47446238,
            0.73655207, 0.42605234, 0.65925771, 0.32377991, 0.42867732, 0.87574344, 0.70010745,
            0.01496939,
        ],
    )
    .unwrap();
    let conv_layer4 = ConvolutionLayer::new(kernel4, 1, Padding::Valid);
    let target_output4 = array![
        [
            [6.97174215, 6.94556856, 6.7378273, 5.9048748],
            [7.18308163, 6.93972731, 6.06566572, 6.08814049],
            [7.10091877, 7.55925512, 7.33032227, 6.63902378],
            [6.4639039, 7.45289707, 6.94276905, 6.40262842]
        ],
        [
            [7.85456228, 7.66588449, 6.6967473, 5.94139767],
            [7.98674774, 7.03720379, 6.49720097, 6.07217503],
            [7.14969301, 7.61145544, 7.1772666, 6.51189518],
            [6.87335777, 7.56024837, 7.42773342, 6.93641281]
        ]
    ];
    let current_output4 = conv_layer4.convolve(&test_input4);

    assert!(
        arr_allclose(&current_output4, &target_output4),
        "{:?} was not equal to {:?}",
        current_output4,
        target_output4
    );

    let test_input5 = array![[
        [
            0.78416554, 0.61210718, 0.98323473, 0.93168049, 0.05175687, 0.70876055, 0.52122001,
            0.68573385
        ],
        [
            0.415587, 0.87644995, 0.73337436, 0.54510111, 0.20423086, 0.5554448, 0.48578473,
            0.27645711
        ],
        [
            0.91929458, 0.89205094, 0.34320405, 0.4283556, 0.3897719, 0.0636046, 0.72917302,
            0.1946033
        ],
        [
            0.86342539, 0.6576018, 0.96574591, 0.22873744, 0.47843248, 0.22157177, 0.91623065,
            0.02157675
        ],
        [
            0.44649429, 0.27921922, 0.68582704, 0.75294507, 0.79195857, 0.22560764, 0.88778717,
            0.80092112
        ],
        [
            0.00003577, 0.97378775, 0.9146247, 0.13869576, 0.70596468, 0.0936791, 0.26477472,
            0.52025
        ],
        [
            0.0330946, 0.17754779, 0.41998119, 0.02919355, 0.82382417, 0.41568551, 0.49590722,
            0.69720375
        ],
        [
            0.71553151, 0.40795937, 0.15397235, 0.02265206, 0.70904147, 0.75877124, 0.67035423,
            0.39483563
        ]
    ]];

    let kernel5: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.86222315, 0.99930576, 0.84902793, 0.26427645, 0.86764544, 0.24274232, 0.69865254,
            0.57399909, 0.76205967, 0.29289714, 0.88402118, 0.89428535, 0.77575279, 0.16431308,
            0.48939566, 0.56055365, 0.46453193, 0.9573795, 0.88995079, 0.16098963, 0.63514714,
            0.81047396, 0.29953358, 0.46075394, 0.02808736, 0.59781087, 0.88556441, 0.61877849,
            0.95374666, 0.61971681, 0.3379795, 0.13108306, 0.30692965, 0.33537497, 0.01351478,
            0.45529486, 0.66261278, 0.94970221, 0.7403127, 0.06039312, 0.08292098, 0.80679556,
            0.1354166, 0.25606222, 0.80891573, 0.97702754, 0.41249681, 0.43591018, 0.87333111,
            0.1396195,
        ],
    )
    .unwrap();
    let conv_layer5 = ConvolutionLayer::new(kernel5, 1, Padding::Valid);
    let target_output5 = array![
        [
            [9.24005222, 8.63694, 7.92237186, 7.2268362],
            [9.0154562, 8.98091602, 7.49284363, 6.25235987],
            [7.54480648, 7.31395388, 7.29761934, 6.35619593],
            [7.67197275, 7.50325727, 7.70970583, 6.51262569]
        ],
        [
            [7.67918015, 7.04363489, 6.69426727, 6.31171799],
            [6.95970297, 7.26586199, 6.39112425, 5.63738489],
            [6.54973221, 6.22342777, 5.44734859, 5.92206907],
            [6.46118498, 6.47880554, 5.68305826, 5.8684516]
        ]
    ];
    let current_output5 = conv_layer5.convolve(&test_input5);

    assert!(
        arr_allclose(&current_output5, &target_output5),
        "{:?} was not equal to {:?}",
        current_output5,
        target_output5
    );

    let test_input6 = array![[
        [
            0.5204747, 0.88564532, 0.29781444, 0.21130918, 0.83071965, 0.3337948, 0.97835617,
            0.42070098
        ],
        [
            0.55396016, 0.16172562, 0.76349668, 0.36205767, 0.48491393, 0.49804138, 0.60014838,
            0.65126087
        ],
        [
            0.36919112, 0.11615072, 0.26983074, 0.86905251, 0.74464162, 0.47161298, 0.72900704,
            0.842964
        ],
        [
            0.21457536, 0.93840097, 0.41665936, 0.05351101, 0.43856344, 0.72531127, 0.85203244,
            0.41512332
        ],
        [
            0.35101932, 0.73887608, 0.3592986, 0.67414793, 0.99658078, 0.31170342, 0.86057029,
            0.94308546
        ],
        [
            0.8192489, 0.31478795, 0.75032399, 0.36604243, 0.78454617, 0.039194, 0.23696694,
            0.2418382
        ],
        [
            0.24788351, 0.56222231, 0.15428482, 0.50688076, 0.37682603, 0.44385925, 0.00051633,
            0.53422697
        ],
        [
            0.5675659, 0.53845215, 0.2130759, 0.86445095, 0.43288101, 0.62559181, 0.39425651,
            0.07226853
        ]
    ]];

    let kernel6: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.09869356, 0.32627373, 0.85439629, 0.85603164, 0.25422712, 0.24929269, 0.36793317,
            0.39957173, 0.90795348, 0.86575798, 0.82237727, 0.60374194, 0.76580248, 0.0215734,
            0.47320398, 0.65947816, 0.86392706, 0.85666667, 0.48541846, 0.54855826, 0.58605551,
            0.158874, 0.10558709, 0.19664533, 0.39609066, 0.27843866, 0.49128444, 0.75033016,
            0.35650546, 0.46870382, 0.61598491, 0.25470009, 0.17250927, 0.07203952, 0.87246574,
            0.14018923, 0.12091745, 0.47703981, 0.43290495, 0.63567976, 0.76194442, 0.23835071,
            0.95481588, 0.49641545, 0.70660178, 0.10666513, 0.06810815, 0.79673209, 0.29373888,
            0.55241187,
        ],
    )
    .unwrap();
    let conv_layer6 = ConvolutionLayer::new(kernel6, 1, Padding::Valid);
    let target_output6 = array![
        [
            [5.65363264, 6.17779207, 6.84486723, 7.84395218],
            [7.18372726, 6.6350379, 7.03902483, 7.44196367],
            [6.29056549, 6.77309799, 7.04046106, 6.84312057],
            [6.65224123, 5.76053238, 6.25180435, 6.86532736]
        ],
        [
            [5.51958179, 5.61665535, 6.91525316, 6.3115797],
            [5.8960433, 5.3474803, 6.55014992, 6.33483601],
            [5.78246546, 5.77504349, 6.07829189, 5.16624451],
            [5.35861874, 5.36640406, 4.80575085, 5.35519743]
        ]
    ];
    let current_output6 = conv_layer6.convolve(&test_input6);

    assert!(
        arr_allclose(&current_output6, &target_output6),
        "{:?} was not equal to {:?}",
        current_output6,
        target_output6
    );

    let test_input7 = array![[
        [
            0.23906927, 0.18915932, 0.02753429, 0.14385741, 0.54197413, 0.71984385, 0.12837073,
            0.55637453, 0.14355855, 0.10225686, 0.87554918, 0.62895285, 0.21388301, 0.30016333,
            0.49605926
        ],
        [
            0.82451067, 0.45287652, 0.68369415, 0.28745724, 0.50312577, 0.26911621, 0.92149793,
            0.71658926, 0.04745785, 0.55642488, 0.34654749, 0.83168657, 0.8410765, 0.7668131,
            0.84094905
        ],
        [
            0.6012723, 0.92569946, 0.66010622, 0.43380973, 0.62281451, 0.45852852, 0.61445724,
            0.52457897, 0.06486581, 0.14233574, 0.13930365, 0.58387869, 0.45914945, 0.30819194,
            0.70949814
        ],
        [
            0.88037591, 0.69272485, 0.50569828, 0.73587477, 0.58652497, 0.85065928, 0.3247378,
            0.67601919, 0.44835041, 0.59195756, 0.37883573, 0.77964994, 0.32748001, 0.44507304,
            0.74884216
        ],
        [
            0.14428215, 0.87857769, 0.15468395, 0.66387251, 0.30651525, 0.94925148, 0.55669755,
            0.08302987, 0.45890567, 0.05946975, 0.9099885, 0.30235246, 0.24214035, 0.42138378,
            0.38782486
        ],
        [
            0.21880286, 0.91822054, 0.85290708, 0.50703254, 0.52722338, 0.71761002, 0.560904,
            0.22129431, 0.26244272, 0.65570881, 0.00633, 0.66032144, 0.45500924, 0.65239857,
            0.14666249
        ],
        [
            0.32440838, 0.28057192, 0.42671443, 0.74477623, 0.91189731, 0.53352833, 0.36968936,
            0.56937558, 0.36426733, 0.11819326, 0.95361023, 0.13343851, 0.59402418, 0.72822953,
            0.93200069
        ],
        [
            0.46956547, 0.50878742, 0.79529177, 0.73709416, 0.33586889, 0.03185031, 0.27057355,
            0.26166973, 0.58431293, 0.53371387, 0.19571388, 0.1192536, 0.75616852, 0.97167399,
            0.71154076
        ],
        [
            0.26672949, 0.07128377, 0.3383284, 0.80085631, 0.95049468, 0.59714341, 0.78477727,
            0.92326205, 0.24163639, 0.12968541, 0.5954836, 0.6734995, 0.08627631, 0.74857154,
            0.87824841
        ],
        [
            0.68631546, 0.72643531, 0.08944888, 0.68172634, 0.4284322, 0.48237634, 0.68565236,
            0.04009921, 0.0687674, 0.9063645, 0.42620142, 0.61030612, 0.10040135, 0.50107219,
            0.76305701
        ]
    ]];

    let kernel7: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.25769316, 0.88161141, 0.77701313, 0.23345616, 0.62762325, 0.15315742, 0.73589576,
            0.27520672, 0.85641517, 0.74394841, 0.65813059, 0.40562607, 0.13899311, 0.26460667,
            0.91797941, 0.96651816, 0.89336775, 0.18948041, 0.93711783, 0.71248111, 0.96575491,
            0.62036752, 0.32684848, 0.11439406, 0.07654371, 0.95680341, 0.97286393, 0.60558715,
            0.00439729, 0.85256128, 0.3167563, 0.1349921, 0.68338643, 0.79550468, 0.21689218,
            0.28267041, 0.12328367, 0.68900431, 0.59066495, 0.41700743, 0.30266365, 0.57165983,
            0.12726786, 0.35587692, 0.16889892, 0.31148919, 0.13098989, 0.24026695,
        ],
    )
    .unwrap();
    let conv_layer7 = ConvolutionLayer::new(kernel7, 1, Padding::Valid);
    let target_output7 = array![
        [
            [
                4.7475667, 4.34477806, 4.75007677, 4.55140257, 4.98603344, 4.09437227, 3.75981164,
                3.28550363, 3.3634274, 4.59347153, 4.16185236, 4.80581427
            ],
            [
                5.27118492, 4.99340916, 5.05623579, 5.15702009, 4.81603527, 4.63129234, 3.48320222,
                3.74484301, 3.88895631, 4.15357876, 4.39118958, 4.98256207
            ],
            [
                5.51319218, 5.27522135, 4.88276339, 5.48563147, 4.44877148, 4.45997572, 3.38051248,
                2.89732766, 3.2649529, 3.97764826, 4.2584157, 3.85999107
            ],
            [
                4.79232931, 6.16646481, 5.47382689, 5.47701406, 4.68342304, 4.33455229, 3.61678863,
                3.55905223, 4.23463535, 3.78541231, 4.5326829, 4.79183674
            ],
            [
                4.84393358, 4.87552166, 4.66411114, 4.68967772, 4.49081516, 3.81383753, 3.53358173,
                3.44128013, 2.99885154, 4.23842287, 4.70140362, 4.92380238
            ],
            [
                5.15615177, 5.94809389, 5.61580658, 5.06679821, 4.8372283, 3.83289862, 3.04443264,
                3.53822899, 4.13013077, 3.14089346, 4.55794477, 5.32483149
            ],
            [
                3.85472989, 4.70597363, 5.27329302, 5.52662516, 4.61694431, 3.5582881, 4.31028032,
                4.04775143, 3.79452419, 3.702703, 4.12856865, 5.24179649
            ]
        ],
        [
            [
                4.40191126, 3.9562912, 4.38587666, 4.04424477, 4.49708843, 4.09018755, 3.33910203,
                3.13580418, 3.37782741, 3.72646999, 4.56173563, 4.64713955
            ],
            [
                5.64433908, 4.67390394, 5.11158419, 4.56819105, 5.60367441, 3.99531507, 4.04922771,
                3.8461566, 3.15160036, 4.67777491, 4.24224186, 4.90383768
            ],
            [
                5.69627523, 5.10237837, 5.0361557, 5.12222338, 5.21573877, 3.90997767, 2.72509003,
                3.3690443, 3.45645452, 3.72172499, 3.53731132, 4.10708904
            ],
            [
                5.235291, 5.44161463, 5.01255655, 5.58301306, 4.60699368, 4.62904978, 3.53152728,
                3.39097166, 3.71126199, 4.22323322, 4.17835665, 4.40641737
            ],
            [
                3.97773933, 5.96228933, 5.31832361, 5.06146193, 3.63194633, 4.06330061, 3.30570388,
                3.23616266, 3.9124651, 3.30654144, 3.72929072, 5.03768587
            ],
            [
                4.26206827, 5.10724878, 5.27473116, 4.80822659, 4.05227232, 3.98061395, 4.14635563,
                3.33837533, 2.79634094, 3.88256884, 4.46155071, 4.77504063
            ],
            [
                4.03234529, 4.98036957, 5.95668125, 5.20364141, 4.7327981, 4.14056635, 2.97780228,
                3.3719902, 4.42973852, 3.45826817, 4.42291641, 4.30571604
            ]
        ],
        [
            [
                2.85495877, 2.68829465, 2.43210292, 2.90799165, 3.50320816, 2.88744187, 2.4689126,
                2.0442462, 2.31146097, 2.87182903, 3.66295671, 3.4937613
            ],
            [
                3.90251613, 3.30114508, 3.27269912, 3.17275167, 3.32077789, 3.04616141, 2.84897923,
                2.05209589, 2.30480576, 2.72671652, 3.25806689, 3.52890158
            ],
            [
                3.96286297, 3.70269942, 3.67805958, 3.37146974, 3.379107, 3.01654196, 2.56012464,
                2.20564032, 2.16919494, 2.36697984, 2.76143932, 2.72411776
            ],
            [
                3.71888232, 3.4505229, 3.77419567, 3.64598012, 3.61969614, 2.88079429, 2.32489944,
                2.55209112, 2.78637147, 2.80669975, 2.84008193, 2.83833432
            ],
            [
                3.49057055, 3.43336463, 3.31019044, 3.38877153, 3.08747172, 2.79361606, 2.07069016,
                2.3680923, 2.07288623, 2.72124028, 3.1329639, 2.79993105
            ],
            [
                3.10471439, 3.98643804, 3.9210155, 3.48306918, 2.96977901, 2.79735708, 2.48267722,
                2.23473144, 2.50457883, 2.59715629, 2.74773002, 3.53564644
            ],
            [
                2.90079284, 3.13457513, 3.34342718, 3.52608967, 3.00057173, 2.62340617, 2.79663658,
                2.70110154, 2.15174794, 2.50863266, 3.28891063, 3.43580151
            ]
        ]
    ];
    let current_output7 = conv_layer7.convolve(&test_input7);

    assert!(
        arr_allclose(&current_output7, &target_output7),
        "{:?} was not equal to {:?}",
        current_output7,
        target_output7
    );

    let test_input8 = array![[
        [
            0.55435273, 0.34375766, 0.4225387, 0.37165097, 0.62029453, 0.60695333, 0.05756182,
            0.0153275, 0.84975781, 0.79796967, 0.40719958, 0.19325097, 0.04944435, 0.59729163,
            0.39304133
        ],
        [
            0.67900197, 0.61268537, 0.67232878, 0.71562921, 0.09058711, 0.33372015, 0.89416437,
            0.30899736, 0.3348802, 0.6412177, 0.26750944, 0.03709449, 0.56803027, 0.87562728,
            0.57711325
        ],
        [
            0.56024177, 0.58685749, 0.75167765, 0.36936092, 0.37185488, 0.35425208, 0.24336163,
            0.01027582, 0.26715372, 0.83992415, 0.49819484, 0.78318667, 0.70054486, 0.87018632,
            0.49413828
        ],
        [
            0.84670646, 0.80696486, 0.09345899, 0.93408288, 0.8206956, 0.70209366, 0.32817393,
            0.74420299, 0.39091238, 0.43911496, 0.92919486, 0.29325069, 0.62813333, 0.81314307,
            0.19520658
        ],
        [
            0.47931833, 0.42483748, 0.47526902, 0.28184402, 0.09741595, 0.45691563, 0.44086095,
            0.96384089, 0.33859608, 0.26381833, 0.29839757, 0.68755939, 0.09156765, 0.58584655,
            0.04617033
        ],
        [
            0.14705709, 0.81179596, 0.16751295, 0.06864621, 0.63087308, 0.38993102, 0.3644169,
            0.68174503, 0.27240898, 0.23609332, 0.21866773, 0.80119156, 0.01742986, 0.49270406,
            0.37920174
        ],
        [
            0.90869633, 0.81912677, 0.7636344, 0.78277877, 0.96949662, 0.79533533, 0.00732174,
            0.83721131, 0.94490713, 0.76702527, 0.50964799, 0.78430691, 0.73653134, 0.71123123,
            0.89694641
        ],
        [
            0.9544987, 0.16811895, 0.97018675, 0.25394835, 0.55851589, 0.51973415, 0.4357872,
            0.29419306, 0.51803759, 0.80581654, 0.71900277, 0.52249017, 0.52525959, 0.33191478,
            0.33889579
        ],
        [
            0.18619475, 0.6839338, 0.72234724, 0.25884648, 0.79801009, 0.36219833, 0.70463167,
            0.92843939, 0.46896498, 0.23158234, 0.32747797, 0.9097073, 0.74404828, 0.03255624,
            0.30697422
        ],
        [
            0.62468214, 0.19074459, 0.98433641, 0.40385719, 0.57477091, 0.65160056, 0.68225169,
            0.98408772, 0.18341686, 0.52884058, 0.92906401, 0.87780553, 0.90901809, 0.82569947,
            0.20383635
        ]
    ]];

    let kernel8: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.71666433, 0.17061437, 0.91526777, 0.08598402, 0.70100875, 0.40537684, 0.59719821,
            0.92796125, 0.15859715, 0.78590811, 0.85644881, 0.35816406, 0.79062704, 0.96448833,
            0.13154315, 0.31929042, 0.80048305, 0.07180242, 0.52815667, 0.45786336, 0.91537885,
            0.97833131, 0.25753945, 0.42799363, 0.07738555, 0.92942058, 0.07022415, 0.60058223,
            0.61962778, 0.90083461, 0.04155484, 0.82207746, 0.41282525, 0.99496077, 0.31092708,
            0.47614527, 0.76158205, 0.35893061, 0.07713356, 0.61239278, 0.62511915, 0.88098775,
            0.21521498, 0.89468117, 0.1842307, 0.10784956, 0.83548332, 0.26307009,
        ],
    )
    .unwrap();
    let conv_layer8 = ConvolutionLayer::new(kernel8, 1, Padding::Valid);
    let target_output8 = array![
        [
            [
                5.74897957, 4.17183208, 4.27312136, 4.9686718, 3.77791905, 3.06985235, 4.18250036,
                4.3341074, 4.18142557, 4.85860205, 4.74166203, 4.64613819
            ],
            [
                4.81463385, 4.65616179, 4.45257568, 3.78734231, 3.63897538, 3.47236371, 4.70483828,
                4.32060099, 4.2383585, 4.38861513, 4.99102402, 4.81599474
            ],
            [
                4.9257369, 4.57287216, 3.50842953, 3.88550138, 4.53487587, 3.96229053, 3.93432736,
                4.32359791, 3.62768364, 4.31304359, 5.08777428, 4.18213511
            ],
            [
                4.65217161, 4.61076975, 4.46816015, 5.03138971, 5.24817228, 4.74012995, 3.99841499,
                4.76884413, 4.89859009, 3.93516421, 4.78611898, 4.3991456
            ],
            [
                4.31889582, 4.94338942, 4.50388527, 4.06644773, 4.26379347, 4.61763525, 4.42341805,
                4.73054266, 4.69888401, 4.65065765, 4.24126339, 4.96857405
            ],
            [
                4.74450636, 5.71129751, 4.97168493, 4.29594707, 5.03915596, 5.02660942, 4.88850403,
                5.3937192, 4.95608282, 5.02212381, 4.46476555, 5.60665798
            ],
            [
                5.32422733, 5.21872997, 5.81803846, 4.98218489, 4.87872839, 5.55172014, 5.56830788,
                5.22433758, 4.86622858, 6.13323832, 5.95203161, 5.11904955
            ]
        ],
        [
            [
                5.44892025, 4.51849079, 4.60312748, 4.06358242, 3.49719, 3.78805399, 4.14539528,
                3.77396059, 4.28384352, 4.53550386, 4.31441164, 3.7272563
            ],
            [
                5.02316618, 3.97599888, 4.3697648, 3.78756642, 3.93294001, 2.9722631, 4.25014544,
                3.60116506, 3.70698643, 4.40149879, 4.85944986, 3.98671126
            ],
            [
                4.56550789, 4.03930044, 3.59045982, 3.93596053, 4.65728807, 3.28981423, 4.19580984,
                3.71799374, 3.80261731, 3.88981891, 5.15410757, 3.59052372
            ],
            [
                5.10523701, 5.11713314, 4.05592442, 4.22273874, 5.13569403, 4.29165602, 4.52157307,
                4.96500587, 4.58808374, 3.47108555, 5.38536596, 3.94521642
            ],
            [
                4.14293718, 4.62053823, 3.82395935, 3.6744411, 4.52132225, 3.91446376, 4.41820765,
                4.69323683, 4.44109201, 3.91249895, 4.26233149, 4.35033512
            ],
            [
                3.88583517, 6.10967159, 4.37981749, 4.65658617, 5.41022348, 4.23864317, 4.30037546,
                5.16579437, 5.2136035, 4.52450275, 4.05285978, 5.32512331
            ],
            [
                4.73275042, 5.69129705, 5.14982605, 4.7851634, 5.26418972, 4.95137787, 4.92232275,
                4.94923544, 5.28224468, 5.98388147, 5.65123129, 5.20296049
            ]
        ],
        [
            [
                4.03264523, 4.38814831, 4.18692493, 3.92355132, 2.63512659, 3.08764648, 3.44655466,
                3.52145958, 4.57965279, 4.10391045, 4.32947493, 3.74354744
            ],
            [
                5.06256676, 4.07316875, 4.13296604, 3.81800246, 3.7871325, 4.06847858, 3.68525171,
                3.5095365, 3.51463032, 4.51829624, 4.04998589, 4.06966162
            ],
            [
                4.03949404, 3.7278471, 3.50490165, 3.2666719, 4.00736094, 3.40484381, 3.27378464,
                3.71272016, 3.7729342, 3.89346957, 4.58337784, 3.49598789
            ],
            [
                4.35730362, 4.05941916, 4.20204163, 4.0554142, 4.27321005, 3.87241054, 4.25708532,
                4.27746248, 3.85454559, 3.4867475, 4.36575842, 3.73737383
            ],
            [
                4.58660555, 4.56765223, 4.06082726, 3.27427697, 4.81463671, 3.7893672, 4.44826603,
                4.67731857, 4.62046146, 3.55089188, 4.3912468, 4.07982063
            ],
            [
                4.43796635, 4.5198102, 4.28205252, 3.73502111, 4.80646038, 4.394207, 3.92126513,
                4.03628254, 4.59162712, 4.60438299, 4.39787769, 3.66746521
            ],
            [
                4.98817778, 5.10434961, 5.01752663, 4.67286348, 5.22345734, 4.4686594, 4.55667686,
                4.9030757, 5.22386265, 5.1169138, 4.9752326, 5.03347063
            ]
        ]
    ];
    let current_output8 = conv_layer8.convolve(&test_input8);

    assert!(
        arr_allclose(&current_output8, &target_output8),
        "{:?} was not equal to {:?}",
        current_output8,
        target_output8
    );

    let test_input9 = array![[
        [
            0.71846745, 0.06132602, 0.06056971, 0.71349824, 0.00944792, 0.07349233, 0.35231607,
            0.85339613, 0.17608605, 0.18067755, 0.51991456, 0.19053963, 0.50451729, 0.7456122,
            0.27621789
        ],
        [
            0.48649722, 0.39297875, 0.54849164, 0.37469909, 0.81942836, 0.34880425, 0.79505838,
            0.41293453, 0.890512, 0.12076204, 0.20799449, 0.88948243, 0.24437675, 0.77314743,
            0.65954227
        ],
        [
            0.49225648, 0.52115808, 0.97382413, 0.97795639, 0.17542631, 0.45519892, 0.81067127,
            0.70959754, 0.5087082, 0.78796805, 0.03310984, 0.20805902, 0.45704819, 0.9133983,
            0.5689028
        ],
        [
            0.04247752, 0.55938283, 0.9835293, 0.04525762, 0.7176199, 0.82096801, 0.55757172,
            0.57441078, 0.97806886, 0.34563605, 0.33249309, 0.8797563, 0.14932355, 0.1134909,
            0.56457033
        ],
        [
            0.30096473, 0.40968749, 0.57031528, 0.88738927, 0.62423742, 0.77620891, 0.68192901,
            0.24701218, 0.74485577, 0.61556436, 0.63869127, 0.05875124, 0.32109321, 0.96946657,
            0.09463911
        ],
        [
            0.62756373, 0.34162355, 0.74390863, 0.87367778, 0.95139082, 0.24045336, 0.70034751,
            0.87750343, 0.16564245, 0.63149631, 0.21785555, 0.76549871, 0.13988015, 0.03287261,
            0.82226164
        ],
        [
            0.60896695, 0.13331373, 0.62307175, 0.23316076, 0.96002043, 0.55291535, 0.29808274,
            0.87651269, 0.98263546, 0.27148732, 0.11101003, 0.2754741, 0.4540411, 0.19701396,
            0.08459944
        ],
        [
            0.98017716, 0.98008131, 0.62585703, 0.18621969, 0.58363214, 0.17965507, 0.81336418,
            0.94554825, 0.28304926, 0.32718146, 0.46701642, 0.91682272, 0.61429792, 0.19277428,
            0.28408902
        ],
        [
            0.25507235, 0.98004533, 0.36125832, 0.96792002, 0.33258556, 0.95086255, 0.84245811,
            0.8130291, 0.77749758, 0.17691322, 0.9389267, 0.22419458, 0.33442206, 0.76145851,
            0.37563835
        ],
        [
            0.70754575, 0.1499497, 0.98738371, 0.71669681, 0.40278858, 0.22288306, 0.3279577,
            0.07722609, 0.59875502, 0.8143903, 0.87905453, 0.83061284, 0.9923988, 0.61964943,
            0.53640598
        ]
    ]];

    let kernel9: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.06662867, 0.83588266, 0.28182984, 0.66218105, 0.99850966, 0.60448395, 0.12318801,
            0.91713258, 0.85405983, 0.19103892, 0.59296137, 0.9118344, 0.93811131, 0.34217221,
            0.8149188, 0.95955951, 0.02717085, 0.89163091, 0.97555751, 0.27588442, 0.59208006,
            0.00008138, 0.95520374, 0.12578068, 0.01249961, 0.05413999, 0.5153533, 0.40144865,
            0.86988112, 0.6468678, 0.8840439, 0.34315115, 0.52290096, 0.66408887, 0.98115785,
            0.85046167, 0.79799048, 0.94447943, 0.69304133, 0.90735816, 0.911567, 0.45996496,
            0.90457691, 0.17170428, 0.43418502, 0.69308426, 0.42869946, 0.92443411,
        ],
    )
    .unwrap();
    let conv_layer9 = ConvolutionLayer::new(kernel9, 1, Padding::Valid);
    let target_output9 = array![
        [
            [
                4.78853512, 4.74145603, 5.69511652, 5.32097197, 5.55636168, 6.14879227, 5.86640167,
                4.43038845, 5.18432236, 3.93206811, 4.32981062, 5.39945602
            ],
            [
                5.09342241, 5.77172089, 6.92920828, 6.72072363, 5.31270504, 6.8100481, 6.15578651,
                4.87377024, 5.37400484, 4.01455069, 4.84629345, 4.44428778
            ],
            [
                5.56650591, 6.81146955, 6.82135105, 5.94070292, 6.59738779, 6.32747126, 5.98450899,
                5.13298225, 5.3425889, 3.63326097, 4.13897324, 4.88496971
            ],
            [
                5.3972187, 6.051898, 6.30672646, 6.18083382, 6.92228746, 6.5195322, 5.58899641,
                5.37233973, 4.73756075, 4.06547499, 3.67937183, 3.15352654
            ],
            [
                5.90810823, 6.0303216, 6.02727413, 5.65410995, 7.11320019, 5.54193497, 5.58218193,
                5.38656092, 4.9050169, 4.4226532, 3.58547735, 4.2312355
            ],
            [
                5.45787668, 6.68986845, 5.52917385, 6.26341486, 7.15754318, 6.41635799, 5.65585852,
                5.67895889, 5.70614195, 3.78434753, 4.30432129, 3.95251083
            ],
            [
                6.01033497, 6.37857342, 5.11856174, 6.00674152, 5.35138655, 5.35369968, 6.02853918,
                6.20209694, 5.6976285, 5.23677301, 6.01861238, 5.268363
            ]
        ],
        [
            [
                3.40190363, 3.49076557, 3.95790792, 2.85423565, 4.51632118, 4.44802237, 4.79559135,
                2.89375424, 3.38329625, 3.39251637, 2.97897482, 4.48914051
            ],
            [
                4.23813486, 4.45184565, 4.64859819, 5.19852066, 4.49442482, 4.69768429, 4.6604929,
                3.98921919, 3.12561536, 3.49305773, 3.20595169, 3.69808483
            ],
            [
                5.06867933, 4.97081375, 5.39055538, 4.27887535, 4.83087587, 4.69334269, 4.86915159,
                4.08340359, 3.21671128, 3.0602355, 2.62358117, 3.78483939
            ],
            [
                4.31375504, 4.23434496, 4.39998674, 4.83089447, 5.00119591, 4.48443031, 4.9527998,
                4.24027205, 3.63926625, 2.84397483, 2.65045667, 2.49698377
            ],
            [
                4.90007257, 4.87735462, 4.98899841, 3.79816031, 4.9999733, 4.56173515, 4.13588047,
                4.30148935, 2.99100256, 3.79647756, 2.85515594, 3.47416735
            ],
            [
                4.24343061, 4.64224386, 5.10065508, 4.64343119, 4.872931, 5.82582808, 4.63196373,
                3.71204281, 4.04153156, 3.30045938, 3.32638502, 2.23793316
            ],
            [
                4.4715457, 4.08821297, 4.62969637, 3.92008138, 3.92029905, 3.92059541, 4.28659773,
                4.12302923, 3.88506532, 4.30186844, 4.52737999, 4.05109262
            ]
        ],
        [
            [
                5.16901493, 6.06030273, 5.35259819, 5.69470882, 5.90928555, 6.79328585, 5.86843157,
                5.60774899, 5.17200041, 4.08267117, 5.02367449, 5.85586548
            ],
            [
                6.49239874, 6.46395016, 7.42693996, 6.74642992, 6.53145409, 7.25163317, 7.1232419,
                5.54658699, 5.44882774, 4.82219601, 5.17942047, 5.51520872
            ],
            [
                6.4424777, 7.5493927, 6.97242594, 7.25722647, 7.32506275, 6.86421251, 7.1250782,
                5.63571262, 5.99494314, 4.20774174, 4.46507978, 5.5243144
            ],
            [
                5.61631107, 6.73175526, 7.71349192, 7.08531332, 7.38415813, 7.39981747, 6.48827744,
                6.24389076, 5.17414045, 4.94318962, 3.96723843, 3.78861475
            ],
            [
                6.64084196, 6.70102739, 6.9121213, 7.13770342, 7.13921356, 6.25783014, 6.89306784,
                5.95730162, 5.61482, 4.49622679, 4.48834753, 4.60927582
            ],
            [
                7.06524372, 6.91477537, 7.05584288, 6.24420595, 7.80974245, 7.32032728, 6.55630684,
                6.49409676, 4.79654694, 4.85001183, 4.47621536, 4.43096066
            ],
            [
                6.20038605, 6.98179197, 5.67840195, 6.1469698, 6.14770079, 7.04037857, 7.04916286,
                6.17431831, 6.37479687, 5.8567791, 6.0411644, 5.33545685
            ]
        ]
    ];
    let current_output9 = conv_layer9.convolve(&test_input9);

    assert!(
        arr_allclose(&current_output9, &target_output9),
        "{:?} was not equal to {:?}",
        current_output9,
        target_output9
    );

    let test_input10 = array![[
        [
            0.41451566, 0.62247083, 0.00536506, 0.33826838, 0.47926103, 0.0032256, 0.02230139,
            0.35960107, 0.48593593, 0.86064773, 0.28908367, 0.4153976, 0.34687061, 0.2242362,
            0.93169004
        ],
        [
            0.3198661, 0.5576108, 0.17364207, 0.69407915, 0.88076497, 0.11111139, 0.19382912,
            0.93070823, 0.91885547, 0.10532705, 0.88550457, 0.20754221, 0.97926296, 0.34729281,
            0.71126234
        ],
        [
            0.03633394, 0.7482733, 0.28782295, 0.73823089, 0.60003114, 0.32597429, 0.85578995,
            0.14142897, 0.39191914, 0.05517358, 0.60509269, 0.96882702, 0.47373445, 0.76571182,
            0.50472077
        ],
        [
            0.53850234, 0.05837096, 0.56728834, 0.3979838, 0.2393961, 0.36507484, 0.01646563,
            0.27730469, 0.62646277, 0.94121945, 0.66457145, 0.84257754, 0.4301739, 0.68211767,
            0.60596876
        ],
        [
            0.76295831, 0.56038121, 0.48163054, 0.43719102, 0.43973155, 0.29997744, 0.21913478,
            0.66115144, 0.20978799, 0.176356, 0.88925514, 0.14793598, 0.36509595, 0.56160287,
            0.66173851
        ],
        [
            0.30053072, 0.36820947, 0.62227125, 0.49574589, 0.69923053, 0.32276483, 0.97024119,
            0.56792343, 0.13432134, 0.74309131, 0.19231907, 0.26170298, 0.10480803, 0.00958306,
            0.20726651
        ],
        [
            0.20851518, 0.17973869, 0.23704102, 0.11638671, 0.27359049, 0.85379089, 0.40302999,
            0.75797636, 0.34342997, 0.74670873, 0.82946825, 0.91931369, 0.96549747, 0.18782941,
            0.10021565
        ],
        [
            0.05109123, 0.30693651, 0.10895161, 0.98912135, 0.62504833, 0.50799401, 0.47125,
            0.84314244, 0.60549933, 0.92367508, 0.69538954, 0.37023903, 0.67128026, 0.43450755,
            0.28869845
        ],
        [
            0.27641537, 0.83697122, 0.68564831, 0.26890948, 0.65425914, 0.84581688, 0.51146319,
            0.48995436, 0.52071318, 0.80564772, 0.67052099, 0.38358571, 0.47078377, 0.51005312,
            0.82525114
        ],
        [
            0.02126783, 0.95831531, 0.23316967, 0.94875039, 0.96095887, 0.95734006, 0.00943314,
            0.75214318, 0.46106156, 0.84370508, 0.16933449, 0.71423986, 0.53166463, 0.64001515,
            0.96389141
        ]
    ]];

    let kernel10: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.69432027, 0.85816409, 0.70813744, 0.28369829, 0.33953485, 0.89505429, 0.20262088,
            0.81930759, 0.0955688, 0.22266188, 0.63842744, 0.83041857, 0.12425002, 0.75820649,
            0.09737789, 0.84872884, 0.17490041, 0.37569722, 0.66691882, 0.89706689, 0.22398192,
            0.29424526, 0.56277038, 0.41113177, 0.78824639, 0.24159204, 0.54609149, 0.2969013,
            0.31420748, 0.76481112, 0.04421633, 0.96366841, 0.98529966, 0.26998707, 0.13811645,
            0.97249976, 0.41856613, 0.13321315, 0.0937838, 0.47424142, 0.79873264, 0.16213139,
            0.5493846, 0.6481355, 0.05176858, 0.17029644, 0.95553601, 0.089831, 0.05664136,
            0.92318648,
        ],
    )
    .unwrap();
    let conv_layer10 = ConvolutionLayer::new(kernel10, 1, Padding::Valid);
    let target_output10 = array![
        [
            [
                5.48071527, 5.03634977, 4.5944891, 5.349998, 4.55442953, 5.36556292, 5.8027544,
                6.40015793, 7.31711817, 6.12845421, 7.96292114
            ],
            [
                5.62483883, 5.92589092, 6.18188858, 6.03274632, 5.82863331, 4.83540726, 6.48011637,
                6.01603031, 6.2638073, 5.73633432, 7.12393713
            ],
            [
                5.72851133, 5.66675472, 6.31155491, 6.3994441, 5.65741062, 5.52878332, 6.08038855,
                6.5829134, 5.68169928, 7.01419306, 6.11646748
            ],
            [
                5.05248213, 5.94319534, 5.70934248, 6.42749691, 5.53016567, 6.81446791, 7.06044054,
                7.33208084, 7.7742939, 6.71528769, 6.08636665
            ],
            [
                5.78692675, 5.95572472, 6.23986769, 6.57152128, 7.28598595, 6.94760799, 7.43004751,
                7.12660456, 6.34845161, 7.31668615, 6.15424204
            ],
            [
                5.91486216, 6.99519777, 6.97542334, 7.4322176, 6.99509001, 8.34119415, 7.24578047,
                7.55459404, 6.67664337, 7.46796322, 6.92152786
            ]
        ],
        [
            [
                4.84775019, 4.12124729, 4.69796705, 4.68272972, 3.44103813, 4.45490265, 6.60048008,
                4.96992445, 5.29131126, 6.05673075, 6.29250813
            ],
            [
                5.79156113, 4.69082355, 5.63880777, 5.4283042, 4.94374752, 5.28432751, 4.31337786,
                4.8368392, 5.38629198, 5.56792927, 6.19954681
            ],
            [
                4.750319, 5.24825478, 4.81266785, 5.03932953, 4.98265791, 4.09267712, 6.13185501,
                6.38447618, 5.72931147, 6.01980925, 5.79756594
            ],
            [
                4.1333518, 3.99661398, 5.35251379, 5.14301538, 4.94991875, 6.13826799, 6.32441854,
                5.89997673, 6.3294673, 6.70199776, 4.91309834
            ],
            [
                5.12046671, 5.83103991, 4.64675236, 5.84996891, 5.97655582, 6.55893421, 6.12699842,
                5.9825263, 5.69972754, 5.81889009, 5.46154928
            ],
            [
                5.03851795, 5.16546535, 5.64577341, 7.39856052, 6.48070335, 6.50571489, 5.97282028,
                6.26635313, 6.63159323, 6.22004509, 6.33368111
            ]
        ]
    ];
    let current_output10 = conv_layer10.convolve(&test_input10);

    assert!(
        arr_allclose(&current_output10, &target_output10),
        "{:?} was not equal to {:?}",
        current_output10,
        target_output10
    );

    let test_input11 = array![[
        [
            0.98567013, 0.01680514, 0.54690884, 0.85939877, 0.64969627, 0.8382851, 0.24000139,
            0.36792266, 0.01756373, 0.65967179, 0.5680892, 0.19350345, 0.48540582, 0.78698719,
            0.12335967
        ],
        [
            0.14544042, 0.25711667, 0.05608724, 0.18204255, 0.9562488, 0.44598027, 0.32297582,
            0.89306789, 0.24216229, 0.21437034, 0.38366762, 0.64894369, 0.86506391, 0.77900323,
            0.35299378
        ],
        [
            0.37360683, 0.26240813, 0.55443299, 0.90017566, 0.68178569, 0.95833224, 0.28551314,
            0.85106284, 0.70093376, 0.4791875, 0.58050109, 0.98031991, 0.97033705, 0.48236644,
            0.66855665
        ],
        [
            0.35855146, 0.25242765, 0.67179667, 0.26290379, 0.53677227, 0.18097793, 0.07985484,
            0.79416143, 0.72152353, 0.42313013, 0.6529702, 0.00384528, 0.08442256, 0.78389844,
            0.98068301
        ],
        [
            0.36212954, 0.61172485, 0.52636618, 0.8496614, 0.13177402, 0.91755979, 0.04323238,
            0.03087392, 0.03482862, 0.36226456, 0.60595438, 0.29194582, 0.34645593, 0.94099127,
            0.60953088
        ],
        [
            0.86102549, 0.16275521, 0.89393591, 0.66327933, 0.48094536, 0.06551107, 0.86129209,
            0.65446064, 0.95927759, 0.80004129, 0.21450381, 0.64425328, 0.46971877, 0.84573214,
            0.34651903
        ],
        [
            0.18830031, 0.57119009, 0.27269889, 0.79159571, 0.21737069, 0.04463017, 0.393406,
            0.84414825, 0.77705368, 0.63151758, 0.85228959, 0.16809768, 0.2230516, 0.77322296,
            0.96781482
        ],
        [
            0.2237789, 0.89826148, 0.27191299, 0.34780892, 0.49277796, 0.14560463, 0.33638618,
            0.1585067, 0.18610527, 0.69630838, 0.94298206, 0.40789625, 0.20056698, 0.37306354,
            0.93670611
        ],
        [
            0.71033061, 0.06833509, 0.48335183, 0.45182208, 0.96346166, 0.00378525, 0.33689301,
            0.28288215, 0.75004079, 0.1607512, 0.51417499, 0.35879079, 0.36688787, 0.00774159,
            0.15532039
        ],
        [
            0.01133456, 0.94680933, 0.052598, 0.73530349, 0.80965635, 0.70976442, 0.37942106,
            0.38656326, 0.13763146, 0.99930646, 0.67476802, 0.06055128, 0.8463604, 0.44607292,
            0.33209084
        ]
    ]];

    let kernel11: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.94373863, 0.53976141, 0.05766413, 0.64256255, 0.73574592, 0.09256811, 0.88329454,
            0.03911254, 0.78255398, 0.40048119, 0.80732702, 0.80103792, 0.28867772, 0.78029255,
            0.94905287, 0.53957024, 0.13691019, 0.45134852, 0.1162144, 0.9589836, 0.24819063,
            0.31490639, 0.22322156, 0.39812055, 0.45308355, 0.57115231, 0.97817532, 0.06805564,
            0.53866458, 0.66998012, 0.18794561, 0.84073161, 0.64728754, 0.53731097, 0.63207714,
            0.00916763, 0.46754488, 0.86709823, 0.1932068, 0.43971534, 0.10441232, 0.46486123,
            0.22910197, 0.76790192, 0.23872072, 0.03931138, 0.85515021, 0.19610136, 0.85550643,
            0.08035297,
        ],
    )
    .unwrap();
    let conv_layer11 = ConvolutionLayer::new(kernel11, 1, Padding::Valid);
    let target_output11 = array![
        [
            [
                6.66509104, 6.31778193, 6.34955406, 7.26062775, 6.84357882, 5.70804691, 6.05681944,
                5.80831289, 6.12562418, 7.54530239, 7.59644985
            ],
            [
                5.45381021, 6.47295332, 5.15516233, 6.27142334, 6.9677825, 5.52292538, 6.20883846,
                6.68355608, 5.99477863, 7.13237286, 7.29419327
            ],
            [
                6.16150141, 6.13537788, 6.44919157, 6.08290958, 6.77101088, 6.16454172, 6.22188854,
                6.94959593, 5.84942532, 7.34134912, 7.0510416
            ],
            [
                5.81108475, 5.0150795, 6.01548767, 5.50586224, 6.15787315, 5.4927392, 6.62978697,
                6.45193624, 6.00448561, 6.89444876, 7.55176592
            ],
            [
                5.62911415, 5.55456448, 5.38090229, 5.52609587, 4.82344341, 6.27116585, 6.57465696,
                5.98447227, 5.44580507, 6.24616671, 7.61216259
            ],
            [
                7.2484746, 4.59257317, 5.86470985, 5.5776453, 5.77381849, 5.56059313, 7.45279264,
                6.30798388, 6.441257, 6.46213627, 6.27596569
            ]
        ],
        [
            [
                5.59421873, 5.80048132, 6.39868546, 5.94626617, 5.75660038, 4.64645481, 5.33338737,
                4.79013872, 4.99518919, 6.56213379, 6.68568707
            ],
            [
                5.71318674, 5.9669323, 5.41105652, 6.3113842, 5.65918636, 5.59771061, 6.59386539,
                6.10896778, 6.13276768, 5.93032408, 7.02501059
            ],
            [
                5.85084105, 5.93528271, 5.0740304, 5.77551603, 5.86879826, 5.77893305, 6.63954401,
                6.71322966, 5.98756695, 5.87943459, 6.30014324
            ],
            [
                5.83514452, 5.41880226, 4.5047884, 4.3733778, 4.92083168, 4.56007814, 5.72244596,
                6.22518682, 4.81317186, 6.09947968, 5.82513237
            ],
            [
                5.21148157, 6.04209375, 5.14290953, 4.51149464, 4.3172245, 5.870543, 5.61803055,
                5.96223688, 5.13612366, 5.78282928, 5.24691153
            ],
            [
                5.89602518, 4.95786047, 5.69490099, 5.39433384, 4.77787542, 5.77996445, 6.59075594,
                6.55897474, 6.52473354, 6.09631824, 4.80284452
            ]
        ]
    ];
    let current_output11 = conv_layer11.convolve(&test_input11);

    assert!(
        arr_allclose(&current_output11, &target_output11),
        "{:?} was not equal to {:?}",
        current_output11,
        target_output11
    );

    let test_input12 = array![[
        [
            0.05671094, 0.90919751, 0.27582647, 0.33816597, 0.42012834, 0.77450939, 0.14011143,
            0.47505256, 0.98297565, 0.50859663, 0.22395916, 0.01153891, 0.66960699, 0.12918297,
            0.55476546
        ],
        [
            0.52878305, 0.50677415, 0.14234911, 0.51528562, 0.64461424, 0.9118427, 0.81935076,
            0.98913505, 0.78423016, 0.59264964, 0.35247177, 0.48483033, 0.22649785, 0.04158387,
            0.58142059
        ],
        [
            0.8653732, 0.45242769, 0.44947337, 0.55191289, 0.79122763, 0.75131983, 0.93151158,
            0.03313805, 0.41213845, 0.45310237, 0.01799934, 0.43282272, 0.23842481, 0.20688592,
            0.57869384
        ],
        [
            0.9324833, 0.43915926, 0.53123089, 0.53241858, 0.41495372, 0.22217223, 0.0080786,
            0.65063344, 0.76816233, 0.84216271, 0.27179126, 0.68530317, 0.99556169, 0.77906156,
            0.18006649
        ],
        [
            0.59751925, 0.65555307, 0.94982658, 0.96909938, 0.51224708, 0.38403579, 0.87572036,
            0.72604293, 0.04691354, 0.40678895, 0.35535267, 0.19270385, 0.23519029, 0.66655291,
            0.2640271
        ],
        [
            0.55168146, 0.08576613, 0.95672032, 0.57141143, 0.20602622, 0.75538652, 0.96776002,
            0.44755464, 0.82362134, 0.29203538, 0.30861593, 0.39762704, 0.26186081, 0.9658112,
            0.27424003
        ],
        [
            0.50570756, 0.81148425, 0.5536027, 0.59788685, 0.05054026, 0.28394442, 0.6402348,
            0.02258505, 0.60606998, 0.68343238, 0.80049993, 0.33494932, 0.42950821, 0.37033585,
            0.0394791
        ],
        [
            0.50698832, 0.29841292, 0.93881605, 0.84357476, 0.29760668, 0.25654386, 0.71037216,
            0.14646495, 0.99062756, 0.9552909, 0.79662907, 0.60948931, 0.72719878, 0.09518696,
            0.39577461
        ],
        [
            0.61575269, 0.31079138, 0.46793707, 0.85144907, 0.86081384, 0.82082742, 0.2372746,
            0.69777578, 0.79387192, 0.94631988, 0.99063906, 0.29514915, 0.87954188, 0.74155299,
            0.03520088
        ],
        [
            0.83411528, 0.47134156, 0.26704507, 0.28724008, 0.04289522, 0.58365099, 0.94414074,
            0.5729697, 0.72244124, 0.7707775, 0.02079507, 0.22973805, 0.18128673, 0.05054512,
            0.65237513
        ]
    ]];

    let kernel12: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.27093725, 0.32479269, 0.53774402, 0.08921466, 0.18494033, 0.78120433, 0.15868788,
            0.81183357, 0.21792394, 0.66204943, 0.6886836, 0.39724786, 0.59319295, 0.02472531,
            0.21891201, 0.53421341, 0.40418788, 0.53426074, 0.2046122, 0.29362341, 0.7835011,
            0.47930118, 0.28956241, 0.73207744, 0.55179525, 0.37774231, 0.04187773, 0.2388364,
            0.63051956, 0.97746942, 0.64151327, 0.41629992, 0.04763152, 0.75958186, 0.13098117,
            0.62382413, 0.41020241, 0.57102816, 0.59153586, 0.66274745, 0.64542708, 0.81208469,
            0.22876394, 0.6206928, 0.19057496, 0.46227381, 0.97724451, 0.17967562, 0.27354005,
            0.48198409,
        ],
    )
    .unwrap();
    let conv_layer12 = ConvolutionLayer::new(kernel12, 1, Padding::Valid);
    let target_output12 = array![
        [
            [
                6.18391466, 6.00133896, 6.0734725, 6.91507578, 6.27094364, 5.98138285, 5.98955631,
                5.51062489, 4.39664268, 4.36005783, 4.16524506
            ],
            [
                6.26489925, 5.84593391, 7.15632915, 6.33577967, 6.12629414, 6.147048, 5.63049841,
                5.15042353, 4.39802647, 4.67465687, 4.27304029
            ],
            [
                6.23928022, 5.64209557, 5.98704815, 5.45129776, 5.08571053, 5.85050726, 5.5506258,
                5.29071856, 4.97258711, 5.46363115, 4.30113649
            ],
            [
                6.36315012, 5.77783632, 6.39138174, 5.49444199, 4.83984709, 5.78280449, 6.42331076,
                5.7128334, 5.9283967, 5.67441225, 4.65808678
            ],
            [
                6.59208536, 6.47174978, 6.66873837, 5.84089565, 6.22629166, 6.01390409, 6.75245619,
                5.72108984, 6.60595608, 6.53844213, 5.19010544
            ],
            [
                5.35076046, 5.50900364, 5.77535391, 5.47483206, 5.67213821, 5.97022438, 7.0580349,
                5.57486153, 6.72973347, 5.54384184, 4.79196358
            ]
        ],
        [
            [
                6.70406723, 7.09058619, 7.01576281, 6.41566277, 6.78858995, 6.89786577, 6.1174159,
                4.74137735, 5.64582968, 4.93857241, 4.42803717
            ],
            [
                6.753654, 7.31484365, 7.41038799, 7.31211233, 6.88919115, 7.43165112, 6.36996031,
                5.54315519, 5.35414982, 5.11166859, 4.71580553
            ],
            [
                7.28913641, 6.74592113, 7.62573195, 5.64790058, 5.48491716, 6.41376448, 5.5062151,
                5.08606529, 5.38766384, 5.59364033, 5.03329992
            ],
            [
                6.70531988, 6.09797239, 6.82777405, 6.15292072, 5.79114437, 6.8714447, 6.30888557,
                6.292943, 6.87860489, 6.97663832, 5.59051275
            ],
            [
                6.52448845, 6.01261711, 7.58920383, 7.06985998, 5.45040798, 6.60196495, 6.99377871,
                6.47445917, 7.15902805, 7.04907703, 5.58381605
            ],
            [
                6.26537228, 5.62096453, 7.25860977, 6.20265484, 6.27084494, 7.41106462, 7.3263526,
                6.93466759, 7.3325491, 6.91564178, 5.65574265
            ]
        ]
    ];
    let current_output12 = conv_layer12.convolve(&test_input12);

    assert!(
        arr_allclose(&current_output12, &target_output12),
        "{:?} was not equal to {:?}",
        current_output12,
        target_output12
    );

    let test_input13 = array![[
        [
            0.09082693, 0.62176847, 0.0965838, 0.89049918, 0.53370575, 0.17222154, 0.62424076,
            0.95776685, 0.99836098, 0.15088301
        ],
        [
            0.28713444, 0.35105018, 0.17659021, 0.96740326, 0.65025777, 0.19593079, 0.31190461,
            0.55247457, 0.38556734, 0.18145509
        ],
        [
            0.94255226, 0.70360031, 0.34025519, 0.16401337, 0.28418577, 0.55049183, 0.61480714,
            0.77402505, 0.37459208, 0.25677746
        ],
        [
            0.80441073, 0.17314304, 0.59462265, 0.30094626, 0.06480476, 0.57987543, 0.62549654,
            0.6065069, 0.9259787, 0.36779149
        ],
        [
            0.69532606, 0.83565686, 0.39276573, 0.18570695, 0.61698795, 0.90647069, 0.01547038,
            0.2551995, 0.11438051, 0.03861368
        ],
        [
            0.65245317, 0.36442749, 0.08230381, 0.79969247, 0.27816204, 0.3741886, 0.44356521,
            0.27386905, 0.41718068, 0.14990133
        ],
        [
            0.4750283, 0.63582629, 0.77572674, 0.7072159, 0.34310366, 0.36999545, 0.82008522,
            0.46510442, 0.92308568, 0.86201534
        ],
        [
            0.04691705, 0.12260284, 0.89921829, 0.47400049, 0.74925438, 0.05440097, 0.28273951,
            0.9184355, 0.90649879, 0.70278021
        ],
        [
            0.19125042, 0.86701486, 0.08634489, 0.72265401, 0.7754086, 0.00211577, 0.64434053,
            0.23444229, 0.98491788, 0.98933159
        ],
        [
            0.87634913, 0.48734385, 0.8760625, 0.53053114, 0.01152504, 0.67888745, 0.7615684,
            0.46805379, 0.07214947, 0.549209
        ],
        [
            0.83832534, 0.00365476, 0.97821559, 0.74190564, 0.40790307, 0.00302504, 0.80174474,
            0.76896708, 0.50054826, 0.16478458
        ],
        [
            0.89107825, 0.77630429, 0.73042728, 0.41667555, 0.73489738, 0.71259014, 0.93557405,
            0.37013117, 0.14954912, 0.33766477
        ],
        [
            0.39673003, 0.03940821, 0.2414454, 0.93733051, 0.84819097, 0.92724316, 0.86047886,
            0.92845491, 0.80238469, 0.06647867
        ],
        [
            0.12827316, 0.02774826, 0.89827949, 0.1193029, 0.37523486, 0.28379654, 0.0638791,
            0.08446726, 0.68760882, 0.26305929
        ],
        [
            0.01052708, 0.45302406, 0.10402057, 0.55390824, 0.39986407, 0.53770445, 0.24856173,
            0.12796782, 0.80071911, 0.38390577
        ]
    ]];

    let kernel13: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.69089755, 0.58509184, 0.71101062, 0.17578217, 0.55867786, 0.71616314, 0.32475841,
            0.91969988, 0.46712968, 0.08430128, 0.83232371, 0.49657015, 0.24024557, 0.60874841,
            0.474187, 0.97708859, 0.99522821, 0.77498844, 0.72536879, 0.26021663, 0.88695781,
            0.51814858, 0.58713257, 0.76900614, 0.57457772, 0.81429287, 0.78002182, 0.70697715,
            0.33134555, 0.74070271, 0.58577558, 0.40479861, 0.75061174, 0.11343616, 0.87953979,
            0.83064, 0.88583721, 0.3898591, 0.93507648, 0.96733689, 0.64465624, 0.0283905,
            0.22112075, 0.13918551, 0.34128339, 0.65248053, 0.29187398, 0.70765273,
        ],
    )
    .unwrap();
    let conv_layer13 = ConvolutionLayer::new(kernel13, 1, Padding::Valid);
    let target_output13 = array![
        [
            [3.74956965, 3.69244862, 3.78638482, 4.37827873, 4.52772474, 5.05924034, 4.69972277],
            [4.06937695, 3.64383578, 4.12164164, 4.08679152, 4.20500135, 3.87038112, 3.64810061],
            [4.39029837, 3.20474386, 3.8988452, 3.63041258, 3.58082771, 4.76810503, 3.37259316],
            [4.7791748, 4.34527636, 3.78568077, 3.90654373, 3.98666358, 4.42408228, 4.18620443],
            [4.91672945, 4.48084641, 3.8355186, 4.25848961, 4.18139935, 4.43011475, 4.3276124],
            [4.82303476, 4.63424969, 4.12094355, 4.32098055, 3.69355321, 5.31023502, 5.71769381],
            [4.25220728, 5.3238492, 4.34384203, 4.10086823, 4.76204395, 4.25193119, 6.07354975],
            [5.08272028, 4.66913414, 3.94412684, 4.80997038, 3.93182564, 4.60920954, 5.04547358],
            [5.453547, 4.83324432, 4.86605072, 4.8743763, 4.86232519, 3.88127708, 4.53446627],
            [5.52394247, 5.11283588, 5.53495312, 5.77106428, 5.67588234, 5.31097174, 4.23833561],
            [4.52677393, 5.15890312, 5.10287285, 4.90777254, 4.58131027, 4.92766428, 4.36651134],
            [4.59079027, 3.8684094, 5.29072714, 4.84222412, 4.88681841, 5.17618036, 4.12832785]
        ],
        [
            [4.51902199, 4.65990114, 4.04108906, 5.06739235, 5.35414982, 5.63705397, 5.8608489],
            [4.89850664, 4.26296043, 4.46836901, 4.95474291, 5.07684803, 4.96499968, 4.54160023],
            [5.53226042, 3.98884249, 4.41547298, 4.2616148, 4.5735774, 5.18506765, 4.23392248],
            [5.53776073, 4.83177042, 4.83845568, 4.29027319, 4.40822983, 5.25346899, 4.51789141],
            [5.82440615, 5.55946922, 4.81742954, 5.15123034, 4.59870625, 5.20051718, 4.97058058],
            [5.16163826, 5.51444149, 5.08575439, 5.25188208, 4.37053347, 5.39216137, 6.64739656],
            [5.48327494, 6.0715785, 5.39938641, 4.90363693, 5.16698313, 5.50996494, 6.76228619],
            [5.25522375, 5.93287706, 5.26597929, 4.96137476, 4.88206959, 5.08038282, 6.32405996],
            [6.30409098, 5.8678503, 5.54584694, 5.75627041, 5.3458457, 5.06958151, 5.57974291],
            [6.60366964, 5.78087473, 6.44441319, 6.60067749, 6.47894049, 6.25763273, 5.51016045],
            [5.43023968, 5.72921705, 6.62823963, 6.22393465, 6.02108908, 5.75562334, 5.68521452],
            [4.86710119, 5.01404142, 5.68249273, 5.75749207, 5.79496479, 5.7005477, 4.81022024]
        ],
        [
            [3.95517373, 4.73747206, 3.30915952, 4.07232761, 4.69798517, 5.09044123, 4.28500986],
            [4.5257659, 4.09507847, 3.70423889, 3.74947906, 4.3016448, 3.93156171, 3.14057398],
            [4.4850688, 2.96145916, 3.66373968, 3.80670786, 4.03927517, 5.1447053, 3.71002436],
            [4.74937487, 3.80497503, 4.17076349, 4.35191917, 3.58278346, 4.78988791, 3.78536439],
            [3.97513628, 4.65257215, 4.13911104, 4.14353466, 3.36493182, 3.77139926, 3.53166938],
            [4.81199169, 4.50169659, 3.84477925, 4.81625843, 3.82868624, 4.45281172, 5.32730865],
            [4.60290575, 4.82949448, 4.38304853, 4.116436, 4.92032194, 4.5655508, 6.08476782],
            [4.46632195, 5.06347561, 4.13423872, 3.97725344, 4.27674627, 4.73434639, 5.8723402],
            [5.39559078, 4.8549099, 4.46312952, 5.10730362, 4.58160925, 3.83665514, 5.16982937],
            [6.01159, 4.17470598, 5.17404652, 5.55399084, 5.5553689, 4.89135742, 4.65625],
            [5.13359451, 4.43154001, 4.55931664, 4.86545324, 5.0963707, 4.26101685, 3.93721008],
            [4.26497936, 4.25759411, 5.70227242, 5.60240269, 5.50462198, 5.14079809, 4.0010047]
        ]
    ];
    let current_output13 = conv_layer13.convolve(&test_input13);

    assert!(
        arr_allclose(&current_output13, &target_output13),
        "{:?} was not equal to {:?}",
        current_output13,
        target_output13
    );

    let test_input14 = array![[
        [
            0.32796223, 0.22921298, 0.59572685, 0.57266627, 0.72872377, 0.8248998, 0.29288607,
            0.92347337, 0.25887515, 0.91578676
        ],
        [
            0.80078502, 0.76703621, 0.89904613, 0.84243075, 0.70455592, 0.43518324, 0.48451255,
            0.31151697, 0.10086012, 0.52423534
        ],
        [
            0.19001916, 0.01069371, 0.01020448, 0.12606936, 0.04778918, 0.8456499, 0.57045124,
            0.46361541, 0.75325534, 0.62787766
        ],
        [
            0.3127784, 0.9686197, 0.96754895, 0.57661321, 0.64639047, 0.63473378, 0.52757851,
            0.55145215, 0.08155768, 0.13378454
        ],
        [
            0.22621571, 0.73179848, 0.54283262, 0.90943681, 0.2528448, 0.24383227, 0.74464061,
            0.5544842, 0.01949351, 0.13375893
        ],
        [
            0.04438102, 0.84890004, 0.6848837, 0.92208021, 0.00185038, 0.44556107, 0.00844186,
            0.8082305, 0.33159012, 0.51384732
        ],
        [
            0.65069796, 0.93000012, 0.58097034, 0.54131552, 0.57145609, 0.21683556, 0.85481279,
            0.02262598, 0.62476623, 0.33444465
        ],
        [
            0.98826235, 0.03221937, 0.12669063, 0.50246466, 0.42635268, 0.91064157, 0.77929238,
            0.07601635, 0.6067355, 0.3940292
        ],
        [
            0.30074375, 0.1328066, 0.72018455, 0.34319455, 0.62951615, 0.03357495, 0.03066352,
            0.51702978, 0.92831143, 0.36689134
        ],
        [
            0.63273019, 0.37459056, 0.93406816, 0.33968035, 0.59511477, 0.43509081, 0.70945081,
            0.29612544, 0.80898664, 0.7905302
        ],
        [
            0.47484182, 0.69897064, 0.85952836, 0.70326394, 0.38940283, 0.37933361, 0.22292,
            0.3949557, 0.27719193, 0.86197712
        ],
        [
            0.9255003, 0.30563156, 0.58444322, 0.36121983, 0.09087573, 0.23811614, 0.17829578,
            0.93985691, 0.04807154, 0.75882014
        ],
        [
            0.05337733, 0.19222781, 0.98696714, 0.32119673, 0.38722879, 0.74463385, 0.62609767,
            0.0084233, 0.31085488, 0.10247752
        ],
        [
            0.60939456, 0.00353958, 0.22236562, 0.31823837, 0.96274444, 0.86644696, 0.82056452,
            0.77927851, 0.61566939, 0.59327534
        ],
        [
            0.33567884, 0.96525836, 0.47292595, 0.26693419, 0.70544795, 0.28257244, 0.02662205,
            0.05098573, 0.82932135, 0.94160771
        ]
    ]];

    let kernel14: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.91014123, 0.07020015, 0.84250683, 0.97081367, 0.3117258, 0.11623824, 0.19467542,
            0.09732427, 0.43287596, 0.20617688, 0.88570485, 0.96018511, 0.09430943, 0.28105716,
            0.69428951, 0.07089514, 0.71485813, 0.00085336, 0.23516754, 0.04615124, 0.59699445,
            0.53420082, 0.75324224, 0.38793717, 0.2669936, 0.29911963, 0.73809717, 0.17850904,
            0.65695777, 0.81192583, 0.26960827, 0.12972822, 0.65970521, 0.73459294, 0.64856812,
            0.22981846, 0.24392553, 0.26706977, 0.32711208, 0.95813235, 0.31259445, 0.91530424,
            0.17250775, 0.715259, 0.5014661, 0.72737892, 0.23862323, 0.40936508,
        ],
    )
    .unwrap();
    let conv_layer14 = ConvolutionLayer::new(kernel14, 1, Padding::Valid);
    let target_output14 = array![
        [
            [3.19715548, 2.99027514, 4.18667698, 4.10336828, 4.04947615, 4.27748251, 3.57987595],
            [4.84679127, 4.80974627, 4.22223139, 3.74875331, 3.70792556, 2.85285306, 2.28806806],
            [3.1457243, 3.14247012, 2.67278957, 3.58834505, 3.00543165, 3.70400643, 3.1303308],
            [4.52808332, 4.55017948, 3.96486235, 3.2750299, 3.50492144, 2.98047686, 2.53269219],
            [3.66666198, 4.20797348, 2.96321774, 4.36870384, 3.45908737, 2.38050151, 2.86729717],
            [3.66804218, 3.51011133, 3.51283288, 3.67852521, 2.45894504, 3.28247166, 3.35338521],
            [4.02039528, 3.75241303, 3.12815619, 2.893857, 3.17033911, 3.20477772, 4.10108662],
            [4.17149019, 3.17903066, 3.77926302, 3.99193525, 3.02487922, 3.50758362, 4.1237216],
            [4.0694356, 3.34799194, 3.19419479, 1.9157176, 2.59545875, 3.27864933, 3.3117342],
            [4.27913284, 2.96900463, 3.40175486, 3.02397847, 3.53457785, 3.02119613, 3.69542027],
            [3.84182143, 3.20444846, 4.1847167, 3.8301928, 2.97751546, 2.89974046, 2.961411],
            [3.38650966, 2.69956279, 3.83383703, 3.37296295, 3.7305038, 3.35846972, 3.56227756]
        ],
        [
            [3.70455313, 3.94745755, 3.90915346, 3.92972302, 3.69533467, 3.4891355, 2.84103012],
            [3.19658494, 3.1935575, 3.48270154, 3.56165743, 3.20922852, 3.50610137, 3.14561272],
            [3.66568661, 4.25647211, 3.58045745, 3.04750538, 2.78586721, 3.11765146, 2.55795169],
            [4.11154509, 4.78384018, 3.51134515, 3.30297542, 2.73849535, 3.25709796, 2.58255339],
            [3.43763828, 3.55550241, 3.03703904, 3.28337383, 3.03252983, 3.08617163, 2.97366476],
            [2.76974201, 3.65899897, 3.24917889, 3.71025991, 2.64179111, 2.31682706, 2.71795011],
            [3.25367713, 3.239609, 3.45054603, 3.21974277, 3.2352078, 3.05458164, 3.82986021],
            [3.91906071, 3.26126146, 3.4915545, 2.8138895, 2.65044737, 2.74752378, 3.52399898],
            [3.96990824, 3.2314508, 3.54846811, 2.40127444, 2.59359264, 2.43386602, 3.28312063],
            [3.59837914, 3.53687668, 3.64119339, 2.51706767, 2.78627801, 3.02851248, 2.63632727],
            [3.23279691, 2.53207254, 2.98158503, 3.30903935, 3.47774744, 3.31424642, 3.03592396],
            [3.36963654, 2.99808741, 3.56591272, 3.51162815, 3.22195125, 2.79000926, 2.24390697]
        ],
        [
            [3.89359426, 4.1658721, 4.61798, 4.27946663, 4.59039497, 4.12411642, 3.90823174],
            [4.75302601, 4.79963446, 5.12055159, 4.59534073, 4.01592588, 3.73920584, 3.46088529],
            [4.03803825, 3.61791635, 3.95139408, 3.48814082, 3.64255977, 3.43055224, 3.50148821],
            [5.90901327, 5.04019022, 4.60589218, 3.93235183, 3.90872931, 3.15636516, 3.19930172],
            [4.88990736, 3.95018911, 3.92131829, 3.93371296, 3.4869101, 4.3559742, 3.14773607],
            [3.70419192, 4.21590853, 3.91288924, 3.98755026, 2.73301792, 3.77530694, 3.13464642],
            [3.92316556, 4.53938723, 4.08591652, 4.10362053, 3.27887058, 3.89349008, 3.84221172],
            [3.73078179, 4.23759127, 3.65143633, 3.75765491, 3.7455759, 4.41208744, 3.87064624],
            [4.14055109, 4.11290026, 3.99918771, 2.95972395, 2.7917738, 2.84299254, 4.55131769],
            [4.09576893, 4.10080242, 4.0651145, 2.96111965, 3.72604823, 3.12523937, 4.37159538],
            [3.47458625, 4.00340796, 4.0496192, 3.84200096, 4.35996199, 3.69203639, 3.55078483],
            [3.54437542, 3.80134892, 3.79316664, 3.96807551, 3.45217276, 3.66754651, 3.5025723]
        ]
    ];
    let current_output14 = conv_layer14.convolve(&test_input14);

    assert!(
        arr_allclose(&current_output14, &target_output14),
        "{:?} was not equal to {:?}",
        current_output14,
        target_output14
    );

    let test_input15 = array![[
        [
            0.04974006, 0.86882771, 0.46409306, 0.20740514, 0.19872624, 0.27135859, 0.02647329,
            0.90772042, 0.97377277, 0.47016056
        ],
        [
            0.06899374, 0.47393377, 0.49847801, 0.02369655, 0.10663922, 0.02373338, 0.21085606,
            0.56809617, 0.70259373, 0.4123619
        ],
        [
            0.01858313, 0.25862442, 0.4823392, 0.47215321, 0.59388602, 0.82653426, 0.06712108,
            0.32281389, 0.11140465, 0.59627574
        ],
        [
            0.49184018, 0.83955359, 0.13370071, 0.25792847, 0.54400548, 0.87923629, 0.58678147,
            0.03434712, 0.81235951, 0.67917911
        ],
        [
            0.02545591, 0.2468276, 0.91919081, 0.02958322, 0.20474248, 0.76555797, 0.82307639,
            0.24628638, 0.17773866, 0.17740512
        ],
        [
            0.4937253, 0.94664534, 0.13741272, 0.72861299, 0.53385909, 0.7898385, 0.47936276,
            0.23633895, 0.85722158, 0.06004518
        ],
        [
            0.33472239, 0.50485811, 0.09635731, 0.18004768, 0.24514199, 0.22804099, 0.05106571,
            0.30884217, 0.38737775, 0.7948706
        ],
        [
            0.50525172, 0.23866583, 0.50680708, 0.15044465, 0.09537497, 0.13518302, 0.72579789,
            0.8645809, 0.71760467, 0.09527912
        ],
        [
            0.72005635, 0.73822259, 0.41232715, 0.54910611, 0.71836695, 0.0796247, 0.04476061,
            0.19437055, 0.79608139, 0.6295519
        ],
        [
            0.98046998, 0.56819233, 0.10505454, 0.94805061, 0.10080673, 0.95383711, 0.23554011,
            0.94827145, 0.46488547, 0.6026009
        ],
        [
            0.76637876, 0.3219317, 0.4168223, 0.25562466, 0.89971455, 0.59076215, 0.22263806,
            0.68407231, 0.24348243, 0.94946456
        ],
        [
            0.34627815, 0.97489059, 0.74076656, 0.96770884, 0.13005458, 0.69001644, 0.14445187,
            0.92162489, 0.03732051, 0.44508552
        ],
        [
            0.66653196, 0.9382296, 0.80578686, 0.97614501, 0.60987449, 0.04455515, 0.5690737,
            0.64281972, 0.21377263, 0.66924338
        ],
        [
            0.86947585, 0.12576633, 0.81548239, 0.36465631, 0.32867206, 0.00950876, 0.02384425,
            0.68798538, 0.62435431, 0.061506
        ],
        [
            0.4878141, 0.24558065, 0.15653012, 0.40195073, 0.52372195, 0.62839465, 0.67610437,
            0.63705762, 0.74306165, 0.82828889
        ]
    ]];

    let kernel15: Array4<f32> = Array::from_shape_vec(
        (3, 1, 4, 4),
        vec![
            0.39436254, 0.45260344, 0.66066552, 0.73097629, 0.40489907, 0.95513747, 0.44314739,
            0.66317318, 0.18731794, 0.43634079, 0.4686375, 0.76206472, 0.57885796, 0.26523941,
            0.13030814, 0.79954732, 0.95100098, 0.58605653, 0.82163815, 0.21192186, 0.12197075,
            0.06249312, 0.39688331, 0.23130116, 0.67013899, 0.89535372, 0.96970482, 0.71544569,
            0.82037819, 0.21395261, 0.74579813, 0.71471521, 0.05275503, 0.93545915, 0.89868745,
            0.86908559, 0.63580819, 0.15263816, 0.74669492, 0.62358908, 0.62486134, 0.73523241,
            0.23342585, 0.98271262, 0.93357895, 0.96423954, 0.02081718, 0.47192466,
        ],
    )
    .unwrap();
    let conv_layer15 = ConvolutionLayer::new(kernel15, 1, Padding::Valid);
    let target_output15 = array![
        [
            [3.02150965, 3.50697494, 3.0182507, 2.2955687, 2.8196249, 4.09807634, 4.27880239],
            [2.31108689, 2.97990537, 3.99396443, 3.37079954, 3.29356551, 3.50096726, 3.61614943],
            [3.72264767, 3.73247623, 4.36342764, 4.58337021, 3.94724107, 4.17540312, 2.74285531],
            [3.13320494, 3.60928059, 3.68400121, 3.79504156, 3.67281055, 4.16861343, 3.48292112],
            [3.40628791, 2.65028715, 3.42175937, 3.68138409, 3.7723968, 3.88007474, 3.27344394],
            [3.68270707, 3.43757844, 2.63475871, 3.08396387, 3.27603507, 3.85991311, 3.52737379],
            [3.8713119, 2.93535542, 2.73116779, 2.43906832, 2.9607532, 4.04933119, 4.37401819],
            [4.28660965, 3.62805581, 3.59849858, 3.18546438, 4.24751806, 3.9315784, 4.4315033],
            [4.91030025, 4.22151852, 4.88480139, 3.37310529, 4.24205542, 3.40330291, 4.56514645],
            [5.47328138, 4.64017916, 4.4260025, 4.45322418, 4.84955978, 3.4495883, 4.59952402],
            [5.54179764, 4.8084898, 4.5616188, 3.20076036, 4.29245615, 3.13568187, 3.82687759],
            [5.51211166, 4.89622545, 4.11989546, 3.60523844, 3.76916504, 3.99248505, 4.17061043]
        ],
        [
            [3.13982606, 4.22024441, 4.00599003, 3.71078825, 3.32235837, 4.08960867, 4.34097815],
            [3.25287628, 3.06055951, 4.03318024, 3.74710941, 3.50135636, 3.86465549, 4.09354305],
            [3.27216554, 4.27592134, 4.47024298, 5.21853924, 4.46524334, 4.61507988, 3.22156119],
            [3.93060541, 3.9408102, 3.57451773, 4.40335226, 4.18606997, 4.17026901, 3.98895574],
            [3.12247062, 2.63700843, 2.92117023, 2.85934496, 3.63655519, 4.06785774, 4.17682695],
            [4.04389572, 4.33296776, 3.04870105, 3.42804551, 3.83638453, 4.53216505, 4.82105637],
            [4.6620636, 4.05705357, 3.1546948, 3.55836964, 2.85764885, 3.87746382, 3.76561356],
            [4.630373, 3.82096148, 4.25457621, 3.43863201, 4.45269012, 5.00887489, 5.36390924],
            [5.11430359, 5.2760067, 4.86196613, 4.72167444, 4.05046368, 3.78908563, 3.69457674],
            [6.45255995, 6.2311058, 4.8402524, 5.07631636, 4.34072256, 4.63923311, 4.19430828],
            [6.31062412, 5.04811954, 4.80889034, 3.78054762, 4.10073042, 4.0614562, 3.52624798],
            [5.00358868, 5.18942118, 4.18895578, 3.85916114, 3.5615387, 4.65950727, 4.27024603]
        ],
        [
            [4.08745003, 3.68556476, 3.4471035, 2.69540668, 4.35591841, 5.13210011, 4.94641876],
            [3.1255765, 3.99794245, 4.01895285, 3.32788086, 3.6860075, 5.55044413, 4.42159176],
            [3.94971776, 4.81287718, 5.40897226, 5.24527359, 4.59150743, 4.59887457, 3.96509504],
            [4.55317163, 3.39188266, 4.61922789, 4.89413309, 4.27758121, 4.43421793, 3.64872265],
            [3.66252756, 4.00611305, 3.17314649, 4.00375605, 3.92477012, 4.28804064, 4.30779648],
            [4.55152369, 4.00807333, 3.81838965, 4.15530968, 3.84274483, 4.09479475, 3.82667851],
            [5.10430002, 3.1901691, 3.46447802, 3.19903898, 3.87806058, 4.23090506, 4.92291594],
            [5.19872665, 3.98009396, 3.95940399, 3.73975563, 5.64687538, 5.12849283, 5.48560047],
            [5.75558329, 5.84790945, 5.32376051, 4.5779891, 4.24389029, 4.30504799, 5.33045721],
            [6.57006645, 5.55661488, 6.76624584, 4.85822153, 5.64397717, 4.09286547, 5.54621077],
            [5.83961582, 6.02748156, 5.26080036, 5.11676836, 4.08485985, 3.38523006, 4.49703836],
            [6.28400135, 5.27779675, 4.51029301, 3.72779012, 5.10707521, 4.16084576, 4.70575905]
        ]
    ];
    let current_output15 = conv_layer15.convolve(&test_input15);

    assert!(
        arr_allclose(&current_output15, &target_output15),
        "{:?} was not equal to {:?}",
        current_output15,
        target_output15
    );

    let test_input16 = array![[
        [
            0.50718916, 0.9034243, 0.67857299, 0.48106776, 0.27722874, 0.0061415, 0.2891619,
            0.99375291, 0.02278532, 0.76614291
        ],
        [
            0.23943478, 0.75684809, 0.1846646, 0.05945846, 0.75223735, 0.72325596, 0.56901877,
            0.80126183, 0.13196982, 0.25499959
        ],
        [
            0.96842652, 0.09975351, 0.65753681, 0.01221572, 0.56905168, 0.86330318, 0.5916843,
            0.73279841, 0.38392547, 0.45234742
        ],
        [
            0.88714563, 0.48625888, 0.49746638, 0.280569, 0.32727791, 0.73086985, 0.16297499,
            0.86902393, 0.58347085, 0.33016786
        ],
        [
            0.24064531, 0.59915099, 0.8538999, 0.30761604, 0.3641591, 0.11430371, 0.45364544,
            0.69845229, 0.70536543, 0.40033871
        ],
        [
            0.38632824, 0.91106906, 0.51805139, 0.18372489, 0.38816592, 0.16589011, 0.91154296,
            0.93466867, 0.90793376, 0.62180165
        ],
        [
            0.71993128, 0.5790186, 0.58128011, 0.58975808, 0.00632351, 0.51240735, 0.36974571,
            0.13892106, 0.99003674, 0.47229374
        ],
        [
            0.56468744, 0.59834724, 0.6383385, 0.03793695, 0.94503431, 0.96132329, 0.60619489,
            0.63035447, 0.51113712, 0.03746503
        ],
        [
            0.55833499, 0.30164845, 0.68653253, 0.99669343, 0.51277812, 0.25915265, 0.34361983,
            0.66471276, 0.42920146, 0.22015804
        ],
        [
            0.22396304, 0.55329103, 0.21043802, 0.03016802, 0.13123624, 0.4177692, 0.15363416,
            0.26550946, 0.97993737, 0.64686607
        ],
        [
            0.22700246, 0.28266105, 0.75680146, 0.49555436, 0.75771218, 0.20788052, 0.91674454,
            0.56273526, 0.45675125, 0.48490577
        ],
        [
            0.82385765, 0.4200622, 0.82511256, 0.35886786, 0.09741933, 0.50827706, 0.09494946,
            0.93389189, 0.41674573, 0.12654001
        ],
        [
            0.47637335, 0.72644437, 0.22123201, 0.29542014, 0.46568521, 0.68506433, 0.68084162,
            0.37799812, 0.80578898, 0.2891591
        ],
        [
            0.69930453, 0.33186396, 0.97341993, 0.96441959, 0.09362596, 0.04142809, 0.27610768,
            0.43870836, 0.34610719, 0.38488158
        ],
        [
            0.24301769, 0.23232727, 0.32100558, 0.22719597, 0.85453414, 0.76819397, 0.85450962,
            0.65347099, 0.64399242, 0.61992766
        ]
    ]];

    let kernel16: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.5419032, 0.42076096, 0.7094996, 0.88026641, 0.30416232, 0.00992903, 0.07512626,
            0.21167818, 0.95756755, 0.33277866, 0.58041593, 0.14874539, 0.84465177, 0.33960778,
            0.03217437, 0.23459853, 0.86872336, 0.05481404, 0.40751188, 0.13763187, 0.38947831,
            0.19455469, 0.22310271, 0.710135, 0.38075932, 0.36192991, 0.57883709, 0.45671246,
            0.02821647, 0.65663048, 0.68215294, 0.13092386, 0.04243296, 0.40237482, 0.96531998,
            0.08922234, 0.65666055, 0.07955469, 0.30693734, 0.61528814, 0.83010793, 0.90806135,
            0.10633651, 0.95870479, 0.24841434, 0.49642795, 0.02807361, 0.67816274, 0.14359485,
            0.96717686,
        ],
    )
    .unwrap();
    let conv_layer16 = ConvolutionLayer::new(kernel16, 1, Padding::Valid);
    let target_output16 = array![
        [
            [4.77967787, 4.31015253, 4.51019716, 4.38612652, 5.63771534, 4.45273304],
            [3.85176611, 4.92401218, 4.8658967, 5.41777229, 5.6241622, 5.64486504],
            [4.79431009, 4.14767885, 4.79955673, 4.28564501, 5.29490662, 6.0834794],
            [4.7114234, 4.75150871, 4.7124753, 4.00698805, 5.91363049, 5.96436596],
            [5.2175293, 4.86125755, 3.8690691, 5.42812395, 5.6538496, 5.36136961],
            [4.20041275, 3.89304113, 4.92239571, 4.44877005, 5.46171761, 6.44273853],
            [4.93529749, 5.13688135, 4.87261486, 4.62560415, 4.51318741, 4.78147125],
            [4.55972862, 4.77799892, 4.670506, 4.86179447, 5.00412798, 5.07892227],
            [4.64290857, 4.8693819, 4.94835615, 4.03364086, 5.39212179, 4.93606138],
            [5.05697918, 3.60969687, 3.56297016, 4.07640266, 3.8947351, 5.27223587],
            [4.33255148, 4.96540594, 5.36933136, 5.06043577, 5.65823269, 4.97160006]
        ],
        [
            [5.48336363, 5.71605635, 5.1660533, 5.20722866, 5.69152594, 5.46845102],
            [5.27653503, 5.55420256, 5.49112129, 5.7332859, 6.52670097, 5.87080383],
            [5.33694267, 5.93172264, 4.14478779, 5.69695377, 6.21662712, 6.28188896],
            [6.17755365, 5.1396656, 5.83622169, 5.79129314, 5.71085548, 6.04900932],
            [5.34211206, 6.14229107, 5.94267988, 5.70126152, 6.94260263, 5.81597614],
            [5.38002396, 5.44353962, 5.20274544, 5.3844347, 6.25422335, 5.64262438],
            [5.4341855, 5.51816177, 5.78657532, 4.0423646, 5.90529156, 5.03337765],
            [5.61445427, 5.27626991, 4.67449808, 6.88404465, 5.82392931, 5.2127614],
            [4.73347044, 5.58323383, 5.56592941, 4.63272142, 5.8245573, 5.24124527],
            [5.04751301, 4.73442173, 4.55369568, 5.01572371, 5.43008041, 4.95839214],
            [6.04489517, 5.16838408, 6.78882265, 5.8314538, 5.59476662, 5.14606714]
        ]
    ];
    let current_output16 = conv_layer16.convolve(&test_input16);

    assert!(
        arr_allclose(&current_output16, &target_output16),
        "{:?} was not equal to {:?}",
        current_output16,
        target_output16
    );

    let test_input17 = array![[
        [
            0.97005397, 0.53526694, 0.78941801, 0.44380167, 0.16963241, 0.22258878, 0.54548246,
            0.33204897, 0.6242531, 0.39491079
        ],
        [
            0.95525232, 0.17685722, 0.43900622, 0.25685028, 0.96196441, 0.70541543, 0.25693817,
            0.06693319, 0.71142706, 0.30001205
        ],
        [
            0.24983038, 0.04385824, 0.83179815, 0.9035203, 0.99454165, 0.4820838, 0.22076631,
            0.6613494, 0.65310255, 0.94143701
        ],
        [
            0.02962555, 0.00604056, 0.67496017, 0.09254023, 0.16296797, 0.76942613, 0.49170364,
            0.04446485, 0.81149441, 0.29030006
        ],
        [
            0.19190631, 0.18254054, 0.13724733, 0.00911832, 0.20514874, 0.59104546, 0.81518296,
            0.26495344, 0.62743607, 0.94401775
        ],
        [
            0.54503895, 0.64316468, 0.52856827, 0.51207055, 0.03335644, 0.28076501, 0.07791043,
            0.86478264, 0.98050101, 0.54355016
        ],
        [
            0.03467919, 0.88657197, 0.36146563, 0.13580919, 0.88198291, 0.48148783, 0.09721046,
            0.7819647, 0.49357224, 0.6708243
        ],
        [
            0.72222506, 0.36648302, 0.37231641, 0.11044633, 0.88196934, 0.78123719, 0.25462821,
            0.82228467, 0.328725, 0.78940447
        ],
        [
            0.46583236, 0.30093508, 0.90517751, 0.70023278, 0.750793, 0.75040493, 0.53337294,
            0.51972126, 0.72387765, 0.98317071
        ],
        [
            0.20632542, 0.16955712, 0.76152087, 0.05444199, 0.28148171, 0.15761588, 0.95890854,
            0.90069482, 0.01261302, 0.21181778
        ],
        [
            0.78206101, 0.92161582, 0.74544141, 0.88165923, 0.99766619, 0.2966056, 0.2162454,
            0.06208929, 0.50320556, 0.65657977
        ],
        [
            0.53518538, 0.10227188, 0.28489799, 0.20003574, 0.18222419, 0.05310873, 0.13790857,
            0.78958033, 0.5917116, 0.38009273
        ],
        [
            0.27422508, 0.90411151, 0.99974847, 0.90908507, 0.4171188, 0.48332874, 0.169661,
            0.15740211, 0.04401799, 0.33348853
        ],
        [
            0.42292984, 0.47983043, 0.90991353, 0.54084136, 0.48263519, 0.56740319, 0.62469666,
            0.70394503, 0.12639284, 0.16602973
        ],
        [
            0.46498439, 0.36747121, 0.75747912, 0.91581801, 0.02039539, 0.51063865, 0.6296097,
            0.55201156, 0.25472447, 0.48130554
        ]
    ]];

    let kernel17: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.324559, 0.66492974, 0.01730853, 0.77949586, 0.13672463, 0.73892077, 0.02376527,
            0.87988772, 0.63560668, 0.22369854, 0.58457098, 0.96449508, 0.79775544, 0.32541804,
            0.10196066, 0.82326738, 0.85434138, 0.97105842, 0.50513296, 0.04858193, 0.16233305,
            0.65101499, 0.62667716, 0.04012987, 0.8986551, 0.59885723, 0.75486132, 0.92305233,
            0.80947357, 0.41193416, 0.11411006, 0.29621909, 0.86571361, 0.30998129, 0.78179376,
            0.55146949, 0.93096709, 0.35345063, 0.04673942, 0.2836077, 0.4491099, 0.16020048,
            0.0033604, 0.70367989, 0.09309967, 0.8027366, 0.66168623, 0.75922126, 0.98626302,
            0.41794769,
        ],
    )
    .unwrap();
    let conv_layer17 = ConvolutionLayer::new(kernel17, 1, Padding::Valid);
    let target_output17 = array![
        [
            [4.93603754, 5.38206816, 6.93416834, 5.74352551, 6.05059576, 6.60462523],
            [4.44033957, 5.07883215, 4.87576246, 5.5804081, 6.55166388, 6.78796673],
            [5.47685003, 4.61637259, 4.92256975, 5.67279339, 5.34354544, 6.70943165],
            [4.60357809, 5.17517471, 5.18260384, 5.56999445, 5.4347167, 6.90373135],
            [5.64454365, 5.71706724, 5.71385479, 6.44876289, 6.685359, 7.87061501],
            [5.65035152, 5.94015551, 7.10522079, 6.23906946, 7.00799704, 7.44886065],
            [6.78144026, 6.81125975, 6.92024088, 5.92544746, 7.30510187, 6.78514242],
            [6.54282331, 6.80508375, 6.57979441, 6.3084054, 6.46070862, 6.00084448],
            [6.8544035, 6.55581903, 6.56049156, 5.36406374, 5.29151344, 4.78987503],
            [6.89066219, 7.79097605, 6.40847778, 5.70883989, 4.57193422, 4.34241486],
            [7.47073317, 7.97271061, 6.83005142, 5.74705219, 5.26631403, 5.57937622]
        ],
        [
            [4.88339329, 5.06957817, 6.58554649, 5.95388174, 5.71174812, 6.44275141],
            [5.77001858, 6.06110144, 5.91206694, 5.39928579, 6.03700924, 7.08113146],
            [5.32454967, 6.38339329, 5.95278883, 5.47069311, 7.2678256, 6.90201235],
            [4.1838851, 5.69415951, 5.73497868, 5.20518446, 7.04161406, 6.57153273],
            [5.40399408, 5.92940903, 5.65338135, 6.60012245, 7.57960176, 7.66297817],
            [6.01595497, 5.13117981, 5.30829287, 6.28137207, 6.64295912, 7.24962187],
            [7.11359024, 7.89880753, 7.31964016, 7.44799185, 6.63551712, 6.21667194],
            [6.06035566, 6.13617802, 5.63510656, 5.67172861, 6.236269, 7.11464787],
            [8.12838173, 7.49013996, 7.87492228, 6.99517727, 6.13226557, 5.47345066],
            [6.76026726, 6.08451319, 6.42716932, 5.54078341, 5.47635508, 5.04436636],
            [7.824965, 7.61322737, 7.302248, 6.46663332, 5.20160532, 5.02342987]
        ]
    ];
    let current_output17 = conv_layer17.convolve(&test_input17);

    assert!(
        arr_allclose(&current_output17, &target_output17),
        "{:?} was not equal to {:?}",
        current_output17,
        target_output17
    );

    let test_input18 = array![[
        [
            0.85175452, 0.69523071, 0.89098162, 0.77955643, 0.25186004, 0.69679788, 0.44887285,
            0.44314901, 0.75464064, 0.81323265
        ],
        [
            0.85127236, 0.15431848, 0.56885447, 0.29611066, 0.87579246, 0.95318211, 0.5536974,
            0.53754665, 0.23263316, 0.52779298
        ],
        [
            0.67977367, 0.74194602, 0.01885639, 0.08134871, 0.67013964, 0.42471457, 0.93320845,
            0.69664936, 0.5644708, 0.03809474
        ],
        [
            0.09368633, 0.52132452, 0.78672022, 0.51032958, 0.05583452, 0.78634884, 0.56742164,
            0.06023929, 0.39982171, 0.32429225
        ],
        [
            0.11995548, 0.89870727, 0.16025589, 0.33672986, 0.74226097, 0.14132027, 0.06929818,
            0.4782574, 0.5697997, 0.11632108
        ],
        [
            0.49556066, 0.47647961, 0.74170323, 0.34966558, 0.47131558, 0.98382828, 0.67772886,
            0.90295657, 0.67075131, 0.0573609
        ],
        [
            0.8237337, 0.36602103, 0.15022675, 0.66375136, 0.17951131, 0.71209091, 0.48833874,
            0.85454535, 0.18296849, 0.10698621
        ],
        [
            0.61914566, 0.5212063, 0.92237302, 0.65213787, 0.45965454, 0.3666493, 0.99957266,
            0.63527644, 0.17045998, 0.32906871
        ],
        [
            0.39238517, 0.83307838, 0.24240606, 0.16471672, 0.39931871, 0.18019378, 0.04206449,
            0.49676638, 0.8137173, 0.2356948
        ],
        [
            0.4160782, 0.96484394, 0.08041501, 0.65951823, 0.8111227, 0.50445548, 0.5347742,
            0.65936247, 0.2873256, 0.93752427
        ],
        [
            0.77539968, 0.72337473, 0.58495981, 0.73156758, 0.51474295, 0.92627021, 0.29888561,
            0.62928632, 0.33485918, 0.68505601
        ],
        [
            0.09462127, 0.39446757, 0.73533658, 0.06431016, 0.30438656, 0.65234167, 0.58759433,
            0.62632952, 0.4344534, 0.21980144
        ],
        [
            0.00100083, 0.69211635, 0.84722637, 0.35980777, 0.88600021, 0.35318831, 0.25727804,
            0.25435161, 0.75035382, 0.4171089
        ],
        [
            0.7314984, 0.4653744, 0.71255461, 0.95627283, 0.98759052, 0.22617352, 0.74177312,
            0.37862287, 0.50947449, 0.18060002
        ],
        [
            0.96206714, 0.49016727, 0.45882289, 0.75507285, 0.45673514, 0.96909469, 0.10567724,
            0.27288928, 0.70271284, 0.84723967
        ]
    ]];

    let kernel18: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.55496893, 0.91851916, 0.96721133, 0.64802116, 0.21997769, 0.38427271, 0.94689554,
            0.74909703, 0.32829218, 0.2643334, 0.34910949, 0.30524121, 0.50387048, 0.37622158,
            0.04119791, 0.71312951, 0.14328648, 0.13365868, 0.36297328, 0.68727153, 0.93408337,
            0.21441842, 0.91439056, 0.40976977, 0.99539249, 0.3781238, 0.28116078, 0.97598533,
            0.36442432, 0.14792817, 0.83921394, 0.62525704, 0.09807893, 0.3419448, 0.94809758,
            0.12152596, 0.29696486, 0.41873358, 0.95614773, 0.47523478, 0.25687808, 0.76020871,
            0.78506594, 0.43647116, 0.97631707, 0.26839126, 0.08090039, 0.48662945, 0.70590996,
            0.99664134,
        ],
    )
    .unwrap();
    let conv_layer18 = ConvolutionLayer::new(kernel18, 1, Padding::Valid);
    let target_output18 = array![
        [
            [6.09158468, 6.94928885, 6.53053141, 6.3657465, 6.75326204, 6.35432625],
            [6.23697996, 6.27228355, 6.56156492, 7.87261677, 8.05043983, 6.91359472],
            [5.54019499, 6.5100441, 5.72771311, 7.0060873, 6.75298071, 6.70804644],
            [7.08427668, 6.29190969, 6.98336267, 7.0608387, 5.96453571, 5.66934109],
            [6.02112818, 5.98441219, 5.70310211, 6.09382725, 6.31856489, 5.8097887],
            [6.41814327, 7.08882999, 6.13202906, 7.19810772, 7.98023415, 7.68254948],
            [7.22706938, 7.70339537, 6.20394135, 7.18026638, 6.48515129, 7.75742912],
            [6.80963898, 6.89705849, 6.44496441, 6.45441389, 6.3569994, 6.63254976],
            [6.46755075, 6.34067678, 6.71013069, 5.56387854, 6.17938185, 5.90263128],
            [7.92092371, 7.53257847, 7.94888878, 7.19991827, 8.00648212, 6.08469868],
            [8.01725292, 7.85562372, 6.97638798, 7.33560944, 6.94140911, 6.80730247]
        ],
        [
            [6.68945551, 7.16649437, 6.00956249, 6.31555128, 6.94879436, 6.14076614],
            [6.82798719, 5.92972136, 6.87273169, 7.30533552, 6.74759054, 5.38232374],
            [5.00112772, 6.88786077, 6.45505428, 6.61580706, 7.08313465, 6.32497692],
            [6.36027956, 6.39571857, 6.30263233, 7.74390125, 6.89451838, 4.93687391],
            [5.84931469, 6.56432819, 6.68252468, 6.19790268, 6.93936825, 6.05272198],
            [6.92165327, 6.01360321, 5.86599159, 7.46216869, 6.48016262, 6.46453524],
            [6.73202848, 6.84900904, 6.80772209, 7.19204807, 5.87289047, 7.41345072],
            [7.07633495, 7.31698275, 6.19446611, 6.88939953, 7.10990667, 5.92226315],
            [7.0235467, 6.78413296, 5.89861679, 5.97506046, 6.36606407, 6.51124001],
            [7.86233902, 7.80073357, 7.24844837, 6.9699688, 7.06949615, 6.11919594],
            [7.43652916, 8.38586712, 7.52329397, 6.37717009, 6.10878325, 6.8063879]
        ]
    ];
    let current_output18 = conv_layer18.convolve(&test_input18);

    assert!(
        arr_allclose(&current_output18, &target_output18),
        "{:?} was not equal to {:?}",
        current_output18,
        target_output18
    );

    let test_input19 = array![
        [
            [
                0.77797665, 0.2436962, 0.6407154, 0.34835713, 0.87617954, 0.19121104, 0.5305259,
                0.65651311, 0.52872786, 0.29444506
            ],
            [
                0.77558901, 0.24550702, 0.95322045, 0.87540913, 0.34133301, 0.63829989, 0.51254486,
                0.50059186, 0.93735199, 0.62244836
            ],
            [
                0.14624618, 0.84175252, 0.94145869, 0.44898897, 0.69933211, 0.36183158, 0.24969168,
                0.96716423, 0.20102102, 0.79905301
            ],
            [
                0.29777643, 0.05473179, 0.82243273, 0.49220118, 0.959262, 0.60974809, 0.82510736,
                0.77621485, 0.31383016, 0.20135997
            ],
            [
                0.40562742, 0.25492424, 0.58743709, 0.69954113, 0.11803117, 0.95850575, 0.90317617,
                0.82405072, 0.77356562, 0.58680465
            ],
            [
                0.50450674, 0.31319898, 0.23300357, 0.80954467, 0.34135282, 0.24274388, 0.67290714,
                0.57593448, 0.80855957, 0.70183952
            ],
            [
                0.76145006, 0.58241341, 0.3309161, 0.67546682, 0.32411023, 0.39496991, 0.41204399,
                0.84085379, 0.76511307, 0.8994237
            ],
            [
                0.83643666, 0.38108206, 0.69459298, 0.84416068, 0.40802578, 0.95296427, 0.72987187,
                0.07076581, 0.8826578, 0.44925806
            ],
            [
                0.8213124, 0.61120748, 0.96117721, 0.3876701, 0.88056745, 0.94836312, 0.8974017,
                0.4120727, 0.27696644, 0.69025475
            ],
            [
                0.42224764, 0.96611448, 0.04551166, 0.40275672, 0.19091434, 0.44375269, 0.31289253,
                0.23962151, 0.63893185, 0.85605003
            ]
        ],
        [
            [
                0.27247687, 0.19161025, 0.50402257, 0.58524975, 0.97299683, 0.59472298, 0.38096266,
                0.29591832, 0.28942941, 0.4529504
            ],
            [
                0.19683413, 0.1757779, 0.88774994, 0.52295888, 0.71379829, 0.82603577, 0.8461087,
                0.90917349, 0.80568945, 0.79286723
            ],
            [
                0.34100041, 0.32917508, 0.17503857, 0.78460036, 0.72724448, 0.48829707, 0.9584728,
                0.74692632, 0.66009417, 0.59341494
            ],
            [
                0.42636783, 0.9874962, 0.8519623, 0.43363969, 0.02657376, 0.11542477, 0.13354255,
                0.5618466, 0.07023699, 0.35689689
            ],
            [
                0.27853092, 0.81448411, 0.99201185, 0.66855964, 0.56708078, 0.68718494, 0.73198697,
                0.84016348, 0.55920875, 0.27009217
            ],
            [
                0.10123584, 0.26360001, 0.96576889, 0.005051, 0.55768741, 0.90251369, 0.55897934,
                0.35369453, 0.94294266, 0.51621787
            ],
            [
                0.59068772, 0.05157892, 0.76241788, 0.07249359, 0.45541913, 0.01278013, 0.4782056,
                0.76319753, 0.55419777, 0.04795831
            ],
            [
                0.58152421, 0.27330734, 0.88154588, 0.29006036, 0.23429064, 0.18781202, 0.94584272,
                0.45230761, 0.29750833, 0.17197817
            ],
            [
                0.06818328, 0.69870181, 0.60906574, 0.24505253, 0.81694578, 0.03939038, 0.5665328,
                0.80118929, 0.75747067, 0.15554731
            ],
            [
                0.18986696, 0.13435428, 0.38600448, 0.19166702, 0.46490033, 0.18260308, 0.82895695,
                0.03558233, 0.14173116, 0.88772247
            ]
        ]
    ];

    let kernel19: Array4<f32> = Array::from_shape_vec(
        (3, 2, 4, 4),
        vec![
            0.12655612, 0.47548521, 0.78434719, 0.89129077, 0.15408872, 0.45979473, 0.18853948,
            0.826404, 0.84971782, 0.36331992, 0.98673576, 0.43612493, 0.03541405, 0.783278,
            0.24658875, 0.74658082, 0.34663446, 0.03917093, 0.39318948, 0.30789323, 0.68702212,
            0.44194368, 0.33855646, 0.91193131, 0.31810584, 0.16017109, 0.00698695, 0.29351898,
            0.14280626, 0.48469457, 0.1767692, 0.42322085, 0.46112145, 0.92553811, 0.55322419,
            0.9853486, 0.24325794, 0.63504065, 0.15406865, 0.11709648, 0.1119092, 0.21574858,
            0.62331999, 0.8729103, 0.52609012, 0.06899712, 0.61684947, 0.3181057, 0.1008886,
            0.28579374, 0.08647749, 0.84640182, 0.5181164, 0.47873197, 0.83375128, 0.9057766,
            0.00922728, 0.36432304, 0.53910845, 0.47707381, 0.23459193, 0.61045031, 0.99977492,
            0.2879088, 0.92371205, 0.24345837, 0.00414109, 0.03638968, 0.30595167, 0.16491043,
            0.70878765, 0.79154644, 0.60650112, 0.46475388, 0.65852329, 0.93920061, 0.09687402,
            0.55449048, 0.56360938, 0.10987341, 0.79093268, 0.68275111, 0.93982805, 0.14053225,
            0.49555323, 0.4556152, 0.66896225, 0.46089745, 0.33559954, 0.30389078, 0.73881618,
            0.56410859, 0.07862057, 0.46463864, 0.07132971, 0.56969289,
        ],
    )
    .unwrap();
    let conv_layer19 = ConvolutionLayer::new(kernel19, 1, Padding::Valid);
    let target_output19 = array![
        [
            [7.07854223, 8.55239487, 8.47744465, 7.67661524, 8.177001, 8.12802792, 7.46604156],
            [7.94075251, 7.84961796, 8.81249905, 8.33015442, 9.80285454, 8.77408218, 9.06686592],
            [7.0293088, 7.83275604, 7.10514259, 7.49307299, 7.85354137, 8.01932335, 7.93538189],
            [6.71983385, 7.44521332, 7.67160606, 7.39395428, 8.25910378, 8.33933926, 7.93097305],
            [6.7596879, 6.81519938, 7.67412853, 7.61524296, 7.78765297, 9.49663544, 7.86601877],
            [7.11916208, 7.03946447, 6.92986107, 7.78295898, 7.50352907, 7.93098736, 8.33669949],
            [7.55213118, 5.97493982, 7.25675821, 6.935853, 7.14681482, 7.55945492, 7.44989586]
        ],
        [
            [8.169384, 9.14911079, 8.7085638, 7.83978176, 8.8815937, 8.48216915, 8.16163254],
            [9.10290432, 9.42352867, 8.95096874, 9.44783306, 9.60045052, 9.72675228, 9.22154903],
            [8.77595711, 8.29251385, 7.34519339, 8.45519447, 8.89475632, 8.01042557, 8.83452892],
            [7.70266581, 7.97273779, 7.51875305, 7.84918022, 8.96656132, 9.18450546, 8.76002598],
            [
                7.69859314,
                6.79889584,
                7.95225906,
                7.93523359,
                8.93863201,
                10.08522511,
                9.24000168
            ],
            [7.71637297, 6.86759472, 7.79598188, 7.3242507, 7.5977869, 8.96841908, 8.4044838],
            [6.89602137, 7.06150532, 6.49225664, 7.29936457, 7.93477345, 7.4916625, 7.35938549]
        ],
        [
            [8.03935814, 8.30807972, 9.18939495, 8.60457134, 9.69528389, 8.20829582, 8.68028069],
            [7.96715355, 8.41888714, 9.13591385, 8.69437313, 9.96138, 9.43733692, 8.73396397],
            [7.13753891, 8.52253056, 8.93212128, 8.46282482, 9.30639744, 9.25186443, 8.30853271],
            [7.81916666, 7.52143097, 7.52969503, 7.82208538, 7.79159355, 8.91422081, 8.87988186],
            [7.6782093, 7.5681448, 7.44613552, 7.76158714, 8.20129681, 9.67425442, 9.39060211],
            [8.24262905, 6.83957148, 7.10861111, 8.24534607, 8.12429333, 8.6132431, 8.28680038],
            [8.17888451, 7.11459112, 7.55475855, 7.49439621, 7.02914906, 7.38558769, 8.07972717]
        ]
    ];
    let current_output19 = conv_layer19.convolve(&test_input19);

    assert!(
        arr_allclose(&current_output19, &target_output19),
        "{:?} was not equal to {:?}",
        current_output19,
        target_output19
    );

    let test_input20 = array![
        [
            [
                0.89171883, 0.97521319, 0.86021405, 0.61829454, 0.40998869, 0.3409378, 0.49427043,
                0.10122171, 0.23691536, 0.70967704
            ],
            [
                0.46413839, 0.83261815, 0.38735757, 0.94895509, 0.07998311, 0.51110605, 0.02956773,
                0.17711017, 0.11328587, 0.74999444
            ],
            [
                0.85890063, 0.07875008, 0.73433581, 0.4188041, 0.48477762, 0.00624699, 0.62862881,
                0.21567077, 0.81573006, 0.70090976
            ],
            [
                0.8734742, 0.64821486, 0.5717835, 0.16271726, 0.53025379, 0.0984337, 0.82271061,
                0.12299971, 0.06295575, 0.79538949
            ],
            [
                0.59333579, 0.27819812, 0.70772565, 0.88466563, 0.33805057, 0.66772457, 0.9335431,
                0.0900248, 0.08626243, 0.0064692
            ],
            [
                0.97915132, 0.52760126, 0.61633665, 0.97595711, 0.54319958, 0.11189566, 0.66231298,
                0.47249613, 0.88115114, 0.93577167
            ],
            [
                0.61019061, 0.4513792, 0.21412608, 0.21063799, 0.59758916, 0.26163143, 0.57292384,
                0.3575447, 0.41482433, 0.56862119
            ],
            [
                0.43116545, 0.88888712, 0.59890786, 0.96428143, 0.67385224, 0.18009396, 0.65008404,
                0.1288117, 0.60346005, 0.23165825
            ],
            [
                0.01380609, 0.45430455, 0.35102451, 0.37587899, 0.79313242, 0.20369535, 0.9617992,
                0.17212614, 0.86613916, 0.818001
            ],
            [
                0.04731771, 0.63314852, 0.83272296, 0.58803685, 0.67738035, 0.96657098, 0.59957683,
                0.85136724, 0.03105091, 0.388052
            ]
        ],
        [
            [
                0.55736135, 0.02805966, 0.80824123, 0.57193865, 0.9242484, 0.43400673, 0.95459734,
                0.19825369, 0.31652351, 0.34878273
            ],
            [
                0.04700416, 0.89200941, 0.8226108, 0.49845084, 0.02590412, 0.33210731, 0.9764468,
                0.53812272, 0.92109437, 0.77103208
            ],
            [
                0.86606787, 0.38955377, 0.85489501, 0.07690383, 0.03470363, 0.623576, 0.74470608,
                0.23551573, 0.09116794, 0.13018293
            ],
            [
                0.29478395, 0.69404102, 0.0967541, 0.82667353, 0.00767931, 0.24422543, 0.47754805,
                0.05508777, 0.30187264, 0.58673539
            ],
            [
                0.38990366, 0.61692172, 0.5919785, 0.35687553, 0.9651153, 0.31502705, 0.15851367,
                0.90410785, 0.24201743, 0.99100995
            ],
            [
                0.46153439, 0.52309412, 0.05274187, 0.85842835, 0.85845118, 0.30464407, 0.00721753,
                0.18392334, 0.85564119, 0.1809689
            ],
            [
                0.5768042, 0.3628767, 0.69780507, 0.11757887, 0.08762363, 0.36607083, 0.24363868,
                0.7472844, 0.08178072, 0.88107829
            ],
            [
                0.35692051, 0.45131599, 0.0383365, 0.84656218, 0.98832129, 0.56150498, 0.52739673,
                0.47732064, 0.43933925, 0.21088907
            ],
            [
                0.55242992, 0.80053111, 0.17473145, 0.40513717, 0.82864842, 0.4856008, 0.41349154,
                0.8595507, 0.77320267, 0.98907978
            ],
            [
                0.24298015, 0.27266596, 0.48466381, 0.87975011, 0.44695868, 0.10110632, 0.55942819,
                0.93042542, 0.09035328, 0.76902574
            ]
        ]
    ];

    let kernel20: Array4<f32> = Array::from_shape_vec(
        (3, 2, 4, 4),
        vec![
            0.28521551, 0.07585676, 0.24124638, 0.06790887, 0.14329627, 0.63817888, 0.95433893,
            0.65819252, 0.1983508, 0.44280004, 0.1576808, 0.77427592, 0.90144795, 0.86143706,
            0.28797777, 0.37103124, 0.0877872, 0.45872805, 0.76575244, 0.68296631, 0.23040929,
            0.52331047, 0.69741451, 0.89214319, 0.22412037, 0.0491925, 0.53688148, 0.19189753,
            0.45287938, 0.60241874, 0.37045264, 0.23233427, 0.42484194, 0.98901116, 0.36564677,
            0.86301588, 0.81168432, 0.3987277, 0.68792058, 0.79984951, 0.59457896, 0.75415336,
            0.80124225, 0.59222097, 0.05390601, 0.82877622, 0.29753333, 0.82358677, 0.29054286,
            0.26042403, 0.883912, 0.81435255, 0.57902404, 0.05703124, 0.61399594, 0.10031959,
            0.78280452, 0.24171719, 0.4721017, 0.53194064, 0.6437402, 0.09277638, 0.86937538,
            0.60042985, 0.88752862, 0.86002532, 0.69702212, 0.12023476, 0.94646693, 0.9782188,
            0.38164645, 0.71724524, 0.91050068, 0.41190185, 0.29969905, 0.43725936, 0.70224348,
            0.75668944, 0.55514523, 0.8824068, 0.10910437, 0.51675713, 0.33856305, 0.4310923,
            0.43717159, 0.22416041, 0.70742674, 0.04574656, 0.62335471, 0.60569308, 0.19430637,
            0.94640953, 0.43765875, 0.47719213, 0.45312902, 0.41785501,
        ],
    )
    .unwrap();
    let conv_layer20 = ConvolutionLayer::new(kernel20, 1, Padding::Valid);
    let target_output20 = array![
        [
            [8.41993046, 7.25495148, 5.7826581, 6.50673294, 5.2729516, 5.75006485, 6.26755953],
            [7.09933472, 6.83333874, 5.55858183, 7.1550498, 5.96196842, 6.35149288, 6.71721411],
            [8.00751305, 6.06634188, 6.71144915, 7.12361288, 5.48175001, 4.8884387, 5.14686728],
            [7.5416503, 7.38707972, 6.02390099, 5.95307016, 6.07058859, 5.44787073, 6.51188946],
            [7.71683455, 8.38956547, 7.5681572, 7.33845997, 5.9682641, 6.71034527, 7.07137489],
            [6.21529198, 6.97530365, 6.33719873, 6.741467, 6.07608223, 6.48825121, 7.40342855],
            [6.6310215, 8.24517727, 7.64163303, 7.57072115, 7.20477009, 7.39157009, 7.35697603]
        ],
        [
            [
                10.25446129,
                9.70357704,
                7.56313658,
                8.49466133,
                5.79562187,
                6.160532,
                8.0180254
            ],
            [
                10.67077541,
                8.15255833,
                8.13955021,
                7.54413414,
                7.33195639,
                6.96363544,
                8.06646347
            ],
            [9.04897118, 9.76562977, 7.88642788, 8.73493099, 7.40083551, 7.19683266, 7.78236866],
            [9.58156395, 8.79182148, 7.56845808, 8.82007027, 6.81165409, 7.40325165, 7.6337595],
            [
                9.73891544,
                10.08412933,
                9.45031452,
                9.05323601,
                8.12979794,
                8.23817825,
                8.02660179
            ],
            [
                9.25827694,
                10.59005451,
                8.77348709,
                9.27874088,
                7.68143368,
                9.51614857,
                9.19230747
            ],
            [8.33819008, 9.82128239, 8.06963539, 9.41620159, 10.0959053, 8.33500099, 9.45377922]
        ],
        [
            [
                10.45381355,
                9.30696106,
                8.31638527,
                7.71734667,
                6.12770891,
                5.97846603,
                7.24191046
            ],
            [
                10.40961742,
                8.56710911,
                8.03950691,
                8.38483047,
                6.32556677,
                6.89126825,
                7.35861158
            ],
            [9.64469719, 9.64585781, 7.97520399, 8.52578831, 7.41102743, 6.57466984, 8.88012314],
            [
                10.02618694,
                8.19434643,
                8.36299229,
                8.01400661,
                7.22375536,
                7.54819584,
                7.10660362
            ],
            [9.48025131, 9.97230816, 9.310112, 9.4951458, 8.15347099, 7.34628534, 9.050354],
            [9.07930088, 9.53768539, 8.36682034, 9.79015636, 8.04027748, 8.32669926, 9.20778656],
            [8.19562817, 9.83011246, 8.88289642, 9.61876965, 9.95977402, 8.35489082, 9.69412136]
        ]
    ];
    let current_output20 = conv_layer20.convolve(&test_input20);

    assert!(
        arr_allclose(&current_output20, &target_output20),
        "{:?} was not equal to {:?}",
        current_output20,
        target_output20
    );

    let test_input21 = array![
        [
            [
                0.81793892, 0.03511541, 0.55490179, 0.67156732, 0.61512813, 0.655004, 0.09111205,
                0.49298652, 0.3268639, 0.77552781
            ],
            [
                0.77209026, 0.47542889, 0.31814524, 0.52555005, 0.81072357, 0.00102462, 0.51096868,
                0.48937834, 0.122188, 0.22519494
            ],
            [
                0.40227203, 0.84508294, 0.43985214, 0.05504967, 0.02137936, 0.26612981, 0.12310848,
                0.00158825, 0.75761557, 0.88188004
            ],
            [
                0.12094666, 0.13906257, 0.91576679, 0.91879824, 0.8513396, 0.28533912, 0.30878847,
                0.12668495, 0.24235714, 0.45707442
            ],
            [
                0.77128291, 0.69032428, 0.09853197, 0.43307764, 0.05488254, 0.70532216, 0.34688667,
                0.9355463, 0.38260134, 0.48385892
            ],
            [
                0.17318112, 0.21472166, 0.77769447, 0.35695698, 0.22671694, 0.18250433, 0.41477198,
                0.18007399, 0.98278629, 0.58704964
            ],
            [
                0.29501828, 0.46143154, 0.19057809, 0.36531091, 0.93977063, 0.26191842, 0.36934672,
                0.14449089, 0.93639778, 0.42698747
            ],
            [
                0.12815461, 0.30951204, 0.1389484, 0.70723682, 0.44510987, 0.68366704, 0.60059835,
                0.09438256, 0.365831, 0.60821446
            ],
            [
                0.0316166, 0.87382413, 0.29876905, 0.33316014, 0.56221596, 0.33539039, 0.10716959,
                0.93341087, 0.86064022, 0.42792627
            ],
            [
                0.48052303, 0.69580782, 0.45255642, 0.99052713, 0.04395659, 0.71055362, 0.91177765,
                0.93380784, 0.90260815, 0.01515595
            ]
        ],
        [
            [
                0.88177705, 0.43487665, 0.56912596, 0.05581366, 0.02638636, 0.50119188, 0.31323937,
                0.05636088, 0.31307654, 0.33269022
            ],
            [
                0.37347791, 0.42102939, 0.08686391, 0.38085341, 0.36317898, 0.19031978, 0.46563995,
                0.41320488, 0.94399139, 0.28572704
            ],
            [
                0.61427557, 0.81580518, 0.26794038, 0.12281225, 0.32823457, 0.14740173, 0.70965311,
                0.19252698, 0.79887708, 0.02814319
            ],
            [
                0.39099366, 0.75513868, 0.50380181, 0.15413615, 0.82638884, 0.2631662, 0.70537729,
                0.6478343, 0.32534242, 0.66350844
            ],
            [
                0.88396533, 0.59479696, 0.68739475, 0.90379299, 0.9826564, 0.56865098, 0.33996935,
                0.63317855, 0.70651505, 0.82775309
            ],
            [
                0.22001709, 0.37304191, 0.20307005, 0.59174454, 0.37599511, 0.67352904, 0.42676451,
                0.64539509, 0.93520574, 0.59322684
            ],
            [
                0.58852909, 0.23145947, 0.15739693, 0.88258469, 0.17851174, 0.56031989, 0.14435844,
                0.10347797, 0.37213183, 0.14642915
            ],
            [
                0.21561022, 0.38304217, 0.90021487, 0.32565015, 0.82000728, 0.72865624, 0.48349918,
                0.41356983, 0.03333719, 0.08149401
            ],
            [
                0.85722615, 0.04374503, 0.88704216, 0.09240988, 0.8528545, 0.79466526, 0.54765996,
                0.74729833, 0.72924789, 0.21080039
            ],
            [
                0.12833529, 0.06738389, 0.91630975, 0.2233036, 0.09597177, 0.4226413, 0.73019655,
                0.80654461, 0.13412596, 0.92962374
            ]
        ]
    ];

    let kernel21: Array4<f32> = Array::from_shape_vec(
        (3, 2, 4, 4),
        vec![
            0.88961373, 0.80970791, 0.92300738, 0.84075748, 0.54675693, 0.90232325, 0.40697717,
            0.70493781, 0.17525118, 0.60480596, 0.01006908, 0.09306769, 0.04155758, 0.00396548,
            0.29594677, 0.24183853, 0.23543635, 0.10814751, 0.36654201, 0.58264211, 0.1795904,
            0.47117368, 0.78273382, 0.22905577, 0.34449509, 0.83183692, 0.12226541, 0.89712569,
            0.27640049, 0.37137195, 0.27103843, 0.27672654, 0.33046692, 0.42443379, 0.85259345,
            0.79606476, 0.24516418, 0.51166811, 0.32966594, 0.36674044, 0.40403319, 0.31310066,
            0.72581839, 0.01080465, 0.05479572, 0.52210696, 0.60234382, 0.20002392, 0.61509339,
            0.23236814, 0.28950064, 0.33898463, 0.57016682, 0.51984867, 0.45874897, 0.78067496,
            0.81381022, 0.95512077, 0.58818042, 0.47504796, 0.19136074, 0.8406687, 0.04588939,
            0.30594055, 0.85119778, 0.87731921, 0.82416615, 0.44152675, 0.38872027, 0.07202522,
            0.96407434, 0.51950771, 0.19128811, 0.25130446, 0.39854062, 0.8797602, 0.72297111,
            0.62001851, 0.69522934, 0.91174836, 0.65982073, 0.10557688, 0.23464549, 0.5982146,
            0.28930025, 0.45670657, 0.47519285, 0.96985732, 0.13737751, 0.33859881, 0.85392951,
            0.74257757, 0.94443824, 0.24404159, 0.74318246, 0.0306461,
        ],
    )
    .unwrap();
    let conv_layer21 = ConvolutionLayer::new(kernel21, 1, Padding::Valid);
    let target_output21 = array![
        [
            [6.79126024, 6.03116608, 5.45750666, 5.85697889, 4.91178417, 5.56386614, 5.37720966],
            [6.36047125, 6.86072111, 5.17870522, 6.0104804, 5.74550915, 5.61128426, 6.25907087],
            [6.99549913, 6.76764393, 6.38296366, 5.76195765, 5.49850702, 5.88756752, 6.96555328],
            [6.69762564, 7.24993992, 8.09814548, 6.53873396, 6.56317377, 6.16080523, 6.55244923],
            [6.44517756, 5.94590235, 6.46552277, 6.197258, 5.90705585, 6.85644531, 6.28100014],
            [5.07501125, 6.68713427, 6.5457058, 6.44627953, 6.00592375, 6.58500099, 6.04973316],
            [5.6154747, 6.72238159, 6.75556326, 7.39830637, 7.04776239, 6.61656523, 6.08112383]
        ],
        [
            [7.45574093, 6.93233395, 5.48807716, 5.73516893, 4.69831657, 5.70425558, 6.25184536],
            [7.0196166, 7.26625776, 6.01775789, 6.40520811, 6.50633669, 6.19781542, 6.67227268],
            [7.23626661, 7.59302235, 6.42431545, 6.64377546, 6.27064276, 6.66057396, 7.98662376],
            [7.46381283, 7.48333502, 8.23413754, 6.7255044, 7.03954506, 6.24528313, 7.65130949],
            [6.09386158, 6.50232077, 7.27825689, 7.35778379, 7.2495389, 6.86702776, 6.54291582],
            [5.75635099, 6.87058973, 6.65991449, 7.35718012, 6.67587137, 7.09549856, 6.77327156],
            [5.85516787, 7.54668951, 7.72561741, 7.22927999, 7.56460905, 8.01137638, 7.54656553]
        ],
        [
            [7.67504692, 7.47162962, 8.07317734, 6.63076973, 6.92137384, 7.0905323, 7.06568193],
            [8.62726212, 7.96203661, 7.12081289, 7.78988886, 7.4427228, 7.78548002, 7.9847908],
            [8.27712345, 8.86223602, 7.34376526, 6.94505072, 6.72853661, 7.61750174, 8.97361279],
            [7.53530836, 9.6906147, 8.54134369, 9.24296665, 7.80622721, 8.60913086, 8.51971054],
            [8.32583046, 7.90393686, 8.39785576, 8.18845272, 7.87907505, 9.11066914, 8.68537903],
            [7.95689964, 7.58140993, 9.24565029, 7.25172424, 7.49965668, 8.18156338, 8.19836044],
            [7.92490053, 8.13130093, 9.09718895, 9.35457516, 8.90516281, 9.38847256, 7.99128008]
        ]
    ];
    let current_output21 = conv_layer21.convolve(&test_input21);

    assert!(
        arr_allclose(&current_output21, &target_output21),
        "{:?} was not equal to {:?}",
        current_output21,
        target_output21
    );

    let test_input22 = array![
        [
            [
                0.32723788, 0.84988172, 0.78041795, 0.77440342, 0.47136632, 0.2987932, 0.90784409,
                0.68410864, 0.38890766, 0.05255083
            ],
            [
                0.16184398, 0.90099065, 0.49884502, 0.29081446, 0.96019645, 0.79299562, 0.47393437,
                0.72834367, 0.61580642, 0.67942558
            ],
            [
                0.47645757, 0.33350429, 0.75634698, 0.11874896, 0.36077333, 0.3897357, 0.37567438,
                0.98458625, 0.55171785, 0.29212236
            ],
            [
                0.96003669, 0.66156867, 0.06723779, 0.20257861, 0.02713268, 0.80878778, 0.73324105,
                0.04588867, 0.02181397, 0.76707071
            ],
            [
                0.45551614, 0.6842329, 0.68315824, 0.66648014, 0.31319311, 0.29468353, 0.85157117,
                0.83927354, 0.14075517, 0.85626128
            ],
            [
                0.52595836, 0.98014617, 0.27240537, 0.44448685, 0.82414292, 0.91900748, 0.22366077,
                0.85325579, 0.70143698, 0.40568367
            ],
            [
                0.37661107, 0.67640065, 0.56091104, 0.04301855, 0.12136482, 0.67375731, 0.27527441,
                0.0267396, 0.94759497, 0.63039673
            ],
            [
                0.12444576, 0.72837056, 0.72811018, 0.26266539, 0.09959163, 0.21715049, 0.30699564,
                0.74566257, 0.72915741, 0.75221894
            ],
            [
                0.98712695, 0.14437846, 0.29435056, 0.91064911, 0.34656417, 0.99010131, 0.67545681,
                0.95416683, 0.84239454, 0.34342708
            ],
            [
                0.74494992, 0.99503728, 0.16594417, 0.31254604, 0.43238706, 0.5073427, 0.14618636,
                0.09028576, 0.88932032, 0.91551373
            ]
        ],
        [
            [
                0.49814488, 0.70523752, 0.65795491, 0.83047029, 0.17178877, 0.10943547, 0.95655823,
                0.92225051, 0.71428937, 0.55764362
            ],
            [
                0.4350043, 0.43690362, 0.04750107, 0.64436133, 0.03292517, 0.58849011, 0.27200706,
                0.90262579, 0.82636202, 0.0902301
            ],
            [
                0.29801483, 0.74622725, 0.51269132, 0.22947553, 0.68985719, 0.89290729, 0.1143901,
                0.25533149, 0.52610627, 0.96802237
            ],
            [
                0.32070743, 0.16912474, 0.42875673, 0.69673245, 0.5962988, 0.65832772, 0.95566137,
                0.30900881, 0.04040552, 0.36515299
            ],
            [
                0.74841679, 0.38902925, 0.57477368, 0.02147576, 0.12675387, 0.89580769, 0.57611838,
                0.80507149, 0.18574312, 0.91033079
            ],
            [
                0.49352487, 0.04084097, 0.32406485, 0.9127804, 0.32315839, 0.52741554, 0.35417321,
                0.43012724, 0.52614151, 0.85194333
            ],
            [
                0.34473135, 0.22837398, 0.16551488, 0.25193901, 0.95738793, 0.33331639, 0.45628268,
                0.6485293, 0.03959658, 0.77746038
            ],
            [
                0.72181728, 0.25632858, 0.40238795, 0.29511455, 0.18771167, 0.47788582, 0.88639263,
                0.03075815, 0.38190666, 0.51886615
            ],
            [
                0.43225556, 0.44312598, 0.78464971, 0.69072249, 0.70348736, 0.48298273, 0.55687041,
                0.68944603, 0.03431003, 0.38795923
            ],
            [
                0.6902452, 0.85404577, 0.52294715, 0.14189826, 0.48577387, 0.0789768, 0.29317726,
                0.34614396, 0.42246844, 0.71652184
            ]
        ]
    ];

    let kernel22: Array4<f32> = Array::from_shape_vec(
        (3, 2, 5, 5),
        vec![
            0.03888219, 0.95906553, 0.15285545, 0.94362165, 0.15887408, 0.13075078, 0.15117891,
            0.03306201, 0.16711909, 0.58508997, 0.26331436, 0.15727987, 0.39590273, 0.23047461,
            0.84281718, 0.32108445, 0.6584057, 0.22742086, 0.03719785, 0.40959628, 0.67157058,
            0.91032362, 0.37286272, 0.27958221, 0.23605917, 0.16103324, 0.48898629, 0.77691663,
            0.63719284, 0.53397748, 0.50137311, 0.23002648, 0.72638501, 0.64956137, 0.10749895,
            0.7930301, 0.25076696, 0.01513924, 0.25819991, 0.03015263, 0.50236378, 0.84156044,
            0.43133247, 0.55331617, 0.56238402, 0.63845594, 0.52681636, 0.13921388, 0.09313619,
            0.75766638, 0.78449276, 0.86921382, 0.79183038, 0.72191998, 0.91970453, 0.26611278,
            0.45631655, 0.83163739, 0.60754435, 0.86304334, 0.81931032, 0.47772342, 0.73805947,
            0.01831975, 0.71567196, 0.27518227, 0.09057815, 0.59426831, 0.98282616, 0.68770772,
            0.01671847, 0.59191654, 0.11799596, 0.3565012, 0.52713779, 0.42855334, 0.71597424,
            0.33997728, 0.13702092, 0.30294093, 0.60102209, 0.31660683, 0.47319988, 0.81581173,
            0.32806375, 0.2910204, 0.70403956, 0.76467193, 0.16295868, 0.51999521, 0.10952926,
            0.25027467, 0.01479205, 0.20828883, 0.6572299, 0.16784889, 0.49984224, 0.73934629,
            0.7692465, 0.45089913, 0.42323233, 0.30926329, 0.94342924, 0.5813263, 0.17081867,
            0.45052945, 0.5468596, 0.32220426, 0.97337824, 0.15655027, 0.0631674, 0.92763947,
            0.73374209, 0.62821566, 0.44235065, 0.70144872, 0.25818462, 0.37731635, 0.74292476,
            0.7893134, 0.96826619, 0.07253607, 0.61240185, 0.57127407, 0.71019414, 0.42240704,
            0.3144015, 0.23257384, 0.35578601, 0.774386, 0.75755355, 0.44447816, 0.76916295,
            0.43969591, 0.09476027, 0.89676638, 0.25122383, 0.38787512, 0.52713352, 0.21266471,
            0.64234613, 0.23638117, 0.12251099, 0.11175825, 0.69299388, 0.06464646, 0.15909616,
            0.64519557, 0.32502402, 0.95026743,
        ],
    )
    .unwrap();
    let conv_layer22 = ConvolutionLayer::new(kernel22, 1, Padding::Valid);
    let target_output22 = array![
        [
            [
                10.48103046,
                10.6580534,
                9.96494389,
                10.50783348,
                10.6544323,
                13.19307137
            ],
            [
                8.67895126,
                10.03993416,
                10.06652832,
                11.12690544,
                10.86876583,
                11.89147472
            ],
            [9.44910812, 9.68609428, 9.5535965, 9.87153625, 9.8895483, 10.704422],
            [
                9.14329147,
                8.49612999,
                9.7423315,
                9.80432129,
                9.46102333,
                10.09365368
            ],
            [
                9.37783623,
                9.38444424,
                9.38728046,
                10.47276592,
                10.9158535,
                11.13897991
            ],
            [
                10.18620586,
                10.05249786,
                9.71212387,
                9.42252731,
                10.75854111,
                10.1233511
            ]
        ],
        [
            [
                12.23291683,
                12.01899242,
                13.47732735,
                13.84741688,
                11.91489601,
                13.46593666
            ],
            [
                11.65810299,
                13.00303078,
                12.11596203,
                13.13373852,
                13.4931736,
                13.94983196
            ],
            [
                10.51371574,
                12.19187546,
                11.73329735,
                12.49722958,
                12.5964222,
                13.48755836
            ],
            [
                10.1757946,
                10.69378567,
                11.32714844,
                12.10466194,
                11.47914124,
                14.08575821
            ],
            [
                11.82709789,
                11.93917465,
                12.3089695,
                12.59331322,
                12.9092865,
                14.10752392
            ],
            [
                11.51098633,
                11.8867321,
                10.95106983,
                11.58636284,
                12.89610958,
                12.75622559
            ]
        ],
        [
            [
                10.69020844,
                12.46495438,
                12.16113567,
                13.18019104,
                11.93504238,
                14.19177914
            ],
            [
                10.18934536,
                12.31416607,
                12.08628273,
                13.12468529,
                13.0268631,
                13.69774246
            ],
            [
                11.44776821,
                11.19520664,
                11.64149284,
                11.40435982,
                11.83932304,
                14.50041771
            ],
            [
                10.63689995,
                9.73890686,
                11.24224758,
                11.73560429,
                11.60124302,
                12.41327381
            ],
            [
                11.5450983,
                11.68659115,
                11.39068413,
                12.28771877,
                12.73973465,
                13.55867481
            ],
            [
                11.25677013,
                10.63498688,
                10.87491131,
                11.04640007,
                11.39583397,
                13.89501953
            ]
        ]
    ];
    let current_output22 = conv_layer22.convolve(&test_input22);

    assert!(
        arr_allclose(&current_output22, &target_output22),
        "{:?} was not equal to {:?}",
        current_output22,
        target_output22
    );

    let test_input23 = array![
        [
            [
                0.57768894, 0.55681904, 0.29656869, 0.68271434, 0.17499127, 0.28795035, 0.62235627,
                0.28275677, 0.62251085, 0.05298517
            ],
            [
                0.95863772, 0.83056019, 0.53959038, 0.77689142, 0.36629458, 0.53110782, 0.87225235,
                0.14521246, 0.74900091, 0.55172805
            ],
            [
                0.96212075, 0.28965781, 0.23772796, 0.38020674, 0.41068245, 0.15089213, 0.3510485,
                0.28178046, 0.0740529, 0.28524187
            ],
            [
                0.20798713, 0.73283645, 0.24482582, 0.13728051, 0.99868368, 0.66772568, 0.30110442,
                0.59491573, 0.33922874, 0.78129903
            ],
            [
                0.45983208, 0.39850447, 0.29452821, 0.3990066, 0.71123667, 0.92457685, 0.80979041,
                0.12899092, 0.03675647, 0.98098062
            ],
            [
                0.12195553, 0.59541752, 0.99234332, 0.46600241, 0.42390977, 0.41920665, 0.63552478,
                0.6557143, 0.47023433, 0.57522745
            ],
            [
                0.81064758, 0.49675161, 0.79606961, 0.35081707, 0.5810784, 0.47564269, 0.59502881,
                0.23334436, 0.35525572, 0.65956025
            ],
            [
                0.98428432, 0.9814129, 0.84742008, 0.81249008, 0.46888288, 0.65711221, 0.44344075,
                0.72268394, 0.50578436, 0.89210488
            ],
            [
                0.29161336, 0.30685804, 0.70156509, 0.76217692, 0.53040796, 0.23608344, 0.33704031,
                0.51532269, 0.12298316, 0.38562469
            ],
            [
                0.39561589, 0.21013618, 0.00794073, 0.21312988, 0.09544598, 0.16640656, 0.39524125,
                0.70305292, 0.69517192, 0.76970626
            ]
        ],
        [
            [
                0.01947077, 0.72122117, 0.43079307, 0.65442199, 0.33095865, 0.37373172, 0.58761565,
                0.49653716, 0.60941027, 0.37502282
            ],
            [
                0.79907188, 0.94719638, 0.90727982, 0.43818597, 0.15018035, 0.26554953, 0.27605641,
                0.15040922, 0.26055169, 0.59765531
            ],
            [
                0.65847851, 0.23161498, 0.69215128, 0.64733315, 0.85464101, 0.03501532, 0.91917506,
                0.90648018, 0.96888335, 0.30725588
            ],
            [
                0.23253885, 0.44027686, 0.44643323, 0.46258069, 0.5722288, 0.78549144, 0.13830437,
                0.68609085, 0.0680802, 0.99768383
            ],
            [
                0.35439101, 0.21689764, 0.20947075, 0.30304361, 0.67836779, 0.34793916, 0.91172965,
                0.36088541, 0.42308012, 0.8522385
            ],
            [
                0.80487376, 0.80669978, 0.20780123, 0.65686723, 0.99092943, 0.68510162, 0.89588594,
                0.53854842, 0.81079438, 0.46694139
            ],
            [
                0.68608955, 0.65788951, 0.45783393, 0.41847236, 0.20630272, 0.49531621, 0.01959337,
                0.83712485, 0.57163461, 0.18082423
            ],
            [
                0.03656635, 0.75915191, 0.77819147, 0.18088074, 0.97228984, 0.45446303, 0.15876008,
                0.15172001, 0.21870645, 0.67578595
            ],
            [
                0.17699588, 0.16891658, 0.85145479, 0.8860516, 0.82196737, 0.29569439, 0.67956754,
                0.56761092, 0.51335655, 0.48570012
            ],
            [
                0.05080688, 0.14092551, 0.35189822, 0.27169822, 0.43087652, 0.82195238, 0.58699362,
                0.18927561, 0.15438258, 0.48444233
            ]
        ]
    ];

    let kernel23: Array4<f32> = Array::from_shape_vec(
        (3, 2, 5, 5),
        vec![
            0.3548947, 0.13443873, 0.05775462, 0.01398679, 0.35539069, 0.48720175, 0.39191842,
            0.73532807, 0.98678988, 0.39567923, 0.66819311, 0.8741793, 0.41219148, 0.43805563,
            0.24787005, 0.46575391, 0.85423167, 0.0098169, 0.03120668, 0.20878879, 0.54290943,
            0.551671, 0.4212191, 0.76660496, 0.52033461, 0.55199233, 0.24225756, 0.92673199,
            0.29546981, 0.90794485, 0.11640227, 0.30306699, 0.60486086, 0.67949794, 0.26091522,
            0.60724494, 0.81439899, 0.1684874, 0.39451824, 0.42586837, 0.31500932, 0.7739118,
            0.26620805, 0.49127059, 0.55821842, 0.14920756, 0.26436529, 0.33135026, 0.44614497,
            0.70298518, 0.4382807, 0.88296111, 0.02333054, 0.85274149, 0.90572881, 0.22357329,
            0.41870592, 0.45508061, 0.93899915, 0.20756939, 0.20021324, 0.47618694, 0.51307929,
            0.58882958, 0.59889995, 0.71293402, 0.85163711, 0.85897657, 0.02912598, 0.49246777,
            0.93976609, 0.63142023, 0.55997157, 0.44621915, 0.24492879, 0.19181061, 0.10366015,
            0.23688388, 0.49670486, 0.67701245, 0.45396151, 0.42133403, 0.6850384, 0.85629206,
            0.76669573, 0.85341533, 0.09939361, 0.82822982, 0.0080629, 0.60769776, 0.66775389,
            0.97007126, 0.69535719, 0.23404987, 0.7702405, 0.48136758, 0.67087533, 0.98482032,
            0.11385565, 0.87580873, 0.70942527, 0.97172351, 0.75492733, 0.52383514, 0.39455087,
            0.31395627, 0.94462168, 0.89547809, 0.2690143, 0.72545925, 0.50680615, 0.67623517,
            0.03957006, 0.55472256, 0.69215521, 0.50038502, 0.52786834, 0.31035744, 0.81599204,
            0.65543225, 0.03603773, 0.53902263, 0.13498626, 0.98521266, 0.16336593, 0.99620887,
            0.19921382, 0.10756692, 0.44649956, 0.94982781, 0.71394465, 0.35815724, 0.02897831,
            0.97218841, 0.05049731, 0.86107605, 0.0762892, 0.74125362, 0.00293741, 0.58428118,
            0.80308986, 0.35674443, 0.5351153, 0.73715035, 0.41913971, 0.79290221, 0.5041107,
            0.55641157, 0.04526648, 0.78619929,
        ],
    )
    .unwrap();
    let conv_layer23 = ConvolutionLayer::new(kernel23, 1, Padding::Valid);
    let target_output23 = array![
        [
            [
                11.4796896,
                10.80716896,
                10.75827789,
                11.85364056,
                10.58491039,
                10.44237614
            ],
            [
                11.47736168,
                11.29134083,
                10.7359066,
                11.1131897,
                11.7859621,
                11.76683617
            ],
            [
                11.39843464,
                11.29477692,
                12.42509556,
                12.22141838,
                12.72798824,
                12.0586729
            ],
            [
                12.55664158,
                13.16744995,
                11.88182926,
                12.52746296,
                11.31927776,
                12.31190586
            ],
            [
                13.01883602,
                12.6867609,
                12.49115658,
                11.37940693,
                11.56009483,
                10.92373562
            ],
            [
                11.48271751,
                12.33388138,
                12.38108921,
                11.55491352,
                11.30057812,
                10.93541527
            ]
        ],
        [
            [
                13.58646297,
                11.12805939,
                13.5497961,
                13.17959976,
                13.19516087,
                13.27650833
            ],
            [
                13.97387981,
                13.21155739,
                14.92206955,
                14.70546818,
                14.78857803,
                15.97273159
            ],
            [
                14.15349865,
                13.70399666,
                14.27331734,
                14.20332146,
                14.01233768,
                13.42252541
            ],
            [
                15.88682652,
                15.60371208,
                14.27951145,
                14.67215252,
                14.11535835,
                13.43238544
            ],
            [
                16.04058266,
                16.412714,
                15.98551655,
                15.23757744,
                13.26316166,
                14.31006908
            ],
            [
                13.06141758,
                13.92899704,
                14.36036777,
                13.29942894,
                12.88698959,
                13.16025734
            ]
        ],
        [
            [
                12.94893456,
                12.4462719,
                13.85472965,
                12.17076206,
                12.74310017,
                11.64889717
            ],
            [
                13.84185982,
                14.02885246,
                12.90046978,
                14.01188946,
                13.04515171,
                14.00470638
            ],
            [
                13.48041725,
                12.56307983,
                13.42935371,
                14.08860111,
                14.08335495,
                12.46475887
            ],
            [
                13.42745686,
                14.38867283,
                13.39984322,
                13.70672607,
                14.14298439,
                13.92205238
            ],
            [
                14.57662201,
                15.08979607,
                14.41972351,
                14.12522602,
                13.44266605,
                13.94813347
            ],
            [
                14.52291679,
                13.92195034,
                14.12770748,
                12.40776062,
                14.09265423,
                13.26291561
            ]
        ]
    ];
    let current_output23 = conv_layer23.convolve(&test_input23);

    assert!(
        arr_allclose(&current_output23, &target_output23),
        "{:?} was not equal to {:?}",
        current_output23,
        target_output23
    );

    let test_input24 = array![
        [
            [
                0.63351091, 0.24217102, 0.90911298, 0.80903275, 0.83993904, 0.81976046, 0.72148051,
                0.40070922, 0.57626017, 0.95258536
            ],
            [
                0.49337667, 0.10905766, 0.94602234, 0.39644081, 0.50362575, 0.07761287, 0.93221566,
                0.31622591, 0.17759776, 0.64270771
            ],
            [
                0.12794439, 0.15542967, 0.97430723, 0.63002571, 0.08167998, 0.75798354, 0.09109605,
                0.76193048, 0.75383404, 0.99397696
            ],
            [
                0.34140688, 0.57779241, 0.450994, 0.34813985, 0.49516844, 0.39270081, 0.56429656,
                0.26018233, 0.88573346, 0.69079582
            ],
            [
                0.55985487, 0.84918074, 0.65128704, 0.31415002, 0.78383876, 0.24776831, 0.09454908,
                0.72278243, 0.92367393, 0.36427069
            ],
            [
                0.08929764, 0.09322322, 0.8198366, 0.61886697, 0.84666561, 0.10928579, 0.07829133,
                0.38427125, 0.92097811, 0.05534032
            ],
            [
                0.33815342, 0.21587123, 0.12900938, 0.838805, 0.70533996, 0.33450192, 0.38096664,
                0.80549439, 0.53035963, 0.28034256
            ],
            [
                0.09335517, 0.90288111, 0.78340421, 0.99226144, 0.01493673, 0.46203192, 0.7521283,
                0.60524951, 0.06838121, 0.63061823
            ],
            [
                0.68300222, 0.1979319, 0.98125646, 0.35303902, 0.01351135, 0.13854096, 0.81033376,
                0.02116127, 0.74512017, 0.52984567
            ],
            [
                0.99872666, 0.55599707, 0.15128083, 0.71545672, 0.55498168, 0.43051603, 0.23737086,
                0.65620621, 0.28059771, 0.39736098
            ]
        ],
        [
            [
                0.46733312, 0.00891489, 0.33884784, 0.61938839, 0.18607458, 0.44318847, 0.01808522,
                0.11024449, 0.59574281, 0.25734401
            ],
            [
                0.57106302, 0.99650699, 0.02719511, 0.34088473, 0.31276717, 0.19508527, 0.51521796,
                0.55529255, 0.53429699, 0.45517372
            ],
            [
                0.03822044, 0.68448043, 0.53839099, 0.19699455, 0.41928287, 0.12089491, 0.15296015,
                0.34004239, 0.08433874, 0.59906756
            ],
            [
                0.32895056, 0.40649991, 0.14991561, 0.20179559, 0.29841897, 0.99814245, 0.42835028,
                0.58305656, 0.88311238, 0.58563498
            ],
            [
                0.10433916, 0.49506863, 0.40216792, 0.66390544, 0.44003267, 0.67188006, 0.73143498,
                0.22884977, 0.45354383, 0.29792643
            ],
            [
                0.52720408, 0.74854459, 0.28624305, 0.92822552, 0.22695023, 0.43092482, 0.95730779,
                0.99238892, 0.1289603, 0.71256122
            ],
            [
                0.9421077, 0.22165332, 0.89570084, 0.01525365, 0.46406323, 0.38429326, 0.29330773,
                0.68809765, 0.82745573, 0.32582921
            ],
            [
                0.95369233, 0.92134258, 0.80696934, 0.17606957, 0.53414556, 0.85412689, 0.55071186,
                0.25444789, 0.65922911, 0.53072676
            ],
            [
                0.77232088, 0.41289272, 0.10455144, 0.65975383, 0.91647806, 0.95716312, 0.56454967,
                0.86060405, 0.55495818, 0.99726841
            ],
            [
                0.39086932, 0.13288062, 0.43203549, 0.02057635, 0.44437656, 0.00600106, 0.86474378,
                0.96837336, 0.52825713, 0.57560819
            ]
        ]
    ];

    let kernel24: Array4<f32> = Array::from_shape_vec(
        (3, 2, 5, 5),
        vec![
            0.50635281, 0.616231, 0.03237248, 0.70649229, 0.24617034, 0.19121489, 0.89378952,
            0.52211759, 0.920404, 0.45497387, 0.84028613, 0.69197805, 0.92198043, 0.00114695,
            0.68662337, 0.74263727, 0.16886179, 0.28282913, 0.71575083, 0.92159183, 0.61868011,
            0.02047214, 0.46281454, 0.68875934, 0.01173675, 0.59077987, 0.37879743, 0.13223802,
            0.20979706, 0.2962676, 0.82381723, 0.62355626, 0.19442007, 0.15597425, 0.44047667,
            0.02631165, 0.79910343, 0.68305829, 0.13235328, 0.36176982, 0.98954595, 0.1066653,
            0.85609133, 0.24844926, 0.94089868, 0.61132301, 0.26047221, 0.62072504, 0.52674733,
            0.04456268, 0.127301, 0.58310641, 0.76188127, 0.99088574, 0.34984971, 0.98932128,
            0.92298387, 0.968473, 0.34732912, 0.54743405, 0.01200672, 0.04459461, 0.11107332,
            0.79086026, 0.427044, 0.28423597, 0.5638385, 0.55078714, 0.52096257, 0.96902648,
            0.40990628, 0.76069827, 0.19991862, 0.05412404, 0.96710502, 0.95133634, 0.08358769,
            0.18445559, 0.15507828, 0.5525091, 0.75220759, 0.41979294, 0.90154667, 0.06932272,
            0.98834363, 0.93267442, 0.95973786, 0.01301026, 0.94750314, 0.19795855, 0.28899274,
            0.23282553, 0.28506086, 0.86825993, 0.82200572, 0.13914691, 0.97130792, 0.03333058,
            0.80871649, 0.80247869, 0.35903281, 0.37787569, 0.29034188, 0.13700394, 0.39205238,
            0.24718882, 0.48470175, 0.79027306, 0.53663422, 0.15042725, 0.83978633, 0.46929242,
            0.90220388, 0.14340297, 0.15322222, 0.34881375, 0.62322848, 0.83594127, 0.16714396,
            0.4264953, 0.04108659, 0.89079211, 0.67103004, 0.6196703, 0.67488447, 0.62487622,
            0.07340665, 0.29599694, 0.90834848, 0.06401163, 0.25583468, 0.43448447, 0.12822088,
            0.16394943, 0.70240457, 0.7238483, 0.54914701, 0.33882854, 0.30244494, 0.7881106,
            0.18323863, 0.9491711, 0.49022143, 0.52859295, 0.44141732, 0.6618432, 0.13727196,
            0.67812914, 0.71892771, 0.41655356,
        ],
    )
    .unwrap();
    let conv_layer24 = ConvolutionLayer::new(kernel24, 1, Padding::Valid);
    let target_output24 = array![
        [
            [
                10.33337402,
                12.32192421,
                10.50376987,
                11.44445133,
                10.5891695,
                13.17270756
            ],
            [
                10.55200195,
                12.21111393,
                10.3284874,
                10.67607689,
                12.68625641,
                11.2216053
            ],
            [
                11.27819157,
                11.47074986,
                11.03547382,
                10.87145042,
                12.65121269,
                12.31093884
            ],
            [
                12.82281399,
                11.25479984,
                11.88711166,
                11.90996361,
                12.54035282,
                12.10985565
            ],
            [
                12.12438869,
                12.72700882,
                12.24047089,
                13.21356869,
                11.08161068,
                12.19361496
            ],
            [
                12.12715054,
                12.29890442,
                11.82738972,
                12.32751465,
                12.30522156,
                12.92329979
            ]
        ],
        [
            [
                12.62419605,
                12.77216053,
                12.95918083,
                11.89280701,
                13.23032951,
                12.64531517
            ],
            [
                12.48061371,
                12.03771019,
                12.24255466,
                12.46466446,
                12.27669716,
                13.06266594
            ],
            [
                11.40332985,
                12.53080273,
                11.46717548,
                13.27933407,
                14.05129051,
                13.42471218
            ],
            [
                13.49358368,
                14.29048729,
                13.09488297,
                13.01701927,
                13.60902691,
                14.32428741
            ],
            [
                12.56587029,
                14.89922905,
                14.8192749,
                12.67091942,
                13.41042233,
                14.22235966
            ],
            [
                13.59513569,
                12.83205986,
                12.99380016,
                14.21613598,
                12.8088522,
                14.08552933
            ]
        ],
        [
            [
                11.09194374,
                10.30252266,
                10.35924816,
                10.6975441,
                10.34982777,
                11.37841225
            ],
            [
                11.22822094,
                11.63484001,
                10.09424019,
                10.79676914,
                10.92451668,
                11.27560711
            ],
            [
                10.63425541,
                11.20128155,
                12.10219955,
                10.28857613,
                11.37705326,
                11.32704449
            ],
            [
                11.13356972,
                11.83639336,
                13.04226208,
                11.13502026,
                10.86777973,
                12.48551559
            ],
            [
                11.88530159,
                12.75787544,
                11.91015053,
                11.73829174,
                11.53857803,
                12.58032322
            ],
            [
                11.78343201,
                11.97658253,
                11.44596767,
                11.88949871,
                13.0611515,
                11.35018635
            ]
        ]
    ];
    let current_output24 = conv_layer24.convolve(&test_input24);

    assert!(
        arr_allclose(&current_output24, &target_output24),
        "{:?} was not equal to {:?}",
        current_output24,
        target_output24
    );

    let test_input25 = array![
        [
            [
                0.22713543, 0.18293882, 0.1918006, 0.53551254, 0.17122073, 0.22345521, 0.44359769,
                0.71808742, 0.22415205, 0.39959106, 0.26373631, 0.97481106, 0.66883225, 0.26237649,
                0.82986438
            ],
            [
                0.47769547, 0.64253337, 0.4279932, 0.05377042, 0.86013267, 0.49268875, 0.61688896,
                0.58930393, 0.61891296, 0.22768961, 0.64132371, 0.64964072, 0.28283465, 0.42210526,
                0.99953726
            ],
            [
                0.39900371, 0.31809522, 0.26837258, 0.91963109, 0.73235176, 0.66651365, 0.32611709,
                0.19029295, 0.34861882, 0.68538037, 0.73598146, 0.53857045, 0.808091, 0.54846342,
                0.17353091
            ],
            [
                0.08409429, 0.1967719, 0.31993369, 0.35334955, 0.93418276, 0.70826129, 0.54894203,
                0.89446758, 0.90379118, 0.09672975, 0.75848629, 0.50249979, 0.67288129, 0.91592125,
                0.34614602
            ],
            [
                0.38041668, 0.17313572, 0.04152303, 0.90533513, 0.13061609, 0.94569021, 0.08379908,
                0.92477977, 0.48921642, 0.9617579, 0.37667144, 0.71979427, 0.53935902, 0.9792834,
                0.86110633
            ],
            [
                0.8655558, 0.29825524, 0.10902968, 0.83468548, 0.72598021, 0.21941453, 0.98457923,
                0.46687176, 0.35792755, 0.86291792, 0.53019644, 0.71784253, 0.50557288, 0.14295319,
                0.49131493
            ],
            [
                0.69113374, 0.59211245, 0.4342134, 0.96155456, 0.34359774, 0.80391459, 0.11799753,
                0.26661384, 0.15955769, 0.24098069, 0.04284242, 0.72233696, 0.52010914, 0.86709221,
                0.22291588
            ],
            [
                0.01988209, 0.19314825, 0.63777114, 0.93071466, 0.23294576, 0.33839073, 0.21783542,
                0.54138702, 0.78856931, 0.6345836, 0.98471538, 0.70376681, 0.59978965, 0.48499247,
                0.52487602
            ],
            [
                0.38216811, 0.09907741, 0.30532844, 0.08845946, 0.50062149, 0.23987759, 0.66961862,
                0.55782833, 0.9853742, 0.30976852, 0.1141604, 0.94015058, 0.86896496, 0.12097415,
                0.70025292
            ],
            [
                0.16485341, 0.46633621, 0.67187447, 0.22297227, 0.20250201, 0.82183464, 0.61939572,
                0.53496595, 0.92597117, 0.78727603, 0.70335182, 0.12606672, 0.06126022, 0.68214495,
                0.6032527
            ]
        ],
        [
            [
                0.65629948, 0.49284569, 0.34271527, 0.92165942, 0.69404828, 0.47624903, 0.24574541,
                0.55520983, 0.32579103, 0.48232094, 0.60592108, 0.67228469, 0.67671171, 0.37876701,
                0.36134558
            ],
            [
                0.7042522, 0.22381731, 0.74746864, 0.36677413, 0.2613474, 0.28857794, 0.48979158,
                0.67423476, 0.89990904, 0.27360516, 0.39544468, 0.26890319, 0.58694217, 0.40545489,
                0.72367474
            ],
            [
                0.27611767, 0.67966813, 0.59654923, 0.26442292, 0.72399602, 0.43040072, 0.20080982,
                0.28246298, 0.6599278, 0.91767023, 0.76456982, 0.59367387, 0.36463643, 0.96831555,
                0.21878308
            ],
            [
                0.11189529, 0.53951961, 0.29627025, 0.11818971, 0.10945794, 0.65944481, 0.13544263,
                0.499514, 0.45294528, 0.71311121, 0.07966256, 0.29142585, 0.68724893, 0.04232476,
                0.13420771
            ],
            [
                0.33155695, 0.18794546, 0.46529655, 0.69078078, 0.02903101, 0.87343268, 0.80222555,
                0.87264, 0.45615639, 0.53332592, 0.24646281, 0.38038794, 0.32190927, 0.2162571,
                0.58034507
            ],
            [
                0.77878347, 0.5063043, 0.76173629, 0.08551037, 0.49260572, 0.83634587, 0.85251175,
                0.26562026, 0.11365525, 0.29192793, 0.5136638, 0.52510725, 0.96994559, 0.38765426,
                0.00939824
            ],
            [
                0.45361685, 0.99569704, 0.92569699, 0.11329727, 0.26731392, 0.50352102, 0.84638329,
                0.90850284, 0.3704941, 0.92850368, 0.12043774, 0.67069003, 0.87018521, 0.46525767,
                0.6889376
            ],
            [
                0.46818327, 0.54725892, 0.67212213, 0.90702208, 0.09271611, 0.28051262, 0.18856684,
                0.9389607, 0.90126435, 0.45777323, 0.82003327, 0.74227343, 0.35982915, 0.26917773,
                0.20851454
            ],
            [
                0.02530834, 0.20598832, 0.98278118, 0.91337963, 0.15525481, 0.54164971, 0.97376152,
                0.05620801, 0.55001611, 0.07101188, 0.06457912, 0.01951568, 0.77520384, 0.58928205,
                0.4893268
            ],
            [
                0.37889206, 0.08488933, 0.69844682, 0.13838367, 0.45322238, 0.28546089, 0.91733085,
                0.76731629, 0.47535939, 0.430336, 0.4033134, 0.22314279, 0.91983052, 0.15463824,
                0.52706518
            ]
        ]
    ];

    let kernel25: Array4<f32> = Array::from_shape_vec(
        (3, 2, 4, 4),
        vec![
            0.53806253, 0.67769824, 0.29269646, 0.5224842, 0.91617042, 0.83632485, 0.96556284,
            0.62659725, 0.62550989, 0.10147168, 0.37210663, 0.38499138, 0.57677184, 0.04776173,
            0.13979574, 0.34796357, 0.92938047, 0.02366208, 0.6165888, 0.4602623, 0.80627349,
            0.68917644, 0.03279204, 0.61764415, 0.84899486, 0.07298613, 0.51074279, 0.15994577,
            0.23598829, 0.42557175, 0.54054205, 0.99730229, 0.77872316, 0.34836138, 0.25666964,
            0.21393713, 0.13617612, 0.29510999, 0.47935697, 0.60274207, 0.26824013, 0.09325973,
            0.99996946, 0.66342248, 0.30268312, 0.4703405, 0.5264845, 0.41914598, 0.93084307,
            0.38605881, 0.3112818, 0.5403318, 0.75441289, 0.23385784, 0.45327122, 0.01928642,
            0.31058536, 0.92313242, 0.51113379, 0.85251105, 0.22631838, 0.60791954, 0.84655061,
            0.15559341, 0.47655348, 0.93172921, 0.73171296, 0.42527972, 0.8793211, 0.80859519,
            0.82055656, 0.88263529, 0.87073562, 0.99079618, 0.24373481, 0.04408429, 0.9780975,
            0.83518287, 0.44241802, 0.96070865, 0.09084356, 0.68804724, 0.78929911, 0.7980087,
            0.09648527, 0.31804043, 0.96192238, 0.99013286, 0.8503088, 0.78152828, 0.39002458,
            0.42641846, 0.69086572, 0.89109583, 0.29640056, 0.17727828,
        ],
    )
    .unwrap();
    let conv_layer25 = ConvolutionLayer::new(kernel25, 1, Padding::Valid);
    let target_output25 = array![
        [
            [
                6.36072493, 6.88649464, 7.40918589, 7.05664349, 8.17166615, 7.8553133, 7.53221416,
                8.17308998, 8.28448105, 8.28387928, 8.2394886, 8.31441879
            ],
            [
                6.75564146, 7.07354927, 7.84864902, 8.37685585, 8.50257683, 8.87651443, 7.49159622,
                8.48030853, 8.77501011, 8.44789124, 8.74794769, 7.73553038
            ],
            [
                6.04652643, 6.81029272, 7.92868185, 8.93433857, 8.50168133, 8.79101658, 8.24908352,
                8.64074612, 8.4817667, 9.71573257, 8.37022209, 8.39937592
            ],
            [
                6.75097609, 6.17665148, 7.6930666, 8.61388302, 8.76940823, 9.69960594, 9.35572529,
                8.60114002, 7.52979946, 8.95337296, 7.99612331, 8.60623741
            ],
            [
                8.46782207, 7.2140317, 8.1340332, 8.36314392, 8.25354481, 9.50742912, 9.08969593,
                9.11600208, 8.2383976, 9.43918705, 7.73125792, 8.14826775
            ],
            [
                9.07098007, 8.27197075, 8.54970169, 9.00512123, 6.8691926, 7.88983297, 7.70646954,
                6.48301649, 7.84885788, 8.34324074, 8.20389462, 9.13293648
            ],
            [
                7.19763422, 7.26375341, 8.81982327, 7.72620201, 7.40150738, 8.04497242, 8.90334415,
                8.57888699, 8.57104301, 8.88927937, 8.30325413, 8.16442108
            ]
        ],
        [
            [
                6.54775906, 7.14619493, 7.01751423, 7.54444933, 6.67259026, 6.71176958, 7.45916033,
                8.66985226, 8.18662453, 7.61672878, 8.52037621, 7.67396879
            ],
            [
                6.03272009, 6.55892849, 7.59323931, 6.5732007, 8.17337799, 8.25602341, 8.09602165,
                7.91178656, 8.30133629, 7.43054008, 7.59113407, 7.68360472
            ],
            [
                6.13341522, 6.97604799, 7.37776661, 8.3004427, 8.6382122, 8.90797043, 7.36421919,
                7.64168262, 7.68332767, 8.52475929, 8.50475693, 7.8977561
            ],
            [
                6.66992188, 7.07043076, 6.86683035, 7.40672827, 8.45323181, 8.47031879, 7.56489658,
                7.75717449, 7.01110315, 7.99215984, 7.6094079, 7.44254446
            ],
            [
                8.1882925, 7.61292267, 7.10181808, 7.59471083, 6.89718866, 8.71207619, 8.8663168,
                7.89157104, 8.10201931, 8.76797009, 7.85895014, 8.16519928
            ],
            [
                8.75269508, 7.99995375, 7.3435688, 6.24801111, 7.31040812, 7.95404339, 8.58798695,
                7.72645187, 7.24425364, 8.20948505, 8.02157593, 7.65854645
            ],
            [
                7.36874008, 7.51757479, 7.5067544, 7.08331442, 7.09440708, 9.05077934, 8.28052711,
                7.46363592, 6.97696352, 7.74402618, 7.00364399, 7.94347239
            ]
        ],
        [
            [
                7.88541555,
                9.33767223,
                9.38384438,
                9.58533001,
                11.32038021,
                10.83576965,
                9.59079933,
                10.39780903,
                10.93352127,
                11.08518982,
                11.70243931,
                11.40731716
            ],
            [
                8.08763695,
                8.15014076,
                9.70212841,
                9.71464157,
                10.61255836,
                11.46654987,
                11.94542885,
                12.18067169,
                10.92657089,
                10.80902767,
                10.84335709,
                11.01739979
            ],
            [
                8.27407455,
                8.37354946,
                10.29666901,
                11.52302456,
                11.181633,
                11.55147266,
                11.86345959,
                11.32910442,
                11.05982304,
                11.29735279,
                11.05127335,
                10.5396347
            ],
            [
                10.13381004,
                8.54798031,
                10.48806,
                10.96978951,
                11.52666187,
                11.93585968,
                11.32895279,
                9.40046787,
                9.48109627,
                10.27073574,
                10.80696487,
                11.65773296
            ],
            [
                10.15608215,
                9.82503223,
                11.3850441,
                11.40770817,
                10.90134621,
                10.30632401,
                11.31679249,
                11.57257462,
                11.42833614,
                11.84930992,
                11.24005318,
                11.09986687
            ],
            [
                9.0790329,
                9.53152466,
                11.11500454,
                11.16950417,
                9.9561224,
                10.35612392,
                9.56521893,
                9.6309557,
                10.81128883,
                11.24505424,
                11.22018814,
                11.38229179
            ],
            [
                9.53304195,
                9.36320114,
                9.83486176,
                9.0121603,
                9.68887234,
                12.19692612,
                11.9923811,
                11.31857777,
                10.99127388,
                9.58917713,
                10.38134289,
                10.72104549
            ]
        ]
    ];
    let current_output25 = conv_layer25.convolve(&test_input25);

    assert!(
        arr_allclose(&current_output25, &target_output25),
        "{:?} was not equal to {:?}",
        current_output25,
        target_output25
    );

    let test_input26 = array![
        [
            [
                0.2089261, 0.49979008, 0.56423787, 0.7030672, 0.27845028, 0.94389766, 0.20636925,
                0.66672019, 0.76393695, 0.48988731, 0.73562812, 0.54680753, 0.68185259, 0.69871773,
                0.40215193
            ],
            [
                0.33184996, 0.23738323, 0.42945445, 0.64908034, 0.58335521, 0.97156673, 0.30805972,
                0.87517558, 0.29061685, 0.32266703, 0.74558375, 0.39886904, 0.45468414, 0.77469293,
                0.79654879
            ],
            [
                0.76469586, 0.27917181, 0.26557566, 0.51671653, 0.14463307, 0.49024066, 0.56441789,
                0.11350685, 0.04281154, 0.57114466, 0.39833463, 0.2126663, 0.1499708, 0.73064126,
                0.45918139
            ],
            [
                0.0285126, 0.92805762, 0.72670998, 0.34472197, 0.18288209, 0.83077593, 0.43013144,
                0.35543967, 0.75937792, 0.45248675, 0.78150373, 0.98412323, 0.86351109, 0.66671311,
                0.53401237
            ],
            [
                0.13950848, 0.57531868, 0.22581473, 0.31055019, 0.35594859, 0.94544616, 0.87944521,
                0.26997161, 0.45676421, 0.20421512, 0.99164583, 0.83325416, 0.89352186, 0.35738186,
                0.94435399
            ],
            [
                0.84149825, 0.31955966, 0.0488622, 0.17070445, 0.6034462, 0.36290236, 0.8472129,
                0.49671843, 0.19694914, 0.80763392, 0.21147081, 0.22211873, 0.43805567, 0.43717725,
                0.89430046
            ],
            [
                0.92837189, 0.8128758, 0.73731279, 0.42566534, 0.44624192, 0.23623947, 0.80635439,
                0.26903113, 0.20805733, 0.03382581, 0.48451242, 0.56668677, 0.22873266, 0.299916,
                0.9879018
            ],
            [
                0.10301294, 0.24334253, 0.44374003, 0.64236861, 0.81102607, 0.78476408, 0.66955779,
                0.93565844, 0.371802, 0.93261364, 0.89604715, 0.2305824, 0.10865665, 0.74001564,
                0.52640328
            ],
            [
                0.59626133, 0.49422848, 0.86068394, 0.99988186, 0.56603131, 0.48357182, 0.35112807,
                0.57117814, 0.8400437, 0.13524966, 0.94668282, 0.39311503, 0.90124023, 0.75557139,
                0.5037727
            ],
            [
                0.42197251, 0.47999806, 0.22245023, 0.7799652, 0.29572074, 0.78845742, 0.87387354,
                0.88842474, 0.46210247, 0.91006059, 0.6943571, 0.28570879, 0.49740205, 0.76284432,
                0.69361483
            ]
        ],
        [
            [
                0.16655016, 0.26878476, 0.58333513, 0.98748305, 0.64336683, 0.26489744, 0.33358737,
                0.00685212, 0.658877, 0.97735418, 0.72935826, 0.96536913, 0.4197044, 0.03449651,
                0.80373667
            ],
            [
                0.88689565, 0.19757592, 0.33775257, 0.9949134, 0.35532915, 0.98935051, 0.08079711,
                0.9904894, 0.34009922, 0.97684611, 0.44599372, 0.09269939, 0.15401786, 0.99797895,
                0.4328108
            ],
            [
                0.7613341, 0.94856582, 0.74674775, 0.33150923, 0.81601158, 0.57959552, 0.62684278,
                0.08034612, 0.86004763, 0.23814382, 0.23848392, 0.10764247, 0.15689475, 0.70573328,
                0.01841728
            ],
            [
                0.17239508, 0.53495741, 0.27755456, 0.5322748, 0.07772017, 0.11139348, 0.81536444,
                0.89346812, 0.08395886, 0.40988755, 0.96835217, 0.71043001, 0.24133632, 0.6608676,
                0.45239363
            ],
            [
                0.7648658, 0.78390221, 0.11525997, 0.11204641, 0.93657471, 0.28355595, 0.94687663,
                0.0319368, 0.95543646, 0.31404087, 0.45478264, 0.46826618, 0.14600264, 0.11851354,
                0.68696929
            ],
            [
                0.8751561, 0.24598802, 0.51128345, 0.21171107, 0.07832937, 0.54206832, 0.16797651,
                0.97511008, 0.46346098, 0.92516051, 0.83557275, 0.93996977, 0.63095193, 0.01171468,
                0.31194555
            ],
            [
                0.89293909, 0.85650479, 0.45759721, 0.12795849, 0.10912379, 0.02952798, 0.10989774,
                0.4077279, 0.05740095, 0.90538735, 0.35906726, 0.55836499, 0.30030969, 0.26236705,
                0.63975834
            ],
            [
                0.64865221, 0.65862478, 0.79906203, 0.69226535, 0.11245027, 0.44999343, 0.19131283,
                0.56852181, 0.58138868, 0.8676397, 0.69495834, 0.98907141, 0.91694082, 0.67337078,
                0.11409238
            ],
            [
                0.93137124, 0.8991999, 0.47506758, 0.14831748, 0.60308778, 0.1869184, 0.89142022,
                0.73000857, 0.87604839, 0.10900346, 0.48400246, 0.08230179, 0.06097801, 0.19118872,
                0.33851793
            ],
            [
                0.82975563, 0.25460039, 0.68964777, 0.46926925, 0.91846106, 0.61307685, 0.65601351,
                0.28075829, 0.12817005, 0.35788413, 0.73211796, 0.766394, 0.84590471, 0.66833038,
                0.87622137
            ]
        ]
    ];

    let kernel26: Array4<f32> = Array::from_shape_vec(
        (3, 2, 4, 4),
        vec![
            0.68722954, 0.33361896, 0.32000798, 0.79336314, 0.51849384, 0.38584011, 0.69625898,
            0.67916823, 0.20234333, 0.60328611, 0.48042778, 0.29644713, 0.21245298, 0.6937536,
            0.08710818, 0.77838677, 0.9167911, 0.59548962, 0.33385372, 0.68012579, 0.89744274,
            0.18934485, 0.0564688, 0.82598113, 0.98988925, 0.78486877, 0.3775057, 0.83544203,
            0.34188869, 0.80864925, 0.82852668, 0.91241813, 0.28085634, 0.48125054, 0.07043128,
            0.47305905, 0.21471797, 0.37207894, 0.10534422, 0.61738714, 0.49574846, 0.87061427,
            0.62692716, 0.12505584, 0.32882456, 0.13899311, 0.31035821, 0.88731766, 0.09477642,
            0.60963128, 0.97063475, 0.33909173, 0.24199934, 0.32436552, 0.50521873, 0.40645204,
            0.72868264, 0.18457449, 0.67775714, 0.80771195, 0.20815027, 0.76091386, 0.42811718,
            0.04814293, 0.2477421, 0.73635357, 0.82568176, 0.23572316, 0.89212479, 0.00548277,
            0.49046425, 0.63641548, 0.95209122, 0.56703387, 0.6343222, 0.43334082, 0.30917186,
            0.22897069, 0.41616559, 0.06782987, 0.68388858, 0.13053188, 0.19831855, 0.27927719,
            0.82981785, 0.38844033, 0.6897695, 0.43391317, 0.2388109, 0.47514349, 0.15262189,
            0.78329371, 0.69722742, 0.76765394, 0.48872955, 0.97543495,
        ],
    )
    .unwrap();
    let conv_layer26 = ConvolutionLayer::new(kernel26, 1, Padding::Valid);
    let target_output26 = array![
        [
            [
                9.75507545,
                8.69923687,
                9.96536636,
                9.16979885,
                9.51300144,
                10.03099346,
                7.97789621,
                9.67975521,
                10.04680824,
                9.59649372,
                10.12002563,
                8.64026928
            ],
            [
                8.83897686, 8.07453442, 8.89038754, 9.74809456, 9.26179123, 9.66407108, 8.55519962,
                9.83794308, 8.3675909, 8.77315331, 9.74698639, 8.56504822
            ],
            [
                8.41338539,
                7.8226018,
                6.83257389,
                9.33043766,
                8.73506641,
                9.08046627,
                9.8553133,
                9.0988903,
                10.11874104,
                9.11031914,
                9.5565691,
                8.56641388
            ],
            [
                7.87981558,
                7.45285654,
                6.26085711,
                7.40604496,
                7.49800587,
                8.51558971,
                9.11654186,
                9.55334377,
                10.82241917,
                10.00434303,
                9.9566288,
                10.39786911
            ],
            [
                9.40633011,
                8.30849648,
                7.37745523,
                7.44195843,
                8.58518505,
                8.18177032,
                9.85508537,
                9.63030338,
                10.21509743,
                10.49439526,
                9.23679543,
                9.62643719
            ],
            [
                10.29960632,
                8.77621746,
                8.15144348,
                7.70098591,
                8.76920795,
                8.62224388,
                9.6916256,
                10.17453957,
                9.09671116,
                10.43714142,
                8.30771446,
                9.34828281
            ],
            [
                10.86556721,
                10.15554333,
                9.65961456,
                9.34183693,
                9.2013855,
                8.49755859,
                9.51622486,
                9.85071945,
                9.40427971,
                9.60194111,
                9.29998112,
                9.71799374
            ]
        ],
        [
            [
                6.82569599, 7.24869108, 8.25789356, 5.97575283, 6.49621391, 6.97578764, 6.65942764,
                6.95185947, 7.544312, 7.29543591, 6.9498167, 6.06794024
            ],
            [
                6.47857237, 6.35229445, 6.66860867, 7.60253906, 7.25415087, 6.69796228, 6.68086576,
                7.9545331, 7.04592943, 6.49713469, 7.43539238, 7.62261772
            ],
            [
                6.01982975, 5.97441053, 5.53606606, 6.58338308, 7.36675072, 6.74782658, 7.51566076,
                6.04251194, 7.07670975, 7.01925468, 7.1606617, 7.19361305
            ],
            [
                6.47638226, 4.95664406, 5.067379, 5.36361551, 6.36414909, 7.28854704, 5.95427322,
                7.39148331, 8.33935738, 7.87933493, 6.3371191, 7.24705219
            ],
            [
                6.91783857, 6.23152304, 6.02999163, 5.82405663, 6.61637306, 6.17707157, 7.25239897,
                7.4297266, 6.56289768, 7.54486084, 6.73062229, 6.92455912
            ],
            [
                7.71875525, 6.1461792, 5.51757336, 6.3885107, 6.09194183, 7.70043135, 7.65108109,
                8.336339, 8.33041859, 8.50201702, 6.8977828, 6.06623173
            ],
            [
                7.93903971, 7.48396349, 6.89638424, 7.13175297, 7.19093275, 6.82833052, 7.45729733,
                7.49464226, 6.93764019, 6.72249079, 7.55799389, 7.01875973
            ]
        ],
        [
            [
                8.00803375, 7.46938276, 7.42080021, 9.02796841, 7.34408045, 8.46869659, 7.29710674,
                8.70588875, 7.58729887, 7.91687489, 8.81009197, 7.94659758
            ],
            [
                8.05272865, 7.76182747, 7.22370863, 9.19091797, 7.87897015, 8.62835979, 7.93576097,
                7.37878752, 7.94737816, 7.36195374, 8.23109627, 7.81157684
            ],
            [
                6.01886559, 6.82082748, 6.25493431, 7.05884838, 7.5705061, 8.83888912, 7.88392067,
                8.21667767, 9.46330738, 8.58712006, 8.57648849, 8.5334034
            ],
            [
                7.36098146, 6.53647947, 5.34335995, 6.08253288, 7.74983597, 6.38078165, 9.20343876,
                7.70112085, 8.81417751, 8.62793064, 8.06516361, 8.36709499
            ],
            [
                8.67549133, 7.02211761, 6.32308817, 6.43462324, 7.94246769, 7.11474419, 8.72362137,
                8.02380562, 9.14659595, 9.79688358, 8.73129082, 8.46788597
            ],
            [
                8.59352493, 7.37296295, 7.02885532, 7.01102448, 7.92898083, 7.91115046, 8.25422287,
                9.20264149, 8.11540985, 7.63596296, 7.18020582, 7.1322279
            ],
            [
                9.37212849, 9.48602867, 8.47047329, 8.80617237, 8.15176296, 8.23621941, 7.34645605,
                8.88223553, 7.82145596, 9.06285191, 9.49863338, 8.89390469
            ]
        ]
    ];
    let current_output26 = conv_layer26.convolve(&test_input26);

    assert!(
        arr_allclose(&current_output26, &target_output26),
        "{:?} was not equal to {:?}",
        current_output26,
        target_output26
    );

    let test_input27 = array![
        [
            [
                0.84143919, 0.5716796, 0.57465926, 0.22662647, 0.72878735, 0.81788557, 0.75768616,
                0.44170135, 0.74363214, 0.03670884, 0.54763687, 0.20077299, 0.56937202, 0.13181127,
                0.13081091
            ],
            [
                0.40169111, 0.02235833, 0.55760674, 0.83430796, 0.360836, 0.56738032, 0.91996184,
                0.79167342, 0.33047372, 0.55233093, 0.77685972, 0.49729655, 0.60879943, 0.85824954,
                0.18380235
            ],
            [
                0.84842744, 0.96455652, 0.12606913, 0.62333464, 0.40896285, 0.60540571, 0.72344356,
                0.64341777, 0.35723292, 0.93422615, 0.2303441, 0.89859826, 0.4833327, 0.88401787,
                0.70710741
            ],
            [
                0.38079957, 0.89847402, 0.76911915, 0.69664333, 0.9301381, 0.52791016, 0.63759292,
                0.41758482, 0.05990019, 0.05685853, 0.27304211, 0.86264995, 0.86841039, 0.48180396,
                0.60107542
            ],
            [
                0.88915733, 0.63210746, 0.07892385, 0.76392257, 0.62059747, 0.30022189, 0.89278922,
                0.90595636, 0.22659946, 0.14760193, 0.00599372, 0.30542407, 0.72884977, 0.87160847,
                0.50342597
            ],
            [
                0.41313492, 0.88581848, 0.6434107, 0.45720101, 0.53698071, 0.17925061, 0.61535142,
                0.64973148, 0.41555945, 0.61887466, 0.17343595, 0.54446397, 0.19735775, 0.69336061,
                0.58806963
            ],
            [
                0.80442407, 0.22769123, 0.53898123, 0.87782377, 0.33365021, 0.02226985, 0.09958417,
                0.27681004, 0.18543235, 0.21413611, 0.26165754, 0.027802, 0.9319044, 0.92774295,
                0.18005316
            ],
            [
                0.81092879, 0.62190108, 0.77950682, 0.72729406, 0.5608989, 0.52275812, 0.16359355,
                0.11108088, 0.88981735, 0.20012106, 0.70492943, 0.54065808, 0.43730916, 0.60061648,
                0.73953919
            ],
            [
                0.74704049, 0.68801787, 0.95084522, 0.81441252, 0.09777608, 0.89484024, 0.82783867,
                0.06093569, 0.91676912, 0.46885745, 0.43228299, 0.4377543, 0.16224979, 0.06134897,
                0.20221839
            ],
            [
                0.07522171, 0.75219087, 0.03596852, 0.28626589, 0.75235978, 0.64913375, 0.92554733,
                0.65209919, 0.83952223, 0.42260578, 0.20702457, 0.30891683, 0.26645028, 0.96312688,
                0.31632706
            ]
        ],
        [
            [
                0.41035688, 0.83820977, 0.8525341, 0.94491211, 0.31281238, 0.94421537, 0.29261506,
                0.43404636, 0.16094153, 0.66423817, 0.06268399, 0.95791441, 0.75028186, 0.09143816,
                0.58713917
            ],
            [
                0.09202226, 0.05626365, 0.94994553, 0.29447657, 0.79507724, 0.75073629, 0.89040359,
                0.25231564, 0.70364728, 0.93381677, 0.16046775, 0.06850107, 0.14086206, 0.18575046,
                0.94590174
            ],
            [
                0.778617, 0.01911113, 0.3645535, 0.18393158, 0.71138199, 0.29766195, 0.94091393,
                0.66175576, 0.06250098, 0.8391969, 0.18263739, 0.27238532, 0.66940516, 0.02453929,
                0.21670068
            ],
            [
                0.78546018, 0.2715362, 0.31696306, 0.45880696, 0.12966863, 0.94143581, 0.5301901,
                0.67305826, 0.19911294, 0.61133267, 0.99582208, 0.8324337, 0.81940349, 0.52347236,
                0.3039722
            ],
            [
                0.23559987, 0.71697519, 0.83921854, 0.00453156, 0.07645657, 0.64613331, 0.31977178,
                0.44444508, 0.51352833, 0.82848715, 0.12873596, 0.19493582, 0.12292414, 0.52158403,
                0.06434183
            ],
            [
                0.20470969, 0.32419515, 0.11837589, 0.95561638, 0.8962471, 0.72749725, 0.86255626,
                0.16951791, 0.89949921, 0.30796449, 0.48415481, 0.50550426, 0.24823008, 0.42320151,
                0.24034185
            ],
            [
                0.50311692, 0.2196024, 0.43426839, 0.98074588, 0.94563128, 0.44097563, 0.03213529,
                0.49693356, 0.60258669, 0.2574467, 0.45553603, 0.44379727, 0.97324241, 0.3627867,
                0.2487736
            ],
            [
                0.21001962, 0.9101744, 0.39797535, 0.26517462, 0.41195874, 0.38203195, 0.0038282,
                0.68331535, 0.45850393, 0.08282983, 0.74266544, 0.72705849, 0.79932619, 0.18561169,
                0.73794276
            ],
            [
                0.13075382, 0.92822394, 0.64137435, 0.43831323, 0.28829069, 0.49762248, 0.26103418,
                0.17956546, 0.97447652, 0.56784427, 0.12135573, 0.63540921, 0.03319374, 0.29163483,
                0.86157887
            ],
            [
                0.13130436, 0.4782706, 0.47632742, 0.84865194, 0.28834381, 0.99329984, 0.23911465,
                0.05297824, 0.39004716, 0.4614755, 0.71394046, 0.36967712, 0.72813417, 0.32832127,
                0.7320835
            ]
        ]
    ];

    let kernel27: Array4<f32> = Array::from_shape_vec(
        (3, 2, 4, 4),
        vec![
            0.84974216, 0.46872958, 0.53924271, 0.0656543, 0.10209152, 0.19136641, 0.26282084,
            0.36334252, 0.24959058, 0.68387176, 0.02750501, 0.24431834, 0.15333543, 0.79784446,
            0.98453825, 0.31919928, 0.70732907, 0.64511192, 0.67005818, 0.64926277, 0.63156655,
            0.00915827, 0.52349092, 0.88483645, 0.78874909, 0.08833914, 0.51414193, 0.07875763,
            0.22806701, 0.78832331, 0.30477429, 0.25333271, 0.6694263, 0.43796757, 0.97122886,
            0.64503408, 0.54534572, 0.68606072, 0.99498231, 0.46345224, 0.65992148, 0.91093289,
            0.5078866, 0.35286993, 0.81354124, 0.47349572, 0.69897416, 0.53855813, 0.93777999,
            0.29683718, 0.08466158, 0.00917824, 0.36412131, 0.31364415, 0.89281444, 0.29423689,
            0.58694244, 0.14618948, 0.68540368, 0.95513807, 0.21801536, 0.02948874, 0.7533694,
            0.61790164, 0.0048431, 0.83636741, 0.74369047, 0.43101178, 0.47684281, 0.83831029,
            0.19812581, 0.05256698, 0.0566386, 0.72115872, 0.50159207, 0.30938643, 0.0141753,
            0.52415643, 0.96125232, 0.78953046, 0.92893124, 0.80651444, 0.80715594, 0.25863178,
            0.70371311, 0.19224384, 0.68629023, 0.58040164, 0.43242832, 0.34644595, 0.54378764,
            0.4958622, 0.69513009, 0.64524393, 0.73673742, 0.73902685,
        ],
    )
    .unwrap();
    let conv_layer27 = ConvolutionLayer::new(kernel27, 1, Padding::Valid);
    let target_output27 = array![
        [
            [
                8.84068298, 7.1261301, 9.05708694, 7.99353981, 8.86686993, 7.71024895, 7.70522594,
                5.5085988, 6.11891508, 7.52461815, 7.50603724, 7.17884541
            ],
            [
                6.59423447, 6.73712921, 7.27077579, 8.13317966, 8.502882, 8.32342529, 8.25155926,
                6.43438339, 5.40494394, 6.30207872, 6.49846458, 7.0721159
            ],
            [
                7.59919071, 6.3534193, 7.13159704, 7.81246567, 7.34308338, 7.94967031, 7.42444372,
                7.49743128, 6.01852417, 7.406322, 6.06473255, 6.74204826
            ],
            [
                6.50402308, 7.38482141, 7.92128801, 7.44019794, 6.81444454, 6.42232275, 6.77631426,
                5.28440428, 5.50766611, 6.2271204, 7.7390089, 7.99319696
            ],
            [
                7.80224657, 7.79620981, 7.04319143, 7.21669102, 6.12223339, 6.08017635, 6.94583368,
                6.07567215, 5.78848791, 5.51704693, 5.93581152, 6.61221075
            ],
            [
                8.42419147, 9.22340202, 7.62022591, 7.1166048, 7.01905632, 6.74369955, 5.73761797,
                7.23304844, 6.67918491, 6.17012358, 6.38798523, 5.34322691
            ],
            [
                6.75581646, 7.72482777, 8.32083321, 6.80145597, 6.55578947, 6.60353565, 5.02043629,
                6.47281504, 6.55168009, 6.22592735, 6.08787632, 7.34719849
            ]
        ],
        [
            [
                9.3516531,
                9.31357002,
                10.43907356,
                11.31943798,
                11.43415451,
                9.90832233,
                9.32564354,
                8.5197916,
                7.93524313,
                9.00117493,
                8.36545372,
                8.64623356
            ],
            [
                8.8115778,
                7.85741234,
                9.30795956,
                10.36941051,
                11.0800066,
                10.07455921,
                9.45149326,
                8.95021343,
                7.49526501,
                9.12927723,
                9.37863541,
                9.13327026
            ],
            [
                9.46486378, 9.20389557, 9.04651833, 9.8093853, 9.72136593, 9.28493118, 9.75998116,
                7.70732784, 6.93834162, 8.73892689, 8.35943317, 9.48697567
            ],
            [
                10.49556351,
                10.52957535,
                9.30927467,
                9.25103188,
                8.19000053,
                8.72834587,
                7.74523544,
                6.4803977,
                6.05058098,
                7.35342264,
                9.0177002,
                8.95888996
            ],
            [
                9.50512695,
                10.74542999,
                9.71688461,
                7.99629211,
                7.90583515,
                8.10388756,
                7.10622406,
                6.84932232,
                7.54187059,
                7.94472837,
                7.97182274,
                8.59810162
            ],
            [
                9.74093342,
                10.20242882,
                9.37630081,
                8.39267063,
                7.0892787,
                7.98828173,
                7.71680975,
                7.21604013,
                8.43015862,
                7.52716255,
                8.03704643,
                8.78754711
            ],
            [
                9.57088947, 9.70731926, 9.14722443, 8.89687443, 7.02302408, 8.18512726, 7.66155577,
                7.3618083, 8.62882996, 7.24235916, 8.26218033, 8.57814503
            ]
        ],
        [
            [
                8.95200825,
                8.64309788,
                10.51016808,
                10.57492542,
                10.26525593,
                9.55349255,
                8.55354214,
                7.60330057,
                7.63249159,
                10.02030182,
                9.01213455,
                8.68607998
            ],
            [
                8.32353592,
                7.99560308,
                9.18205643,
                8.97485447,
                10.75743961,
                9.88433647,
                8.89435577,
                7.57622242,
                7.50315285,
                8.55392838,
                8.15495014,
                7.76016378
            ],
            [
                8.65187931, 7.48686838, 8.82392311, 9.70506191, 9.90645218, 10.2416935, 9.23030758,
                7.68694019, 7.26798677, 7.35711718, 8.69474697, 8.60617161
            ],
            [
                9.58411789, 9.04540348, 9.03862286, 8.68275452, 7.53502417, 8.63504696, 7.60506439,
                6.72235489, 6.66278172, 8.10141277, 9.6137867, 9.06225681
            ],
            [
                8.98120594, 9.91987419, 8.82854652, 7.39180279, 6.86075306, 7.99023962, 7.58943224,
                7.1347127, 7.45893955, 7.36573935, 7.90126324, 8.76664448
            ],
            [
                9.48264885, 9.70434475, 9.35239124, 9.02420616, 7.65968657, 7.92459249, 7.73089743,
                7.761796, 8.18333721, 7.05978298, 6.84399033, 7.44968033
            ],
            [
                8.31819534,
                9.64580917,
                10.03301525,
                8.78883171,
                7.53378963,
                7.62592888,
                6.3072238,
                7.6269927,
                7.45273066,
                7.31052828,
                8.57531071,
                9.04127026
            ]
        ]
    ];
    let current_output27 = conv_layer27.convolve(&test_input27);

    assert!(
        arr_allclose(&current_output27, &target_output27),
        "{:?} was not equal to {:?}",
        current_output27,
        target_output27
    );

    let test_input28 = array![
        [
            [
                0.38423092, 0.29721686, 0.41607439, 0.64454817, 0.69389512, 0.55612449, 0.62221509,
                0.75789962, 0.8944672, 0.92868456, 0.96990104, 0.12573825, 0.04893699, 0.98348894,
                0.1309708
            ],
            [
                0.10405056, 0.89075837, 0.19249535, 0.7266609, 0.97847943, 0.88732066, 0.04145219,
                0.40886414, 0.94225923, 0.48782048, 0.32128148, 0.33589965, 0.548731, 0.39472355,
                0.20935446
            ],
            [
                0.45881257, 0.87849302, 0.11820385, 0.33547177, 0.78958012, 0.61463959, 0.54037099,
                0.75543073, 0.93286069, 0.79101775, 0.23345572, 0.08010993, 0.78839544, 0.54354429,
                0.81300774
            ],
            [
                0.84049743, 0.16837756, 0.35681822, 0.9842876, 0.7681288, 0.3387178, 0.3631438,
                0.85423149, 0.69573399, 0.04040196, 0.51030129, 0.87327089, 0.37753971, 0.59577572,
                0.19604515
            ],
            [
                0.4733552, 0.82332438, 0.93222111, 0.95901178, 0.85556581, 0.89882571, 0.69483556,
                0.25473274, 0.58026378, 0.46147575, 0.87210913, 0.29316397, 0.52445789, 0.30302691,
                0.43613002
            ],
            [
                0.26899648, 0.55013153, 0.37700799, 0.41173777, 0.36448048, 0.67584548, 0.53783194,
                0.58787241, 0.99191519, 0.95134267, 0.49309427, 0.87526672, 0.60490572, 0.96107544,
                0.25857434
            ],
            [
                0.15807905, 0.81055479, 0.56145431, 0.52334199, 0.00024235, 0.24716882, 0.62018557,
                0.20580723, 0.59646319, 0.45906409, 0.42482692, 0.45910731, 0.28503575, 0.02397736,
                0.70268539
            ],
            [
                0.38717397, 0.72264349, 0.05888641, 0.1981337, 0.28624369, 0.86936975, 0.98584665,
                0.33910661, 0.04178984, 0.83887973, 0.87520554, 0.19628692, 0.32806987, 0.19625323,
                0.48324485
            ],
            [
                0.26547596, 0.29169067, 0.34818614, 0.54155626, 0.55841755, 0.43203036, 0.90635383,
                0.62216193, 0.13312029, 0.58438163, 0.24158851, 0.59230624, 0.80972454, 0.78276191,
                0.18394486
            ],
            [
                0.59019595, 0.94054116, 0.44074105, 0.67807877, 0.58551256, 0.83411977, 0.0958912,
                0.42005201, 0.54269039, 0.47856296, 0.68272057, 0.02972909, 0.85674535, 0.71152625,
                0.78101332
            ]
        ],
        [
            [
                0.70287635, 0.61693936, 0.99540682, 0.53743317, 0.65756059, 0.96492665, 0.31929256,
                0.02934249, 0.56245795, 0.09922413, 0.86692382, 0.39934039, 0.07765451, 0.73534189,
                0.00198996
            ],
            [
                0.446601, 0.49630404, 0.79839312, 0.58093805, 0.21345795, 0.72308261, 0.48493851,
                0.82055302, 0.62823937, 0.20790926, 0.17480347, 0.10601443, 0.81503462, 0.127237,
                0.27046125
            ],
            [
                0.28842457, 0.7203788, 0.69916581, 0.26068439, 0.52442361, 0.32585684, 0.71527441,
                0.68926451, 0.38133959, 0.86428924, 0.5063956, 0.52138848, 0.59597006, 0.85057951,
                0.77488746
            ],
            [
                0.32738407, 0.52149975, 0.34216304, 0.22714304, 0.76833694, 0.36691627, 0.14223122,
                0.67387353, 0.09267096, 0.49853118, 0.58446873, 0.76446555, 0.28446306, 0.3201185,
                0.26963411
            ],
            [
                0.85784458, 0.09514732, 0.59979402, 0.50938488, 0.71366805, 0.88974968, 0.56399824,
                0.48656831, 0.57541674, 0.63260813, 0.51304414, 0.49034654, 0.70372093, 0.33208346,
                0.63787571
            ],
            [
                0.62917059, 0.47421247, 0.23486344, 0.86995201, 0.65361419, 0.03662743, 0.51462922,
                0.91969109, 0.87932213, 0.78186775, 0.48471547, 0.53838686, 0.62534816, 0.3553714,
                0.99681179
            ],
            [
                0.49688725, 0.37583, 0.19825908, 0.93685856, 0.68677646, 0.24576979, 0.36799956,
                0.66436833, 0.40309097, 0.40307762, 0.60841759, 0.90556718, 0.69772192, 0.19649447,
                0.12604196
            ],
            [
                0.43395323, 0.05938564, 0.06919543, 0.65974034, 0.90802655, 0.56249222, 0.28784845,
                0.02659295, 0.47776846, 0.76198399, 0.79841344, 0.79470665, 0.02110602, 0.54365277,
                0.71139069
            ],
            [
                0.18104874, 0.24870853, 0.57747318, 0.61245713, 0.03752139, 0.94574443, 0.46812821,
                0.96979702, 0.12823386, 0.15993103, 0.42355735, 0.72048514, 0.48144374, 0.85812101,
                0.33813378
            ],
            [
                0.97785051, 0.46431799, 0.22258296, 0.62782708, 0.25811203, 0.72843253, 0.27373014,
                0.27433896, 0.73249104, 0.68628502, 0.9107763, 0.52486304, 0.02864541, 0.63270447,
                0.38749784
            ]
        ]
    ];

    let kernel28: Array4<f32> = Array::from_shape_vec(
        (3, 2, 5, 5),
        vec![
            0.44100301, 0.78058935, 0.14124235, 0.28628785, 0.76789914, 0.37555937, 0.43971176,
            0.04331318, 0.09780997, 0.40862007, 0.70528004, 0.09185711, 0.82353595, 0.81429753,
            0.07302681, 0.61528493, 0.93562272, 0.77982756, 0.7211608, 0.71058422, 0.40345481,
            0.80509214, 0.09783126, 0.21926213, 0.13207655, 0.70158083, 0.17238653, 0.18460116,
            0.55758209, 0.5780929, 0.04024655, 0.60567654, 0.67101529, 0.11163998, 0.97307409,
            0.79570754, 0.13753681, 0.42499141, 0.95902903, 0.64616002, 0.01944306, 0.0451069,
            0.60988926, 0.57029749, 0.91541411, 0.298369, 0.47126327, 0.56598396, 0.57679987,
            0.28650795, 0.35120928, 0.22292198, 0.76072214, 0.83723958, 0.61290087, 0.14372927,
            0.35133615, 0.2495688, 0.98542097, 0.44534237, 0.26395977, 0.64136176, 0.29018157,
            0.70265153, 0.46130355, 0.83116457, 0.38838806, 0.7658825, 0.2515203, 0.1549832,
            0.32756809, 0.10193888, 0.37098823, 0.16565025, 0.64406869, 0.39290614, 0.8382721,
            0.4127133, 0.66124401, 0.86943133, 0.91799987, 0.71498458, 0.17257372, 0.72377337,
            0.43520794, 0.32025693, 0.22938729, 0.20685976, 0.56188855, 0.03298171, 0.04516815,
            0.28889107, 0.37819354, 0.35941375, 0.22646557, 0.48656109, 0.06850647, 0.36713556,
            0.97507527, 0.98560174, 0.13691915, 0.25587378, 0.23198135, 0.63168261, 0.90634482,
            0.62659276, 0.00830113, 0.57375852, 0.66081992, 0.4511592, 0.7095235, 0.37015311,
            0.44504768, 0.49891137, 0.54966918, 0.53325307, 0.02767666, 0.48693478, 0.61392414,
            0.88516566, 0.26826328, 0.40765006, 0.27840444, 0.89372281, 0.997754, 0.46338457,
            0.78445924, 0.58261301, 0.74148726, 0.58712801, 0.25544515, 0.38590936, 0.68114016,
            0.50827443, 0.66626601, 0.23000366, 0.408603, 0.913767, 0.06065572, 0.154079,
            0.61952481, 0.84496329, 0.76260163, 0.18244016, 0.17815381, 0.26175068, 0.04169152,
            0.30446775, 0.94878975, 0.73767347,
        ],
    )
    .unwrap();
    let conv_layer28 = ConvolutionLayer::new(kernel28, 1, Padding::Valid);
    let target_output28 = array![
        [
            [
                12.41143227,
                14.10520172,
                13.65375614,
                14.01558876,
                14.2712059,
                13.35305023,
                13.16063595,
                12.68485165,
                11.55848598,
                12.21369362,
                11.26004124
            ],
            [
                14.42728233,
                14.4203968,
                13.11817455,
                13.42795277,
                14.39086723,
                13.60726929,
                11.8106041,
                13.37348175,
                14.12486458,
                11.72906017,
                11.2575655
            ],
            [
                13.4412899,
                12.30952454,
                12.79889679,
                13.7067852,
                13.08306503,
                14.04136181,
                13.67263985,
                14.04629421,
                13.91142273,
                13.26732445,
                12.91872787
            ],
            [
                12.12606812,
                11.93964577,
                11.08445168,
                12.34902763,
                12.69426918,
                12.32437706,
                13.03761005,
                13.69719791,
                13.37101269,
                12.40610123,
                11.71035957
            ],
            [
                12.03792572,
                12.04188061,
                12.32967377,
                12.59656715,
                12.54647827,
                13.4802494,
                13.40587521,
                12.66966152,
                12.88530064,
                12.09875011,
                11.29882526
            ],
            [
                10.82872486,
                11.36306381,
                11.49699688,
                13.15952682,
                12.2153244,
                12.02388477,
                12.32208729,
                13.8131609,
                13.23144341,
                13.20937443,
                12.28310108
            ]
        ],
        [
            [
                13.53574181,
                14.64169979,
                14.0618515,
                12.63672543,
                13.7223959,
                13.23978615,
                13.09844494,
                11.95412159,
                11.11797333,
                10.82637978,
                9.98127651
            ],
            [
                12.3547554,
                14.237813,
                12.80404568,
                13.62728977,
                14.73758793,
                13.55768967,
                13.05852509,
                11.896595,
                12.17829227,
                11.94991589,
                11.56138897
            ],
            [
                12.34168148,
                12.73444653,
                11.5047121,
                12.35760403,
                13.12375927,
                12.76409245,
                12.88647747,
                13.29387665,
                12.89890289,
                12.50135136,
                11.95624638
            ],
            [
                12.76299191,
                13.11687756,
                11.59880447,
                11.44602013,
                11.49735069,
                12.38115788,
                13.02983761,
                12.95109653,
                12.6103096,
                11.94723606,
                11.30022621
            ],
            [
                11.59503555,
                12.06493378,
                12.59000969,
                13.44333553,
                12.31665516,
                12.41429996,
                12.29159927,
                13.36339378,
                13.37661362,
                12.50649071,
                11.7806263
            ],
            [
                10.82671547,
                10.22889996,
                10.72734928,
                12.5318346,
                11.91310883,
                13.03410149,
                13.53999996,
                12.87446499,
                12.51858711,
                12.02460766,
                12.25546074
            ]
        ],
        [
            [
                15.07518578,
                15.84627533,
                14.29849434,
                13.93229198,
                14.68340683,
                14.08417702,
                12.69966507,
                12.33177376,
                11.95295143,
                12.22871304,
                11.00294781
            ],
            [
                14.02559185,
                13.98468399,
                13.45081902,
                14.18959713,
                15.83597565,
                15.5313282,
                13.77393818,
                13.29954243,
                13.39850521,
                12.93072319,
                12.55520248
            ],
            [
                13.41537762,
                13.14820576,
                12.83195305,
                13.80006981,
                13.77881718,
                14.24200153,
                13.77797127,
                14.22524452,
                14.60185719,
                13.17392731,
                12.49674797
            ],
            [
                11.95192814,
                13.57465172,
                13.68770885,
                12.9512682,
                11.90033913,
                12.76069736,
                14.47568989,
                14.08183193,
                13.20589638,
                12.22524643,
                12.74985123
            ],
            [
                10.68819237,
                12.94041061,
                14.59778786,
                14.2770052,
                12.43268394,
                13.10191917,
                13.43499088,
                13.0955143,
                13.81951332,
                14.07547092,
                13.10273933
            ],
            [
                11.0020113,
                12.32398891,
                12.27340794,
                12.71049118,
                12.32326317,
                13.72482872,
                14.26332664,
                13.54574203,
                12.99476147,
                14.03162384,
                12.57922554
            ]
        ]
    ];
    let current_output28 = conv_layer28.convolve(&test_input28);

    assert!(
        arr_allclose(&current_output28, &target_output28),
        "{:?} was not equal to {:?}",
        current_output28,
        target_output28
    );

    let test_input29 = array![
        [
            [
                0.88643997, 0.420784, 0.0778392, 0.88266083, 0.64920469, 0.38854632, 0.68384961,
                0.62660611, 0.54694177, 0.02779118, 0.58517391, 0.89240649, 0.86535265, 0.20996386,
                0.13090512
            ],
            [
                0.72814707, 0.39318707, 0.32672238, 0.68486334, 0.84961617, 0.45679869, 0.67593971,
                0.64456962, 0.96701486, 0.16086548, 0.70874045, 0.88949418, 0.64757223, 0.18771773,
                0.2012408
            ],
            [
                0.94878229, 0.58967289, 0.80090126, 0.57993472, 0.91786684, 0.16573429, 0.58338782,
                0.47667618, 0.95321173, 0.21564776, 0.89133877, 0.17446654, 0.0107795, 0.29889567,
                0.39913233
            ],
            [
                0.53028938, 0.07816543, 0.74028524, 0.98573533, 0.30748605, 0.99362098, 0.03758357,
                0.13146875, 0.86146387, 0.69495144, 0.2455884, 0.77066559, 0.63164333, 0.81027586,
                0.48230579
            ],
            [
                0.00178706, 0.45821981, 0.65619095, 0.28412483, 0.03629474, 0.45011836, 0.35812909,
                0.02914437, 0.69193079, 0.10555214, 0.27197846, 0.08190992, 0.74310325, 0.79646136,
                0.66244077
            ],
            [
                0.15210662, 0.20802912, 0.50446085, 0.86376217, 0.95377633, 0.60208729, 0.83035149,
                0.95887528, 0.73197966, 0.43450554, 0.65447566, 0.1375018, 0.45277232, 0.91661334,
                0.76142713
            ],
            [
                0.42497007, 0.14067934, 0.44368562, 0.79865278, 0.64449096, 0.92738415, 0.89581372,
                0.12830848, 0.04963118, 0.81917153, 0.42274445, 0.05446685, 0.04101894, 0.09930792,
                0.52868895
            ],
            [
                0.25766372, 0.46413783, 0.83290284, 0.2857464, 0.93483082, 0.75272588, 0.66271508,
                0.97417882, 0.86544561, 0.03159403, 0.08091403, 0.14496518, 0.93542052, 0.99598936,
                0.79414079
            ],
            [
                0.74232757, 0.02799125, 0.03848875, 0.80547294, 0.99117134, 0.64981678, 0.32092867,
                0.39836622, 0.14606106, 0.51995739, 0.48990741, 0.53609649, 0.44993455, 0.03084684,
                0.40801702
            ],
            [
                0.57139093, 0.73604949, 0.66188473, 0.93578261, 0.87069364, 0.21162366, 0.21231654,
                0.5704002, 0.72954617, 0.39067076, 0.23692592, 0.02214847, 0.41872549, 0.48079551,
                0.39574632
            ]
        ],
        [
            [
                0.62385207, 0.27060798, 0.93228407, 0.65184226, 0.71227602, 0.09648224, 0.52886577,
                0.38637865, 0.59184713, 0.01740899, 0.73943389, 0.56132905, 0.19255764, 0.89828088,
                0.18568947
            ],
            [
                0.64582922, 0.90009913, 0.14083895, 0.19123401, 0.29393503, 0.97096816, 0.82107479,
                0.37299707, 0.69329291, 0.78315556, 0.71168383, 0.90605891, 0.39581179, 0.97290847,
                0.37787062
            ],
            [
                0.31105782, 0.51860092, 0.82105915, 0.47715544, 0.86727587, 0.86623363, 0.29922553,
                0.03071198, 0.03382622, 0.45532397, 0.62365896, 0.149902, 0.42382213, 0.65666048,
                0.45536264
            ],
            [
                0.42575221, 0.97928354, 0.01637395, 0.56597986, 0.72018579, 0.13000993, 0.38580756,
                0.46124812, 0.73456862, 0.45498174, 0.01468375, 0.3311825, 0.68482728, 0.04436485,
                0.59042015
            ],
            [
                0.97141219, 0.54361908, 0.94970683, 0.91654963, 0.82998192, 0.68421301, 0.89789514,
                0.18899626, 0.59009004, 0.99886152, 0.02270102, 0.86184339, 0.74995397, 0.42788859,
                0.6528449
            ],
            [
                0.2109633, 0.62540177, 0.80175091, 0.2595119, 0.02546183, 0.02745248, 0.64143605,
                0.73727669, 0.22952433, 0.69794111, 0.67568086, 0.70173411, 0.91833401, 0.03686747,
                0.21967117
            ],
            [
                0.65583056, 0.16345957, 0.50405574, 0.52543861, 0.2864706, 0.85770921, 0.17987564,
                0.12798377, 0.37675844, 0.04420354, 0.97041538, 0.40747899, 0.07644754, 0.14767134,
                0.62435315
            ],
            [
                0.67701851, 0.19173194, 0.46982294, 0.02457761, 0.72695231, 0.23975594, 0.19219192,
                0.33087449, 0.39658298, 0.86232313, 0.48967764, 0.19221618, 0.08402258, 0.73316128,
                0.19351118
            ],
            [
                0.31468205, 0.77017715, 0.68409839, 0.40743571, 0.94743479, 0.16978115, 0.98625355,
                0.68625983, 0.11779779, 0.59068389, 0.22131853, 0.04202804, 0.6265308, 0.98268984,
                0.6135814
            ],
            [
                0.59731365, 0.48969689, 0.51994119, 0.21510182, 0.66191621, 0.87151363, 0.57183193,
                0.28850291, 0.50771167, 0.90177902, 0.08790162, 0.49242653, 0.97057748, 0.63548346,
                0.45100801
            ]
        ]
    ];

    let kernel29: Array4<f32> = Array::from_shape_vec(
        (3, 2, 5, 5),
        vec![
            0.03424489, 0.78716157, 0.08637598, 0.78139438, 0.56886003, 0.40288509, 0.55354594,
            0.38486881, 0.64877658, 0.70381685, 0.52164921, 0.79412487, 0.47117358, 0.61789879,
            0.69248389, 0.95235469, 0.99155946, 0.70862474, 0.3368942, 0.1660726, 0.68587414,
            0.47262584, 0.45400558, 0.46214448, 0.33963646, 0.79271979, 0.74960237, 0.53057699,
            0.51949296, 0.91085593, 0.0421344, 0.1856097, 0.16283799, 0.59682315, 0.94973904,
            0.45783094, 0.93284742, 0.55421731, 0.4387137, 0.05644235, 0.44071786, 0.14814438,
            0.55691821, 0.20264524, 0.04074387, 0.6096802, 0.48095221, 0.47096237, 0.00810335,
            0.22991579, 0.21848392, 0.73244206, 0.72079857, 0.68204967, 0.73275174, 0.33685236,
            0.93032443, 0.38904786, 0.70664368, 0.66565032, 0.84123703, 0.41910259, 0.59142588,
            0.9108226, 0.53551847, 0.4931909, 0.54357492, 0.68504052, 0.36235321, 0.7924024,
            0.75572897, 0.39252733, 0.03436404, 0.22152406, 0.73895642, 0.649227, 0.38674412,
            0.33436301, 0.55308978, 0.52526342, 0.77226716, 0.55382131, 0.68355748, 0.38821791,
            0.81708771, 0.00781578, 0.97707476, 0.99407461, 0.74518463, 0.52904606, 0.30411442,
            0.59167517, 0.80317616, 0.43357349, 0.64922996, 0.6601235, 0.90748503, 0.53241574,
            0.69454863, 0.67047438, 0.71958782, 0.90204449, 0.95180837, 0.787326, 0.96140549,
            0.327034, 0.41490154, 0.72119238, 0.09215528, 0.57506337, 0.42119924, 0.03004104,
            0.17358405, 0.00080285, 0.28787527, 0.64472922, 0.90600003, 0.16794387, 0.54675949,
            0.75012407, 0.85762239, 0.77786934, 0.33486333, 0.88640977, 0.47692632, 0.74142269,
            0.04009474, 0.54252204, 0.35029163, 0.63763181, 0.29794612, 0.03641145, 0.16722608,
            0.12909189, 0.15894171, 0.59547029, 0.85711458, 0.24522811, 0.97477299, 0.85072468,
            0.67588324, 0.83975344, 0.863551, 0.1023455, 0.51589403, 0.85847047, 0.86474273,
            0.81499612, 0.38785053, 0.76636767,
        ],
    )
    .unwrap();
    let conv_layer29 = ConvolutionLayer::new(kernel29, 1, Padding::Valid);
    let target_output29 = array![
        [
            [
                13.70506668,
                13.84468555,
                15.48651028,
                13.94455051,
                13.44385529,
                11.29493332,
                11.32633591,
                12.81345081,
                12.20384216,
                12.46436882,
                11.67661476
            ],
            [
                13.565938,
                14.2677803,
                13.43238258,
                12.10114193,
                12.5248394,
                12.96334171,
                13.05064964,
                13.58824539,
                12.2257185,
                12.65222168,
                12.39527035
            ],
            [
                12.85080814,
                14.06199455,
                13.96963882,
                13.22840214,
                13.00632668,
                12.96949387,
                10.92540741,
                10.65559864,
                10.9493494,
                11.48801041,
                11.54749393
            ],
            [
                12.44787884,
                12.64995766,
                13.63054752,
                12.21863937,
                13.65407658,
                13.20324135,
                10.99137783,
                10.96030998,
                12.58988285,
                11.55628872,
                11.55522251
            ],
            [
                12.5962429,
                12.7284584,
                15.55065823,
                14.19678783,
                14.3926878,
                13.83263493,
                11.77119637,
                11.54753876,
                10.89222336,
                10.82875633,
                10.22130871
            ],
            [
                12.00700378,
                13.21703053,
                14.00274181,
                14.07619381,
                13.64338779,
                11.87340927,
                12.21778584,
                11.52595139,
                10.36068726,
                10.65454197,
                10.74419975
            ]
        ],
        [
            [
                17.03962326,
                17.48665237,
                17.37709808,
                15.95158863,
                16.02030945,
                14.47668934,
                13.82262993,
                15.23371792,
                16.17454338,
                14.85055923,
                14.87367916
            ],
            [
                16.37674522,
                15.9958601,
                16.73561096,
                15.2334404,
                14.84757328,
                15.74085712,
                15.2557869,
                14.90065861,
                15.21627522,
                15.548069,
                15.20866585
            ],
            [
                15.53806114,
                16.51923752,
                16.96100616,
                14.22821522,
                14.6811924,
                14.92087364,
                13.63359356,
                13.02713585,
                13.6000433,
                13.18159676,
                14.65723801
            ],
            [
                15.06544781,
                16.28752518,
                15.17590046,
                14.43299103,
                15.95420837,
                14.747262,
                13.50908852,
                13.99804783,
                14.78710651,
                14.284935,
                13.64171505
            ],
            [
                15.60314083,
                15.13697433,
                16.47322464,
                16.71011353,
                15.22783756,
                14.47972298,
                14.79239845,
                12.51935387,
                12.50512409,
                13.89192963,
                13.01102638
            ],
            [
                14.86846638,
                15.79642487,
                17.15662384,
                17.09169006,
                16.03264427,
                15.39698315,
                13.97282028,
                12.43833065,
                13.49090195,
                12.78045273,
                13.03244972
            ]
        ],
        [
            [
                15.21291924,
                14.96238136,
                16.50603104,
                13.34389877,
                14.56354237,
                12.23529911,
                12.22832775,
                12.46904469,
                14.08002281,
                13.10652256,
                13.84186172
            ],
            [
                14.59979057,
                14.68945122,
                15.07293987,
                14.38578796,
                15.28815746,
                14.81048393,
                14.47685432,
                14.46409321,
                14.74083138,
                13.9449501,
                13.24780464
            ],
            [
                15.24415588,
                15.96827602,
                16.24076462,
                14.83703136,
                13.65958881,
                13.87731934,
                14.0478096,
                11.74308491,
                12.91788101,
                12.42044353,
                12.62425423
            ],
            [
                12.11508083,
                13.80171585,
                13.46140957,
                13.00299549,
                13.8428812,
                12.91055679,
                12.63362789,
                11.35057068,
                13.20622349,
                13.09715462,
                11.85405731
            ],
            [
                13.86870003,
                13.58120346,
                15.16377068,
                13.7701292,
                14.49636269,
                12.6477623,
                12.29016399,
                11.46233368,
                11.13360596,
                12.67688656,
                11.78415012
            ],
            [
                14.47458458,
                14.22085571,
                15.33731747,
                15.56132984,
                15.38234901,
                14.50277042,
                13.31567574,
                12.38056374,
                12.33764839,
                11.8227644,
                11.58813763
            ]
        ]
    ];
    let current_output29 = conv_layer29.convolve(&test_input29);

    assert!(
        arr_allclose(&current_output29, &target_output29),
        "{:?} was not equal to {:?}",
        current_output29,
        target_output29
    );

    let test_input30 = array![
        [
            [
                0.94109128, 0.08583226, 0.84066054, 0.71259858, 0.20553346, 0.24283216, 0.57682237,
                0.47941734, 0.926685, 0.39005476, 0.54092983, 0.88133336, 0.0324995, 0.59161954,
                0.22166132
            ],
            [
                0.7692697, 0.01657799, 0.10074908, 0.56219357, 0.00591142, 0.45705856, 0.40678144,
                0.62936534, 0.42606649, 0.48859269, 0.92328418, 0.25023912, 0.80427088, 0.03818879,
                0.36219997
            ],
            [
                0.17138261, 0.42277343, 0.94081557, 0.74456281, 0.21179068, 0.71635485, 0.83644695,
                0.19754058, 0.82449115, 0.42324458, 0.26319243, 0.79482712, 0.72855155, 0.42772555,
                0.89472645
            ],
            [
                0.97494472, 0.95646164, 0.65030685, 0.15980155, 0.62844395, 0.65289095, 0.60285438,
                0.13638273, 0.39407017, 0.06674533, 0.83398768, 0.71127338, 0.99888978, 0.45113886,
                0.37628286
            ],
            [
                0.12467484, 0.23401077, 0.5302998, 0.03754441, 0.89399736, 0.16035181, 0.69940187,
                0.78323723, 0.22348203, 0.95586166, 0.08868469, 0.38749497, 0.1495293, 0.13567366,
                0.07900955
            ],
            [
                0.48383069, 0.85511381, 0.88709895, 0.36363719, 0.20012485, 0.18496908, 0.26352007,
                0.21221249, 0.04832328, 0.45603733, 0.48977067, 0.97272791, 0.2223024, 0.75809141,
                0.99529114
            ],
            [
                0.78135292, 0.34888557, 0.42161967, 0.88537117, 0.24929681, 0.24824438, 0.75166474,
                0.51153193, 0.57408338, 0.31640234, 0.70006971, 0.92716256, 0.38665441, 0.90997947,
                0.52299017
            ],
            [
                0.48876185, 0.43697715, 0.46684209, 0.8870456, 0.13939073, 0.15193757, 0.10377176,
                0.03825287, 0.83194524, 0.71169677, 0.12412303, 0.22000751, 0.65762941, 0.80387026,
                0.92468382
            ],
            [
                0.2840905, 0.03209783, 0.19625776, 0.11980431, 0.30807668, 0.13390501, 0.05043373,
                0.12723272, 0.98241477, 0.44856634, 0.2624294, 0.00958934, 0.0995127, 0.08031525,
                0.38621364
            ],
            [
                0.66721712, 0.17361916, 0.21235857, 0.99523524, 0.65810089, 0.60438163, 0.38974791,
                0.85241152, 0.36282186, 0.0062347, 0.98641159, 0.53632268, 0.25642252, 0.35544557,
                0.87673139
            ]
        ],
        [
            [
                0.79783882, 0.99685939, 0.93126133, 0.68729692, 0.01807762, 0.53289114, 0.29115056,
                0.09607173, 0.9291924, 0.79556409, 0.68579101, 0.24262013, 0.77050707, 0.86541871,
                0.17621124
            ],
            [
                0.69040029, 0.3497612, 0.21581873, 0.55326157, 0.95970744, 0.55223053, 0.1605104,
                0.01258456, 0.97428217, 0.09648368, 0.16584114, 0.13684596, 0.98106206, 0.68078684,
                0.0038069
            ],
            [
                0.82000684, 0.77186105, 0.00677892, 0.48767112, 0.70951276, 0.43624929, 0.90160043,
                0.78814267, 0.20579425, 0.11782064, 0.05957514, 0.83045637, 0.02350398, 0.76849564,
                0.91710154
            ],
            [
                0.85411554, 0.02124477, 0.11364035, 0.54948291, 0.02591292, 0.42192397, 0.86921203,
                0.48664332, 0.96356675, 0.5469399, 0.37939195, 0.21657681, 0.38010216, 0.95164127,
                0.97265728
            ],
            [
                0.8991906, 0.62887538, 0.94870439, 0.30023638, 0.71587542, 0.308687, 0.1237447,
                0.70287865, 0.56422577, 0.49097719, 0.00513179, 0.96346223, 0.72805624, 0.97035195,
                0.34751764
            ],
            [
                0.95301348, 0.07550302, 0.14497681, 0.54578071, 0.43179563, 0.24281646, 0.7374898,
                0.53038147, 0.89710973, 0.02905989, 0.84309702, 0.25471458, 0.88964962, 0.04810897,
                0.92559078
            ],
            [
                0.80966904, 0.03910594, 0.50459674, 0.14540059, 0.90726247, 0.52693001, 0.8414026,
                0.11982161, 0.10823907, 0.26861846, 0.60190607, 0.69637885, 0.25325528, 0.13881885,
                0.0617022
            ],
            [
                0.97593206, 0.52187018, 0.79595085, 0.7466225, 0.85052256, 0.91569148, 0.42966274,
                0.338509, 0.59587628, 0.01035187, 0.3031956, 0.81942144, 0.88566147, 0.05187115,
                0.51230317
            ],
            [
                0.23396359, 0.25060338, 0.22599821, 0.35538376, 0.73213949, 0.68476429, 0.43052002,
                0.84957286, 0.67671155, 0.25629111, 0.93865448, 0.7209084, 0.43928609, 0.65920982,
                0.19666668
            ],
            [
                0.69094858, 0.61787501, 0.46187317, 0.15833754, 0.88865151, 0.68419674, 0.06233076,
                0.41375994, 0.10668166, 0.36822248, 0.15206665, 0.46758505, 0.04919559, 0.69296478,
                0.85146294
            ]
        ]
    ];

    let kernel30: Array4<f32> = Array::from_shape_vec(
        (3, 2, 5, 5),
        vec![
            0.93492837, 0.84714531, 0.49949895, 0.96548997, 0.10857984, 0.04954484, 0.86486349,
            0.32165972, 0.59677982, 0.24502176, 0.40264117, 0.71358093, 0.95630357, 0.99361945,
            0.27493002, 0.80910063, 0.0388213, 0.42418939, 0.21886946, 0.60990226, 0.74957039,
            0.0567609, 0.6618832, 0.31648433, 0.07057994, 0.79375072, 0.35538703, 0.16586034,
            0.53550745, 0.91076663, 0.08248742, 0.7804362, 0.07774146, 0.28810685, 0.59082873,
            0.07081332, 0.24666146, 0.52224765, 0.15884496, 0.72800059, 0.17179801, 0.16601219,
            0.21720299, 0.75876251, 0.40750048, 0.27971972, 0.32153467, 0.24065089, 0.1429008,
            0.90698327, 0.4561631, 0.1254066, 0.1332323, 0.0730514, 0.16514674, 0.60105509,
            0.20042138, 0.79326256, 0.81028929, 0.61555564, 0.21495369, 0.6555247, 0.59598464,
            0.20266143, 0.51127623, 0.85234586, 0.59933768, 0.74778622, 0.39690518, 0.5696813,
            0.87416848, 0.90118777, 0.69164119, 0.62494179, 0.64547081, 0.32460627, 0.70959913,
            0.92651145, 0.94145868, 0.66309574, 0.21866481, 0.0734322, 0.37875827, 0.26569541,
            0.80689548, 0.47265751, 0.69838281, 0.07320249, 0.12168032, 0.64268041, 0.91290434,
            0.84286947, 0.43912457, 0.86054597, 0.60123306, 0.09201861, 0.14726785, 0.7902299,
            0.24951272, 0.51773988, 0.33639954, 0.39910503, 0.26826427, 0.1295481, 0.04226355,
            0.36311297, 0.33253833, 0.03372583, 0.61510392, 0.16333707, 0.35070628, 0.63254868,
            0.45462115, 0.80232839, 0.83204209, 0.97930786, 0.34594544, 0.48682921, 0.87573602,
            0.59496605, 0.21009445, 0.00543618, 0.68560296, 0.04975929, 0.45436792, 0.49572425,
            0.80676099, 0.26881901, 0.41149921, 0.78489711, 0.67779648, 0.17057473, 0.70026565,
            0.86850825, 0.75086758, 0.9457111, 0.24649319, 0.96657243, 0.85440517, 0.35102446,
            0.07823556, 0.71804871, 0.8317649, 0.67942085, 0.55172745, 0.10098601, 0.03686264,
            0.8578678, 0.12133782, 0.2815227,
        ],
    )
    .unwrap();
    let conv_layer30 = ConvolutionLayer::new(kernel30, 1, Padding::Valid);
    let target_output30 = array![
        [
            [
                12.04812336,
                10.2302599,
                12.12365246,
                10.29754162,
                11.66274834,
                11.5609684,
                10.63355637,
                11.74158955,
                11.88802814,
                12.83214951,
                11.25830173
            ],
            [
                11.66422176,
                9.28717041,
                11.00504971,
                9.89499664,
                12.01281071,
                10.19305897,
                9.19553947,
                10.35475731,
                11.2681284,
                12.43858624,
                12.26270103
            ],
            [
                11.64479446,
                10.52346325,
                11.45567608,
                11.73827457,
                10.79444218,
                11.1865406,
                10.38133907,
                11.60598087,
                10.08991337,
                11.66824818,
                11.2241354
            ],
            [
                12.09945011,
                11.58978081,
                9.99473667,
                11.24978352,
                9.77693653,
                8.69826603,
                10.49514198,
                10.09860992,
                12.4966116,
                10.78276443,
                12.95849895
            ],
            [
                10.97500992,
                10.42280865,
                9.90014076,
                9.97767639,
                10.65742588,
                9.18100452,
                10.43690968,
                10.84919071,
                12.34321976,
                11.84298038,
                10.18007851
            ],
            [
                12.0626173,
                10.80487442,
                9.70171165,
                9.64715862,
                9.30792332,
                8.89755821,
                9.21092415,
                10.14970684,
                11.06264877,
                9.55342579,
                12.94122601
            ]
        ],
        [
            [
                14.19288349,
                11.10563469,
                11.75078487,
                11.54575253,
                12.58518887,
                13.19298744,
                13.6242609,
                13.16601562,
                13.17013073,
                13.14949322,
                13.61196613
            ],
            [
                13.29476452,
                12.38734818,
                13.21567726,
                11.44080925,
                12.12137508,
                10.98598003,
                11.20916557,
                11.48808861,
                12.54843616,
                13.56133556,
                14.3524847
            ],
            [
                13.25650883,
                11.44148159,
                13.46717834,
                13.09535599,
                12.38539028,
                11.41616631,
                11.40335751,
                12.38865662,
                12.67650032,
                13.15675068,
                14.32518482
            ],
            [
                12.86727333,
                11.07420444,
                12.27199268,
                11.63637352,
                12.05707359,
                11.55188274,
                12.03802681,
                12.18345642,
                11.95960999,
                12.93000984,
                13.43418121
            ],
            [
                12.7150259,
                11.64824009,
                11.87048721,
                10.46500492,
                11.41802692,
                10.59285736,
                11.1214838,
                11.66294765,
                12.99162769,
                12.40305138,
                12.81112003
            ],
            [
                11.9857893,
                11.20655155,
                12.22307205,
                12.23626804,
                12.73327827,
                10.80692291,
                11.91337299,
                13.58922672,
                12.19438362,
                11.26646805,
                13.13010979
            ]
        ],
        [
            [
                12.75144768,
                11.99867725,
                12.86402988,
                10.10560513,
                12.7016077,
                12.78256702,
                10.74759197,
                11.42397118,
                11.69529724,
                12.89970112,
                11.98171043
            ],
            [
                11.87024593,
                10.78175735,
                10.67286968,
                11.50550938,
                12.33818626,
                10.89250755,
                11.27554035,
                10.96170712,
                11.84627533,
                12.18277931,
                12.02285671
            ],
            [
                11.96254635,
                10.68428421,
                12.08757401,
                11.49952221,
                11.76368237,
                11.4483242,
                11.37011242,
                11.06453514,
                10.80148029,
                12.36196327,
                12.63201141
            ],
            [
                12.17701626,
                10.78513145,
                10.63208485,
                11.29041481,
                11.21053123,
                10.36414242,
                11.18437195,
                11.14037037,
                12.74979591,
                12.78678036,
                14.07926559
            ],
            [
                12.45150471,
                10.70084858,
                11.60169792,
                11.3779211,
                11.43770027,
                9.69209576,
                11.12264538,
                10.57064056,
                12.90019512,
                11.70266533,
                12.67951012
            ],
            [
                11.99226761,
                10.2834816,
                12.0901022,
                11.05751514,
                10.50783825,
                10.63561153,
                10.39525127,
                10.04048157,
                11.84521103,
                10.79479599,
                11.24074459
            ]
        ]
    ];
    let current_output30 = conv_layer30.convolve(&test_input30);

    assert!(
        arr_allclose(&current_output30, &target_output30),
        "{:?} was not equal to {:?}",
        current_output30,
        target_output30
    );
}

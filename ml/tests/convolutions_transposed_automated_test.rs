use ml::convolutions::*;
use ml::transposed_convolutions::*;
use ndarray::{array, Array, Array4, Dimension};
// Template test file for testing the Rust implementation against the Python
// one. This file has been automatically generated by Jinja2 via the
// script generate_tests.py.
// Please do not change this file by hand.

fn arr_allclose<D: Dimension>(arr1: &Array<f32, D>, arr2: &Array<f32, D>) -> bool {
    (arr1 - arr2).map(|x| (*x as f32).abs()).sum() < 1e-9
}

#[test]
fn test_py_implementation_random_arrays_conv2d_transpose() {
    let test_input1 = array![[
        [0.25940374, 0.74904203, 0.26350107, 0.99580124, 0.41392357],
        [0.71904923, 0.5932102, 0.36214926, 0.71343461, 0.04343178],
        [0.01264012, 0.30633782, 0.7311494, 0.06306979, 0.63444037],
        [0.04783731, 0.13794519, 0.38289404, 0.72769855, 0.43036366],
        [0.43202258, 0.61760359, 0.55465346, 0.26971524, 0.37383645]
    ]];

    let kernel1: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.51039219, 0.99000951, 0.45440432, 0.5617109, 0.93941316, 0.03544521, 0.83329134,
            0.06244483, 0.5651197, 0.60774669, 0.56883523, 0.7743095, 0.51972487, 0.54574215,
            0.69407843, 0.38157288, 0.74213763, 0.48221947, 0.37698739, 0.38870603, 0.69717123,
            0.35903164, 0.87240737, 0.26511827, 0.19452758, 0.39895927, 0.76077819,
        ],
    )
    .unwrap();
    let conv_layer1 = TransposedConvolutionLayer::new(kernel1, 1, Padding::Same);
    let target_output1 = array![
        [
            [1.69191366, 2.09795521, 2.34203443, 2.08639842, 1.06992287],
            [1.77578312, 1.80936086, 2.66684596, 2.07661763, 1.07169678],
            [0.70747266, 1.91712335, 2.14211521, 1.93016095, 1.85278028],
            [0.87904715, 1.85188843, 2.28028979, 2.6417915, 0.94259954],
            [1.08165962, 1.36218672, 1.24883224, 1.09584444, 0.79452033]
        ],
        [
            [1.30187835, 1.55395657, 2.11430116, 1.50983065, 1.25971699],
            [1.68263641, 2.52077953, 2.89407907, 2.51890068, 1.67445955],
            [1.24825681, 1.9540048, 2.44596896, 2.4272271, 1.26856517],
            [0.95042785, 1.93636255, 2.11715545, 2.39272123, 1.54289305],
            [0.72710272, 1.38847031, 1.81021042, 1.79442903, 1.05380069]
        ],
        [
            [0.99925707, 1.34876761, 1.43016612, 1.47773197, 0.9127702],
            [1.56889515, 1.91287863, 2.50975592, 1.94086598, 1.4298971],
            [0.80348357, 1.71646291, 2.26793029, 1.5862633, 1.42900439],
            [0.70021333, 1.40370806, 1.56375987, 2.31583403, 1.06864454],
            [0.72581988, 1.26666656, 1.54891078, 1.38615898, 1.10145754]
        ]
    ];
    let current_output1 = conv_layer1.transposed_convolve(&test_input1);

    assert!(
        arr_allclose(&current_output1, &target_output1),
        "{:?} was not equal to {:?}",
        current_output1,
        target_output1
    );

    let test_input2 = array![[
        [0.86497578, 0.25645738, 0.93321523, 0.78417597, 0.86321055],
        [0.95577991, 0.71984723, 0.54026544, 0.15434536, 0.09155878],
        [0.71520297, 0.50214098, 0.49909649, 0.60980338, 0.90022467],
        [0.95214696, 0.250633, 0.79348303, 0.31241128, 0.16839387],
        [0.84959728, 0.77755684, 0.67304164, 0.62291602, 0.59172674]
    ]];

    let kernel2: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.59189187, 0.67114293, 0.49211782, 0.545842, 0.86454816, 0.70317149, 0.05703689,
            0.75967349, 0.95099478, 0.70248219, 0.53076038, 0.62345115, 0.21467632, 0.81357253,
            0.51520825, 0.88604479, 0.2597569, 0.77339247, 0.71107548, 0.73335917, 0.26292254,
            0.2678165, 0.71665682, 0.34538904, 0.97129183, 0.68370079, 0.3037366,
        ],
    )
    .unwrap();
    let conv_layer2 = TransposedConvolutionLayer::new(kernel2, 1, Padding::Same);
    let target_output2 = array![
        [
            [1.86770932, 2.27235602, 1.95524072, 2.13549055, 1.40078479],
            [2.73147268, 3.78348514, 3.06553514, 3.36316653, 2.07530308],
            [2.64973204, 3.65417254, 2.99497306, 2.49336873, 1.56243762],
            [2.66538578, 3.62265485, 2.99507788, 3.06099026, 1.95436583],
            [2.04923309, 3.2415709, 2.54068037, 2.50411254, 1.4003003]
        ],
        [
            [1.55070112, 2.3095686, 2.10428834, 1.91470318, 1.06239192],
            [2.27147621, 3.5956847, 2.85692822, 3.18395376, 1.899361],
            [2.17006992, 3.7609585, 2.40332311, 2.54642879, 1.37030065],
            [2.31781376, 3.3878903, 3.17317217, 2.95682588, 1.83253335],
            [1.75071677, 2.57072086, 1.87758293, 1.8752957, 0.9715938]
        ],
        [
            [1.57580551, 2.9648562, 2.37284275, 2.46426528, 1.32920281],
            [2.12765764, 3.34627293, 2.6539389, 2.61660439, 1.54086074],
            [1.83340439, 3.45200777, 2.2721202, 2.65403412, 1.48912013],
            [2.02565184, 3.44643341, 2.83278135, 2.73010188, 1.59393122],
            [1.57385632, 2.21608535, 1.90310401, 1.73371216, 1.00300531]
        ]
    ];
    let current_output2 = conv_layer2.transposed_convolve(&test_input2);

    assert!(
        arr_allclose(&current_output2, &target_output2),
        "{:?} was not equal to {:?}",
        current_output2,
        target_output2
    );

    let test_input3 = array![[
        [0.00554333, 0.00499232, 0.56012624, 0.04692093, 0.95133614],
        [0.43184582, 0.58763006, 0.0488642, 0.02556094, 0.17130234],
        [0.1298894, 0.59459813, 0.00256654, 0.80149844, 0.89082568],
        [0.2149228, 0.42144233, 0.49002213, 0.61149438, 0.47333991],
        [0.30657022, 0.46667864, 0.91321123, 0.40754156, 0.63535143]
    ]];

    let kernel3: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.50684425, 0.68285409, 0.12924373, 0.77956712, 0.07048018, 0.35233786, 0.85458856,
            0.80509476, 0.80089063, 0.90569775, 0.79006946, 0.62275162, 0.52764612, 0.71930771,
            0.04703298, 0.05200182, 0.56203679, 0.48269879, 0.14007695, 0.99515513, 0.92304645,
            0.1113743, 0.17853651, 0.89363664, 0.76292199, 0.53197617, 0.24232654,
        ],
    )
    .unwrap();
    let conv_layer3 = TransposedConvolutionLayer::new(kernel3, 1, Padding::Same);
    let target_output3 = array![
        [
            [0.63828944, 1.23921337, 0.62876751, 1.25239433, 0.26021189],
            [0.83692666, 1.07688357, 1.61778487, 1.82472749, 1.78483248],
            [1.0244339, 1.46803226, 2.56944027, 1.87251857, 1.6804719],
            [0.9010699, 1.9398631, 2.68938808, 2.58057206, 2.32503565],
            [0.47047476, 1.28725174, 1.30758962, 1.86688047, 1.02940495]
        ],
        [
            [0.76800864, 0.82601889, 0.52227111, 1.27136007, 0.80239094],
            [1.38533011, 1.37855266, 1.20177706, 2.27607544, 0.71669822],
            [1.44456539, 1.44660982, 2.10543939, 2.19008593, 1.39319927],
            [1.44839076, 1.992631, 2.73396277, 2.52089608, 1.46937352],
            [0.86178922, 1.65821633, 1.84844261, 1.86844455, 1.00349672]
        ],
        [
            [0.13636777, 0.96300903, 0.60669099, 1.31719986, 0.23338873],
            [0.76920101, 1.07177766, 1.45802491, 1.47283024, 1.61639642],
            [1.62620169, 1.13223701, 1.78580444, 1.73203253, 1.26393952],
            [1.22220264, 1.65620905, 2.32125147, 3.21114126, 1.78179194],
            [1.10022535, 2.03620506, 1.92133664, 2.29295476, 0.90141102]
        ]
    ];
    let current_output3 = conv_layer3.transposed_convolve(&test_input3);

    assert!(
        arr_allclose(&current_output3, &target_output3),
        "{:?} was not equal to {:?}",
        current_output3,
        target_output3
    );

    let test_input4 = array![[
        [0.92368241, 0.53568405, 0.99749255, 0.00387712, 0.275297],
        [0.75773142, 0.68179756, 0.28086394, 0.14250895, 0.69858032],
        [0.00022103, 0.21589487, 0.17350982, 0.54028481, 0.96104162],
        [0.96504942, 0.0072373, 0.43020759, 0.86417538, 0.04885763],
        [0.94388, 0.69476511, 0.87142102, 0.62799608, 0.5023904]
    ]];

    let kernel4: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.72670178, 0.44753028, 0.65127281, 0.07885906, 0.75618975, 0.82717828, 0.55565932,
            0.93769235, 0.99851009, 0.55887702, 0.57329576, 0.81170392, 0.4081002, 0.08493485,
            0.25913426, 0.60352615, 0.00626469, 0.86184285, 0.84487355, 0.59569605, 0.15069862,
            0.70818421, 0.4961406, 0.58283608, 0.02291553, 0.34156243, 0.64322952, 0.79177324,
            0.76275867, 0.09121816, 0.9557012, 0.40404551, 0.52204476, 0.53803065, 0.81690542,
            0.17207692, 0.42866696, 0.44563662, 0.42125652, 0.92374999, 0.10720393, 0.26198116,
            0.67622769, 0.26961788, 0.21424311, 0.24767296, 0.40937589, 0.68684913, 0.37738029,
            0.08832247,
        ],
    )
    .unwrap();
    let conv_layer4 = TransposedConvolutionLayer::new(kernel4, 1, Padding::Same);
    let target_output4 = array![
        [
            [2.95329758, 3.39060897, 4.0457495, 3.61557663, 2.28060813],
            [2.89313801, 5.19355658, 4.78742872, 4.64684415, 2.67602861],
            [5.1048235, 5.62496597, 6.9179311, 5.62660067, 2.53195741],
            [3.2420532, 4.26317626, 5.37340179, 3.94743794, 2.91859901],
            [1.97924726, 4.1984116, 5.01288119, 3.09839156, 2.73847645]
        ],
        [
            [2.52765075, 2.47060758, 3.67499376, 2.96746245, 1.52847045],
            [2.87300494, 3.41129193, 4.98335651, 2.70432296, 1.92618568],
            [4.34967235, 5.12765987, 5.80207905, 3.62604831, 2.48779902],
            [3.55145271, 4.49683303, 4.67583392, 3.38704109, 2.95490625],
            [2.40426274, 3.44441244, 4.01724936, 3.4580653, 2.68185657]
        ]
    ];
    let current_output4 = conv_layer4.transposed_convolve(&test_input4);

    assert!(
        arr_allclose(&current_output4, &target_output4),
        "{:?} was not equal to {:?}",
        current_output4,
        target_output4
    );

    let test_input5 = array![[
        [0.38654814, 0.82660555, 0.44084537, 0.07873131, 0.30274439],
        [0.2361903, 0.61979492, 0.0840907, 0.72342789, 0.58261941],
        [0.07743666, 0.73132286, 0.84478535, 0.15313673, 0.47405228],
        [0.40235711, 0.14101507, 0.92657284, 0.7040261, 0.44487728],
        [0.95989797, 0.86412975, 0.5500817, 0.01467922, 0.02434787]
    ]];

    let kernel5: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.19218098, 0.23284889, 0.01929748, 0.85564087, 0.30623956, 0.32625732, 0.86521466,
            0.50525042, 0.83446757, 0.66017742, 0.78154071, 0.73509839, 0.49155769, 0.84649227,
            0.77338033, 0.57997582, 0.54078518, 0.28085809, 0.84826087, 0.22946075, 0.2641176,
            0.49239955, 0.40529283, 0.85380271, 0.16085505, 0.81784101, 0.52609934, 0.78290052,
            0.39820364, 0.39185107, 0.52169504, 0.07266373, 0.8044589, 0.6743304, 0.37191734,
            0.8807143, 0.08070045, 0.54589866, 0.0505761, 0.30998018, 0.28781089, 0.64759287,
            0.44109603, 0.87691706, 0.61349725, 0.10794181, 0.8929152, 0.58464706, 0.19428867,
            0.84529757,
        ],
    )
    .unwrap();
    let conv_layer5 = TransposedConvolutionLayer::new(kernel5, 1, Padding::Same);
    let target_output5 = array![
        [
            [1.80709092, 2.48520781, 3.17192166, 2.9944942, 1.89293745],
            [3.24998389, 4.01751113, 4.94191314, 4.93345892, 3.07109651],
            [3.96398588, 5.96953659, 6.23912972, 5.08203402, 3.45699716],
            [3.88451234, 4.62904761, 5.22136788, 4.57238555, 2.9712166],
            [2.97153815, 3.99680161, 4.20552838, 3.14067441, 2.54157828]
        ],
        [
            [2.47008889, 2.86004208, 3.54020584, 2.37710865, 1.60109173],
            [3.13542036, 3.33623359, 4.99402365, 4.3993078, 2.44251971],
            [4.63162282, 4.55026044, 5.43019476, 4.08728562, 3.41943647],
            [2.6582982, 3.67739673, 5.28731735, 4.59088392, 2.61566577],
            [2.76125374, 3.26267262, 3.19281813, 3.31121287, 2.1162561]
        ]
    ];
    let current_output5 = conv_layer5.transposed_convolve(&test_input5);

    assert!(
        arr_allclose(&current_output5, &target_output5),
        "{:?} was not equal to {:?}",
        current_output5,
        target_output5
    );

    let test_input6 = array![[
        [0.01543552, 0.14992482, 0.81716457, 0.69931854, 0.48973524],
        [0.09253297, 0.89185411, 0.33026116, 0.29813164, 0.26543642],
        [0.74838343, 0.10143464, 0.52032985, 0.56595637, 0.00287411],
        [0.2319383, 0.1188672, 0.66865083, 0.65016285, 0.09753594],
        [0.9598696, 0.1739428, 0.42068345, 0.3657551, 0.63471812]
    ]];

    let kernel6: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.0686802, 0.7894763, 0.54168904, 0.4229552, 0.9833499, 0.71969432, 0.9904965,
            0.78023085, 0.14502142, 0.73803948, 0.182635, 0.5330444, 0.05136959, 0.66815121,
            0.75630659, 0.75689568, 0.16207213, 0.86851645, 0.42064583, 0.55643152, 0.0252467,
            0.38962095, 0.74027965, 0.14667273, 0.84681331, 0.44718666, 0.59797402, 0.31721209,
            0.79960011, 0.40734418, 0.45675536, 0.67777623, 0.9860008, 0.41964784, 0.93330052,
            0.63036119, 0.10027983, 0.82261347, 0.42008113, 0.27918678, 0.1241539, 0.12511983,
            0.69167872, 0.51867129, 0.88392608, 0.40952043, 0.5541298, 0.54397633, 0.91586623,
            0.56177839,
        ],
    )
    .unwrap();

    let conv_layer6 = TransposedConvolutionLayer::new(kernel6, 1, Padding::Same);
    let target_output6 = array![
        [
            [1.9992732, 3.08870516, 2.45423881, 2.56340806, 1.99797381],
            [2.34119542, 2.92700252, 3.99711552, 3.19989184, 2.08108093],
            [2.75481532, 5.95201402, 5.31568036, 3.98200788, 3.50084386],
            [3.27071056, 3.99549241, 4.24801882, 3.71052763, 2.58881127],
            [2.02045716, 3.35159417, 3.68300425, 2.5609857, 1.85613473]
        ],
        [
            [1.98174949, 2.31230141, 3.09281501, 2.91445756, 1.86317551],
            [2.73750659, 3.68572927, 4.17397807, 3.04708269, 2.6965357],
            [3.41131204, 4.66375009, 5.54935588, 4.49183635, 3.53886102],
            [2.75154673, 3.6272524, 5.16901854, 3.49970477, 2.53066574],
            [2.29208492, 3.71452498, 3.64102178, 2.75964138, 2.78791912]
        ]
    ];
    let current_output6 = conv_layer6.transposed_convolve(&test_input6);

    assert!(
        arr_allclose(&current_output6, &target_output6),
        "{:?} was not equal to {:?}",
        current_output6,
        target_output6
    );

    let test_input7 = array![[
        [
            0.57311571, 0.4358579, 0.27137832, 0.14918056, 0.31802373, 0.97574221, 0.2949725,
            0.43487531, 0.70853278, 0.74549819, 0.37029197, 0.29680613, 0.28866815, 0.95536917,
            0.95149357
        ],
        [
            0.2957575, 0.88887382, 0.28092442, 0.71045248, 0.37157902, 0.71040413, 0.19740541,
            0.0963868, 0.76472401, 0.14113663, 0.99507736, 0.15779655, 0.83081423, 0.44410533,
            0.21194516
        ],
        [
            0.60294921, 0.35429438, 0.14831909, 0.20181699, 0.6767633, 0.94905903, 0.13985753,
            0.06974182, 0.72531435, 0.92212437, 0.58538142, 0.49827085, 0.65023925, 0.35552604,
            0.63631585
        ],
        [
            0.34873845, 0.01343687, 0.34505465, 0.99399124, 0.37026687, 0.42950712, 0.36143671,
            0.13509372, 0.59568264, 0.40123801, 0.10019378, 0.0810014, 0.87241247, 0.76771956,
            0.64757356
        ],
        [
            0.65561595, 0.69015763, 0.65006679, 0.51841069, 0.40064591, 0.90588063, 0.59132544,
            0.66226815, 0.16276369, 0.42727843, 0.97012432, 0.13313926, 0.62895851, 0.18893319,
            0.54281119
        ],
        [
            0.56222924, 0.91382734, 0.67368679, 0.4860561, 0.86990858, 0.73475547, 0.4251425,
            0.99310255, 0.46723602, 0.10087194, 0.51427491, 0.68643432, 0.15279304, 0.73727488,
            0.7290007
        ],
        [
            0.52728593, 0.85484006, 0.76510908, 0.43334171, 0.36226065, 0.14004619, 0.67732511,
            0.25778284, 0.64071409, 0.69122188, 0.28540163, 0.78459144, 0.87706531, 0.05653322,
            0.57173935
        ],
        [
            0.56478134, 0.3264186, 0.98817882, 0.33434192, 0.7164926, 0.82586361, 0.56437535,
            0.48411915, 0.24941035, 0.1478321, 0.89537659, 0.33705255, 0.11622208, 0.04580417,
            0.50438826
        ],
        [
            0.54705663, 0.81575099, 0.4591416, 0.42085035, 0.86667756, 0.34056736, 0.99575399,
            0.16796347, 0.68238665, 0.08120212, 0.68124427, 0.75410377, 0.61138987, 0.88313173,
            0.18507351
        ],
        [
            0.27922578, 0.55814685, 0.88576819, 0.49138483, 0.16211294, 0.35546337, 0.58112356,
            0.23521907, 0.48736007, 0.58191434, 0.76816551, 0.4520079, 0.03529088, 0.3398527,
            0.60778112
        ]
    ]];

    let kernel7: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.37353724, 0.28655962, 0.21426377, 0.95074919, 0.85650491, 0.0596006, 0.45011655,
            0.97451968, 0.48365399, 0.04593647, 0.09514757, 0.26731007, 0.46548901, 0.29808706,
            0.65945538, 0.62595253, 0.39318037, 0.14317592, 0.4661266, 0.8079113, 0.57168909,
            0.25229013, 0.16278361, 0.6434899, 0.90260084, 0.12466568, 0.02655451,
        ],
    )
    .unwrap();
    let conv_layer7 = TransposedConvolutionLayer::new(kernel7, 1, Padding::Same);
    let target_output7 = array![
        [
            [
                1.22899438, 2.09275018, 1.63250404, 1.42407961, 1.63580386, 2.14658388, 1.87159484,
                1.32911424, 2.06745184, 2.28521164, 2.19725201, 1.60605914, 1.83707201, 2.24761624,
                2.14739082
            ],
            [
                1.34117531, 2.15500674, 1.94524206, 1.70847189, 2.60313691, 2.56149575, 2.05789002,
                1.2146577, 2.26708794, 3.03957555, 2.63901186, 2.58169698, 2.33338884, 2.51957202,
                1.89810408
            ],
            [
                1.16261817, 1.48839544, 1.83441166, 2.00781931, 2.52614082, 2.48685027, 2.02808448,
                1.18258574, 1.85291007, 2.94289594, 2.01029336, 2.3002502, 2.51805627, 2.95871978,
                2.08014347
            ],
            [
                1.29552115, 1.98884886, 1.93925865, 2.45763437, 2.70281202, 2.50861534, 2.46647866,
                1.82245667, 1.64382282, 2.32593945, 2.25208461, 1.66734959, 2.13056569, 2.83081984,
                2.11380341
            ],
            [
                1.65886118, 3.03325563, 2.85134976, 2.58809568, 3.02309448, 2.86683621, 2.94316159,
                2.81071606, 2.02297, 1.63438257, 2.29360683, 2.42107143, 1.70790387, 2.57880337,
                2.08390242
            ],
            [
                1.75100026, 3.35703868, 3.36453507, 2.6449654, 2.48979674, 2.52257247, 2.78332449,
                2.54843341, 2.80184133, 2.05333108, 1.90403676, 2.94682263, 2.36159011, 2.0831416,
                2.03563899
            ],
            [
                1.58478982, 2.86969157, 3.41015475, 2.79208047, 2.35725955, 2.54120321, 2.47312307,
                2.23685945, 2.03810178, 2.22766257, 2.41312759, 2.29073799, 2.31040577, 1.62528477,
                1.44498906
            ],
            [
                1.61669121, 2.77637021, 2.77310225, 2.85870458, 2.57798588, 2.98185269, 2.75302392,
                2.37914638, 1.79344969, 1.67731186, 2.49290594, 2.81925465, 2.13558777, 2.03106341,
                1.11153731
            ],
            [
                1.27988128, 2.85493725, 2.87415327, 2.6340776, 2.13948323, 2.56631402, 2.57005364,
                2.33229844, 1.83870657, 2.31061413, 2.23690432, 2.75171496, 2.05533182, 2.13829465,
                1.80218157
            ],
            [
                0.60649138, 1.41557471, 1.95548026, 1.76337328, 1.04774787, 1.281789, 1.1715983,
                1.5452622, 0.95271058, 1.67432438, 1.59600513, 1.65128257, 1.15849309, 0.88763357,
                1.28992134
            ]
        ],
        [
            [
                0.39081279, 0.99287827, 0.98625503, 0.70505082, 0.89660207, 1.01630698, 1.05394448,
                0.51658541, 0.87590874, 1.12612575, 0.99052591, 0.9960201, 0.79955632, 1.22532657,
                1.03590733
            ],
            [
                0.96413038, 1.39915545, 1.08215235, 0.79770162, 1.43454949, 2.01630622, 1.4601742,
                0.8508476, 1.4317092, 2.03961653, 1.66997699, 1.47147343, 1.47109681, 2.00664792,
                1.52078548
            ],
            [
                0.80903657, 1.30080148, 0.91983998, 1.48661629, 1.7223197, 1.58505227, 1.12243647,
                0.75752562, 1.26747214, 1.64855139, 1.60457815, 1.04967053, 1.60482485, 1.8238593,
                1.31481133
            ],
            [
                0.93444289, 1.29507694, 1.16361807, 1.46905499, 1.82354944, 1.76777182, 1.40893813,
                1.18485394, 1.51359003, 1.57711339, 1.57173839, 1.43088181, 1.34492058, 1.6377029,
                1.33634609
            ],
            [
                0.79835624, 1.4846354, 1.91756834, 1.94002821, 1.65368328, 1.82276195, 1.63485335,
                1.4953275, 1.71274833, 1.02338173, 0.94908305, 1.43038968, 1.58460897, 1.63187029,
                1.57389553
            ],
            [
                1.1560914, 2.04344427, 2.18358909, 1.7318552, 1.54722236, 1.73738315, 1.62158748,
                1.6459539, 1.34707271, 1.5630307, 1.59635604, 1.40033851, 1.77190239, 1.31053412,
                1.19372363
            ],
            [
                1.13144744, 1.94900684, 1.99010641, 1.92108967, 1.71209553, 1.83020505, 1.73442145,
                1.83487029, 1.26130985, 1.02206783, 1.49338282, 1.71938555, 1.23861191, 1.23628235,
                1.04241773
            ],
            [
                1.06776242, 2.00037575, 1.94118008, 1.57163285, 1.44449304, 1.65363686, 1.75904118,
                1.56101032, 1.34947001, 1.34741284, 1.25658101, 2.06182651, 1.67455322, 1.22531942,
                1.19243993
            ],
            [
                0.85600613, 1.53749706, 2.06967369, 1.73256042, 1.59671999, 1.62872487, 1.57035612,
                1.46887118, 0.95131078, 1.3410923, 1.75105978, 1.62520852, 1.01489368, 0.91112744,
                1.23722478
            ],
            [
                0.7151578, 1.09945102, 1.06231933, 1.08510847, 0.99817601, 0.83984256, 1.08568185,
                0.78071449, 0.788885, 0.77152459, 1.16324087, 1.19838937, 0.96780039, 0.89240456,
                0.56328602
            ]
        ],
        [
            [
                0.9343728, 0.9837994, 1.42337064, 0.92105631, 1.92481889, 1.0434245, 1.25694218,
                1.23894909, 1.11756663, 1.69852761, 0.84499994, 1.65292891, 1.41488837, 1.92095815,
                0.72831082
            ],
            [
                1.70150923, 1.56210282, 1.45329075, 1.23613448, 2.28470973, 2.04188581, 1.58731968,
                1.83277923, 1.81996669, 2.79264506, 1.94707259, 2.14398439, 2.03303197, 2.48670027,
                1.20894607
            ],
            [
                1.17711167, 1.47210626, 1.40440382, 2.00997603, 2.75698119, 1.54275125, 0.94025409,
                1.75720764, 1.90634462, 2.07906157, 1.7722796, 1.79988015, 1.89896752, 2.36500855,
                1.15240199
            ],
            [
                1.14526893, 1.72211774, 2.10971494, 1.92896112, 2.50586181, 1.98252172, 1.65212884,
                1.78823788, 2.27171981, 1.87472762, 1.51027647, 2.64081882, 1.77418436, 2.23511628,
                0.92750344
            ],
            [
                1.46420518, 1.98648804, 2.62268852, 2.4857647, 2.37259334, 2.33671499, 2.29882374,
                1.60217258, 2.13182027, 1.89180357, 0.98094686, 1.91287613, 2.27584756, 2.09882999,
                1.39839232
            ],
            [
                2.1777437, 2.64451522, 2.51588715, 2.41459096, 2.13308706, 2.18117791, 2.16377012,
                2.10210637, 1.36447091, 2.20976889, 2.42421488, 1.63467146, 2.1781741, 2.24903532,
                0.76016391
            ],
            [
                1.95532356, 2.8638772, 2.01664707, 2.59683555, 2.08637219, 2.47226877, 2.31028626,
                2.30929777, 1.64837939, 1.47406992, 2.00898419, 2.36198627, 1.17919416, 1.82727221,
                0.75739517
            ],
            [
                1.70192055, 2.83699037, 2.28275164, 2.18732785, 1.90748147, 2.49901475, 1.80980313,
                2.16004477, 1.39630439, 2.3574669, 1.68371341, 2.3643802, 1.96203369, 1.67688591,
                1.30103373
            ],
            [
                1.62876034, 2.16763586, 2.30843917, 2.47597439, 2.06088076, 2.34795319, 1.57921009,
                1.98292116, 1.06199815, 2.20706721, 2.432778, 1.83257537, 1.59225159, 1.0913137,
                0.92609673
            ],
            [
                1.31476789, 1.64322975, 1.16847607, 1.0998625, 1.13840341, 1.35899737, 1.07477174,
                1.02911724, 1.06878462, 1.23592589, 1.43441478, 1.05072844, 1.25499033, 1.24108127,
                0.28384884
            ]
        ]
    ];
    let current_output7 = conv_layer7.transposed_convolve(&test_input7);

    assert!(
        arr_allclose(&current_output7, &target_output7),
        "{:?} was not equal to {:?}",
        current_output7,
        target_output7
    );

    let test_input8 = array![[
        [
            0.92845957, 0.28528847, 0.8097526, 0.87034765, 0.42747613, 0.44829037, 0.49021396,
            0.03754933, 0.62726354, 0.36184155, 0.45796338, 0.36549965, 0.43468671, 0.18711746,
            0.85754847
        ],
        [
            0.08775862, 0.87000282, 0.3350561, 0.03511939, 0.08443702, 0.75267269, 0.0415243,
            0.40281492, 0.98840945, 0.04243748, 0.93224924, 0.10394991, 0.95669074, 0.95873938,
            0.52177524
        ],
        [
            0.10306507, 0.46772014, 0.52828555, 0.14868502, 0.75478183, 0.27904746, 0.60683715,
            0.9606596, 0.10455381, 0.67872084, 0.40994582, 0.03147708, 0.69280813, 0.80589628,
            0.12709932
        ],
        [
            0.81974328, 0.25094952, 0.19762492, 0.78337755, 0.78307076, 0.88419262, 0.34068454,
            0.11876318, 0.48846716, 0.83060747, 0.71716144, 0.12185706, 0.13819898, 0.73997694,
            0.95485534
        ],
        [
            0.83643242, 0.91762593, 0.82693177, 0.36162344, 0.58955064, 0.30270008, 0.44417979,
            0.50068556, 0.17880087, 0.22710325, 0.84239835, 0.01078446, 0.4714315, 0.2118137,
            0.19729383
        ],
        [
            0.71398524, 0.67336474, 0.46796007, 0.26652489, 0.37367155, 0.63627535, 0.41612743,
            0.8174639, 0.85374435, 0.30557198, 0.65540462, 0.59044443, 0.61980199, 0.80633384,
            0.2173366
        ],
        [
            0.41819711, 0.44758891, 0.13972853, 0.20299291, 0.76329401, 0.55912033, 0.83250086,
            0.80420402, 0.18225672, 0.55844726, 0.55949493, 0.5360104, 0.77069365, 0.82037873,
            0.79309343
        ],
        [
            0.86543269, 0.81233403, 0.27575303, 0.07010028, 0.78707754, 0.02696148, 0.01000071,
            0.40216272, 0.64200562, 0.0386022, 0.06343126, 0.28409158, 0.48098558, 0.2663604,
            0.29327105
        ],
        [
            0.81045092, 0.40317488, 0.78183401, 0.99053768, 0.00834513, 0.48237178, 0.91447208,
            0.86097516, 0.06681773, 0.32801142, 0.15094436, 0.72864565, 0.61057421, 0.74629107,
            0.67716976
        ],
        [
            0.47403161, 0.89144899, 0.7097984, 0.83073012, 0.75525068, 0.64578453, 0.01439666,
            0.33885689, 0.45331199, 0.24960478, 0.20792788, 0.93337096, 0.43428714, 0.72489494,
            0.84552191
        ]
    ]];

    let kernel8: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.26748916, 0.75911028, 0.12753571, 0.29053397, 0.62417456, 0.33590944, 0.59470978,
            0.05421542, 0.27962414, 0.19960591, 0.71575612, 0.80618434, 0.58197929, 0.86186447,
            0.81091887, 0.1092851, 0.24810465, 0.96650199, 0.86551583, 0.67156481, 0.18890017,
            0.82224662, 0.01988453, 0.3881491, 0.49758736, 0.73946495, 0.32713,
        ],
    )
    .unwrap();
    let conv_layer8 = TransposedConvolutionLayer::new(kernel8, 1, Padding::Same);
    let target_output8 = array![
        [
            [
                1.05429944, 1.23767831, 1.80572228, 1.14370197, 0.90105727, 0.95511351, 0.92622207,
                0.93229183, 1.20631139, 1.45701722, 0.90681455, 1.42346254, 1.02940248, 1.77840347,
                1.26716971
            ],
            [
                1.21852156, 1.59935227, 1.21715232, 1.23675628, 1.45246191, 1.53080712, 1.2665401,
                1.90164044, 1.72158526, 1.51213282, 1.49588947, 1.58619205, 2.03822123, 2.02030226,
                1.23423954
            ],
            [
                0.86510669, 1.67134816, 1.24447355, 1.36525493, 1.75508339, 1.77120504, 2.05552101,
                1.35263796, 1.51735592, 1.87368496, 1.38977023, 1.48427301, 1.82916266, 1.84576183,
                1.28386951
            ],
            [
                1.28489984, 1.58963585, 1.94153557, 2.14259018, 2.00046095, 1.79251496, 1.19812296,
                1.42656658, 1.7426136, 1.79648663, 1.29936504, 1.06363014, 1.19893238, 2.06952951,
                1.08744473
            ],
            [
                1.91357838, 2.32998285, 1.68458297, 1.59204471, 1.64949509, 1.63590076, 1.76852066,
                1.38312392, 1.43029885, 2.06980167, 1.56508448, 1.39647478, 1.37740238, 1.37752739,
                1.20496798
            ],
            [
                1.59603079, 1.87795026, 1.47248155, 1.24952533, 1.56049187, 1.89554028, 2.00197904,
                2.2735754, 1.7187943, 1.38855638, 1.85975786, 1.86849191, 1.98148557, 1.83884505,
                1.02318063
            ],
            [
                1.39523792, 1.71808727, 1.22701758, 1.37663466, 1.47063645, 1.87221157, 1.70888724,
                1.47980604, 1.57163831, 1.61811704, 1.28467208, 1.65950836, 1.98894477, 2.06965372,
                1.08159408
            ],
            [
                1.69770054, 1.85664394, 1.19923402, 1.61577089, 1.62054444, 0.96423456, 1.63440089,
                2.07694734, 1.42833158, 0.59237071, 1.10362817, 1.44545938, 1.84156035, 1.76825547,
                1.33386585
            ],
            [
                1.58240087, 2.1698944, 2.54908837, 1.73352654, 1.59872133, 1.86676799, 1.79158346,
                1.08573196, 1.07040482, 0.92124542, 1.19197354, 1.61198737, 2.13726442, 1.96938501,
                1.31288088
            ],
            [
                1.29624387, 1.58269852, 1.62367595, 1.68273611, 1.34796941, 0.73595174, 0.85309494,
                1.10983997, 0.79582196, 0.48633043, 1.08719911, 1.2883678, 1.37597261, 1.62563125,
                1.00320247
            ]
        ],
        [
            [
                1.22913468, 1.63861403, 1.68871914, 1.33090328, 1.1084469, 1.29885413, 0.74742351,
                1.03921481, 1.4366489, 1.11407409, 1.3140221, 1.09310245, 1.35875809, 1.64958119,
                1.19395358
            ],
            [
                1.8345878, 3.18184582, 2.55204231, 2.3017911, 2.68067849, 2.23727334, 1.94733185,
                2.72113844, 2.12016308, 2.7062012, 2.2231931, 2.29650264, 2.96065638, 3.27042979,
                1.72586051
            ],
            [
                1.72331407, 2.14232374, 2.11745723, 1.85365185, 2.31417902, 2.25571707, 2.68432418,
                2.42082667, 2.50235863, 3.32553287, 1.95750816, 2.55818357, 3.07237844, 3.71653391,
                2.29580441
            ],
            [
                2.01672223, 2.25641844, 2.44733382, 2.94284492, 2.92590869, 2.97444553, 2.52578987,
                2.36194309, 2.80951579, 2.65216298, 2.44241769, 1.55458043, 2.23874114, 2.99524625,
                2.02648421
            ],
            [
                2.79467683, 3.30869865, 2.63268402, 2.67721048, 3.29305832, 2.96778088, 2.51776289,
                2.18071417, 2.26858204, 2.96883015, 2.80536297, 1.99806422, 1.97318146, 2.52453999,
                1.92669758
            ],
            [
                2.84810138, 3.64571155, 2.78089942, 2.46679998, 2.49322698, 2.6872816, 2.86413764,
                2.99371103, 2.27476374, 2.4369927, 2.46824, 2.84503121, 2.49215065, 2.51071957,
                1.30329666
            ],
            [
                2.46844453, 2.82528602, 1.88517456, 1.95365252, 2.65308807, 2.58343081, 3.13231155,
                3.14676522, 2.91035425, 2.63359174, 2.40507853, 3.03261245, 3.47187756, 3.16017342,
                2.04243134
            ],
            [
                2.57942358, 2.47127356, 1.89572346, 2.27078345, 2.1903528, 2.5521248, 2.92375282,
                3.02664602, 2.25445299, 1.54634615, 1.96229063, 2.76401634, 3.06401531, 3.24454862,
                2.23053454
            ],
            [
                2.79757547, 3.53793782, 3.22442618, 2.72334066, 1.98518303, 2.32423108, 2.02905431,
                2.15938058, 1.79707478, 1.34656748, 1.38537838, 2.43452301, 2.61996892, 2.83478331,
                1.83534019
            ],
            [
                2.02885428, 3.13450709, 3.24975208, 2.9982739, 2.6722604, 1.89072748, 2.31704966,
                2.25596893, 1.80417726, 0.92867905, 1.93604977, 2.39586672, 2.92573012, 3.0789237,
                2.17899664
            ]
        ],
        [
            [
                1.03521212, 2.2850583, 1.55035477, 1.1718461, 1.69150093, 1.35106541, 1.12376582,
                1.99185001, 1.33312155, 2.11217714, 1.39975766, 2.01521484, 2.07274323, 2.61701788,
                1.06150328
            ],
            [
                1.4898442, 1.76773445, 2.04142584, 2.02703445, 2.00456106, 1.64197918, 2.64122189,
                2.17827176, 1.82155303, 2.7548735, 1.1869411, 2.53720897, 2.34621969, 2.57111336,
                1.61890862
            ],
            [
                1.40579283, 1.65526663, 1.84290021, 2.45990408, 2.29775582, 2.71036734, 2.02487011,
                1.58464754, 2.87133711, 2.42876145, 2.03500374, 1.87172627, 1.97944369, 2.90099915,
                2.26794811
            ],
            [
                1.79515961, 2.94536901, 2.55126406, 2.27978486, 2.50965019, 2.22197403, 2.19785417,
                1.96092746, 1.7311091, 2.23924042, 1.91239354, 1.73880904, 1.59757069, 1.90111235,
                1.1467602
            ],
            [
                2.16834416, 2.90896589, 2.19514802, 2.30665662, 2.20022814, 2.47326085, 2.37911782,
                2.32645108, 2.28488583, 2.56345264, 1.96702105, 2.59580528, 1.89420473, 2.15763642,
                1.35317262
            ],
            [
                1.69566196, 2.33868281, 1.88898952, 2.02160911, 2.24867789, 2.52276662, 3.05255121,
                2.50397393, 2.13613078, 2.41742884, 2.24066412, 2.6676178, 2.82743118, 2.63849054,
                1.80677577
            ],
            [
                2.12791913, 2.33254451, 1.61395737, 1.82316297, 1.59857895, 2.00490531, 1.86387915,
                2.26001092, 2.39126683, 1.44940813, 1.56718459, 2.1840762, 2.31605584, 2.38779295,
                1.3442253
            ],
            [
                1.82496089, 2.58969588, 2.59305445, 2.2132843, 1.47112982, 2.40551754, 2.68529935,
                2.28625125, 1.54263801, 1.33377625, 1.63967912, 2.11492699, 2.53851121, 2.78183119,
                1.70715029
            ],
            [
                1.93757455, 3.36607952, 3.11111758, 2.55946822, 2.98340598, 1.8189787, 1.66820959,
                1.69699441, 2.00369793, 1.0050494, 1.92881639, 2.00483121, 2.83100902, 2.78118338,
                1.82221476
            ],
            [
                0.99882726, 1.41423478, 1.85366991, 1.69040356, 1.48139363, 0.94369686, 1.38077381,
                0.96777209, 0.79675993, 0.65749748, 1.11906021, 0.91150613, 1.80197483, 1.52070391,
                1.05982423
            ]
        ]
    ];
    let current_output8 = conv_layer8.transposed_convolve(&test_input8);

    assert!(
        arr_allclose(&current_output8, &target_output8),
        "{:?} was not equal to {:?}",
        current_output8,
        target_output8
    );

    let test_input9 = array![[
        [
            0.79910054, 0.65938069, 0.89889676, 0.41508498, 0.12250702, 0.58874311, 0.22207342,
            0.64465895, 0.30018568, 0.1437312, 0.88102899, 0.30654707, 0.24862174, 0.83286719,
            0.07759443
        ],
        [
            0.56863876, 0.67665126, 0.53734403, 0.51252052, 0.02690168, 0.6468591, 0.55838117,
            0.44018088, 0.05583533, 0.51150844, 0.1448351, 0.12172047, 0.59288119, 0.53741276,
            0.85418471
        ],
        [
            0.41209605, 0.65305221, 0.88630907, 0.90247832, 0.94631489, 0.69896981, 0.31295437,
            0.23667673, 0.68871153, 0.86944598, 0.6344982, 0.37257316, 0.11054891, 0.21636334,
            0.88060153
        ],
        [
            0.29575007, 0.14654573, 0.33058419, 0.46961635, 0.89210135, 0.02785723, 0.97660417,
            0.69941695, 0.08753569, 0.79941792, 0.96473227, 0.57645197, 0.49391993, 0.02444519,
            0.66453208
        ],
        [
            0.0468762, 0.52927854, 0.20487691, 0.55672701, 0.12054694, 0.7478523, 0.99887235,
            0.90311056, 0.30797804, 0.73281638, 0.74942562, 0.90977167, 0.77209694, 0.58004093,
            0.69969179
        ],
        [
            0.66169819, 0.16011967, 0.13766924, 0.97415123, 0.13525665, 0.04051598, 0.61821406,
            0.15653565, 0.52766786, 0.38979906, 0.38183664, 0.17276833, 0.37312876, 0.04687037,
            0.96584445
        ],
        [
            0.90059278, 0.6869039, 0.13710514, 0.93337165, 0.8309544, 0.80964408, 0.87477944,
            0.95367652, 0.14472676, 0.94398593, 0.90163705, 0.21545039, 0.55490441, 0.00089157,
            0.10562981
        ],
        [
            0.1370874, 0.87447132, 0.90893644, 0.81232099, 0.93559456, 0.28642728, 0.38456902,
            0.61786639, 0.31358671, 0.40926057, 0.64651547, 0.76370012, 0.53640801, 0.2028953,
            0.4870808
        ],
        [
            0.85692897, 0.34825282, 0.47515214, 0.68894153, 0.31576025, 0.1009673, 0.39385105,
            0.21859388, 0.01500413, 0.10860183, 0.31928153, 0.23404567, 0.03587083, 0.15897874,
            0.24370667
        ],
        [
            0.58719108, 0.48492466, 0.90005585, 0.18147687, 0.50668002, 0.99078265, 0.98931894,
            0.50024187, 0.85909709, 0.35466765, 0.25585772, 0.33284406, 0.63859931, 0.08002022,
            0.09679864
        ]
    ]];

    let kernel9: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.15957619, 0.705643, 0.96002514, 0.63596881, 0.09242705, 0.98511867, 0.13448747,
            0.0174145, 0.26730223, 0.296218, 0.29038338, 0.97885119, 0.92181437, 0.78998809,
            0.87140419, 0.28715158, 0.84299195, 0.36335422, 0.28589742, 0.77913638, 0.71632739,
            0.16807558, 0.29890266, 0.76807243, 0.56268563, 0.94031891, 0.38139842,
        ],
    )
    .unwrap();
    let conv_layer9 = TransposedConvolutionLayer::new(kernel9, 1, Padding::Same);
    let target_output9 = array![
        [
            [
                1.00875982, 1.30171195, 0.9019882, 0.54297111, 0.62325344, 0.71735823, 0.99802717,
                0.63922172, 0.31672751, 0.99612897, 0.48057248, 0.41061276, 1.09520674, 0.69388343,
                0.6371859
            ],
            [
                2.31655454, 2.78992599, 2.67887742, 1.68666106, 2.09944632, 1.90192838, 1.6993145,
                1.37492987, 1.58836341, 1.9649084, 1.88872066, 1.54822227, 1.7175141, 1.91715924,
                0.97650879
            ],
            [
                1.92016244, 2.21312446, 2.23725902, 1.92644051, 2.01585617, 1.77593675, 2.09011678,
                1.739917, 1.62232321, 1.87207548, 1.54599056, 1.42646581, 1.69744951, 2.3392618,
                1.49619343
            ],
            [
                1.27792638, 2.23193904, 2.56888926, 3.11396482, 2.22566153, 2.60042754, 2.18658079,
                1.87924144, 2.59505264, 3.03296265, 2.44534242, 1.86395556, 1.19509062, 2.15225576,
                1.51016824
            ],
            [
                1.25622152, 0.94788463, 1.50122274, 2.20714934, 1.80314801, 2.12214571, 2.80718821,
                1.61917994, 2.02078455, 2.7188063, 2.76430217, 2.1626574, 1.42864514, 1.58897959,
                1.3564992
            ],
            [
                1.41080789, 1.43393374, 1.90921154, 1.65144731, 1.82676775, 2.93648222, 3.03662627,
                2.59716802, 1.94581322, 2.6020485, 2.70630131, 2.47053047, 2.01323414, 2.2339361,
                1.00170923
            ],
            [
                1.60024633, 1.362313, 2.62217978, 2.58946719, 1.84687246, 1.74550676, 1.91972191,
                1.52623981, 1.9798111, 2.02324087, 1.48608871, 1.71589113, 0.99064759, 1.43633044,
                1.3108336
            ],
            [
                2.77692387, 2.18618054, 2.34613969, 3.05740747, 2.45767515, 2.34318378, 2.76919852,
                1.7917225, 1.68854926, 2.45574997, 2.20817585, 1.64384307, 0.89080086, 0.76723169,
                0.32921947
            ],
            [
                1.75032504, 2.68409665, 3.11171841, 2.55346691, 2.03095787, 2.05031717, 2.0832366,
                1.63844993, 1.61903695, 1.72518573, 1.93954609, 1.84061307, 1.51058425, 1.15037807,
                0.63168302
            ],
            [
                1.57496421, 1.71845128, 1.4422633, 1.49881877, 1.34127818, 1.36047978, 1.08652042,
                1.00470274, 0.51585598, 0.64580046, 0.83294305, 0.83618688, 0.37180741, 0.48698801,
                0.29291569
            ]
        ],
        [
            [
                1.54736877, 2.40176625, 2.22795487, 1.75596566, 0.98123434, 1.40227034, 1.68979922,
                1.36629247, 1.15170903, 1.15288802, 1.22263015, 1.38647989, 1.43734568, 1.80873988,
                1.70511767
            ],
            [
                2.56080314, 3.89763758, 3.84479973, 3.04065252, 2.81352991, 2.47951595, 2.71199992,
                2.28299519, 2.16059764, 2.77711219, 2.64589798, 1.77941812, 2.14330369, 2.55648107,
                2.37195251
            ],
            [
                1.98907772, 2.76083848, 3.21447225, 3.1951675, 3.51963093, 3.1319483, 3.1730963,
                2.24299598, 2.22368283, 3.10729059, 3.06319956, 2.55505752, 2.17922343, 2.40088787,
                2.43726329
            ],
            [
                1.47452962, 2.6094998, 2.91983215, 3.55122941, 3.43796528, 3.33677947, 3.1594823,
                3.60587663, 3.18839615, 3.60037958, 4.00768831, 3.35804657, 2.47152103, 2.68299743,
                2.20310154
            ],
            [
                1.24928288, 1.45427659, 2.03214236, 3.02768541, 2.17340909, 2.5461578, 3.85542466,
                3.17305484, 2.97716464, 3.35286181, 3.68447353, 3.29044177, 2.61655018, 2.59997415,
                2.53346451
            ],
            [
                2.1618155, 2.33548549, 2.04252559, 2.74838189, 3.25302429, 3.2428536, 3.91553043,
                3.42259793, 2.66272793, 3.52651538, 3.65629789, 3.00945881, 2.59882149, 2.29437867,
                1.72061873
            ],
            [
                2.02966625, 2.97107733, 3.41969691, 3.41247632, 3.37040902, 2.9303164, 2.97695411,
                3.18327393, 2.67835742, 2.6935444, 3.15381075, 2.79447298, 1.82791846, 2.10634068,
                1.45012912
            ],
            [
                2.71247458, 2.83817778, 3.71588144, 4.2212243, 3.8816364, 3.29079214, 3.17146235,
                2.51295696, 2.39285869, 2.7321444, 2.8119262, 2.6806666, 1.83653516, 1.28875187,
                0.91850066
            ],
            [
                2.43845093, 3.71925498, 3.79661929, 3.56625841, 3.06301315, 2.77816186, 2.84837103,
                2.49385231, 2.1666647, 1.94399192, 2.30766477, 2.45938558, 1.92327724, 1.36090015,
                0.9369186
            ],
            [
                1.69230721, 2.21938428, 2.38747879, 2.13131323, 1.46527812, 2.08535316, 2.35589513,
                1.82691841, 1.40217262, 1.49130899, 1.14453899, 1.01914034, 1.08022325, 1.01977893,
                0.41405879
            ]
        ],
        [
            [
                1.04162791, 2.23618184, 1.82970322, 1.46095837, 1.3634859, 0.74769618, 1.705937,
                1.0395356, 1.21120446, 1.17047145, 0.98429831, 1.38524427, 1.33326696, 1.21132748,
                1.25231596
            ],
            [
                2.03924002, 3.20578724, 3.20989246, 2.34978378, 2.53480268, 2.05112816, 2.48858295,
                1.90778076, 1.90603196, 1.88929418, 2.2725966, 1.83532616, 1.90494917, 2.52409854,
                1.40766198
            ],
            [
                1.64505834, 2.68032398, 2.89236093, 2.97833566, 2.77771725, 3.03553783, 2.30588239,
                2.18477557, 2.31981968, 2.37920138, 2.4677941, 2.14849241, 1.8530866, 2.57752157,
                1.45315535
            ],
            [
                1.1460965, 2.04703324, 2.67021904, 3.0986872, 2.84901092, 3.20915521, 2.38642986,
                2.79195938, 3.31819289, 2.96861924, 3.37344055, 2.86698095, 1.89824246, 2.56063364,
                1.42448487
            ],
            [
                0.91551689, 1.2626708, 2.03064231, 1.85866467, 2.60893361, 2.43601866, 3.1386281,
                2.94656885, 2.7070775, 2.90259703, 3.41363771, 3.09328235, 2.32825144, 2.62169134,
                1.46300346
            ],
            [
                1.08543115, 2.00989272, 2.38513857, 1.58970203, 2.72497264, 2.81061323, 2.91946302,
                3.02836083, 2.54538047, 2.62521571, 2.86638723, 2.94127769, 1.88076759, 2.70117853,
                1.1096627
            ],
            [
                1.70036179, 2.11693279, 3.15579711, 2.86841107, 2.95753476, 2.91502327, 2.77070987,
                2.36428284, 2.93710373, 2.32498764, 2.4480088, 2.53568609, 1.33309456, 1.94971099,
                0.98815883
            ],
            [
                2.14967019, 2.74432109, 3.23554963, 3.66430547, 3.31044365, 3.13766619, 2.71502445,
                2.22307438, 2.30125793, 2.46501744, 2.56168268, 2.39024327, 1.72873118, 1.34911245,
                0.54826362
            ],
            [
                1.4965068, 3.32435844, 3.09583245, 3.22133042, 2.52500883, 2.22073857, 2.0969908,
                2.17961268, 1.59159421, 1.80855549, 1.91735839, 1.99801665, 1.52077635, 1.38091728,
                0.73512829
            ],
            [
                1.46098197, 2.33303764, 1.85769017, 2.23192327, 1.67166255, 2.02350971, 2.11471806,
                2.0780107, 1.17619785, 1.43103112, 1.1236134, 1.16486454, 0.79690213, 1.01018663,
                0.35199651
            ]
        ]
    ];
    let current_output9 = conv_layer9.transposed_convolve(&test_input9);

    assert!(
        arr_allclose(&current_output9, &target_output9),
        "{:?} was not equal to {:?}",
        current_output9,
        target_output9
    );

    let test_input10 = array![[
        [
            0.06548045, 0.00913408, 0.70435097, 0.0079826, 0.16893487, 0.29944389, 0.12247329,
            0.94360059, 0.38220185, 0.49785558, 0.97177798, 0.53094018, 0.33132295, 0.84232026,
            0.19554896
        ],
        [
            0.55755622, 0.0331462, 0.91221669, 0.1003846, 0.24653083, 0.51758086, 0.73047909,
            0.93751221, 0.22341999, 0.10366006, 0.47452989, 0.38613925, 0.90140546, 0.96519027,
            0.56692436
        ],
        [
            0.58805196, 0.84767175, 0.59596742, 0.28664271, 0.03601055, 0.07393303, 0.030159,
            0.25885589, 0.83221944, 0.00545016, 0.41427107, 0.05567308, 0.42005537, 0.68539167,
            0.7590018
        ],
        [
            0.72914267, 0.73239258, 0.13350256, 0.18356606, 0.57364015, 0.72933919, 0.62401034,
            0.00522454, 0.81930201, 0.89744821, 0.45216465, 0.53980274, 0.3617102, 0.54837332,
            0.88659669
        ],
        [
            0.54260343, 0.95218645, 0.25225356, 0.54315816, 0.92152476, 0.84947816, 0.40292062,
            0.43419262, 0.34730352, 0.19899201, 0.40532802, 0.09138747, 0.31675869, 0.65795419,
            0.88842269
        ],
        [
            0.88011608, 0.98725317, 0.78864848, 0.06023429, 0.15067703, 0.48051066, 0.88368449,
            0.16770447, 0.5568461, 0.9588074, 0.65036011, 0.38752879, 0.01370966, 0.47450773,
            0.131128
        ],
        [
            0.87109082, 0.60229446, 0.96868773, 0.65574979, 0.22015611, 0.30335161, 0.31898144,
            0.20641703, 0.22301586, 0.31008192, 0.51116645, 0.88835622, 0.12446219, 0.38059879,
            0.86916299
        ],
        [
            0.00304829, 0.62849608, 0.17905655, 0.1530777, 0.16238053, 0.3729522, 0.04563535,
            0.97295233, 0.54490872, 0.14030091, 0.70234427, 0.79208325, 0.08276344, 0.23013659,
            0.31907466
        ],
        [
            0.08286041, 0.82474615, 0.60721296, 0.32122356, 0.88011564, 0.58986834, 0.8918898,
            0.85137707, 0.59152986, 0.4391231, 0.1578612, 0.79528105, 0.74257545, 0.51367758,
            0.63454368
        ],
        [
            0.37134467, 0.48403765, 0.43673295, 0.32532635, 0.49307734, 0.83973192, 0.09708725,
            0.93633932, 0.853499, 0.57281684, 0.84261185, 0.05469608, 0.32877077, 0.56050263,
            0.19492267
        ]
    ]];

    let kernel10: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.01887928, 0.10205422, 0.27572378, 0.52168377, 0.39948625, 0.87144666, 0.52207936,
            0.27002991, 0.79887704, 0.40591711, 0.01968747, 0.69893641, 0.10295277, 0.27480727,
            0.28747879, 0.56931661, 0.43757635, 0.28292514, 0.73880335, 0.44464781, 0.28657754,
            0.0423444, 0.33070129, 0.12819706, 0.83380679, 0.66820425, 0.99603591, 0.89585434,
            0.13042457, 0.83791696, 0.51807117, 0.33727206, 0.13548309, 0.24214873, 0.22271484,
            0.943824, 0.98068613, 0.11377525, 0.15501966, 0.98296692, 0.20942484, 0.48072004,
            0.45401686, 0.21222219, 0.94949808, 0.42705424, 0.45405858, 0.05547877, 0.83340549,
            0.90596606,
        ],
    )
    .unwrap();
    let conv_layer10 = TransposedConvolutionLayer::new(kernel10, 1, Padding::Same);
    let target_output10 = array![
        [
            [
                1.46504044, 1.84173963, 1.81207445, 1.60420096, 1.36652585, 1.46070825, 2.06740985,
                2.36413198, 1.63403392, 2.28745703, 1.58829531, 2.48448959, 2.93820937, 2.7202385,
                1.75029891
            ],
            [
                2.28011256, 2.79242449, 2.45100596, 2.63011874, 2.16128579, 2.46937392, 2.73463454,
                3.44408976, 4.14108719, 3.70272232, 3.41671729, 3.71008921, 3.86815747, 3.54123421,
                2.62956397
            ],
            [
                3.1641005, 3.49372122, 3.26264496, 4.03052914, 4.25238922, 4.34772855, 4.66695463,
                3.92622828, 4.35109165, 5.00768293, 4.0004944, 5.02760203, 5.46214159, 4.7789058,
                3.46021562
            ],
            [
                3.79215678, 4.62821176, 4.54283265, 4.09051342, 4.35078644, 3.88437766, 3.95686094,
                4.68037162, 4.42786036, 4.35251578, 3.71204622, 4.06002058, 4.86594382, 4.22790549,
                3.67751412
            ],
            [
                3.76022261, 5.1307396, 5.41654328, 4.59659254, 3.99955568, 3.78114686, 3.92895913,
                4.14200178, 3.82652117, 4.62470969, 4.97141911, 3.44303769, 4.61485723, 3.87409927,
                2.52004807
            ],
            [
                3.74955399, 3.93774294, 5.58305772, 5.10026722, 4.28593189, 3.52787542, 4.7849594,
                4.40055998, 4.16362848, 4.25785129, 4.66834955, 4.58597378, 4.62903449, 3.84960408,
                2.6637639
            ],
            [
                3.68500406, 4.31656016, 4.81716072, 5.25761033, 4.2453537, 4.80118067, 5.05148417,
                5.52783401, 4.86959638, 4.30626475, 4.5487807, 4.03117893, 4.24734088, 3.2756022,
                2.28372297
            ],
            [
                3.40193337, 4.67067849, 4.95885011, 5.05657815, 4.82027066, 3.6454872, 4.95897295,
                4.97719798, 5.12945223, 5.39476808, 4.40174379, 4.79280455, 5.06991122, 3.35152143,
                2.0383253
            ],
            [
                2.43370158, 2.73641636, 3.75327997, 3.57121313, 3.65684188, 3.58416522, 3.92836086,
                3.57832263, 4.25908375, 4.47796285, 3.61701061, 3.15845973, 3.67624351, 3.076138,
                1.64284936
            ],
            [
                1.61529208, 1.61892559, 2.49157053, 3.19782234, 2.46796324, 3.34236279, 3.60823455,
                3.3483362, 3.07579959, 3.75594903, 3.17607213, 2.71197407, 3.26882058, 2.41302269,
                1.1995186
            ]
        ],
        [
            [
                3.49865078, 2.26502874, 2.84715169, 2.588453, 2.22556729, 3.21330274, 2.99487605,
                3.0785343, 4.05798974, 2.61102402, 3.42833063, 4.06519695, 4.2445463, 3.20047236,
                2.89159824
            ],
            [
                3.60238353, 3.29361385, 3.03457082, 3.49958681, 3.48251264, 3.05851587, 3.69514749,
                3.22872729, 4.71629843, 4.1586293, 4.42978471, 4.7672849, 5.2842687, 3.74654621,
                3.40858072
            ],
            [
                3.85470032, 4.09570503, 5.1433704, 5.27256532, 5.60527793, 5.08754098, 6.04206707,
                5.75792853, 6.62997598, 6.56089695, 5.76328328, 6.81428299, 7.16861571, 5.28416809,
                5.16586608
            ],
            [
                4.96938189, 5.26972255, 6.93701042, 6.51836697, 6.58846442, 5.69565018, 6.3913546,
                6.56865783, 6.18605166, 5.58865834, 5.5968702, 5.4551071, 6.59032993, 4.9057951,
                4.83383247
            ],
            [
                5.75379157, 6.37267017, 8.02803598, 6.51340689, 4.93402147, 4.0702115, 5.06956196,
                4.76545016, 5.90428508, 5.18282473, 5.78579971, 6.04737566, 5.49610192, 4.36954997,
                4.06617362
            ],
            [
                4.75007322, 5.44134328, 6.24901236, 6.38774598, 5.09251916, 5.04116186, 6.43212382,
                6.8857725, 5.79431187, 6.71824873, 6.09093399, 6.39113163, 5.87126337, 3.99666301,
                3.96887171
            ],
            [
                3.78819921, 5.83950918, 6.58253645, 7.08163523, 6.3494725, 6.85412536, 6.66316339,
                6.50117005, 6.53490928, 6.09551185, 5.24996226, 6.18178482, 6.49197385, 3.96765579,
                3.6807529
            ],
            [
                4.25625716, 5.21648549, 7.49791272, 6.81794004, 6.65272446, 6.76111556, 7.11285386,
                7.42124847, 7.50871132, 7.26112972, 6.2396089, 6.3211537, 5.84029336, 4.20496528,
                2.70463066
            ],
            [
                3.60565633, 3.97176789, 5.57623668, 5.84384575, 4.73137776, 5.2448125, 4.51417094,
                4.9243493, 4.72405218, 5.61887907, 4.95473389, 4.5602175, 5.31246367, 3.60529649,
                2.45226807
            ],
            [
                1.08383587, 1.69748133, 2.25232059, 3.47584118, 1.98708085, 3.54725318, 3.81073542,
                3.41587551, 4.62322043, 4.06976774, 3.16832597, 3.52063919, 2.7704941, 2.38961224,
                1.72827676
            ]
        ]
    ];
    let current_output10 = conv_layer10.transposed_convolve(&test_input10);

    assert!(
        arr_allclose(&current_output10, &target_output10),
        "{:?} was not equal to {:?}",
        current_output10,
        target_output10
    );

    let test_input11 = array![[
        [
            0.28493766, 0.84425454, 0.2125586, 0.30355949, 0.72178414, 0.79734001, 0.68846015,
            0.49113186, 0.61795039, 0.34699435, 0.09748444, 0.27466017, 0.14281377, 0.23376207,
            0.29919703
        ],
        [
            0.37902007, 0.17703729, 0.48892596, 0.00818884, 0.26108363, 0.35126718, 0.31604383,
            0.1264298, 0.61599498, 0.35579155, 0.47586013, 0.43474474, 0.6499928, 0.18429177,
            0.19589748
        ],
        [
            0.86887764, 0.21657656, 0.26640975, 0.91355433, 0.13511849, 0.55250745, 0.72444307,
            0.6438669, 0.94123844, 0.30522149, 0.19405145, 0.79150316, 0.22158641, 0.99354407,
            0.20575579
        ],
        [
            0.501861, 0.5988626, 0.61178063, 0.93854606, 0.34350866, 0.50226347, 0.87133253,
            0.55700096, 0.08640469, 0.25996841, 0.91667372, 0.28289969, 0.83865421, 0.01682584,
            0.31150644
        ],
        [
            0.11063476, 0.15751906, 0.73088829, 0.00140237, 0.27468005, 0.39583332, 0.8969025,
            0.92615268, 0.9761576, 0.30405822, 0.34184698, 0.5575465, 0.33684777, 0.34010286,
            0.82011597
        ],
        [
            0.28057107, 0.1391191, 0.38748598, 0.87951782, 0.72061183, 0.53143767, 0.08748581,
            0.53522171, 0.22046958, 0.99804627, 0.19019943, 0.42354576, 0.7567667, 0.10538436,
            0.50140806
        ],
        [
            0.57955885, 0.05986565, 0.35325299, 0.00311012, 0.7658407, 0.75137092, 0.97656071,
            0.58249012, 0.40999976, 0.26895262, 0.70032211, 0.64712326, 0.39382798, 0.40851804,
            0.05244604
        ],
        [
            0.11295627, 0.37395093, 0.05590766, 0.68818381, 0.29728608, 0.00232255, 0.64427335,
            0.65602951, 0.98811732, 0.77366874, 0.43098462, 0.22007245, 0.51141516, 0.42347395,
            0.25439575
        ],
        [
            0.78671196, 0.67322709, 0.03266731, 0.47595525, 0.09416257, 0.0019726, 0.11114309,
            0.64022517, 0.2728151, 0.90005399, 0.12672469, 0.94218068, 0.65010311, 0.06410667,
            0.59500879
        ],
        [
            0.88287456, 0.14757424, 0.22814396, 0.79920479, 0.29192075, 0.60299758, 0.98987752,
            0.64544795, 0.27073949, 0.72904194, 0.74243449, 0.63698597, 0.64247255, 0.72162172,
            0.028181
        ]
    ]];

    let kernel11: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.57569657, 0.02473816, 0.66734326, 0.39896733, 0.56368286, 0.88647441, 0.72141818,
            0.2723632, 0.05544049, 0.89559562, 0.69954492, 0.90682904, 0.4700125, 0.92629227,
            0.36400231, 0.47457242, 0.53150453, 0.37097195, 0.84628141, 0.41523463, 0.10259873,
            0.98971354, 0.89586818, 0.4411347, 0.44968689, 0.73471591, 0.77696189, 0.46962292,
            0.33835452, 0.35865163, 0.17881688, 0.23639117, 0.42578194, 0.88501457, 0.06259882,
            0.69691562, 0.71692068, 0.50784357, 0.41480116, 0.92402813, 0.92042994, 0.4443741,
            0.95553073, 0.63262739, 0.37982388, 0.1719768, 0.61462681, 0.2091208, 0.94248735,
            0.12528607,
        ],
    )
    .unwrap();
    let conv_layer11 = TransposedConvolutionLayer::new(kernel11, 1, Padding::Same);
    let target_output11 = array![
        [
            [
                1.94241683, 2.8038476, 3.42360111, 3.57168559, 3.76737113, 3.68350293, 4.54578108,
                4.54489463, 3.87662636, 3.52534078, 3.66463999, 3.58929344, 3.49869688, 2.63838454,
                1.91237046
            ],
            [
                3.13309636, 4.13125345, 5.82580652, 4.73850615, 5.19208029, 5.87647296, 5.86169705,
                5.7418323, 5.69400476, 4.93411419, 5.54176255, 4.31094341, 4.15884229, 3.91120656,
                2.52662997
            ],
            [
                3.72083304, 4.49435311, 6.24439832, 6.3206864, 6.40633709, 7.93797923, 8.14990048,
                7.50286084, 6.80139589, 6.49911215, 5.9436534, 5.7532692, 5.98261121, 4.92130558,
                3.44927346
            ],
            [
                3.07722119, 5.04936437, 5.36271362, 6.25767251, 6.68615975, 6.09974377, 6.53777252,
                7.60718657, 8.45117336, 7.1366887, 6.86939826, 6.04824565, 5.87502156, 5.38535023,
                4.20952675
            ],
            [
                3.01145837, 4.10449881, 5.77466974, 6.55724311, 8.39180404, 8.17400369, 8.16556218,
                7.681364, 7.1519733, 7.07017508, 7.14195797, 6.86856061, 6.59439429, 4.73319367,
                3.60389536
            ],
            [
                2.9152197, 4.02408719, 5.86186477, 5.18298008, 6.42913093, 7.5193851, 8.23821105,
                8.64710251, 8.28219053, 7.62969774, 6.57393379, 6.5500029, 6.07133721, 4.54348046,
                3.73218502
            ],
            [
                3.07951338, 3.44253464, 4.45762434, 4.93661676, 5.53949138, 6.471554, 7.00682092,
                7.68061461, 8.08756752, 8.17451182, 7.7623167, 6.23592299, 6.45614395, 5.16837073,
                3.48299556
            ],
            [
                3.39816193, 4.51738779, 5.81865961, 5.39241062, 5.58802529, 6.75176408, 7.06270965,
                6.89605865, 7.7451381, 7.27596835, 7.80167521, 8.43383247, 5.93258979, 5.31284088,
                3.51459307
            ],
            [
                2.09901665, 3.02244278, 4.32864745, 4.23477924, 4.50151267, 5.79343286, 5.39829262,
                5.93203914, 6.34300434, 7.23228479, 6.19106682, 6.02861861, 5.457879, 4.51051069,
                3.1162609
            ],
            [
                1.794028, 3.09446227, 3.38673326, 2.55533724, 2.7961324, 3.74165798, 3.11113141,
                4.66165637, 4.74915877, 4.87553854, 4.18308063, 4.62683896, 4.10913448, 2.90731151,
                2.24712331
            ]
        ],
        [
            [
                2.13744612, 3.02088467, 3.10646431, 3.23140314, 3.79568932, 3.49682615, 4.65673914,
                3.97220316, 3.83682875, 3.90268955, 3.06234671, 3.06675048, 2.98798665, 2.24376805,
                2.12300776
            ],
            [
                3.22219305, 4.47777415, 4.65281011, 5.86744054, 5.46952925, 5.55426729, 6.03102278,
                5.98983819, 5.50248986, 4.80138933, 5.10685011, 4.73484086, 3.90744387, 3.83385431,
                1.92011903
            ],
            [
                3.14923953, 5.1114146, 4.95200537, 5.53341123, 6.55376692, 6.21892977, 7.01903438,
                7.16083839, 7.08678021, 6.3335757, 5.5809848, 5.14041763, 6.02851873, 3.78543048,
                3.98258018
            ],
            [
                3.16557353, 4.41704727, 6.13891546, 5.2924148, 6.8572573, 6.86880972, 6.52153222,
                7.09925123, 6.94523997, 6.45767765, 7.1893503, 5.38078662, 6.42712858, 4.82854562,
                3.12754676
            ],
            [
                3.53288708, 4.43691481, 5.51388824, 6.52677636, 6.52362445, 8.01300868, 7.49197951,
                7.77808582, 7.28751887, 7.08107198, 5.38098068, 6.65501162, 5.84629664, 4.71304841,
                3.68916849
            ],
            [
                2.42770777, 4.08489434, 4.71605383, 5.37820277, 7.13462415, 6.39901535, 7.47696018,
                7.74274305, 7.74142508, 6.92036184, 7.69881801, 5.26188283, 5.64566913, 4.80040051,
                2.9019257
            ],
            [
                2.13602125, 4.2606365, 4.70317086, 4.36300186, 5.30289082, 6.30463328, 6.81499075,
                7.26582944, 7.34658122, 6.98412385, 6.73648897, 6.54797651, 5.88647917, 4.30797725,
                3.68680318
            ],
            [
                2.62052142, 4.6780325, 4.38986131, 5.11589216, 6.0841977, 6.28151127, 5.98810387,
                8.04295802, 6.76629577, 8.14767284, 7.13932416, 6.61374007, 6.29396633, 4.66569868,
                3.53927504
            ],
            [
                2.60930529, 3.31163885, 4.03127713, 3.1564245, 4.16056655, 5.21262497, 4.9297613,
                5.81784945, 6.30789066, 5.83155921, 6.3100034, 5.79975125, 4.91635968, 3.8483155,
                2.34352663
            ],
            [
                1.69937123, 2.99668911, 2.91043553, 2.72224007, 2.86584914, 2.77774247, 3.36582319,
                3.93163888, 4.52864393, 4.23775837, 4.64920813, 4.36200239, 3.3817857, 3.60707497,
                2.19826511
            ]
        ]
    ];
    let current_output11 = conv_layer11.transposed_convolve(&test_input11);

    assert!(
        arr_allclose(&current_output11, &target_output11),
        "{:?} was not equal to {:?}",
        current_output11,
        target_output11
    );

    let test_input12 = array![[
        [
            0.93378943, 0.87571464, 0.37056728, 0.90004735, 0.32630125, 0.3536163, 0.16810242,
            0.42665591, 0.22195213, 0.89762411, 0.73626052, 0.96711238, 0.14636794, 0.63440596,
            0.17075826
        ],
        [
            0.11598377, 0.22405057, 0.7753175, 0.45025636, 0.11275331, 0.45725665, 0.2769305,
            0.72469656, 0.81962022, 0.50384414, 0.25193857, 0.70907182, 0.10860251, 0.72674749,
            0.01785724
        ],
        [
            0.73000075, 0.62110339, 0.8582073, 0.83433441, 0.56744623, 0.90214961, 0.80780497,
            0.89690073, 0.71868527, 0.15416864, 0.31095941, 0.37281284, 0.35761752, 0.74799631,
            0.035442
        ],
        [
            0.94523052, 0.26024639, 0.54536495, 0.13844939, 0.01583813, 0.80983331, 0.14065732,
            0.39385345, 0.74254406, 0.56148315, 0.79519624, 0.13521732, 0.83143984, 0.42911456,
            0.23204545
        ],
        [
            0.89810099, 0.8682528, 0.70681597, 0.36217733, 0.53928081, 0.35841223, 0.59799546,
            0.96208871, 0.94422915, 0.73375402, 0.3066293, 0.97125517, 0.83962086, 0.88084039,
            0.89714118
        ],
        [
            0.7529824, 0.72198951, 0.90715827, 0.48381476, 0.97088132, 0.81348953, 0.20165135,
            0.35108918, 0.23535108, 0.1987758, 0.55788108, 0.96563347, 0.31244107, 0.07823667,
            0.90779878
        ],
        [
            0.04468893, 0.00807871, 0.51423221, 0.56531455, 0.94767292, 0.36464281, 0.07726929,
            0.47914063, 0.70946408, 0.03051785, 0.98401846, 0.50928405, 0.33882262, 0.20721249,
            0.30427558
        ],
        [
            0.33484283, 0.04683242, 0.81377693, 0.54005422, 0.61234246, 0.39617478, 0.50771533,
            0.55701981, 0.76028924, 0.89738517, 0.71266067, 0.40452088, 0.36860221, 0.66588918,
            0.32224171
        ],
        [
            0.7616602, 0.17484691, 0.02260675, 0.67581807, 0.68912731, 0.00524846, 0.54603006,
            0.82281511, 0.6370315, 0.22467362, 0.35656845, 0.4183928, 0.6750586, 0.4910721,
            0.79399351
        ],
        [
            0.8604528, 0.60608339, 0.57523617, 0.55920974, 0.77359199, 0.14374817, 0.53407039,
            0.66251425, 0.75181252, 0.44070471, 0.22500344, 0.53439797, 0.04389151, 0.25937989,
            0.18684314
        ]
    ]];

    let kernel12: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.364072, 0.74862231, 0.72648119, 0.85251121, 0.97074165, 0.91841763, 0.38936671,
            0.32220647, 0.37838979, 0.60087971, 0.27303653, 0.04175345, 0.22579135, 0.14077606,
            0.08313155, 0.76760068, 0.18255528, 0.45401565, 0.06547726, 0.34588438, 0.29941447,
            0.85046981, 0.36554415, 0.6702008, 0.55796266, 0.5358035, 0.08683414, 0.03629659,
            0.73831752, 0.97330501, 0.01495373, 0.61129066, 0.93443234, 0.2467136, 0.01170023,
            0.04234208, 0.92500629, 0.80947829, 0.26216622, 0.18145516, 0.91649899, 0.76867297,
            0.51883361, 0.8480724, 0.43531515, 0.88431464, 0.0618127, 0.51059407, 0.85750154,
            0.55303333,
        ],
    )
    .unwrap();
    let conv_layer12 = TransposedConvolutionLayer::new(kernel12, 1, Padding::Same);
    let target_output12 = array![
        [
            [
                2.51691161, 3.88631706, 3.6838049, 3.71284345, 4.16045467, 3.99421679, 3.87152082,
                4.0428153, 3.29755931, 4.09876653, 3.12082997, 3.46666532, 2.89111217, 1.90131965,
                1.29678557
            ],
            [
                3.05080129, 4.23795528, 4.18457883, 4.52667299, 4.42290251, 4.42053283, 4.62155262,
                4.93569318, 4.62579182, 5.79836211, 4.05707159, 5.04171633, 3.36139607, 2.7263777,
                1.62122354
            ],
            [
                4.56308275, 5.76971314, 6.20128559, 6.03731418, 5.68725901, 5.95772261, 6.22177999,
                7.10820855, 6.40545254, 6.89400107, 6.54989232, 6.68006939, 5.73435015, 4.19073772,
                2.88412961
            ],
            [
                4.76345109, 5.42812402, 6.00150634, 7.07671307, 6.51551517, 6.36360475, 7.0607542,
                5.8297378, 5.22054252, 6.70883472, 6.85149778, 6.09730285, 5.17558919, 4.24435278,
                2.47203861
            ],
            [
                4.15800695, 4.74492338, 6.67890195, 7.35115575, 6.61624462, 6.24513475, 6.86734201,
                6.20869908, 5.36930445, 6.94433977, 6.09336418, 5.61217197, 5.96628105, 3.91626203,
                2.65009081
            ],
            [
                3.70426804, 4.56232417, 5.8533014, 6.27769557, 5.52852722, 5.58001322, 6.95796636,
                5.9392606, 6.07924373, 7.14751353, 6.92943832, 5.95546246, 6.53158137, 4.01644804,
                2.78119336
            ],
            [
                3.83954451, 4.3476986, 6.5344285, 5.67258481, 5.71653184, 6.41796224, 6.98173815,
                5.89305298, 6.1095709, 7.06248653, 6.35565674, 6.08520037, 6.76502307, 5.0229431,
                2.72103937
            ],
            [
                3.62447201, 5.05188644, 7.18423958, 5.90348723, 5.05646304, 6.26004286, 6.76252598,
                4.93612257, 5.72101608, 6.59422878, 5.86947832, 3.94415657, 5.64311416, 3.520895,
                2.03033719
            ],
            [
                2.21365541, 3.37927822, 5.14314399, 3.38819184, 4.0535142, 4.97139901, 5.63738728,
                3.82998599, 4.66729334, 5.03121912, 4.26985643, 3.77886512, 3.99531795, 2.48455372,
                1.36349477
            ],
            [
                1.84606518, 2.91123525, 4.01968977, 2.54672928, 3.11971261, 4.04020961, 4.21541346,
                3.36563988, 3.63991125, 3.72942336, 3.35017611, 3.14212031, 3.05933149, 1.6304059,
                1.23512392
            ]
        ],
        [
            [
                2.39922649, 3.53695224, 4.83321882, 4.68362778, 4.05266972, 3.64606596, 3.78298251,
                3.9788437, 4.75026365, 4.80190266, 4.18511773, 3.63640486, 3.36405573, 2.74295542,
                2.12725802
            ],
            [
                2.5314177, 5.45219173, 6.31514377, 5.71085629, 5.07424514, 4.71962281, 5.37116146,
                6.15581991, 5.46668095, 5.25926429, 5.40356873, 5.59235057, 5.12666779, 4.09997646,
                2.92348452
            ],
            [
                3.91143687, 6.2175044, 6.93315665, 6.76520027, 6.38757717, 6.8084069, 6.6126278,
                7.23467708, 7.07463657, 8.62394623, 6.66494203, 6.68179218, 6.30398464, 5.49061128,
                3.88526421
            ],
            [
                4.73627199, 6.31430457, 7.14731379, 7.08033361, 6.95521768, 7.02529355, 7.54643207,
                7.55113714, 7.14561565, 7.89799945, 5.65597276, 6.50472596, 6.97716885, 5.68971407,
                4.11024942
            ],
            [
                4.74783665, 6.39669815, 6.85676735, 7.26264, 6.87306501, 7.09726337, 7.49412894,
                5.99920727, 6.64777562, 6.68506974, 7.07809009, 7.46884731, 6.63973189, 5.67306814,
                4.70105695
            ],
            [
                3.53581615, 4.88689708, 6.53418571, 7.76032628, 7.45430319, 6.49671032, 6.4960836,
                6.30139304, 6.35018677, 7.11707511, 8.61740438, 7.85798111, 6.32962008, 5.47939158,
                4.73744882
            ],
            [
                2.4247632, 4.76188895, 7.2767691, 6.94523576, 6.97078861, 7.2768136, 6.7473216,
                5.94446164, 6.37938786, 8.47412647, 7.20178791, 5.95375148, 7.23372065, 5.44095873,
                4.02301125
            ],
            [
                2.93284034, 4.45843381, 6.68491377, 6.4997079, 6.54132984, 6.90169363, 6.78345401,
                5.6406941, 6.93536066, 7.59021327, 5.68946165, 5.25108316, 6.94823688, 4.79717786,
                3.15025172
            ],
            [
                3.20599083, 3.67750678, 4.790675, 4.78683218, 4.83083123, 5.27451172, 5.79709306,
                5.21223546, 6.16369031, 5.41007093, 4.96148445, 4.83670618, 4.65230115, 3.50809093,
                2.91518399
            ],
            [
                2.39661061, 3.38060652, 4.20846963, 3.17975034, 3.83644454, 4.41909653, 4.30985967,
                4.03514145, 4.66206353, 4.22023417, 4.03143863, 3.49097223, 3.1803039, 2.44486103,
                2.06391135
            ]
        ]
    ];
    let current_output12 = conv_layer12.transposed_convolve(&test_input12);

    assert!(
        arr_allclose(&current_output12, &target_output12),
        "{:?} was not equal to {:?}",
        current_output12,
        target_output12
    );

    let test_input13 = array![[
        [
            0.41009568, 0.23349695, 0.94077221, 0.55069901, 0.81176676, 0.10928705, 0.36122619,
            0.83176975, 0.78873862, 0.19257348
        ],
        [
            0.5499223, 0.60205756, 0.01182431, 0.82526198, 0.87057256, 0.49188788, 0.84871368,
            0.51736277, 0.28413567, 0.99594162
        ],
        [
            0.3504231, 0.83290643, 0.51126899, 0.08089531, 0.20058871, 0.13052975, 0.31688937,
            0.63784495, 0.10728794, 0.38428746
        ],
        [
            0.21822088, 0.67794786, 0.01925816, 0.6034686, 0.59955319, 0.62752598, 0.19007124,
            0.53523794, 0.79173157, 0.39723003
        ],
        [
            0.01994821, 0.95703891, 0.03960026, 0.77256811, 0.75460904, 0.96137806, 0.76599173,
            0.14408278, 0.38372182, 0.56905314
        ],
        [
            0.65501193, 0.93689041, 0.69427642, 0.5075379, 0.94859544, 0.67054916, 0.28722051,
            0.85033778, 0.69368642, 0.51913927
        ],
        [
            0.17161215, 0.60783255, 0.83147178, 0.77806758, 0.90788475, 0.00837805, 0.92137239,
            0.86804241, 0.28711274, 0.92413177
        ],
        [
            0.5842536, 0.18172403, 0.8176909, 0.33601242, 0.97055828, 0.27681328, 0.3818515,
            0.43224368, 0.20357549, 0.41325221
        ],
        [
            0.43054481, 0.17652053, 0.26649218, 0.5115917, 0.6426764, 0.60195382, 0.05434526,
            0.20245806, 0.45893813, 0.63194728
        ],
        [
            0.1865494, 0.45349252, 0.00986793, 0.30004006, 0.65656857, 0.93669157, 0.9383834,
            0.42786608, 0.1657839, 0.84471141
        ],
        [
            0.095719, 0.61942987, 0.53117512, 0.06176106, 0.11184933, 0.94375013, 0.47268752,
            0.73247989, 0.41305849, 0.16590116
        ],
        [
            0.47553223, 0.95835186, 0.70241493, 0.25335352, 0.18999969, 0.54406755, 0.24702378,
            0.52970947, 0.37160356, 0.00654423
        ],
        [
            0.79921725, 0.37446592, 0.74593585, 0.05065656, 0.49161108, 0.44375099, 0.72296927,
            0.19321841, 0.78163571, 0.68207539
        ],
        [
            0.2713287, 0.34708099, 0.46632324, 0.24111566, 0.27292953, 0.22054346, 0.04943878,
            0.35453218, 0.31998316, 0.76677154
        ],
        [
            0.76535693, 0.07973383, 0.59684074, 0.47592012, 0.79735077, 0.59453138, 0.03127723,
            0.32571087, 0.96873191, 0.05784191
        ]
    ]];

    let kernel13: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.23112701, 0.21375875, 0.48185335, 0.6969342, 0.04131768, 0.1001141, 0.89933887,
            0.10443967, 0.22237247, 0.04539814, 0.52683881, 0.72701546, 0.57144904, 0.12132035,
            0.83154236, 0.82883681, 0.40907048, 0.48474864, 0.13092748, 0.95943569, 0.00129573,
            0.12605824, 0.14914274, 0.25621373, 0.1270078, 0.25362594, 0.32486655,
        ],
    )
    .unwrap();
    let conv_layer13 = TransposedConvolutionLayer::new(kernel13, 1, Padding::Same);
    let target_output13 = array![
        [
            [
                0.58926764, 1.17047002, 0.92140846, 1.08152998, 1.57702674, 1.48842528, 1.35758498,
                1.43021335, 1.0541202, 1.03997232
            ],
            [
                0.74171325, 1.6665196, 1.77532129, 1.4394567, 0.72641378, 1.00278932, 1.14395233,
                1.4687311, 1.37261359, 0.6298094
            ],
            [
                0.84645579, 1.04175032, 1.42072948, 1.18082528, 1.65793847, 1.76634869, 1.42724766,
                1.18677605, 1.90154072, 1.1788529
            ],
            [
                0.82545485, 1.15667159, 1.54283985, 1.12200395, 1.76581804, 1.86524979, 1.98765466,
                1.27521794, 1.03980603, 0.90311982
            ],
            [
                1.22695899, 1.57826367, 2.15395319, 1.74831208, 2.08650164, 1.95682706, 1.57909422,
                1.65659469, 1.91041755, 1.26508044
            ],
            [
                0.9505705, 1.14498992, 2.13003426, 2.24588621, 2.28054347, 1.85660893, 1.4738624,
                2.08302453, 1.76745202, 1.1384681
            ],
            [
                1.1032275, 1.63584581, 1.59752918, 2.16922044, 1.6940836, 1.86262548, 1.42707773,
                1.36843314, 1.43487666, 0.74549181
            ],
            [
                0.71391212, 1.31480056, 1.18063357, 1.75175963, 1.44944062, 1.85118661, 1.275487,
                0.82744092, 1.45694786, 1.04786714
            ],
            [
                0.4364053, 1.13745288, 0.90705341, 1.23921965, 1.45784465, 1.99131957, 2.01173892,
                1.51885972, 1.18639069, 0.89848807
            ],
            [
                0.44268321, 0.92270801, 1.36589773, 1.12052991, 1.07847023, 1.40479848, 1.81239264,
                1.43568084, 1.61254011, 0.70463971
            ],
            [
                0.92647223, 1.4986928, 1.75622632, 1.28273255, 1.28262356, 1.45080542, 1.56696841,
                1.17653451, 1.38468346, 0.51018607
            ],
            [
                1.17611218, 1.73080725, 1.27229874, 1.12241691, 1.12103135, 1.3607355, 1.73799586,
                1.47010884, 1.23241526, 1.32585947
            ],
            [
                0.89177775, 1.39223212, 1.17913805, 1.10870422, 0.91601187, 0.85055529, 0.83321808,
                0.90309715, 1.07549693, 1.01526772
            ],
            [
                0.8976849, 1.59883414, 0.88708009, 1.57757392, 1.47903342, 1.68896346, 0.99678483,
                1.12398514, 1.64546751, 1.21873004
            ],
            [
                0.24307254, 0.53059112, 0.37476872, 0.51178701, 0.3969471, 0.22111926, 0.35783335,
                0.42447158, 0.56675156, 0.25148402
            ]
        ],
        [
            [
                0.51435308, 1.49209915, 1.04301096, 1.40024134, 1.58516136, 1.57681801, 1.4429175,
                1.67620652, 1.17378995, 1.15064476
            ],
            [
                1.13273324, 2.17075801, 2.9645247, 2.54683652, 1.91137758, 1.86516612, 1.85304191,
                2.63184104, 2.57730761, 1.08805739
            ],
            [
                1.53178942, 1.85871594, 1.94733032, 2.03756106, 2.4790478, 2.57706266, 2.40122804,
                1.8110724, 2.60161667, 1.93962524
            ],
            [
                1.33541856, 1.98105767, 2.33623154, 1.36645809, 2.06631157, 2.06728862, 2.59334204,
                2.05644786, 1.5666038, 1.38685273
            ],
            [
                1.59780289, 1.93845909, 2.78301297, 2.36305276, 3.15456281, 2.96196372, 2.17199255,
                2.40127093, 2.7366648, 1.81172588
            ],
            [
                1.41108846, 2.10899103, 2.80765688, 3.23056796, 3.54098275, 3.14192722, 2.53773912,
                2.62895747, 2.43363406, 1.77201304
            ],
            [
                1.90897491, 2.80854399, 2.7930441, 3.27487513, 2.80085934, 3.06400862, 2.22188417,
                2.55686175, 2.73659701, 1.40239863
            ],
            [
                1.00527569, 2.35478126, 2.22410077, 3.13908678, 2.35785046, 2.62782558, 2.32775518,
                1.87465182, 2.20937384, 1.78255534
            ],
            [
                0.8903707, 1.78095328, 1.78151953, 2.10050494, 2.44197264, 2.46489168, 2.45748297,
                2.01090985, 1.63840098, 1.3268431
            ],
            [
                0.83071859, 1.14318517, 1.84363266, 1.88879957, 2.07386445, 2.38166491, 2.29219607,
                1.88057441, 2.43005009, 1.3554207
            ],
            [
                1.13802199, 1.84252709, 2.00375362, 1.7509141, 2.25169979, 2.66826922, 2.99088909,
                1.95535327, 2.04822587, 1.28361247
            ],
            [
                1.56623018, 2.53878055, 2.13652598, 1.47785788, 1.56545534, 2.15037752, 2.70437702,
                2.2447353, 1.72215278, 1.52860916
            ],
            [
                1.55721367, 2.74784129, 2.06830713, 1.79626906, 1.356324, 1.71442312, 1.45242638,
                1.81946498, 1.61526326, 1.29145454
            ],
            [
                1.5935812, 2.34690366, 1.59296768, 1.92777043, 1.88099711, 2.29940348, 1.76518661,
                1.5672339, 2.65348705, 2.00596646
            ],
            [
                0.6128148, 1.3963601, 1.08706826, 1.34693549, 1.10881342, 0.76641568, 0.82436589,
                1.11408213, 1.27663227, 1.19601144
            ]
        ],
        [
            [
                0.43333622, 1.18873258, 0.91389655, 1.31908972, 0.64455377, 0.85245374, 1.11681984,
                1.182625, 0.74527777, 0.39039961
            ],
            [
                0.91825118, 0.65132257, 1.44468109, 1.51050832, 1.25076343, 1.48405245, 1.01688013,
                1.03120971, 1.74653429, 0.58824541
            ],
            [
                1.10933151, 1.15224824, 0.73234274, 0.70761691, 0.90184265, 0.96446338, 1.24399717,
                0.88235058, 1.00843015, 0.58263499
            ],
            [
                0.90167319, 0.6312007, 1.38318282, 1.05841783, 1.24150568, 0.84435323, 1.06298011,
                1.31984926, 1.01132461, 0.51383113
            ],
            [
                1.1832164, 0.72260011, 1.48878644, 1.28727063, 1.85317469, 1.66810495, 0.98226933,
                1.01832359, 1.28040447, 0.69472021
            ],
            [
                1.10414256, 1.43099121, 1.43405685, 1.69623585, 1.57348205, 1.3456211, 1.76837506,
                1.4155104, 1.23050189, 0.67678032
            ],
            [
                0.87525061, 1.58982884, 1.67773134, 1.82808047, 0.95084039, 1.80401112, 1.40478795,
                1.08032738, 1.73894157, 0.64696243
            ],
            [
                0.38363179, 1.28419555, 1.02492645, 1.84181597, 1.20575235, 1.11670866, 0.891593,
                0.97124191, 1.05954248, 0.58126505
            ],
            [
                0.46639271, 0.71078203, 0.94245448, 1.23852389, 1.40483963, 1.01596449, 0.83662237,
                0.91418519, 1.10506119, 0.51020341
            ],
            [
                0.66662617, 0.46964514, 0.68436344, 0.98556385, 1.54986372, 1.76468642, 1.27312486,
                0.73744347, 1.29468772, 0.55241175
            ],
            [
                0.84238239, 1.07626598, 0.68925607, 0.47819977, 1.33208414, 1.2021988, 1.72749938,
                1.1869236, 0.70409982, 0.44781111
            ],
            [
                1.1655021, 1.37432592, 1.07652961, 0.75224971, 0.79104082, 0.85811979, 1.28449827,
                1.05846777, 0.75242752, 0.45717443
            ],
            [
                0.68119873, 1.51443395, 0.88089454, 1.08711819, 0.73751395, 1.15489068, 0.72714052,
                1.27142559, 1.2730476, 0.55966621
            ],
            [
                0.68564314, 1.10993681, 0.84942307, 0.91222837, 0.69524372, 0.60419806, 0.85520205,
                0.82966927, 1.30828705, 0.75452678
            ],
            [
                0.26061477, 0.95631316, 0.79839762, 1.20098473, 0.95858387, 0.46614337, 0.55272545,
                1.09325773, 0.48073691, 0.55473146
            ]
        ]
    ];
    let current_output13 = conv_layer13.transposed_convolve(&test_input13);

    assert!(
        arr_allclose(&current_output13, &target_output13),
        "{:?} was not equal to {:?}",
        current_output13,
        target_output13
    );

    let test_input14 = array![[
        [
            0.62041427, 0.697295, 0.93699034, 0.23178808, 0.07347008, 0.87454646, 0.17515964,
            0.41914884, 0.15454182, 0.36946547
        ],
        [
            0.79976181, 0.07178256, 0.46134616, 0.70403694, 0.31149798, 0.94000924, 0.56593972,
            0.93609526, 0.073363, 0.93035972
        ],
        [
            0.43241251, 0.47519298, 0.90120367, 0.1962483, 0.80530498, 0.82388787, 0.48392893,
            0.37745702, 0.86567136, 0.85204843
        ],
        [
            0.12615952, 0.11317621, 0.04537176, 0.23528395, 0.10647685, 0.66997437, 0.21937414,
            0.17724377, 0.73926926, 0.44401155
        ],
        [
            0.50388386, 0.94392321, 0.48345915, 0.3287163, 0.6634121, 0.46625282, 0.9509837,
            0.68855167, 0.81077918, 0.42277807
        ],
        [
            0.95792125, 0.11384781, 0.90199845, 0.05767209, 0.17340713, 0.0322121, 0.67263431,
            0.24741997, 0.18859474, 0.43701663
        ],
        [
            0.2152038, 0.77168582, 0.01789387, 0.4761448, 0.86404796, 0.75328025, 0.44620235,
            0.55957254, 0.8530702, 0.73950565
        ],
        [
            0.63887657, 0.72841926, 0.42928135, 0.87943432, 0.4875559, 0.87694169, 0.49920833,
            0.55926815, 0.48188641, 0.08828494
        ],
        [
            0.5162344, 0.47625086, 0.1528102, 0.11186781, 0.66326325, 0.08997896, 0.5311464,
            0.55197066, 0.19109693, 0.08596
        ],
        [
            0.34851643, 0.796684, 0.68925636, 0.41194296, 0.24475926, 0.92876573, 0.26898536,
            0.00017125, 0.43372559, 0.87517701
        ],
        [
            0.81242472, 0.84583838, 0.23242904, 0.84338525, 0.32513255, 0.83046264, 0.68667636,
            0.7849342, 0.22307974, 0.02804313
        ],
        [
            0.01699137, 0.65737803, 0.24152313, 0.78862953, 0.72347561, 0.78096512, 0.00413024,
            0.55508564, 0.95837716, 0.51338004
        ],
        [
            0.91324074, 0.51398357, 0.7841788, 0.64921321, 0.62972442, 0.23678949, 0.5444091,
            0.98195265, 0.28127429, 0.74537945
        ],
        [
            0.41554297, 0.04450764, 0.33355127, 0.10750319, 0.94191695, 0.37232223, 0.40169754,
            0.70445879, 0.3049165, 0.22046075
        ],
        [
            0.4864949, 0.00569754, 0.41896838, 0.08973251, 0.23901314, 0.91818737, 0.3380357,
            0.59644133, 0.47192204, 0.06918518
        ]
    ]];

    let kernel14: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.43654358, 0.88755145, 0.06436663, 0.87080521, 0.41433589, 0.2206951, 0.03716711,
            0.6242032, 0.49542145, 0.98770301, 0.20076575, 0.99377597, 0.47892019, 0.98983224,
            0.81258559, 0.16723854, 0.9405662, 0.42380182, 0.86250733, 0.50889605, 0.54473287,
            0.80337036, 0.25368781, 0.13558078, 0.50765886, 0.97640121, 0.61498672,
        ],
    )
    .unwrap();
    let conv_layer14 = TransposedConvolutionLayer::new(kernel14, 1, Padding::Same);
    let target_output14 = array![
        [
            [
                1.60371805, 1.80143721, 1.74095974, 1.51232735, 1.6591052, 1.64087921, 1.92689283,
                1.28838455, 1.15840527, 1.06243709
            ],
            [
                1.16087516, 2.28327818, 2.31609702, 1.93218052, 2.65839306, 2.2855322, 2.76778956,
                1.72004301, 2.84581228, 1.3635201
            ],
            [
                0.94131287, 1.83147409, 1.1733225, 2.0156395, 2.05939318, 2.35489891, 1.99395704,
                2.20370584, 2.73453961, 1.54918458
            ],
            [
                1.12958833, 1.5947707, 1.34479522, 1.35575784, 1.90706209, 1.99652403, 2.35170943,
                2.23416417, 2.16010149, 1.66063089
            ],
            [
                1.96554749, 1.7536261, 1.9773674, 1.26749139, 1.24428153, 1.99419723, 2.38287156,
                2.11667502, 1.78471332, 1.53306999
            ],
            [
                1.19418388, 2.6225495, 1.34359805, 1.88808642, 1.57466788, 2.09422668, 1.66442061,
                2.24131288, 2.25420981, 1.46944708
            ],
            [
                1.86713785, 1.87316525, 1.95569236, 2.44070981, 2.23278315, 2.38348658, 2.04350978,
                2.38342883, 2.03037807, 1.1235635
            ],
            [
                1.66582816, 1.86030093, 2.02960211, 1.62727253, 2.62536874, 2.06866341, 2.46512121,
                1.95431592, 1.36465802, 1.00516615
            ],
            [
                1.47575161, 2.16769338, 1.78175107, 1.65974791, 1.65813566, 2.32522192, 1.61559544,
                1.33110321, 1.64886988, 1.19134957
            ],
            [
                2.07279496, 2.39830738, 2.02737902, 1.84623887, 2.06747477, 2.19399928, 1.86015346,
                1.75661565, 1.51341959, 0.77970595
            ],
            [
                1.51730786, 2.13523902, 2.52517533, 2.24278816, 2.71636295, 2.20880758, 2.29400874,
                2.01496147, 1.83871977, 1.04156473
            ],
            [
                1.8438699, 1.92532158, 2.72036687, 2.31123392, 2.70407971, 1.63466004, 2.50689815,
                2.60907535, 2.24596044, 1.5871758
            ],
            [
                1.2619249, 1.84786436, 1.99073954, 2.17486144, 2.4637175, 2.04001077, 2.33961928,
                1.94404959, 2.29854394, 1.27582207
            ],
            [
                0.87243786, 1.39615694, 1.13511302, 1.8591074, 1.87597934, 2.4540334, 1.9136121,
                2.05574386, 1.82158988, 0.66331236
            ],
            [
                0.30120227, 0.91504946, 0.35937507, 0.76043916, 1.25508254, 1.4043263, 1.56102092,
                1.25109173, 1.05972812, 0.52295793
            ]
        ],
        [
            [
                1.20802093, 2.08566343, 2.55818267, 1.84748289, 1.6616888, 2.03118804, 2.43292806,
                1.22608568, 1.73198904, 0.96890282
            ],
            [
                2.67957683, 3.86662431, 2.65767347, 2.89190727, 3.41853556, 3.2601399, 3.30413336,
                3.15874662, 3.12952504, 1.90845703
            ],
            [
                1.41683385, 2.03386439, 2.7563982, 2.50617873, 3.38483748, 3.68372623, 3.51040349,
                2.92774557, 3.58610111, 2.78097491
            ],
            [
                2.14484216, 2.71862941, 2.04138949, 2.53217273, 2.85072663, 3.57257507, 3.21389518,
                3.19189839, 3.61877872, 2.53213448
            ],
            [
                1.47447081, 2.8014771, 2.25900086, 1.57926484, 2.03600264, 2.79275568, 2.72833348,
                3.12771576, 3.21546957, 2.09600829
            ],
            [
                3.18379691, 3.07902448, 2.7389608, 3.15602383, 2.61155295, 2.88109636, 3.29275103,
                3.8688862, 3.11046019, 1.79394244
            ],
            [
                2.28490875, 3.24441159, 2.8736713, 2.23759669, 2.89843601, 3.41060347, 3.00675316,
                2.64565988, 2.62309746, 2.09226715
            ],
            [
                2.43800608, 2.60950215, 2.36469033, 3.35954508, 3.56355163, 3.52717345, 3.48375275,
                3.15335408, 2.95471727, 1.57620444
            ],
            [
                2.8034265, 3.39752369, 3.02336745, 2.32299372, 3.52363107, 2.98627707, 2.33859711,
                2.70266701, 2.51406849, 1.03246427
            ],
            [
                2.62221467, 2.78292878, 3.03725102, 2.68390314, 2.60899095, 3.21591822, 3.40115116,
                1.91487316, 1.3456229, 1.47580108
            ],
            [
                2.70633617, 3.68430971, 3.50659155, 3.12144479, 3.8280078, 2.89052315, 2.91158908,
                3.22589069, 3.24585071, 1.53869485
            ],
            [
                2.59456863, 3.15119251, 3.50392382, 3.32401096, 3.70562775, 3.70577854, 3.81026988,
                2.73540652, 3.15073483, 1.93092349
            ],
            [
                1.9172111, 2.72681389, 2.92192715, 4.00637323, 3.81652712, 2.6138892, 2.79513745,
                3.65143441, 3.35744009, 1.9822618
            ],
            [
                1.91174393, 2.58375891, 2.18405153, 2.4440409, 3.166733, 3.14901921, 3.31236515,
                3.25280092, 2.7882156, 1.3419602
            ],
            [
                0.86458707, 1.09108414, 0.834818, 1.69564289, 1.68627593, 2.30245229, 2.50223831,
                2.0487595, 1.80741649, 0.82072304
            ]
        ],
        [
            [
                1.21666012, 2.12108776, 2.05080865, 2.07954712, 2.10843356, 1.78417353, 2.85089952,
                1.45861639, 1.97307912, 1.02929051
            ],
            [
                1.46062025, 3.39894053, 2.36203756, 2.74501436, 3.33090934, 2.57788995, 3.46026781,
                2.3716842, 3.50802822, 1.57676242
            ],
            [
                0.69802439, 1.94836528, 1.57951979, 2.19228809, 2.58528898, 2.65038413, 2.95327513,
                2.41511171, 3.18104371, 1.96465534
            ],
            [
                1.62602617, 2.42736159, 1.91418485, 2.25939829, 2.37835133, 2.78772544, 3.17249015,
                3.19095868, 2.76575309, 2.2336081
            ],
            [
                1.55470371, 2.45087095, 2.24767547, 1.66465814, 1.44699362, 2.21987061, 2.35535154,
                2.78037139, 2.19828492, 1.86056762
            ],
            [
                1.72192563, 2.86906976, 2.01125376, 2.82371253, 2.2483597, 2.93768174, 2.34226379,
                3.34720015, 2.88273101, 1.8781145
            ],
            [
                1.78071625, 2.79067138, 2.69722602, 2.57993166, 2.7384826, 3.12183442, 2.70785746,
                2.68005116, 2.30209656, 1.51133607
            ],
            [
                1.80780228, 2.05024786, 2.46507083, 2.17611992, 2.91619165, 2.69624972, 3.04453534,
                2.56740894, 2.08374484, 1.28387065
            ],
            [
                1.8238714, 2.83958778, 2.85940999, 2.05589657, 2.61474827, 2.73380685, 2.10287763,
                1.91200244, 2.19191302, 1.43999367
            ],
            [
                2.20548441, 2.65087706, 2.88046936, 2.44847192, 2.55033067, 2.74540465, 3.05345776,
                2.16058181, 1.56964301, 0.91046595
            ],
            [
                1.69842187, 2.56898151, 3.32979137, 2.59959865, 3.77619878, 2.29880198, 2.87080458,
                2.65947792, 2.8674422, 1.50928516
            ],
            [
                2.08673786, 2.60008481, 3.56644404, 2.70125694, 3.40583202, 2.57269949, 3.48197879,
                2.59065017, 2.94197704, 1.94859921
            ],
            [
                1.22586444, 2.1866897, 2.28107208, 2.96849775, 3.05506441, 2.62879576, 2.7715653,
                2.55652836, 2.95315371, 1.45462912
            ],
            [
                0.92761934, 2.25816979, 1.3757177, 2.23653392, 2.17652836, 3.08503846, 2.83040245,
                2.40506531, 2.66702516, 0.92284485
            ],
            [
                0.2069017, 1.13295509, 0.28867005, 1.28627621, 1.01214659, 1.48689469, 1.95297898,
                1.23017538, 1.3319608, 0.69574653
            ]
        ]
    ];
    let current_output14 = conv_layer14.transposed_convolve(&test_input14);

    assert!(
        arr_allclose(&current_output14, &target_output14),
        "{:?} was not equal to {:?}",
        current_output14,
        target_output14
    );

    let test_input15 = array![[
        [
            0.16097162, 0.43652695, 0.17749045, 0.85863024, 0.65317434, 0.85352746, 0.31870111,
            0.54268581, 0.19828886, 0.77097548
        ],
        [
            0.1067149, 0.5376704, 0.89802532, 0.57886819, 0.7348713, 0.73367958, 0.98734075,
            0.47719629, 0.01627225, 0.12886033
        ],
        [
            0.5318864, 0.34410889, 0.42659934, 0.48874857, 0.62418905, 0.89550234, 0.46432869,
            0.28980239, 0.0539234, 0.32702622
        ],
        [
            0.26965245, 0.63714337, 0.75393031, 0.76813186, 0.51628516, 0.85332134, 0.95423958,
            0.18988214, 0.45906849, 0.33289818
        ],
        [
            0.03320504, 0.11031762, 0.17383276, 0.3129896, 0.85597065, 0.9220503, 0.47989766,
            0.5442769, 0.66366854, 0.32367742
        ],
        [
            0.90965999, 0.27162619, 0.6443874, 0.19808483, 0.66812703, 0.16283889, 0.70452963,
            0.31147507, 0.51876567, 0.91000757
        ],
        [
            0.6290827, 0.84165203, 0.20687214, 0.86232537, 0.39579086, 0.33525459, 0.48246925,
            0.78413523, 0.77436682, 0.2016614
        ],
        [
            0.60858262, 0.36106374, 0.65999044, 0.90629843, 0.12646431, 0.71717771, 0.71488951,
            0.19756947, 0.24275093, 0.02829744
        ],
        [
            0.71575912, 0.86293361, 0.88272509, 0.48441255, 0.69855721, 0.47107411, 0.18837612,
            0.56484905, 0.71894842, 0.95889149
        ],
        [
            0.32359771, 0.71319768, 0.1812861, 0.2607455, 0.95429844, 0.60492752, 0.13305853,
            0.43519334, 0.10764747, 0.3028979
        ],
        [
            0.59622556, 0.99331076, 0.32433405, 0.62541955, 0.10687612, 0.37056901, 0.01105776,
            0.87456894, 0.42201773, 0.38667051
        ],
        [
            0.32159325, 0.2434449, 0.16923993, 0.04785596, 0.84527341, 0.01050071, 0.65986446,
            0.33057122, 0.9055937, 0.46914759
        ],
        [
            0.49815389, 0.86429725, 0.26227381, 0.5329861, 0.95956645, 0.7396849, 0.85941637,
            0.97343794, 0.13750444, 0.90942891
        ],
        [
            0.4959437, 0.1819489, 0.17650132, 0.63172897, 0.03979215, 0.64037652, 0.20715363,
            0.60980881, 0.20690127, 0.70077304
        ],
        [
            0.19370348, 0.41493667, 0.52806393, 0.0175705, 0.67782882, 0.60332279, 0.1796121,
            0.89490646, 0.21748377, 0.91430938
        ]
    ]];

    let kernel15: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.13322055, 0.30654451, 0.66079213, 0.55148687, 0.56553301, 0.63856812, 0.43889546,
            0.14746108, 0.82792407, 0.44854432, 0.92061511, 0.36675016, 0.76544757, 0.43750969,
            0.92189559, 0.12008844, 0.66456074, 0.95672622, 0.16496679, 0.08722926, 0.85512849,
            0.0493081, 0.88096885, 0.0771014, 0.49567017, 0.24437537, 0.56498146,
        ],
    )
    .unwrap();
    let conv_layer15 = TransposedConvolutionLayer::new(kernel15, 1, Padding::Same);
    let target_output15 = array![
        [
            [
                0.35533032, 0.78800645, 1.23630324, 1.52326109, 1.51472605, 1.53539224, 1.40254189,
                1.11336177, 0.6640823, 0.54345858
            ],
            [
                0.95558637, 1.60444601, 2.25812743, 2.35184434, 3.09588206, 2.95202785, 2.7693264,
                1.53268033, 1.40494753, 0.93578019
            ],
            [
                1.06330749, 1.9990727, 2.64068698, 2.95268372, 2.86845023, 3.29448121, 2.96279081,
                1.96649752, 1.04495879, 0.67372607
            ],
            [
                0.94784903, 1.67176441, 1.82204395, 2.14453097, 2.79406401, 3.19478789, 2.6949554,
                1.59314312, 1.52813684, 0.9792176
            ],
            [
                1.18365832, 1.88376416, 2.22801431, 2.4019595, 2.81948433, 2.87458421, 2.51701745,
                2.34675569, 1.76916782, 1.60310869
            ],
            [
                1.15086516, 1.46591153, 1.47272218, 1.94034427, 2.5133928, 2.44404056, 2.46509712,
                2.36984398, 2.50464037, 1.79837401
            ],
            [
                1.75786559, 2.53870043, 1.91589193, 2.54732029, 1.71506565, 2.06480608, 2.08852885,
                2.3320272, 2.03020449, 1.36098351
            ],
            [
                1.92241712, 2.59887361, 3.03313643, 2.3797283, 2.27383168, 2.09544159, 2.06030722,
                2.19339454, 2.22418292, 1.66605019
            ],
            [
                1.56999499, 2.59419483, 2.54194318, 2.17747517, 2.63721394, 2.23239963, 1.92683275,
                1.75879538, 1.41183226, 1.08164109
            ],
            [
                1.8900527, 3.08624755, 2.58398618, 2.46998616, 2.30479152, 1.78000393, 1.4666606,
                1.833855, 2.44637562, 1.79319019
            ],
            [
                1.52938011, 1.8901737, 1.6067067, 1.59475049, 1.97981616, 1.95770205, 1.61491984,
                1.67735185, 1.82237073, 1.2196407
            ],
            [
                1.68346835, 2.30944799, 2.18402839, 1.5865338, 2.18087722, 1.60885479, 2.29611391,
                2.34070146, 2.57800071, 1.55706055
            ],
            [
                1.21063948, 1.51771236, 1.0417606, 1.79463035, 1.81885123, 2.36404612, 2.01854609,
                2.52999593, 2.13717113, 2.06120929
            ],
            [
                1.387577, 1.75198742, 2.03122086, 1.91880891, 2.31666195, 2.92035521, 2.68602461,
                2.46417175, 2.55094743, 1.72107798
            ],
            [
                0.67366651, 1.06852039, 1.04600026, 0.87141629, 1.54246021, 1.07496583, 1.53029356,
                1.29688407, 1.6352959, 1.16793239
            ]
        ],
        [
            [
                0.79515361, 1.28853846, 2.16982777, 1.97549245, 2.60326096, 2.1936105, 2.26416811,
                1.12291004, 1.28473354, 0.56967417
            ],
            [
                1.4116509, 2.27304234, 2.76637977, 3.43283295, 4.05645638, 4.21566524, 3.26123922,
                2.05961429, 1.65039792, 1.2244556
            ],
            [
                1.33725986, 2.68213259, 3.41800975, 3.64438562, 3.79286037, 4.11881586, 3.7702928,
                2.34136698, 1.55957075, 0.62322129
            ],
            [
                1.39598415, 2.30099557, 2.6488702, 3.04442611, 3.99975941, 4.2117856, 3.2726759,
                2.64296057, 1.79896493, 1.13125604
            ],
            [
                1.41648484, 1.95842372, 2.63855228, 3.18795948, 3.56340251, 3.56552745, 3.78807726,
                2.98010493, 2.51968891, 2.08762113
            ],
            [
                1.57816687, 2.32639621, 1.67159973, 2.76120547, 2.55747543, 3.52938, 2.98866693,
                3.29184854, 3.30034851, 1.92358804
            ],
            [
                2.61608901, 2.97927399, 3.32534734, 2.7529834, 2.44737163, 2.78640261, 2.79725114,
                2.87400113, 2.37777217, 1.98890308
            ],
            [
                2.42222616, 3.76607793, 3.67184469, 2.87972472, 3.43488506, 2.44959861, 2.47850197,
                3.03095155, 2.8498558, 1.9207895
            ],
            [
                2.36864895, 3.48910953, 3.03326433, 3.60438796, 3.34103121, 2.52541879, 2.70283478,
                2.38669113, 2.26640572, 1.40042236
            ],
            [
                2.67641723, 3.47544104, 3.25842806, 3.2260092, 2.75104531, 2.49448837, 2.13762971,
                2.20261757, 2.77153342, 2.12254915
            ],
            [
                2.09055862, 2.46384848, 2.50312028, 1.78746654, 2.81209235, 2.1683385, 2.57189669,
                2.0849559, 2.69181996, 1.29971712
            ],
            [
                2.04776012, 2.92017378, 2.3022031, 2.70752344, 2.37436049, 2.68865261, 2.46877563,
                3.29846543, 3.04545607, 2.27993674
            ],
            [
                1.86062216, 1.82281952, 2.02659416, 2.32951318, 2.67743577, 3.4007532, 3.01233303,
                2.97625781, 3.41342193, 2.34942581
            ],
            [
                1.49509945, 2.51899047, 2.50578952, 1.90541951, 3.48416289, 3.03624508, 3.5459176,
                3.16912838, 3.21657871, 2.14001924
            ],
            [
                0.99068222, 1.5033623, 1.09143716, 1.74848265, 1.7395955, 1.58417572, 2.33067759,
                1.54736268, 2.56276806, 1.38853783
            ]
        ],
        [
            [
                0.27384857, 0.66693776, 0.7442188, 1.45167332, 1.30390246, 1.50265945, 1.02775344,
                1.08887796, 0.63314897, 0.74208182
            ],
            [
                0.60960371, 1.20544571, 2.23980015, 1.85707308, 2.53896846, 2.04957448, 2.57617745,
                1.3078998, 1.32362335, 0.33182456
            ],
            [
                1.08500041, 1.62946368, 1.85026922, 2.26642456, 2.30550971, 2.75340937, 2.05322384,
                1.54009953, 0.69957732, 0.56436743
            ],
            [
                0.64823547, 1.43537407, 1.64702961, 1.96124653, 2.1564611, 2.32882576, 2.42579351,
                1.14550129, 1.28330809, 0.80605847
            ],
            [
                0.69416847, 1.53723195, 1.48144465, 1.75894062, 2.27247797, 2.69224201, 1.58047215,
                2.05113954, 1.50334803, 1.03437348
            ],
            [
                1.09183526, 1.08116218, 1.56435658, 1.45492064, 2.18476234, 1.62556234, 2.03032261,
                1.77799538, 1.70809686, 1.72215234
            ],
            [
                1.01960187, 2.42750077, 1.19670239, 2.18812264, 1.46510178, 1.64263396, 1.4113661,
                2.14605942, 2.00012277, 0.85186912
            ],
            [
                1.51350955, 1.66454424, 2.52875669, 2.06921962, 1.55211161, 1.7876691, 2.05540503,
                1.60498282, 1.41339259, 0.94094519
            ],
            [
                1.19512293, 2.17365437, 2.46613411, 1.51444826, 2.18603992, 1.86500682, 1.33779998,
                1.33824764, 1.28057556, 1.22807132
            ],
            [
                1.33365839, 2.34697893, 1.93809606, 1.69991361, 2.06397034, 1.44288558, 1.39520218,
                1.3082942, 1.94023717, 1.00152199
            ],
            [
                1.30274487, 1.6412352, 1.35982346, 1.80382094, 1.08463286, 1.58147633, 0.99304035,
                1.50353241, 1.41833029, 0.99995665
            ],
            [
                1.36707067, 1.33141218, 1.86304792, 0.79468494, 1.86926835, 1.02566059, 2.14040849,
                1.46269823, 2.41612285, 1.01585329
            ],
            [
                0.80169159, 1.5351324, 0.88337736, 1.56466442, 1.56204007, 2.08921534, 1.79051022,
                2.41916098, 1.52419103, 1.51970539
            ],
            [
                1.30827771, 1.07283364, 1.45397455, 1.98739473, 1.39459088, 2.32138352, 2.16430157,
                1.45311746, 2.3358113, 0.96860957
            ],
            [
                0.40066899, 0.90410408, 1.22475653, 0.38610595, 1.56165466, 0.96181941, 1.2829695,
                1.19223067, 1.44977809, 1.02955171
            ]
        ]
    ];
    let current_output15 = conv_layer15.transposed_convolve(&test_input15);

    assert!(
        arr_allclose(&current_output15, &target_output15),
        "{:?} was not equal to {:?}",
        current_output15,
        target_output15
    );

    let test_input16 = array![[
        [
            0.4136684, 0.89354685, 0.83862323, 0.52634918, 0.54115704, 0.93397512, 0.82197185,
            0.25728146, 0.12835145, 0.60473513
        ],
        [
            0.97797878, 0.54104578, 0.98580398, 0.56049311, 0.63521925, 0.16342546, 0.72779833,
            0.69517738, 0.28433611, 0.54881183
        ],
        [
            0.1912929, 0.87234915, 0.26996411, 0.68535744, 0.94819958, 0.13918375, 0.10763118,
            0.10393438, 0.22363693, 0.48144888
        ],
        [
            0.76189504, 0.95534327, 0.53593775, 0.46751158, 0.52564165, 0.55793579, 0.98169913,
            0.76130232, 0.24232448, 0.41208319
        ],
        [
            0.88346986, 0.46067681, 0.13800847, 0.36020854, 0.10404445, 0.86207269, 0.51452161,
            0.12440164, 0.52791041, 0.41590991
        ],
        [
            0.29517243, 0.70710871, 0.24709525, 0.1217574, 0.65159662, 0.4712269, 0.25235259,
            0.84618954, 0.53189186, 0.03532711
        ],
        [
            0.11363855, 0.82895177, 0.98733521, 0.91233557, 0.94919289, 0.02088014, 0.41740271,
            0.63891721, 0.38801015, 0.3914449
        ],
        [
            0.53320506, 0.30564279, 0.5088338, 0.09429542, 0.82430763, 0.59343902, 0.35545859,
            0.01728052, 0.3149185, 0.64630566
        ],
        [
            0.1773973, 0.10563535, 0.99574574, 0.83141977, 0.07924509, 0.66102469, 0.30809724,
            0.72544979, 0.78890643, 0.92907037
        ],
        [
            0.02664311, 0.0423031, 0.81839703, 0.74128566, 0.55995121, 0.29510012, 0.86310244,
            0.07239962, 0.11448776, 0.07260404
        ],
        [
            0.57292328, 0.30392585, 0.43362981, 0.22826639, 0.3717919, 0.3870818, 0.58913678,
            0.80100105, 0.03515592, 0.43047451
        ],
        [
            0.88590705, 0.94926488, 0.0415703, 0.83084994, 0.64771729, 0.8861909, 0.13245371,
            0.94425732, 0.56812858, 0.54513182
        ],
        [
            0.4209538, 0.58699655, 0.46091164, 0.06856077, 0.8246437, 0.83686617, 0.80897746,
            0.78756963, 0.3360227, 0.30177003
        ],
        [
            0.06824325, 0.336493, 0.34435577, 0.6780542, 0.98894474, 0.75053315, 0.7147914,
            0.33843811, 0.84122542, 0.6135419
        ],
        [
            0.84051906, 0.30047426, 0.05456006, 0.41162473, 0.73265047, 0.96197641, 0.37300163,
            0.36128371, 0.26401688, 0.78292053
        ]
    ]];

    let kernel16: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.31136861, 0.97378665, 0.79150156, 0.94911953, 0.79772372, 0.65184495, 0.3331248,
            0.78876267, 0.83173686, 0.0604596, 0.77457815, 0.04165471, 0.30562419, 0.02631989,
            0.54903223, 0.09713693, 0.81306897, 0.72306783, 0.14105903, 0.80495674, 0.13341243,
            0.71446872, 0.36670475, 0.58845116, 0.24821945, 0.66416981, 0.53572711, 0.03655309,
            0.74671289, 0.65498684, 0.66267095, 0.6071994, 0.27294084, 0.30453218, 0.41659123,
            0.1920016, 0.96724222, 0.49889321, 0.83074074, 0.63144204, 0.69900098, 0.27700077,
            0.70801649, 0.20407276, 0.6525301, 0.11087482, 0.86433922, 0.60763948, 0.64478622,
            0.15407855,
        ],
    )
    .unwrap();
    let conv_layer16 = TransposedConvolutionLayer::new(kernel16, 1, Padding::Same);
    let target_output16 = array![
        [
            [
                3.47679704, 4.42583622, 4.94392509, 5.1780697, 5.15173153, 3.95874401, 2.91578417,
                3.36718243, 2.7950653, 1.5312121
            ],
            [
                4.99716726, 5.63075842, 6.42578272, 6.08812486, 5.93903667, 6.00362363, 4.65849182,
                4.59069764, 3.30800869, 1.53410978
            ],
            [
                5.22119331, 5.89640447, 8.11499033, 7.24819123, 7.00592321, 7.12252983, 5.5609682,
                5.66301122, 4.29966266, 2.45793927
            ],
            [
                4.84462009, 6.06122667, 7.20615709, 6.74608702, 6.16508658, 5.70946508, 5.92287577,
                6.59110991, 3.90359592, 2.11581641
            ],
            [
                3.86331314, 5.44276033, 7.46830187, 6.6640373, 6.25913938, 6.22292492, 5.85123005,
                4.82882353, 3.64017632, 2.9822572
            ],
            [
                4.29753256, 4.85120967, 6.83125698, 6.62387983, 7.0173569, 6.8112042, 5.75951145,
                5.59338008, 4.26799524, 2.79636847
            ],
            [
                4.05930604, 5.1921021, 7.04065654, 7.12328719, 5.133945, 5.78290766, 6.82850422,
                5.92340768, 3.72115035, 3.08092984
            ],
            [
                4.15352546, 5.50740581, 6.38102216, 6.65168466, 6.13820103, 6.69672078, 6.20168604,
                5.06417192, 3.86886813, 2.80562817
            ],
            [
                4.16604606, 5.19679236, 6.03138078, 6.49974195, 7.70931023, 5.77279639, 5.40712137,
                6.25806741, 4.3922317, 2.46939818
            ],
            [
                4.30931319, 5.56491651, 5.65009442, 6.03973135, 6.86530138, 6.7139486, 5.43354346,
                6.49162022, 3.97421588, 2.52899099
            ],
            [
                3.7146119, 5.74334409, 6.10281613, 6.61605241, 6.7812186, 7.74031691, 6.70528493,
                5.85538708, 4.58580417, 3.367308
            ],
            [
                3.44320468, 4.26260477, 6.78914315, 7.48108753, 7.68526515, 7.37955518, 7.18176466,
                6.09666655, 5.00597234, 3.01187005
            ],
            [
                3.80178751, 4.0336642, 6.52951199, 7.4798189, 6.92396152, 8.10598793, 7.75626837,
                7.41646506, 4.54767425, 3.36921844
            ],
            [
                2.26077658, 4.49826142, 6.14494748, 6.77447684, 6.12485694, 7.0051824, 6.81088865,
                6.40804949, 4.06474136, 2.93507007
            ],
            [
                1.77986171, 2.76056042, 4.53803882, 4.68585517, 4.54082665, 4.84632282, 4.9968769,
                4.94656797, 3.13454409, 1.52828641
            ]
        ],
        [
            [
                3.07761401, 3.61517432, 5.86190376, 4.47505576, 4.4028317, 3.94137406, 3.78829121,
                3.39548913, 2.78716672, 2.01965703
            ],
            [
                3.90825091, 5.53654489, 6.4617857, 6.9636633, 6.37125387, 5.55730679, 4.90883488,
                4.50630378, 3.69043625, 2.54236785
            ],
            [
                5.41016937, 6.31310121, 7.8066008, 7.41528306, 7.94297032, 6.88790325, 6.93609448,
                5.87499081, 4.0889347, 3.51551122
            ],
            [
                4.6727801, 5.8485033, 7.15876644, 6.71798592, 5.63125861, 6.29610953, 6.03744576,
                5.85610356, 4.75318588, 3.11999745
            ],
            [
                4.63076137, 6.0844244, 7.50565521, 6.58279032, 6.16090466, 6.35005997, 5.77694277,
                5.82074747, 4.13415864, 3.33558607
            ],
            [
                4.34174699, 5.89029112, 6.77000966, 7.34484669, 6.3603518, 6.37944048, 6.37004079,
                5.99977971, 4.61351499, 3.36195817
            ],
            [
                3.54359138, 4.93063021, 5.66270149, 6.74572885, 6.97940519, 5.71875007, 6.60479845,
                5.76665419, 4.7789452, 3.70557635
            ],
            [
                3.44081957, 5.45064411, 6.78561301, 6.42511993, 7.00135443, 6.94498143, 5.80091248,
                5.89580634, 4.35526954, 3.71819693
            ],
            [
                3.22280295, 4.51517682, 6.89980123, 6.42281295, 7.55480748, 6.13640857, 5.51369782,
                4.96642156, 4.76658999, 3.03455848
            ],
            [
                3.57288761, 4.3722723, 6.22194489, 6.13744253, 6.59622705, 6.94727473, 6.43121681,
                6.41015701, 4.6433289, 3.90303656
            ],
            [
                4.07046191, 5.06098473, 6.38737328, 7.58558183, 6.69029616, 7.28502977, 7.10461432,
                6.87662998, 5.31595428, 3.9508958
            ],
            [
                3.64068332, 4.47682154, 6.71517383, 6.75389875, 7.85851824, 7.49058462, 7.31269041,
                7.08303748, 4.47720598, 4.06997696
            ],
            [
                3.06709899, 5.0890436, 5.88523141, 7.34453586, 6.69920997, 8.16529277, 7.83359535,
                7.93158497, 5.79142986, 3.95675937
            ],
            [
                3.01785252, 3.6161735, 5.14096918, 5.67092768, 6.33610532, 7.1293983, 6.62585348,
                6.34657084, 4.69011795, 3.93752979
            ],
            [
                1.73187218, 2.56184549, 3.54113607, 3.69999502, 4.42554166, 5.02665494, 5.26862473,
                4.24659373, 3.21994226, 2.22780076
            ]
        ]
    ];
    let current_output16 = conv_layer16.transposed_convolve(&test_input16);

    assert!(
        arr_allclose(&current_output16, &target_output16),
        "{:?} was not equal to {:?}",
        current_output16,
        target_output16
    );

    let test_input17 = array![[
        [
            0.80167412, 0.86261693, 0.79547076, 0.64605472, 0.05995506, 0.9807167, 0.89215669,
            0.2898572, 0.66831106, 0.50166803
        ],
        [
            0.70505137, 0.80674216, 0.44505035, 0.67376211, 0.45553896, 0.88837537, 0.95662258,
            0.6476962, 0.20270044, 0.28030362
        ],
        [
            0.22960758, 0.72196469, 0.21384446, 0.53872057, 0.91090715, 0.70740471, 0.47642905,
            0.46838177, 0.57517196, 0.66118985
        ],
        [
            0.77817184, 0.85863576, 0.27843637, 0.53604117, 0.71417473, 0.75883435, 0.5165504,
            0.66596749, 0.16817366, 0.11748104
        ],
        [
            0.13227384, 0.95457479, 0.03376469, 0.73477388, 0.515693, 0.02647051, 0.69875166,
            0.56806876, 0.97424887, 0.04654682
        ],
        [
            0.0333183, 0.34091828, 0.73816105, 0.1581235, 0.55792226, 0.68412864, 0.41112508,
            0.77551204, 0.20818521, 0.76925389
        ],
        [
            0.47091549, 0.74194834, 0.38542064, 0.17033956, 0.18400494, 0.07596095, 0.91375589,
            0.6551212, 0.78268474, 0.09378912
        ],
        [
            0.79123644, 0.89897371, 0.9056562, 0.46766227, 0.12010345, 0.94773035, 0.40417556,
            0.91714181, 0.19337696, 0.51002628
        ],
        [
            0.42095899, 0.04445668, 0.70967997, 0.834394, 0.93230311, 0.77485827, 0.95655318,
            0.30799981, 0.29142946, 0.77886774
        ],
        [
            0.84054648, 0.80014222, 0.88480488, 0.24018444, 0.42975077, 0.21906808, 0.18688925,
            0.84739802, 0.94253302, 0.6681535
        ],
        [
            0.46223331, 0.96831539, 0.13454512, 0.71196741, 0.10851607, 0.24261514, 0.34147785,
            0.18652018, 0.87956145, 0.83443567
        ],
        [
            0.66578375, 0.01294852, 0.72405021, 0.6016285, 0.17695533, 0.43573812, 0.0102322,
            0.92289252, 0.18716798, 0.28005708
        ],
        [
            0.14532646, 0.39431769, 0.15734959, 0.63961165, 0.50983715, 0.63043635, 0.5031585,
            0.2069102, 0.44692337, 0.27018595
        ],
        [
            0.9117209, 0.36429109, 0.69015995, 0.65026092, 0.0944013, 0.95352951, 0.07374734,
            0.41383051, 0.73352531, 0.72835382
        ],
        [
            0.72061441, 0.31086605, 0.84233568, 0.22034272, 0.27988736, 0.44744346, 0.24040897,
            0.76424691, 0.06748126, 0.96815177
        ]
    ]];

    let kernel17: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.61821608, 0.43435308, 0.16651273, 0.04372918, 0.70475293, 0.69322646, 0.95044236,
            0.86605226, 0.30986254, 0.8063971, 0.86901558, 0.25764177, 0.02262197, 0.85024198,
            0.93472265, 0.96369309, 0.03737255, 0.04802336, 0.90558938, 0.13240665, 0.63091763,
            0.73957344, 0.62679534, 0.37828343, 0.37169732, 0.92848463, 0.03397404, 0.55299685,
            0.99432055, 0.41560472, 0.50239326, 0.67230496, 0.50070583, 0.58630748, 0.64933588,
            0.44744582, 0.18986748, 0.67163819, 0.68489236, 0.76187721, 0.91694877, 0.34488038,
            0.51000983, 0.78903281, 0.09755067, 0.46884783, 0.92604915, 0.08584987, 0.11251308,
            0.40765193,
        ],
    )
    .unwrap();
    let conv_layer17 = TransposedConvolutionLayer::new(kernel17, 1, Padding::Same);
    let target_output17 = array![
        [
            [
                2.87160406, 3.13431232, 4.59893736, 4.61295675, 5.49104157, 5.63797889, 4.13811361,
                4.6204454, 3.78319551, 2.2083205
            ],
            [
                4.05426465, 4.93622105, 6.64675708, 6.83602848, 5.98065996, 6.54893812, 6.4471794,
                5.73405326, 4.54345368, 2.78603087
            ],
            [
                5.47560284, 5.98571142, 7.48492457, 8.05119345, 7.19570829, 7.94197933, 8.15748952,
                7.41016026, 5.94270192, 3.53502545
            ],
            [
                4.53675014, 4.51990805, 6.40705408, 7.8003053, 6.95922787, 8.58975624, 8.06774993,
                6.66830541, 5.17062126, 4.04490887
            ],
            [
                4.53778679, 5.31176857, 6.01403541, 6.69807865, 6.28073159, 6.99682884, 7.5584034,
                7.33794471, 5.88623671, 3.8049126
            ],
            [
                5.30924895, 6.26659126, 6.34414098, 7.32536605, 6.95844262, 6.91140696, 7.06688833,
                6.67311285, 5.77102483, 3.77598437
            ],
            [
                4.08787042, 5.1892764, 6.1318064, 7.18207865, 7.68936766, 7.98458295, 8.00385475,
                7.35971055, 5.82072518, 3.93888046
            ],
            [
                4.71177926, 6.4658228, 7.68772258, 6.515156, 7.03790267, 6.3847149, 6.7623227,
                7.71470727, 7.19844907, 5.12983594
            ],
            [
                4.9847009, 6.74665275, 7.29090368, 6.1165533, 5.8669927, 5.99152381, 7.37195604,
                7.30924163, 6.62075974, 4.13970543
            ],
            [
                5.49784839, 5.77572095, 6.41324544, 7.03970584, 6.48704327, 7.1606845, 6.60715,
                7.2453608, 5.28326443, 3.86923096
            ],
            [
                3.79749673, 5.22789202, 7.71274198, 6.65161898, 6.85527287, 6.58516205, 5.91047548,
                6.25299748, 5.5578685, 4.35905015
            ],
            [
                4.85232397, 6.4262358, 7.14559864, 5.89569107, 5.7546681, 5.20413554, 6.02484108,
                6.57261788, 5.54296085, 5.07492745
            ],
            [
                4.52384678, 5.45092098, 6.23892771, 6.00007393, 5.5004809, 5.04097218, 4.76575879,
                7.14370264, 5.87084538, 3.78942174
            ],
            [
                2.69370123, 3.41306442, 4.57819568, 3.42909674, 4.69940963, 4.13325902, 3.91291348,
                4.78321419, 3.22561815, 2.47058304
            ],
            [
                1.90874042, 3.15098006, 3.31870076, 3.56451582, 3.68403929, 3.12638413, 3.22281443,
                2.61259773, 3.12945251, 2.33289605
            ]
        ],
        [
            [
                2.76560678, 3.60342994, 4.8655184, 4.7410342, 4.5827949, 5.04518865, 5.02969512,
                4.64827475, 3.5030563, 2.46844492
            ],
            [
                4.54369059, 5.94263567, 6.21871232, 7.0877532, 6.61504509, 6.73410959, 7.06205944,
                5.79759997, 3.91345931, 2.5274261
            ],
            [
                4.83845473, 6.45154739, 7.88975632, 7.39174573, 8.01732843, 8.41264155, 7.80931476,
                6.88230624, 5.27264564, 3.64551364
            ],
            [
                4.6852836, 4.97379054, 6.87621434, 7.96565964, 6.86295659, 8.61284065, 7.25132636,
                6.78655905, 4.99287733, 3.4481742
            ],
            [
                3.83324332, 5.65878344, 5.95328575, 6.27240521, 7.1404263, 6.58930635, 7.26707286,
                6.49376958, 5.53379483, 3.61860191
            ],
            [
                4.79913584, 5.93038935, 6.88588481, 7.08037518, 6.4443172, 7.03332169, 6.88027109,
                6.74020395, 5.31416043, 3.66125835
            ],
            [
                4.24724039, 5.54842416, 6.5284149, 7.12268169, 7.43873032, 7.29448389, 7.63280378,
                7.92577682, 5.67251102, 3.43184335
            ],
            [
                4.91021546, 6.25787201, 6.74016203, 5.91383067, 6.49473209, 7.46065596, 7.71359556,
                7.4529016, 6.19289073, 4.2920781
            ],
            [
                5.21349309, 6.86018017, 7.04778653, 7.15496555, 6.62415203, 6.12633214, 7.17769517,
                6.9900465, 5.35651891, 4.22212501
            ],
            [
                5.7574697, 6.69137114, 7.25541398, 7.34623215, 6.53616465, 7.22447481, 5.71549255,
                6.96315621, 5.33949098, 3.9456981
            ],
            [
                4.00776326, 5.92044683, 7.05013557, 5.85790201, 6.51439818, 6.02590648, 6.73501695,
                6.3908851, 5.32062112, 4.66914702
            ],
            [
                4.92962794, 6.42616516, 6.04448389, 6.00960764, 5.18979255, 4.92039851, 6.29220043,
                7.17470145, 5.23751349, 4.18528243
            ],
            [
                4.30459939, 5.79178006, 5.8357059, 6.15848172, 5.42059102, 5.58897026, 4.79575489,
                6.30244935, 5.14529795, 3.29595289
            ],
            [
                2.85459352, 4.20413033, 4.80321839, 4.58079574, 4.70803003, 3.97475673, 4.39663854,
                4.14813144, 3.32768085, 2.98245835
            ],
            [
                3.06187186, 3.8226095, 3.2338825, 4.28268853, 3.15088298, 3.46411526, 3.59194241,
                3.71290211, 2.94598324, 2.20824868
            ]
        ]
    ];
    let current_output17 = conv_layer17.transposed_convolve(&test_input17);

    assert!(
        arr_allclose(&current_output17, &target_output17),
        "{:?} was not equal to {:?}",
        current_output17,
        target_output17
    );

    let test_input18 = array![[
        [
            0.1735392, 0.33252023, 0.25156297, 0.76787076, 0.89477505, 0.96116027, 0.2584334,
            0.77774405, 0.4706827, 0.85400445
        ],
        [
            0.91445363, 0.61077877, 0.87850972, 0.75744079, 0.4954274, 0.47403999, 0.47812821,
            0.23264737, 0.39994144, 0.28322014
        ],
        [
            0.65956971, 0.66955073, 0.26484334, 0.07841692, 0.26816803, 0.80713357, 0.41487376,
            0.65040877, 0.76945631, 0.73825741
        ],
        [
            0.41042215, 0.13615583, 0.27915765, 0.7944226, 0.26580368, 0.73352823, 0.74480999,
            0.83931228, 0.23283576, 0.53357715
        ],
        [
            0.40468675, 0.31377844, 0.84170581, 0.94374919, 0.90735578, 0.06908223, 0.04756542,
            0.46796427, 0.19377977, 0.8793519
        ],
        [
            0.33400341, 0.49993458, 0.01247511, 0.74934986, 0.61883542, 0.4234197, 0.94264753,
            0.37172454, 0.20224409, 0.08899162
        ],
        [
            0.83086104, 0.0117837, 0.84676997, 0.19534237, 0.81788686, 0.44404785, 0.49013675,
            0.19165153, 0.98517054, 0.6858654
        ],
        [
            0.38388728, 0.26978252, 0.95347904, 0.52106827, 0.31000102, 0.49730714, 0.7098068,
            0.38983029, 0.54669074, 0.42960297
        ],
        [
            0.60427777, 0.25360515, 0.21147918, 0.0578304, 0.61881437, 0.19406554, 0.28450664,
            0.38654826, 0.83438196, 0.15709557
        ],
        [
            0.91200652, 0.19315188, 0.76291628, 0.66323908, 0.93848146, 0.96918081, 0.2608721,
            0.1898083, 0.14044469, 0.87049315
        ],
        [
            0.80305506, 0.01738684, 0.52363151, 0.52860831, 0.54209763, 0.82708054, 0.76773686,
            0.10310049, 0.31399414, 0.2426104
        ],
        [
            0.93551163, 0.99139623, 0.82426164, 0.92174076, 0.87250655, 0.59068181, 0.19400844,
            0.83613534, 0.34580576, 0.38326238
        ],
        [
            0.22822227, 0.29971081, 0.12596803, 0.42147853, 0.69587578, 0.38107418, 0.52459194,
            0.79646396, 0.01983257, 0.94544915
        ],
        [
            0.21176444, 0.42423561, 0.47329789, 0.34714479, 0.21170486, 0.18608356, 0.85570563,
            0.43115609, 0.17854514, 0.89127533
        ],
        [
            0.65434946, 0.55963352, 0.43441923, 0.584112, 0.95443476, 0.06028856, 0.24475269,
            0.04049677, 0.34307076, 0.43996089
        ]
    ]];

    let kernel18: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.5071757, 0.75181625, 0.90593505, 0.84733522, 0.70442171, 0.48675611, 0.51876261,
            0.2478143, 0.76889365, 0.73484225, 0.28900971, 0.03879812, 0.75820906, 0.88520763,
            0.11304509, 0.07477583, 0.27484249, 0.7407, 0.11028086, 0.76255664, 0.49100062,
            0.05269502, 0.3763243, 0.88289954, 0.26070575, 0.64896429, 0.79309964, 0.71815444,
            0.76294598, 0.1583295, 0.37510984, 0.32861404, 0.46441202, 0.73681785, 0.72865114,
            0.75126361, 0.85966651, 0.39674308, 0.07021335, 0.20876752, 0.570997, 0.98188103,
            0.14502364, 0.27177867, 0.61020742, 0.80370778, 0.90339635, 0.43053118, 0.01441014,
            0.7898905,
        ],
    )
    .unwrap();
    let conv_layer18 = TransposedConvolutionLayer::new(kernel18, 1, Padding::Same);
    let target_output18 = array![
        [
            [
                2.1055402, 2.85037616, 3.14341735, 3.81369371, 3.50993743, 3.8901692, 3.47882949,
                3.98322044, 2.32748733, 2.01225265
            ],
            [
                3.16154269, 4.21432441, 5.1455403, 6.1863246, 5.65938432, 6.04936607, 5.53685385,
                5.89410229, 3.48184164, 2.95119388
            ],
            [
                4.36363452, 5.85682038, 7.45053728, 6.86494324, 6.63259999, 6.94130112, 6.84623626,
                6.18229625, 4.86319447, 3.16022327
            ],
            [
                4.24943747, 5.90226825, 5.98738703, 6.56944559, 6.08705873, 6.68665819, 5.818042,
                6.89027199, 4.64013591, 2.93853313
            ],
            [
                3.5618106, 4.74111852, 6.67123782, 6.02277047, 6.86341359, 6.87410526, 5.9898231,
                6.65546465, 4.40891887, 3.50979533
            ],
            [
                3.44504304, 5.82076221, 6.58783378, 6.07070125, 7.43166474, 6.30721839, 6.2908443,
                6.13193628, 4.21665814, 2.69071404
            ],
            [
                4.2369073, 5.01557237, 6.3405119, 6.25904388, 6.05212258, 6.024421, 6.41370175,
                5.00481496, 4.27621689, 2.60537182
            ],
            [
                4.15620246, 4.12498709, 7.34766877, 5.82217358, 7.28088321, 5.71453281, 6.50564954,
                6.28454391, 4.38930857, 2.6346131
            ],
            [
                3.98212374, 5.33583195, 6.32711861, 6.01900451, 6.3917848, 5.65210641, 5.89525199,
                5.91763683, 4.55463094, 2.77270451
            ],
            [
                4.85774289, 5.62118861, 6.82371138, 7.2317906, 6.95589027, 5.86996327, 6.16501528,
                5.77694306, 3.22510023, 2.62322471
            ],
            [
                4.53950475, 5.11732596, 7.21131352, 6.91038926, 6.48495694, 6.47885051, 6.18247204,
                5.71890063, 3.52241003, 2.98352245
            ],
            [
                4.418887, 6.18497514, 7.78013863, 7.42763445, 7.55591674, 7.48081576, 5.53527236,
                5.71063719, 4.7471105, 2.02352916
            ],
            [
                4.38864525, 5.87593265, 7.04578385, 6.82826545, 6.98139796, 6.75359032, 5.4470968,
                6.55950135, 3.46292275, 2.7196977
            ],
            [
                3.29088803, 4.60126897, 5.90110635, 5.26447893, 4.95116039, 5.05243941, 4.79803211,
                5.2994463, 3.56760991, 3.15108131
            ],
            [
                2.27783821, 3.2001511, 4.2007727, 3.32253517, 4.15064497, 4.21780525, 3.48851331,
                3.5210745, 3.57875711, 2.12190069
            ]
        ],
        [
            [
                3.00605897, 4.16759496, 5.35964514, 5.56702827, 4.73597083, 4.84035075, 4.77546485,
                5.18746208, 3.46447351, 3.10498787
            ],
            [
                3.26413525, 4.4979396, 5.70458012, 5.88304075, 5.20589446, 5.9262628, 5.96479445,
                6.50492693, 4.77760805, 3.65573404
            ],
            [
                3.85260454, 5.17422178, 6.28168552, 7.04618629, 7.51356534, 7.59561591, 7.05315657,
                7.46737269, 5.28054165, 4.48920445
            ],
            [
                3.50841352, 5.48997011, 6.92123786, 7.33072567, 8.05313431, 7.99584113, 6.35909667,
                6.16334539, 4.4859842, 3.21415012
            ],
            [
                3.5598238, 5.21618825, 7.03376791, 5.9036779, 7.29661467, 6.56615993, 7.27233689,
                6.85848576, 5.56553948, 3.67141942
            ],
            [
                3.90260919, 5.24782685, 7.41650765, 6.10286948, 7.20431232, 6.72363102, 7.01694449,
                6.44460985, 5.97678123, 3.94054992
            ],
            [
                3.65215723, 4.42853421, 7.11855708, 6.22714738, 7.33326386, 6.00158599, 6.61493623,
                5.28085754, 4.91719678, 3.3989279
            ],
            [
                4.13463748, 4.72438781, 6.86611438, 6.13846497, 6.52667828, 6.8882781, 6.81636188,
                6.45892411, 4.64626723, 3.36207089
            ],
            [
                4.18090295, 5.55806245, 6.96093073, 6.75103534, 7.69546527, 6.98273804, 7.31955003,
                6.73999564, 4.09480584, 2.9319642
            ],
            [
                4.53872655, 6.07041877, 8.05373411, 7.95523246, 7.99777944, 7.38736089, 6.87432668,
                6.91372085, 4.29040024, 3.18942425
            ],
            [
                3.98493748, 6.10964493, 7.91197632, 8.0398684, 7.23668121, 7.12703709, 6.12055163,
                6.42032195, 4.70401621, 3.92158686
            ],
            [
                3.36411846, 5.53995261, 6.7485073, 6.90529218, 7.61345598, 7.16084446, 6.25277327,
                6.80664501, 4.73142396, 3.7532268
            ],
            [
                3.68872193, 5.44609097, 7.10509672, 6.17484311, 6.69699033, 6.30108799, 5.84785675,
                6.09932556, 4.52205434, 3.06749062
            ],
            [
                3.09305536, 4.41955488, 6.37753946, 5.4960745, 5.74249634, 5.46391483, 4.70985313,
                3.90162628, 3.55302346, 2.3515174
            ],
            [
                1.80601751, 1.99943817, 2.86755726, 2.44829235, 2.62286869, 2.93706957, 2.82475827,
                2.58140712, 2.84385585, 1.19765751
            ]
        ]
    ];
    let current_output18 = conv_layer18.transposed_convolve(&test_input18);

    assert!(
        arr_allclose(&current_output18, &target_output18),
        "{:?} was not equal to {:?}",
        current_output18,
        target_output18
    );

    let test_input19 = array![
        [
            [0.53551238, 0.84630893, 0.49395443, 0.31477891, 0.65824331, 0.78483599],
            [0.1510672, 0.42329791, 0.16708442, 0.98063123, 0.34932785, 0.85616634],
            [0.65831075, 0.6045492, 0.59448459, 0.49652184, 0.19938152, 0.71286954],
            [0.76311034, 0.12619635, 0.45953398, 0.73609305, 0.45522751, 0.27430529],
            [0.42199708, 0.60537079, 0.22874044, 0.17153989, 0.18029414, 0.5190589],
            [0.36979611, 0.22644467, 0.56790539, 0.0774854, 0.54487514, 0.52285328]
        ],
        [
            [0.28804024, 0.94630589, 0.45284552, 0.67754718, 0.51962546, 0.3579118],
            [0.40998468, 0.01620401, 0.91762753, 0.62317074, 0.60952909, 0.53925424],
            [0.99580084, 0.1331574, 0.73531079, 0.34988298, 0.58402663, 0.57381993],
            [0.08381489, 0.71979917, 0.26103321, 0.71194158, 0.96576445, 0.69263771],
            [0.86091734, 0.74921032, 0.86290229, 0.6507571, 0.00374019, 0.43869575],
            [0.48209461, 0.13357504, 0.37444469, 0.92316669, 0.25001044, 0.96148134]
        ],
        [
            [0.62870991, 0.48406195, 0.63366682, 0.59469455, 0.92729818, 0.54603784],
            [0.13363587, 0.38365367, 0.33317753, 0.54434068, 0.92751212, 0.54897169],
            [0.07616951, 0.06364463, 0.5037747, 0.118681, 0.79107323, 0.89233322],
            [0.05960295, 0.43817316, 0.50985106, 0.65321445, 0.09364624, 0.2547052],
            [0.66226519, 0.21316498, 0.09515281, 0.25465712, 0.89676253, 0.54031879],
            [0.19572686, 0.13148713, 0.2641501, 0.81448007, 0.07326905, 0.12440558]
        ]
    ];

    let kernel19: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.60326092, 0.50336872, 0.73233401, 0.67789743, 0.14069029, 0.32648214, 0.87160036,
            0.7169897, 0.69570975, 0.64410523, 0.60836403, 0.06947965, 0.6603661, 0.39585782,
            0.51584344, 0.7992338, 0.9854483, 0.52205783, 0.67180044, 0.93684356, 0.51900642,
            0.02719556, 0.15868022, 0.65852522, 0.99737092, 0.47087741, 0.3785762, 0.37369973,
            0.88206939, 0.35842388, 0.46797603, 0.33649432, 0.58254954, 0.23564331, 0.86164392,
            0.9941346, 0.91916728, 0.28123403, 0.65850909, 0.43712796, 0.18253075, 0.99813489,
            0.82458349, 0.22564544, 0.601965, 0.1018929, 0.98446453, 0.95680402, 0.35278337,
            0.06435335, 0.6966015, 0.95331307, 0.09583493, 0.69810932,
        ],
    )
    .unwrap();
    let conv_layer19 = TransposedConvolutionLayer::new(kernel19, 1, Padding::Same);
    let target_output19 = array![
        [
            [2.64463967, 4.46850303, 6.09584445, 6.55071729, 6.53607372, 4.42753979],
            [4.06046887, 7.33864376, 7.19063415, 8.93791336, 8.83118, 5.90561598],
            [3.21129638, 6.13577868, 6.82425399, 8.37725764, 9.48134595, 5.3039216],
            [4.18927413, 7.34543064, 7.29973405, 6.47684148, 7.31296838, 5.24564965],
            [3.05229136, 6.43453909, 6.82308631, 6.73124187, 7.48089457, 4.09912761],
            [2.2163698, 3.69421412, 3.76807359, 3.70391568, 4.39857902, 2.36390723]
        ],
        [
            [2.27163931, 4.04363312, 4.40287493, 5.31834941, 5.08015743, 3.43704247],
            [4.44199932, 7.50178552, 7.89405272, 8.54543272, 8.52808449, 5.94057166],
            [3.32953374, 5.55905014, 7.34938895, 8.78455186, 9.60322021, 5.07644773],
            [4.56084449, 7.89568252, 6.88917691, 6.48107223, 7.27930326, 5.09167678],
            [3.47813755, 5.75128523, 6.41440622, 6.95224464, 8.29802503, 3.77276148],
            [3.07255627, 4.8118156, 4.64023044, 4.13443479, 3.90629522, 2.8165351]
        ]
    ];
    let current_output19 = conv_layer19.transposed_convolve(&test_input19);

    assert!(
        arr_allclose(&current_output19, &target_output19),
        "{:?} was not equal to {:?}",
        current_output19,
        target_output19
    );

    let test_input20 = array![
        [
            [0.2069652, 0.07376959, 0.2294709, 0.31579313, 0.33869487, 0.47575932],
            [0.58571469, 0.04753572, 0.18346356, 0.53604738, 0.18584671, 0.64365136],
            [0.40849308, 0.70973461, 0.24728718, 0.34820151, 0.81738771, 0.36227777],
            [0.25395742, 0.20914847, 0.30944657, 0.31628296, 0.51608183, 0.50329994],
            [0.59146862, 0.72468011, 0.68792256, 0.33808803, 0.82763827, 0.7930527],
            [0.18008629, 0.35312354, 0.50524457, 0.21019965, 0.55174293, 0.5169359]
        ],
        [
            [0.55980761, 0.34688075, 0.39895425, 0.7609961, 0.97988675, 0.79512574],
            [0.13564406, 0.89619201, 0.81221761, 0.19600912, 0.84066533, 0.83936905],
            [0.57498973, 0.80389475, 0.60667424, 0.37596556, 0.391024, 0.99212998],
            [0.58918342, 0.79533594, 0.56581289, 0.0528274, 0.86063302, 0.99905436],
            [0.18699598, 0.60602587, 0.47798221, 0.47830799, 0.72988235, 0.66585116],
            [0.44784999, 0.92261229, 0.65957379, 0.47514748, 0.07560958, 0.7602587]
        ],
        [
            [0.8904679, 0.1950909, 0.57932831, 0.21419428, 0.61572374, 0.14621958],
            [0.91224446, 0.71360005, 0.5201434, 0.48371075, 0.55119929, 0.51028204],
            [0.68514136, 0.73975417, 0.90205777, 0.15398078, 0.39852729, 0.91738732],
            [0.03889621, 0.29210058, 0.5723887, 0.66059166, 0.07154161, 0.52726948],
            [0.59904165, 0.01829243, 0.15631116, 0.65362698, 0.56822439, 0.48060026],
            [0.04548458, 0.93498044, 0.8845066, 0.23969703, 0.40285116, 0.31280545]
        ]
    ];

    let kernel20: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.39572205, 0.54200973, 0.8969547, 0.77138475, 0.0354443, 0.915543, 0.55883674,
            0.59411934, 0.66782853, 0.83422443, 0.79845789, 0.90230981, 0.24819306, 0.45509673,
            0.18927146, 0.2588136, 0.39415059, 0.1062895, 0.19552689, 0.09579732, 0.60221068,
            0.36422288, 0.07335183, 0.55739336, 0.85957508, 0.579735, 0.93959679, 0.75264192,
            0.72409565, 0.91203925, 0.5658694, 0.51702878, 0.71761038, 0.50851425, 0.73565096,
            0.90199146, 0.74037708, 0.95587525, 0.24229282, 0.28037115, 0.5831479, 0.66420243,
            0.26157438, 0.95551175, 0.01882877, 0.38997127, 0.65857524, 0.40820356, 0.59943012,
            0.54042662, 0.22976574, 0.2188059, 0.88535125, 0.3082493,
        ],
    )
    .unwrap();
    let conv_layer20 = TransposedConvolutionLayer::new(kernel20, 1, Padding::Same);
    let target_output20 = array![
        [
            [2.38676429, 4.05050577, 3.19982867, 4.30841672, 4.39514992, 3.01976784],
            [4.05101938, 7.14379686, 6.0716816, 6.76659051, 7.18510925, 4.54038125],
            [4.9349179, 6.60028006, 5.83998158, 6.89464511, 7.40041695, 4.56728015],
            [5.24529605, 7.28665173, 5.98161416, 6.98270503, 8.22659151, 5.28309363],
            [3.83412957, 5.7717867, 6.14028949, 6.74697697, 7.29978355, 4.29790236],
            [3.34982055, 4.60464526, 4.51615693, 4.87681483, 5.15676212, 3.26259311]
        ],
        [
            [3.32203959, 4.9315497, 4.11523041, 5.41816186, 5.83506181, 3.85970819],
            [5.41277261, 7.46060724, 6.70682855, 7.23427243, 8.07048738, 5.58110976],
            [5.15048555, 7.91013796, 7.02136883, 6.91001018, 8.10548591, 5.46361613],
            [5.32393675, 7.20467591, 6.84030476, 7.73142982, 8.32470292, 6.0499778],
            [4.50807576, 7.04182546, 6.80368019, 6.81496572, 8.26938568, 5.59871767],
            [3.633732, 5.86085931, 6.06604943, 5.589216, 5.48047547, 3.77167172]
        ]
    ];
    let current_output20 = conv_layer20.transposed_convolve(&test_input20);

    assert!(
        arr_allclose(&current_output20, &target_output20),
        "{:?} was not equal to {:?}",
        current_output20,
        target_output20
    );

    let test_input21 = array![
        [
            [0.16071312, 0.83594682, 0.22708985, 0.17599847, 0.14375285, 0.47631564],
            [0.22191391, 0.70076339, 0.62529133, 0.48909206, 0.4368913, 0.87737213],
            [0.83849181, 0.42826145, 0.28988461, 0.59858889, 0.70642778, 0.18215496],
            [0.89728155, 0.3877185, 0.90388064, 0.25849035, 0.27922356, 0.49311085],
            [0.37437872, 0.65416154, 0.17897265, 0.3831441, 0.79478062, 0.93560797],
            [0.58257598, 0.54394796, 0.86098909, 0.19722052, 0.61633448, 0.5712354]
        ],
        [
            [0.56986641, 0.16279561, 0.12920256, 0.80265046, 0.45887132, 0.76312066],
            [0.30019793, 0.93926425, 0.87902539, 0.48235862, 0.51786328, 0.73625133],
            [0.80001345, 0.45447991, 0.26245163, 0.51312528, 0.38167934, 0.58934385],
            [0.39737841, 0.90141283, 0.03582105, 0.79488092, 0.32727263, 0.82759531],
            [0.95427304, 0.6115196, 0.11641497, 0.06941804, 0.05837393, 0.07343165],
            [0.51928007, 0.9167956, 0.21110035, 0.12763413, 0.42576944, 0.66916052]
        ],
        [
            [0.49244329, 0.53892329, 0.49379312, 0.46095899, 0.78997212, 0.98074606],
            [0.94376722, 0.81427413, 0.43118378, 0.36272494, 0.53075185, 0.9816929],
            [0.04264403, 0.20135687, 0.9447678, 0.68336103, 0.6722416, 0.23696878],
            [0.34307223, 0.30059189, 0.24676771, 0.43225858, 0.72559514, 0.97501828],
            [0.97740527, 0.21789329, 0.29735, 0.3452764, 0.90220148, 0.44412678],
            [0.53958588, 0.04653481, 0.65971615, 0.91931394, 0.61549491, 0.33268865]
        ]
    ];

    let kernel21: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.14686015, 0.4400883, 0.87996229, 0.20377532, 0.7939284, 0.5523168, 0.86131782,
            0.26729272, 0.82922994, 0.24622782, 0.87051425, 0.54647283, 0.16327019, 0.99609414,
            0.78622589, 0.12706756, 0.5417015, 0.2662801, 0.60556669, 0.32932518, 0.47560595,
            0.9392806, 0.79730126, 0.73681276, 0.3724561, 0.73015352, 0.77976812, 0.08497322,
            0.85640694, 0.48347974, 0.85027822, 0.21730231, 0.23967233, 0.52442352, 0.63649454,
            0.19164597, 0.09752544, 0.07949329, 0.05948856, 0.73755899, 0.12181213, 0.01710567,
            0.32955934, 0.62790688, 0.74601978, 0.59271806, 0.30180662, 0.57772453, 0.29254381,
            0.02286196, 0.67745977, 0.42358266, 0.10448514, 0.94677523,
        ],
    )
    .unwrap();
    let conv_layer21 = TransposedConvolutionLayer::new(kernel21, 1, Padding::Same);
    let target_output21 = array![
        [
            [3.58292898, 4.55293193, 4.44820158, 4.36394522, 5.41075414, 4.64491432],
            [5.24067672, 8.26533202, 8.44043083, 7.44997956, 8.3253936, 6.7038224],
            [5.74906529, 8.02072871, 7.85221148, 8.25497227, 8.72599499, 6.21158829],
            [5.80930115, 6.67343524, 6.87692947, 7.23485935, 8.05730006, 6.37294796],
            [6.00070159, 7.75584411, 5.92467161, 6.9884158, 7.2335033, 5.95113001],
            [5.153444, 5.68497577, 4.42045184, 4.77968714, 5.97044437, 4.50993921]
        ],
        [
            [2.32707939, 3.61547726, 3.75232525, 2.90203625, 3.73997473, 2.88187773],
            [3.64954332, 5.43223412, 5.20462454, 5.49437324, 6.48186141, 4.31080463],
            [3.7625053, 6.30300828, 5.84347304, 5.60672647, 5.54181105, 4.61338001],
            [2.89207725, 5.8537562, 4.71202168, 5.12839004, 5.34682501, 3.75796255],
            [2.96296613, 5.44270777, 5.42060063, 4.44092447, 5.7959505, 4.43754844],
            [2.00168916, 4.22656935, 3.03418295, 3.21491238, 3.11250819, 2.5136158]
        ]
    ];
    let current_output21 = conv_layer21.transposed_convolve(&test_input21);

    assert!(
        arr_allclose(&current_output21, &target_output21),
        "{:?} was not equal to {:?}",
        current_output21,
        target_output21
    );

    let test_input22 = array![
        [
            [0.96873789, 0.92322345, 0.60917634, 0.94519846, 0.12409528, 0.68128411],
            [0.5716734, 0.501514, 0.22860546, 0.92212159, 0.44406583, 0.1542127],
            [0.16333881, 0.31131621, 0.79715753, 0.0189157, 0.22067957, 0.02669688],
            [0.59391549, 0.28938227, 0.6689486, 0.10160481, 0.6331741, 0.98035881],
            [0.50837393, 0.39784452, 0.23936197, 0.95753935, 0.6997954, 0.06163376],
            [0.68129741, 0.09791846, 0.57890421, 0.49879334, 0.39445239, 0.16723303]
        ],
        [
            [0.60669834, 0.5102383, 0.10125823, 0.66658471, 0.1792789, 0.30907263],
            [0.44471934, 0.20939837, 0.66946925, 0.83692222, 0.66040567, 0.74435736],
            [0.77695976, 0.95433838, 0.68292709, 0.08829409, 0.56812716, 0.00912788],
            [0.10915067, 0.31652548, 0.3737754, 0.55523109, 0.05621141, 0.16548332],
            [0.68468039, 0.25819537, 0.25772731, 0.53556773, 0.74136718, 0.6659698],
            [0.21283952, 0.02755237, 0.02189583, 0.67465586, 0.17141948, 0.78575314]
        ],
        [
            [0.66420489, 0.82216426, 0.99233509, 0.8543546, 0.82711903, 0.75170993],
            [0.58780992, 0.96511392, 0.80625056, 0.06538053, 0.52468611, 0.60359324],
            [0.04742145, 0.78252211, 0.75249715, 0.83350608, 0.48944862, 0.34004327],
            [0.60042203, 0.40922363, 0.3382663, 0.14599253, 0.01791884, 0.7154418],
            [0.7967042, 0.76947507, 0.28149039, 0.67518515, 0.16034362, 0.9039926],
            [0.91630901, 0.60018506, 0.53243699, 0.09806427, 0.00361243, 0.03235233]
        ]
    ];

    let kernel22: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.49200817, 0.36811488, 0.43964379, 0.95787218, 0.37022108, 0.90955856, 0.7056481,
            0.94783514, 0.87095943, 0.0721623, 0.91794165, 0.46591211, 0.15807041, 0.25671939,
            0.88565322, 0.28665671, 0.1975345, 0.48577998, 0.5902187, 0.84412791, 0.30328888,
            0.65129436, 0.38382509, 0.50394199, 0.75988208, 0.23319262, 0.33190217, 0.57713819,
            0.31263726, 0.81753182, 0.80775329, 0.43170337, 0.42844591, 0.03569735, 0.12867417,
            0.97356161, 0.98876944, 0.74182733, 0.59953535, 0.99280038, 0.96741843, 0.37950196,
            0.35676009, 0.78953841, 0.75115924, 0.00821835, 0.81491798, 0.50297242, 0.05695754,
            0.0843627, 0.2776464, 0.21576556, 0.60595792, 0.91037862, 0.96805363, 0.48760958,
            0.98833586, 0.59050095, 0.67825312, 0.46523635, 0.4099195, 0.57748451, 0.61414123,
            0.37167261, 0.79557911, 0.63609418, 0.73902086, 0.55386216, 0.77087413, 0.26668031,
            0.53028961, 0.93095535, 0.55778038, 0.7150617, 0.01458837, 0.59685291, 0.62382998,
            0.84473287, 0.43763179, 0.22782494, 0.40684054, 0.49241365, 0.43284682, 0.69737589,
            0.66302309, 0.5579211, 0.97682999, 0.57523776, 0.43330704, 0.50330183, 0.83868376,
            0.58163696, 0.27874266, 0.90373819, 0.4729931, 0.10366911, 0.93342016, 0.53046708,
            0.99518434, 0.34475809, 0.10565407, 0.22962275, 0.9931405, 0.06514845, 0.53949545,
            0.79688665, 0.87975772, 0.25976427, 0.6619676, 0.08208053, 0.1369592, 0.2905277,
            0.49282862, 0.92351882, 0.19423584, 0.57817717, 0.67066754, 0.8414798, 0.26107649,
            0.85904396, 0.23807348, 0.33510028, 0.17900767, 0.0149483, 0.46468822, 0.08069148,
            0.70345618, 0.53077708, 0.46374871, 0.75979481, 0.90777835, 0.10171497, 0.29441158,
            0.42988262, 0.78537358, 0.40416927, 0.35423821, 0.64398178, 0.19943954, 0.28054147,
            0.51395611, 0.69631606, 0.07927214, 0.92005237, 0.10094948, 0.19631697, 0.99284588,
            0.87525398, 0.34130777, 0.01140268,
        ],
    )
    .unwrap();
    let conv_layer22 = TransposedConvolutionLayer::new(kernel22, 1, Padding::Same);
    let target_output22 = array![
        [
            [
                9.56360871,
                12.4708775,
                14.40796371,
                13.21091461,
                10.49498671,
                7.32701401
            ],
            [
                11.73494383,
                15.42150903,
                18.06156602,
                17.02100326,
                14.48439918,
                8.53106918
            ],
            [
                14.24480962,
                19.17686653,
                20.92628487,
                21.31300235,
                16.35175253,
                11.12579363
            ],
            [
                13.08443737,
                15.97116035,
                18.88955357,
                18.61967792,
                15.1377808,
                11.15640666
            ],
            [
                9.60317017,
                12.4934498,
                15.573365,
                14.05053116,
                10.25563001,
                7.06753147
            ],
            [
                6.40272552,
                9.49128421,
                10.11241378,
                9.78339602,
                7.1351727,
                6.64775925
            ]
        ],
        [
            [
                7.91163618,
                11.04165665,
                12.95397889,
                13.28764762,
                8.98969483,
                6.60647899
            ],
            [
                10.40353435,
                13.64449587,
                15.87021576,
                16.04857575,
                12.65257176,
                8.63132945
            ],
            [
                12.09334687,
                16.00075765,
                20.01347664,
                17.41691511,
                14.84334313,
                10.06327168
            ],
            [
                11.28636094,
                14.41097655,
                16.10608299,
                16.58678292,
                13.39630132,
                8.94322353
            ],
            [
                7.94912771,
                11.76862061,
                14.72053585,
                13.00811694,
                9.63050652,
                6.80367977
            ],
            [5.78809416, 7.54631981, 8.60635291, 8.84618073, 8.45615465, 5.58743199]
        ]
    ];
    let current_output22 = conv_layer22.transposed_convolve(&test_input22);

    assert!(
        arr_allclose(&current_output22, &target_output22),
        "{:?} was not equal to {:?}",
        current_output22,
        target_output22
    );

    let test_input23 = array![
        [
            [0.57378313, 0.39780362, 0.00894329, 0.95121751, 0.26556554, 0.31038957],
            [0.02006488, 0.0167818, 0.80114313, 0.27580709, 0.40361309, 0.64757799],
            [0.21416465, 0.71002182, 0.63564363, 0.39986216, 0.29731516, 0.50205036],
            [0.85981414, 0.85585728, 0.41005794, 0.00723796, 0.78819428, 0.92691984],
            [0.67294292, 0.06005982, 0.28755463, 0.2801387, 0.26798776, 0.36559151],
            [0.53728592, 0.86725212, 0.59903367, 0.21001084, 0.33877702, 0.44548307]
        ],
        [
            [0.03939145, 0.265257, 0.05252068, 0.57450772, 0.27857375, 0.3941208],
            [0.17461439, 0.86797475, 0.67996789, 0.1374418, 0.2982574, 0.83746234],
            [0.44603807, 0.91260526, 0.04259554, 0.82146941, 0.39432474, 0.98196003],
            [0.57031123, 0.05324613, 0.93669968, 0.77452022, 0.88745565, 0.67198618],
            [0.83665968, 0.62275573, 0.4144875, 0.98895594, 0.49827062, 0.00932433],
            [0.11335411, 0.79387136, 0.13115894, 0.84061016, 0.57639501, 0.35614995]
        ],
        [
            [0.77315618, 0.35688343, 0.90272168, 0.35503748, 0.18704538, 0.98550257],
            [0.34441966, 0.84245069, 0.4218309, 0.93672383, 0.70438131, 0.79725463],
            [0.91564776, 0.8028246, 0.49614032, 0.31249228, 0.32670668, 0.07912182],
            [0.14225736, 0.59574166, 0.39076128, 0.50603219, 0.09007599, 0.07867004],
            [0.40808585, 0.34830772, 0.36845306, 0.84361774, 0.21418521, 0.79875923],
            [0.75509873, 0.22608207, 0.76961662, 0.30132967, 0.84672317, 0.39845581]
        ]
    ];

    let kernel23: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.72078145, 0.54225027, 0.7265613, 0.94499791, 0.9388161, 0.20417753, 0.32993179,
            0.29291362, 0.06538389, 0.6309051, 0.78194744, 0.00438614, 0.05666028, 0.39072883,
            0.58886514, 0.6912619, 0.51930905, 0.17292291, 0.51070882, 0.31410695, 0.67367397,
            0.52346776, 0.6583543, 0.50126807, 0.89983841, 0.29600909, 0.98955236, 0.61777542,
            0.87203763, 0.3580352, 0.29113078, 0.47970802, 0.90885916, 0.28738904, 0.49291476,
            0.36322667, 0.06341909, 0.1109254, 0.47537883, 0.80177513, 0.11030616, 0.74675145,
            0.22475419, 0.35865467, 0.94247977, 0.83760769, 0.25179782, 0.9279907, 0.06837399,
            0.96478903, 0.53029258, 0.50301835, 0.62736612, 0.19461104, 0.47048929, 0.35097707,
            0.43067838, 0.89469914, 0.70610127, 0.87260346, 0.54277272, 0.33890912, 0.13253068,
            0.77257076, 0.45061613, 0.00021298, 0.39972393, 0.34546029, 0.80978477, 0.9330243,
            0.64806755, 0.81744423, 0.98913914, 0.51185113, 0.7539409, 0.03361223, 0.16076361,
            0.42308962, 0.56133595, 0.63550864, 0.40730718, 0.79315281, 0.81707261, 0.43318189,
            0.93504876, 0.23084438, 0.68584396, 0.90050021, 0.16225579, 0.08571842, 0.41576298,
            0.07737487, 0.28837257, 0.61380305, 0.47933865, 0.38214803, 0.50832582, 0.74069262,
            0.26731371, 0.66795841, 0.45487658, 0.45981998, 0.85672951, 0.14175496, 0.75072691,
            0.53907277, 0.06353178, 0.45922958, 0.23109665, 0.74539217, 0.31188768, 0.31985107,
            0.76296731, 0.19242898, 0.70321194, 0.43082849, 0.96050779, 0.29373446, 0.59216508,
            0.30148823, 0.7075394, 0.8607001, 0.04281424, 0.70918104, 0.28979701, 0.04958678,
            0.88535485, 0.86111635, 0.18919272, 0.13910359, 0.26363587, 0.19965524, 0.33814349,
            0.29912386, 0.74661126, 0.20746636, 0.39719839, 0.54231991, 0.2512377, 0.73317566,
            0.48384894, 0.02170124, 0.78187356, 0.40785405, 0.87422935, 0.87134858, 0.50870154,
            0.95529995, 0.62473926, 0.35094658,
        ],
    )
    .unwrap();
    let conv_layer23 = TransposedConvolutionLayer::new(kernel23, 1, Padding::Same);
    let target_output23 = array![
        [
            [
                5.90639906,
                7.28255469,
                9.52494292,
                11.40538105,
                7.66096917,
                6.06160172
            ],
            [
                8.4347031,
                11.52593599,
                13.94924835,
                14.88627961,
                11.75842897,
                7.98417799
            ],
            [
                11.12668326,
                13.71264594,
                18.33825629,
                20.33586837,
                13.70565888,
                11.975053
            ],
            [
                11.02408293,
                15.78464671,
                20.21055078,
                19.95169974,
                15.20444644,
                10.97886559
            ],
            [
                9.4773014,
                12.64047034,
                18.27909454,
                15.82230836,
                11.03335933,
                9.09705434
            ],
            [
                7.44760805,
                8.98182471,
                12.75513515,
                12.8081254,
                10.22498962,
                7.13120509
            ]
        ],
        [
            [
                5.05436789,
                7.72756901,
                10.64016635,
                12.21220127,
                8.06243692,
                6.48078095
            ],
            [
                6.53373516,
                10.52549447,
                13.18505861,
                13.19154932,
                11.72512028,
                9.52894379
            ],
            [
                9.53461829,
                14.18275158,
                16.62067854,
                17.2706262,
                14.66323566,
                11.54281749
            ],
            [
                10.72293735,
                14.20064617,
                17.73660541,
                18.58791561,
                15.43112249,
                11.40628712
            ],
            [
                9.77361866,
                12.33120711,
                14.45767581,
                14.33660973,
                11.48745972,
                8.54213056
            ],
            [
                6.97665039,
                9.53182677,
                12.38411775,
                11.81525027,
                9.43507567,
                6.15006438
            ]
        ]
    ];
    let current_output23 = conv_layer23.transposed_convolve(&test_input23);

    assert!(
        arr_allclose(&current_output23, &target_output23),
        "{:?} was not equal to {:?}",
        current_output23,
        target_output23
    );

    let test_input24 = array![
        [
            [0.9096759, 0.59524552, 0.13351307, 0.81332318, 0.42631583, 0.0035931],
            [0.07048251, 0.07519514, 0.18939982, 0.87369786, 0.00128342, 0.8981391],
            [0.97424996, 0.57966325, 0.70005023, 0.0112594, 0.9865017, 0.27214439],
            [0.91399616, 0.07878154, 0.24984076, 0.55183937, 0.35431222, 0.97273962],
            [0.60836137, 0.33572473, 0.52165456, 0.56770298, 0.58089966, 0.43531328],
            [0.82776911, 0.22593151, 0.63039662, 0.8334527, 0.30903128, 0.94089689]
        ],
        [
            [0.13178278, 0.79426322, 0.05114055, 0.594996, 0.27465257, 0.67343453],
            [0.03731679, 0.12771852, 0.940126, 0.83570276, 0.85512392, 0.59624236],
            [0.29097714, 0.39612382, 0.12540146, 0.69585948, 0.21010888, 0.39966926],
            [0.95263644, 0.81748063, 0.53617253, 0.53385807, 0.62478774, 0.27644823],
            [0.89869582, 0.85496159, 0.85087478, 0.89033232, 0.03586937, 0.33968536],
            [0.06124673, 0.23250894, 0.08375615, 0.47954948, 0.91840732, 0.21943197]
        ],
        [
            [0.97475973, 0.84619021, 0.88107623, 0.1246982, 0.47207135, 0.68816301],
            [0.77914886, 0.79642275, 0.9467356, 0.90903929, 0.10962847, 0.48698908],
            [0.55631064, 0.2088539, 0.56366589, 0.5418821, 0.83182922, 0.80361349],
            [0.12046539, 0.72985771, 0.24096293, 0.89423001, 0.34455788, 0.18728091],
            [0.95869121, 0.42046248, 0.83280024, 0.63142445, 0.67809236, 0.05008886],
            [0.17358086, 0.25375138, 0.60347786, 0.15238366, 0.37940994, 0.84772721]
        ]
    ];

    let kernel24: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.61506607, 0.27299849, 0.8665764, 0.15441248, 0.42965399, 0.08137494, 0.95345321,
            0.52348808, 0.34545556, 0.57843513, 0.89669987, 0.24445514, 0.41707171, 0.93946746,
            0.78209147, 0.23775001, 0.385049, 0.36374742, 0.21875483, 0.47269265, 0.95557332,
            0.77991634, 0.8595208, 0.37268019, 0.66964044, 0.18707228, 0.40029572, 0.90977283,
            0.84473495, 0.74008674, 0.11274399, 0.13137567, 0.42235527, 0.4836344, 0.1666113,
            0.16497026, 0.1174771, 0.65497973, 0.9515421, 0.79927913, 0.90327873, 0.39306568,
            0.7766521, 0.16238345, 0.73090769, 0.41990882, 0.96651786, 0.65133097, 0.31202801,
            0.05357829, 0.734736, 0.45420194, 0.65854719, 0.21718248, 0.10660967, 0.20430151,
            0.98762506, 0.22064201, 0.03183809, 0.15887743, 0.42301865, 0.81301942, 0.67026451,
            0.82581934, 0.71007704, 0.28611488, 0.43596106, 0.51239775, 0.99346176, 0.60509657,
            0.6482389, 0.10052492, 0.81494231, 0.15624358, 0.04961722, 0.85466178, 0.98789651,
            0.92365693, 0.40704548, 0.24627322, 0.24340185, 0.03939323, 0.47447433, 0.21890541,
            0.11656966, 0.21967725, 0.02515282, 0.55302792, 0.40577021, 0.40748626, 0.1371414,
            0.67362365, 0.36785348, 0.83786594, 0.19096765, 0.62859952, 0.69250244, 0.09926207,
            0.28515418, 0.41492537, 0.97928363, 0.3445191, 0.53325635, 0.87375446, 0.0385802,
            0.80442204, 0.98545738, 0.62279547, 0.61875291, 0.84817796, 0.72456356, 0.67168518,
            0.5784683, 0.18871792, 0.80384588, 0.60516614, 0.95890114, 0.42417792, 0.1409927,
            0.26719814, 0.68626305, 0.66120477, 0.2230379, 0.32365033, 0.55113969, 0.50525952,
            0.47469518, 0.79047297, 0.3932542, 0.00149018, 0.22568692, 0.2683659, 0.32623609,
            0.26367319, 0.69324692, 0.38359961, 0.72746053, 0.63734019, 0.70937159, 0.64033485,
            0.16753768, 0.72674289, 0.76465585, 0.41193017, 0.79588211, 0.45439622, 0.56811828,
            0.40350484, 0.06510132, 0.80012434,
        ],
    )
    .unwrap();
    let conv_layer24 = TransposedConvolutionLayer::new(kernel24, 1, Padding::Same);
    let target_output24 = array![
        [
            [
                7.24307348,
                9.21853786,
                13.30214604,
                10.43541063,
                9.99425749,
                7.31924815
            ],
            [
                8.88421906,
                13.59190857,
                15.14031185,
                17.34889309,
                11.9354031,
                11.57912424
            ],
            [
                10.90475368,
                16.07381927,
                22.29923995,
                19.47254124,
                15.51531978,
                12.0055139
            ],
            [
                11.10223219,
                15.16334912,
                19.37642497,
                19.98719714,
                15.64490989,
                14.06123842
            ],
            [
                10.34809768,
                13.36408005,
                16.23794766,
                14.53932022,
                13.77821882,
                9.98852846
            ],
            [
                7.92485968,
                10.34850142,
                11.96409658,
                11.45844588,
                9.60084041,
                7.83534767
            ]
        ],
        [
            [
                7.14841113,
                10.36136442,
                12.16818768,
                12.7149642,
                9.67002525,
                6.87039006
            ],
            [
                9.46799328,
                13.77026161,
                16.43128895,
                15.89813803,
                11.2854651,
                9.07464765
            ],
            [
                13.4596564,
                18.38882249,
                20.6375425,
                19.45248328,
                14.45655106,
                10.71253967
            ],
            [
                10.83092995,
                16.82527604,
                20.5507303,
                19.75980971,
                15.78013425,
                12.0621781
            ],
            [
                9.05266551,
                12.40335949,
                14.3231874,
                14.28518274,
                11.77100999,
                9.02946997
            ],
            [
                7.64222727,
                8.81361712,
                10.33422691,
                10.94479443,
                8.03339705,
                6.25667829
            ]
        ]
    ];
    let current_output24 = conv_layer24.transposed_convolve(&test_input24);

    assert!(
        arr_allclose(&current_output24, &target_output24),
        "{:?} was not equal to {:?}",
        current_output24,
        target_output24
    );

    let test_input25 = array![
        [
            [
                0.77948046, 0.93170301, 0.30185182, 0.61924048, 0.31023443, 0.19631852, 0.07390053,
                0.83275717, 0.25700967, 0.65307343, 0.73180196, 0.18586362, 0.8078716, 0.77839164,
                0.7349751
            ],
            [
                0.35845023, 0.43633966, 0.01972343, 0.71083085, 0.4260922, 0.39436828, 0.51863832,
                0.21679399, 0.10449901, 0.22839932, 0.66276419, 0.61925807, 0.206714, 0.60372941,
                0.41963072
            ],
            [
                0.30041472, 0.30532263, 0.9047769, 0.11101993, 0.57444376, 0.4119178, 0.90638079,
                0.40659423, 0.25297422, 0.24030283, 0.56659668, 0.63424051, 0.327252, 0.06076881,
                0.52967036
            ],
            [
                0.87899251, 0.11439145, 0.95893172, 0.73697186, 0.5900436, 0.91111672, 0.28196961,
                0.49504947, 0.7536799, 0.5165421, 0.05161112, 0.85683401, 0.27431211, 0.90104449,
                0.68053509
            ],
            [
                0.87542031, 0.28038404, 0.91167012, 0.39215883, 0.29668351, 0.53383789, 0.50070009,
                0.89529955, 0.98473877, 0.55281355, 0.73485544, 0.58007702, 0.01270174, 0.39543777,
                0.28791699
            ],
            [
                0.78784958, 0.03362276, 0.18134156, 0.68864927, 0.96172424, 0.62161485, 0.38977638,
                0.57814899, 0.54499734, 0.14547525, 0.540897, 0.3162914, 0.82115628, 0.85408371,
                0.09731764
            ],
            [
                0.44356391, 0.81184469, 0.01860107, 0.81715731, 0.65403223, 0.98040395, 0.93617559,
                0.42911106, 0.55974698, 0.45448933, 0.06660813, 0.17935576, 0.31223231, 0.96262072,
                0.45731342
            ],
            [
                0.6785347, 0.32192521, 0.96741144, 0.82334908, 0.41068049, 0.80928464, 0.52558545,
                0.58500673, 0.87130634, 0.38157371, 0.13870009, 0.56868043, 0.59814083, 0.3574539,
                0.94136681
            ],
            [
                0.78846684, 0.39215145, 0.99353662, 0.20177249, 0.91184342, 0.18399727, 0.79315291,
                0.5731924, 0.15304143, 0.69954605, 0.15864603, 0.01925668, 0.64654654, 0.72880518,
                0.87165306
            ],
            [
                0.79250007, 0.86170047, 0.2165383, 0.92450127, 0.06162249, 0.29544892, 0.18815497,
                0.20450825, 0.36479505, 0.20395004, 0.0257373, 0.4699501, 0.32352779, 0.17628226,
                0.75517549
            ]
        ],
        [
            [
                0.58177771, 0.73350389, 0.02051142, 0.85481103, 0.83489869, 0.54642883, 0.83826548,
                0.18735092, 0.48078324, 0.6732103, 0.68837371, 0.52392515, 0.29957301, 0.79630407,
                0.64510677
            ],
            [
                0.45815349, 0.82180861, 0.55192975, 0.97240614, 0.65610654, 0.43312447, 0.50740764,
                0.94788022, 0.63209259, 0.65555931, 0.67052222, 0.41575046, 0.8746799, 0.31176649,
                0.93577436
            ],
            [
                0.18032381, 0.71664887, 0.44238764, 0.19915899, 0.11978984, 0.57909613, 0.27895957,
                0.98695446, 0.72039455, 0.6292799, 0.94756453, 0.01166608, 0.38578872, 0.76447243,
                0.68370639
            ],
            [
                0.20654403, 0.91503917, 0.2062981, 0.84316545, 0.21242656, 0.01205953, 0.9262031,
                0.88646529, 0.52352717, 0.91763991, 0.4291862, 0.05985525, 0.00024094, 0.69274827,
                0.59546298
            ],
            [
                0.77772779, 0.30915392, 0.84452281, 0.94592518, 0.9832551, 0.11121995, 0.68779351,
                0.22960067, 0.61292205, 0.91809969, 0.94702023, 0.3274046, 0.56571293, 0.47996787,
                0.94251623
            ],
            [
                0.70033288, 0.39979418, 0.1532831, 0.81132425, 0.83818549, 0.78514912, 0.43648005,
                0.12495397, 0.54919955, 0.40107633, 0.95021839, 0.80036692, 0.49411505, 0.54618488,
                0.98641369
            ],
            [
                0.67987191, 0.11575048, 0.88862415, 0.1502684, 0.75693698, 0.69985367, 0.88540234,
                0.58753988, 0.54766767, 0.07530271, 0.47854484, 0.35159733, 0.62527738, 0.10202075,
                0.34306986
            ],
            [
                0.77124027, 0.2953802, 0.59345064, 0.0631554, 0.35453771, 0.87512227, 0.91793389,
                0.62673443, 0.52161974, 0.72532278, 0.367339, 0.55982344, 0.89800325, 0.93233983,
                0.11013599
            ],
            [
                0.37744503, 0.22905607, 0.84281208, 0.3367692, 0.0845728, 0.0307896, 0.85245208,
                0.27665535, 0.04007194, 0.05185039, 0.74104067, 0.08161648, 0.20229144, 0.50537779,
                0.37232294
            ],
            [
                0.50409348, 0.17126255, 0.49172163, 0.49374352, 0.89244539, 0.67569478, 0.89285484,
                0.60729242, 0.73902698, 0.32027009, 0.62537155, 0.07189014, 0.72280625, 0.42314525,
                0.62679986
            ]
        ],
        [
            [
                0.4918857, 0.68641432, 0.20318979, 0.58106904, 0.16232036, 0.88596264, 0.86273425,
                0.5007842, 0.97483326, 0.32025232, 0.65470873, 0.76505328, 0.547536, 0.15410115,
                0.28437362
            ],
            [
                0.08146471, 0.04487987, 0.14390907, 0.86931245, 0.64853597, 0.00243695, 0.98901892,
                0.45077147, 0.797346, 0.61402696, 0.812481, 0.50799416, 0.882206, 0.17137862,
                0.45257563
            ],
            [
                0.11896311, 0.0099988, 0.16871951, 0.58499975, 0.57431713, 0.03170383, 0.47689346,
                0.60207048, 0.27565097, 0.72154609, 0.37868198, 0.1862373, 0.97069765, 0.4059111,
                0.85430924
            ],
            [
                0.54251731, 0.74534591, 0.39831475, 0.63505031, 0.19837748, 0.99956813, 0.62044546,
                0.24860584, 0.08589319, 0.4956853, 0.63280644, 0.7516146, 0.66608726, 0.06317678,
                0.74680416
            ],
            [
                0.38840516, 0.23738277, 0.2260869, 0.43724543, 0.35188743, 0.42919477, 0.16846194,
                0.15647871, 0.58770742, 0.61656408, 0.36768009, 0.47391068, 0.80465791, 0.85045826,
                0.81879742
            ],
            [
                0.83058875, 0.37001839, 0.70317753, 0.19160416, 0.17675606, 0.83527125, 0.1693727,
                0.58821732, 0.11069718, 0.99195172, 0.03902764, 0.80868847, 0.25444191, 0.29574174,
                0.66321801
            ],
            [
                0.27567437, 0.45301218, 0.44179404, 0.23022332, 0.30703882, 0.96612921, 0.71897377,
                0.65253569, 0.45338177, 0.43787929, 0.12205274, 0.90195818, 0.53852835, 0.61873161,
                0.68955016
            ],
            [
                0.71160354, 0.2429764, 0.4665585, 0.45732535, 0.81843138, 0.21347605, 0.2425075,
                0.78325398, 0.27865269, 0.86849696, 0.28503794, 0.01219704, 0.54079707, 0.39422444,
                0.15862207
            ],
            [
                0.67054975, 0.63199355, 0.78375039, 0.44444095, 0.6533876, 0.56727204, 0.54298072,
                0.67955002, 0.45691182, 0.4339906, 0.13047415, 0.16629537, 0.17998669, 0.05238211,
                0.89221111
            ],
            [
                0.14670761, 0.16047769, 0.70041592, 0.48388447, 0.96036433, 0.58228344, 0.38652714,
                0.51934111, 0.1170715, 0.370591, 0.94307475, 0.33282564, 0.46358395, 0.48457426,
                0.29540314
            ]
        ]
    ];

    let kernel25: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.3597477, 0.79552316, 0.93867228, 0.74576804, 0.26802925, 0.82117091, 0.87668816,
            0.6174874, 0.89961679, 0.27749308, 0.47996837, 0.71295953, 0.22661544, 0.35529518,
            0.2529621, 0.98182573, 0.86974462, 0.93338445, 0.52813271, 0.95338375, 0.22356904,
            0.21109126, 0.15210753, 0.84811828, 0.01707013, 0.18659416, 0.83736242, 0.90062677,
            0.41175643, 0.87932725, 0.29970514, 0.90173735, 0.27139241, 0.36127891, 0.61516435,
            0.14357715, 0.6835671, 0.87426843, 0.79999288, 0.5905615, 0.72201146, 0.12478102,
            0.3157006, 0.04205429, 0.67278102, 0.67953238, 0.25841942, 0.9202294, 0.6226681,
            0.17438058, 0.53142228, 0.4418243, 0.40290748, 0.21003468,
        ],
    )
    .unwrap();
    let conv_layer25 = TransposedConvolutionLayer::new(kernel25, 1, Padding::Same);
    let target_output25 = array![
        [
            [
                3.03517493, 3.66037427, 5.26234411, 3.77598231, 5.36129787, 4.88446559, 4.50116481,
                4.74172796, 4.41283392, 4.78638075, 4.99608591, 5.53308452, 4.16038412, 4.80379012,
                3.13028719
            ],
            [
                4.41501029, 6.37292732, 9.10669408, 7.08569459, 6.83911337, 7.65028343, 8.11593619,
                8.25261638, 8.55340913, 8.64748663, 7.96296993, 9.52369643, 7.52111758, 8.03367071,
                5.31125092
            ],
            [
                3.74950394, 5.70748216, 7.70248639, 7.7603275, 8.16499008, 7.54918392, 7.61810351,
                7.7992801, 8.67653413, 8.35204635, 8.14330564, 8.51911075, 6.66601846, 8.15457315,
                5.50704058
            ],
            [
                4.04838875, 7.26416983, 7.42669746, 7.75574617, 8.07356449, 7.22983517, 7.30962736,
                8.6002169, 8.88812266, 8.66528919, 8.76490813, 7.70776042, 6.49589159, 7.52185647,
                5.55240295
            ],
            [
                4.56840543, 8.45373997, 7.76222227, 8.11754944, 9.52236469, 8.63661227, 8.00328429,
                8.26498911, 8.25749036, 7.92639881, 8.28180387, 8.04107699, 8.48404718, 8.21326309,
                5.93602956
            ],
            [
                4.04591693, 8.47803973, 6.40020558, 8.19831379, 9.13487074, 9.29505694, 8.57489197,
                8.28163998, 8.12874482, 8.40303443, 7.73048159, 7.70642034, 7.37145159, 8.53372328,
                5.73920852
            ],
            [
                4.62066386, 7.52566081, 6.86718215, 8.56065961, 9.222779, 9.70189238, 9.66516722,
                8.59390522, 7.34602385, 7.08789982, 6.58215525, 7.37710044, 8.76599826, 8.28694549,
                5.56164247
            ],
            [
                4.26304525, 8.60064349, 6.99920489, 8.86211941, 7.69549541, 9.35531408, 9.97422372,
                9.70094862, 7.53583674, 5.82117765, 4.82084, 6.02382699, 6.83637136, 8.50151563,
                6.00599128
            ],
            [
                4.57327746, 9.56359825, 7.09151034, 9.20420101, 7.66695255, 8.08016888, 7.71811044,
                8.19842584, 7.36825461, 6.31726381, 5.45283172, 5.9086677, 5.99641616, 8.33732035,
                5.20415874
            ],
            [
                3.31888504, 6.5952251, 5.80247382, 6.60872684, 5.19857717, 5.90804579, 5.13847601,
                5.42622588, 4.45568711, 4.55417494, 3.15480906, 3.89668554, 3.65780904, 5.34450085,
                3.77522048
            ]
        ],
        [
            [
                3.82496941, 3.83335161, 5.10946805, 5.2914291, 4.86915393, 4.51277762, 4.45984937,
                4.9379015, 4.95993659, 5.80912378, 5.41085768, 5.0993484, 5.12194673, 5.51151463,
                3.10499453
            ],
            [
                5.20349449, 5.55059953, 6.46899014, 6.32379853, 6.57722806, 7.20999077, 7.33970729,
                7.89144575, 6.81074233, 7.80965033, 7.19684747, 7.67238068, 6.7896569, 7.59199652,
                4.23456789
            ],
            [
                4.41507475, 5.98723101, 7.72470603, 6.6689452, 6.62452284, 7.27765826, 8.03339005,
                7.7125155, 7.33730132, 7.44888989, 7.36993635, 6.67055551, 6.53986533, 7.59352424,
                3.74967809
            ],
            [
                4.68296941, 6.71154783, 6.9242091, 7.40409442, 6.08289553, 6.58780784, 7.87712421,
                7.08530418, 8.22276192, 8.46559927, 6.28199231, 6.43171215, 6.64187378, 8.32170572,
                4.89695069
            ],
            [
                5.65876816, 6.80775115, 8.23664236, 7.53581116, 7.90015644, 7.08703838, 6.66459111,
                6.73826328, 8.06979938, 7.81092256, 8.12416649, 6.94660849, 6.84236265, 7.20776196,
                4.58991329
            ],
            [
                4.8974911, 6.29413725, 6.23133837, 7.66520313, 8.62100333, 8.72398702, 7.09985981,
                7.59940043, 7.09263617, 6.57064162, 7.04804027, 6.82924746, 7.74993386, 8.24673484,
                4.19470292
            ],
            [
                4.68284478, 6.96867087, 6.51731861, 6.94859595, 8.9783048, 8.53833758, 8.68355652,
                7.49556836, 6.75203775, 6.18308985, 6.03781234, 6.51034158, 7.25551634, 7.26988803,
                3.72382682
            ],
            [
                5.13740612, 7.85864452, 6.38455055, 7.71621825, 7.30674367, 9.54272722, 8.37305403,
                7.25784135, 6.75544505, 5.12297925, 4.61484034, 5.85455405, 6.69158433, 7.27756241,
                3.72681241
            ],
            [
                4.65576268, 7.49933441, 7.44150001, 7.32270291, 6.99024623, 7.27923919, 7.64823767,
                6.80805037, 5.93313924, 5.62841251, 5.35109608, 5.19024321, 5.97309724, 7.17695325,
                4.00780573
            ],
            [
                3.37726054, 5.44451495, 4.20203596, 5.44239393, 4.17728261, 4.83550237, 4.20298923,
                3.7887862, 3.45977305, 3.00772712, 1.9363892, 3.38927016, 3.37074256, 4.34123951,
                2.71932557
            ]
        ]
    ];
    let current_output25 = conv_layer25.transposed_convolve(&test_input25);

    assert!(
        arr_allclose(&current_output25, &target_output25),
        "{:?} was not equal to {:?}",
        current_output25,
        target_output25
    );

    let test_input26 = array![
        [
            [
                0.37795688, 0.73976185, 0.29152088, 0.16516899, 0.88543129, 0.29453322, 0.24924066,
                0.64985832, 0.31199292, 0.09449384, 0.35053849, 0.49503768, 0.86012281, 0.47424416,
                0.50374683
            ],
            [
                0.14023664, 0.67529226, 0.99348333, 0.40646063, 0.58576419, 0.26051699, 0.43190236,
                0.3524189, 0.20151226, 0.72627814, 0.02336918, 0.99067538, 0.19271493, 0.63491191,
                0.97028645
            ],
            [
                0.80085794, 0.66224891, 0.25438033, 0.61699228, 0.71798668, 0.05094214, 0.8696046,
                0.46318201, 0.36424868, 0.90202272, 0.35879988, 0.85177694, 0.69111154, 0.13240815,
                0.70327077
            ],
            [
                0.57562187, 0.13603642, 0.97879846, 0.42628526, 0.08654373, 0.79104022, 0.11414032,
                0.52094258, 0.37672571, 0.53055809, 0.42280748, 0.02939593, 0.9269707, 0.46382494,
                0.24367186
            ],
            [
                0.03454055, 0.91002734, 0.43184422, 0.06645538, 0.13082687, 0.82700904, 0.24779269,
                0.90801484, 0.62532703, 0.2569422, 0.64241293, 0.60633999, 0.51694712, 0.31174046,
                0.18764913
            ],
            [
                0.77992792, 0.61078004, 0.8457061, 0.01477505, 0.89572598, 0.83663252, 0.33544053,
                0.82364262, 0.14947782, 0.75764845, 0.35848398, 0.27645361, 0.24928959, 0.84879736,
                0.40229415
            ],
            [
                0.4180667, 0.13404034, 0.06558784, 0.03085664, 0.39431461, 0.48906582, 0.0031025,
                0.52604856, 0.11154373, 0.47536329, 0.05275596, 0.49369687, 0.07469026, 0.08895482,
                0.04548356
            ],
            [
                0.60533017, 0.89718826, 0.48850777, 0.36350025, 0.39925044, 0.49241906, 0.0844234,
                0.52778646, 0.80248681, 0.15037163, 0.62884157, 0.64277414, 0.33921771, 0.98352855,
                0.24540759
            ],
            [
                0.78022687, 0.01093329, 0.59993489, 0.29644916, 0.83083511, 0.33316182, 0.91351881,
                0.95643899, 0.58899049, 0.15597685, 0.48510949, 0.86323279, 0.58901381, 0.90591915,
                0.63812808
            ],
            [
                0.58600501, 0.56674846, 0.85589913, 0.6244334, 0.5306959, 0.33156252, 0.78658769,
                0.8094903, 0.33466303, 0.29148756, 0.54605326, 0.21405107, 0.16774107, 0.32707231,
                0.79562058
            ]
        ],
        [
            [
                0.62750609, 0.89953091, 0.10109619, 0.75910299, 0.57118431, 0.5722274, 0.17762062,
                0.98631013, 0.4401673, 0.8446909, 0.85321166, 0.65877382, 0.92638324, 0.56713393,
                0.18707248
            ],
            [
                0.22550605, 0.85762739, 0.17081456, 0.15443878, 0.68514679, 0.7343027, 0.80016197,
                0.87702165, 0.37050524, 0.95259152, 0.01791185, 0.04022788, 0.94819645, 0.18247107,
                0.61226694
            ],
            [
                0.78929411, 0.47345075, 0.45825642, 0.90994351, 0.39965237, 0.98112968, 0.9377779,
                0.44797824, 0.88840214, 0.68153184, 0.81818703, 0.16285369, 0.8437409, 0.56898323,
                0.01979256
            ],
            [
                0.57616321, 0.44407006, 0.26750981, 0.18059246, 0.71612679, 0.9329246, 0.20866849,
                0.5414302, 0.95989268, 0.8042043, 0.84862008, 0.6563523, 0.65558882, 0.79106796,
                0.97036447
            ],
            [
                0.14605666, 0.70265037, 0.17763207, 0.01948182, 0.50926742, 0.32226926, 0.8841952,
                0.11162108, 0.90768203, 0.33781504, 0.18866146, 0.215027, 0.85156431, 0.85556368,
                0.02192051
            ],
            [
                0.14473192, 0.16521506, 0.15874847, 0.15952839, 0.15017168, 0.033431, 0.06685378,
                0.1321782, 0.26025009, 0.08857261, 0.01795984, 0.20759478, 0.5570829, 0.85914622,
                0.46305147
            ],
            [
                0.04267943, 0.12947068, 0.57634248, 0.88225847, 0.21484314, 0.53445198, 0.34005703,
                0.7629966, 0.23896409, 0.2247379, 0.30354246, 0.11336972, 0.89553145, 0.30877561,
                0.00263487
            ],
            [
                0.67948426, 0.87571098, 0.63241164, 0.91973508, 0.55860318, 0.65452889, 0.00942481,
                0.87496081, 0.89108164, 0.01391789, 0.12946972, 0.96581, 0.92361313, 0.51143279,
                0.55520944
            ],
            [
                0.68020292, 0.73177846, 0.66030017, 0.90363447, 0.57833191, 0.98768222, 0.42762559,
                0.46510608, 0.2126677, 0.11585392, 0.78192338, 0.58290756, 0.37158109, 0.72635504,
                0.28860243
            ],
            [
                0.22664766, 0.80771953, 0.79720663, 0.42433542, 0.33046588, 0.50360386, 0.88482266,
                0.02115386, 0.26483329, 0.6145991, 0.03568472, 0.17478029, 0.32506121, 0.20470207,
                0.8852776
            ]
        ],
        [
            [
                0.13831533, 0.47567591, 0.7037309, 0.40850815, 0.12494645, 0.88835902, 0.87996485,
                0.55999575, 0.21339298, 0.78180988, 0.12930349, 0.10274391, 0.11252328, 0.28057011,
                0.23030733
            ],
            [
                0.91341002, 0.23894765, 0.09381517, 0.63682296, 0.91999329, 0.37913527, 0.24169779,
                0.13757731, 0.2003077, 0.17978839, 0.02051936, 0.70604284, 0.51620601, 0.08848825,
                0.61682198
            ],
            [
                0.59445985, 0.30716177, 0.94546497, 0.04403141, 0.09278881, 0.71041265, 0.88155565,
                0.95114681, 0.37324883, 0.78081575, 0.75092649, 0.86777861, 0.97972063, 0.20773627,
                0.92097487
            ],
            [
                0.5542235, 0.0774203, 0.68609905, 0.17041783, 0.38146912, 0.21643132, 0.54004044,
                0.12459709, 0.61065816, 0.97269844, 0.22782128, 0.01601224, 0.07167336, 0.11644867,
                0.07912475
            ],
            [
                0.06837665, 0.28475521, 0.4541781, 0.79337154, 0.02366205, 0.99759455, 0.96243397,
                0.19634301, 0.13901489, 0.96638346, 0.13656646, 0.21054715, 0.9781035, 0.59230281,
                0.32155102
            ],
            [
                0.20603529, 0.36755773, 0.09377635, 0.99647892, 0.68602376, 0.54771584, 0.74572668,
                0.46809427, 0.74540301, 0.76704352, 0.55707131, 0.37034941, 0.16359222, 0.34129493,
                0.93402787
            ],
            [
                0.76973557, 0.04660734, 0.83558243, 0.14450879, 0.59371489, 0.77863053, 0.63499133,
                0.00469752, 0.21350854, 0.8305853, 0.17677877, 0.29164183, 0.81703572, 0.96685802,
                0.00914962
            ],
            [
                0.50467278, 0.38642972, 0.30208894, 0.5049, 0.936565, 0.78432874, 0.38638478,
                0.67018365, 0.31134085, 0.37245492, 0.51684279, 0.19782987, 0.34174147, 0.23697898,
                0.76220805
            ],
            [
                0.66204364, 0.74079989, 0.93850554, 0.63198225, 0.79330113, 0.16897064, 0.77646864,
                0.2792867, 0.8702586, 0.39426564, 0.00268238, 0.66541365, 0.19902446, 0.9754361,
                0.20468039
            ],
            [
                0.35856878, 0.43430239, 0.06737733, 0.19180125, 0.6848106, 0.81364198, 0.4841047,
                0.76538725, 0.32961448, 0.65133747, 0.57655895, 0.64931538, 0.68721704, 0.38200348,
                0.42994823
            ]
        ]
    ];

    let kernel26: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.44826566, 0.24958962, 0.44254749, 0.06080529, 0.58301872, 0.18547981, 0.21089083,
            0.21620868, 0.89585309, 0.05753587, 0.03029133, 0.42973348, 0.90859122, 0.64174662,
            0.72166282, 0.97783841, 0.03201354, 0.78646559, 0.80218788, 0.28006926, 0.39917236,
            0.66574101, 0.49331632, 0.70910794, 0.68068529, 0.34553643, 0.36778807, 0.15987424,
            0.72313746, 0.07239398, 0.71229852, 0.03320818, 0.26927547, 0.87179439, 0.9014395,
            0.1117594, 0.90189727, 0.10556608, 0.37192692, 0.16559757, 0.6948119, 0.44701602,
            0.32377524, 0.25664158, 0.15209688, 0.04241126, 0.40773837, 0.24595652, 0.32552641,
            0.93657025, 0.54885111, 0.49345591, 0.33230531, 0.98101615,
        ],
    )
    .unwrap();
    let conv_layer26 = TransposedConvolutionLayer::new(kernel26, 1, Padding::Same);
    let target_output26 = array![
        [
            [
                2.40164616, 4.04736915, 3.23742307, 3.43709859, 3.88922325, 4.33280264, 3.69530502,
                4.02293845, 3.23575135, 2.8861551, 3.55676695, 2.34238178, 3.8410745, 3.77674865,
                2.14349976
            ],
            [
                4.19547526, 7.07365365, 6.24638709, 5.94052441, 6.20006924, 7.52396913, 7.96436124,
                6.76740209, 7.00483584, 6.92306318, 6.82384737, 6.99077869, 6.74572954, 7.20291139,
                4.20199732
            ],
            [
                4.20769835, 6.22038014, 5.22216707, 5.82170848, 5.57172182, 7.09714615, 6.74127628,
                5.9173026, 7.2697145, 6.69609943, 6.85979153, 5.51331061, 6.39048687, 5.79134814,
                4.69950502
            ],
            [
                3.66378849, 5.75562168, 6.3495407, 4.55153967, 5.8900999, 7.36171725, 7.44145812,
                7.14453004, 7.13271243, 7.4971112, 6.82261813, 5.9569847, 6.83178636, 7.24840403,
                3.9608902
            ],
            [
                2.56751362, 5.13499391, 4.45564045, 5.08860587, 5.72814693, 5.70331512, 6.5070018,
                5.0039471, 7.05442825, 6.62737612, 5.4099087, 4.75662986, 5.49404103, 7.03019623,
                4.78205583
            ],
            [
                2.5698368, 4.17105939, 5.00160768, 5.52318046, 5.80738609, 6.26455354, 6.74530552,
                5.49286942, 5.97880122, 5.51450307, 4.49810337, 4.54466501, 6.6560796, 6.93261415,
                3.76012448
            ],
            [
                3.3372245, 5.41196847, 5.3023678, 6.80760447, 6.33384026, 6.47689581, 5.67878578,
                5.03150223, 6.11494234, 4.98454636, 4.08364297, 4.41883033, 6.48962789, 6.20199891,
                4.92428428
            ],
            [
                3.93183459, 6.78000113, 6.34053563, 7.44131721, 6.70107543, 7.18938288, 6.18551517,
                5.83932961, 5.81323873, 3.89201514, 4.86788889, 5.4333241, 6.90214043, 6.00694625,
                3.88381249
            ],
            [
                4.46769276, 6.76683257, 7.43445904, 7.27595638, 7.20283614, 7.01153427, 7.36936592,
                6.53088675, 5.90286124, 5.58967502, 5.19891505, 5.83744192, 6.65207534, 6.46951036,
                5.2396851
            ],
            [
                2.6716152, 5.03424787, 4.44757966, 4.7891601, 4.38207766, 4.92181607, 4.95189166,
                4.26342763, 3.72298697, 3.33811452, 3.10416669, 3.72283239, 4.21393005, 3.9055807,
                3.6667028
            ]
        ],
        [
            [
                2.72811316, 3.81488847, 4.14300031, 4.43034422, 3.92713337, 5.20145954, 4.48973692,
                3.72390684, 3.92941211, 3.33249972, 3.03795316, 3.80030954, 3.90153025, 4.17548483,
                2.67826786
            ],
            [
                4.09698662, 5.86343373, 5.67675032, 6.1328134, 6.33012997, 6.06383007, 6.21476026,
                6.85738326, 5.76073559, 5.36868698, 6.10646933, 5.19642418, 6.7967782, 4.66709591,
                3.65026024
            ],
            [
                3.96378211, 5.76376488, 5.17594358, 5.57824935, 5.46631461, 6.7969555, 6.28188377,
                6.10222652, 6.12718288, 6.18693134, 6.52259293, 5.54987468, 6.40018429, 6.541025,
                3.3710734
            ],
            [
                3.17199089, 5.2418869, 4.86171617, 5.06625409, 4.42666467, 5.42902834, 6.79477957,
                6.49998643, 6.98274547, 6.53738806, 5.74597638, 6.31659289, 5.94098805, 5.69718003,
                3.50810121
            ],
            [
                2.83464036, 4.39797796, 4.7054276, 4.48525492, 4.62988018, 5.66083828, 6.33887731,
                4.95910057, 5.63237896, 6.24055381, 5.22554128, 4.43495747, 5.55024605, 5.51024123,
                3.7030813
            ],
            [
                2.13338676, 4.42809961, 3.91795153, 5.1629653, 4.9703208, 5.53546099, 6.78834652,
                4.66113323, 5.23967665, 4.20363821, 4.65159428, 4.07421491, 5.08013841, 5.32410739,
                3.9821996
            ],
            [
                3.135522, 4.69323634, 5.35519312, 4.86891983, 5.89219269, 5.33503879, 5.63769657,
                4.6054733, 5.1079657, 4.55835842, 5.01677403, 4.68856366, 5.853836, 5.430784,
                3.53577278
            ],
            [
                4.06418195, 6.11210536, 5.98989208, 6.66230638, 6.74809908, 6.30335792, 5.96731373,
                6.06123966, 4.8846667, 5.25425924, 4.33980316, 5.28343592, 6.97122782, 5.64454997,
                5.30347285
            ],
            [
                4.14438498, 7.34154822, 6.27833114, 6.96429348, 6.28850151, 7.48389029, 6.10970421,
                6.71473858, 6.19330799, 3.97218373, 4.74639118, 5.51860731, 5.38054128, 6.1907482,
                4.28659227
            ],
            [
                2.5176342, 4.51954732, 4.40655067, 4.5807671, 4.3900488, 4.77250289, 4.21994289,
                4.14318123, 3.36882853, 3.74832465, 3.00425971, 3.12928095, 3.59002782, 3.44343908,
                3.1003331
            ]
        ]
    ];
    let current_output26 = conv_layer26.transposed_convolve(&test_input26);

    assert!(
        arr_allclose(&current_output26, &target_output26),
        "{:?} was not equal to {:?}",
        current_output26,
        target_output26
    );

    let test_input27 = array![
        [
            [
                0.82688346, 0.58248128, 0.7544629, 0.74585287, 0.52090971, 0.16575689, 0.44608647,
                0.80342913, 0.03440544, 0.7831754, 0.26010162, 0.40536038, 0.96070998, 0.64246368,
                0.80894354
            ],
            [
                0.02527965, 0.57334673, 0.14951943, 0.63782813, 0.33237478, 0.29261942, 0.23334783,
                0.54639104, 0.37769936, 0.19193114, 0.30370448, 0.2059106, 0.62071285, 0.81840692,
                0.68744313
            ],
            [
                0.52467766, 0.88781664, 0.31891413, 0.5491171, 0.0237066, 0.77914923, 0.88855501,
                0.71280416, 0.75881109, 0.35433735, 0.70162674, 0.22968956, 0.13019671, 0.91856806,
                0.53734204
            ],
            [
                0.76382384, 0.02344197, 0.12567211, 0.1292863, 0.75359905, 0.67722659, 0.42152083,
                0.79158563, 0.95793354, 0.39981195, 0.63437623, 0.49055187, 0.29662893, 0.74175041,
                0.20728986
            ],
            [
                0.47967317, 0.2839333, 0.94481437, 0.15156075, 0.83187238, 0.9782483, 0.24363569,
                0.89796303, 0.99519932, 0.38747676, 0.4652494, 0.16026023, 0.54492412, 0.25081875,
                0.6642706
            ],
            [
                0.1113514, 0.38591126, 0.56433513, 0.47719019, 0.21879651, 0.30729501, 0.22057394,
                0.37933104, 0.68463833, 0.6235146, 0.76046709, 0.62654956, 0.50220083, 0.7923531,
                0.99088559
            ],
            [
                0.42682472, 0.82754997, 0.71401822, 0.43480645, 0.4903477, 0.72713343, 0.96060595,
                0.11285039, 0.480432, 0.83266143, 0.87951493, 0.42723287, 0.66535561, 0.57117723,
                0.16757834
            ],
            [
                0.68018555, 0.66937586, 0.18654909, 0.14417606, 0.27395775, 0.48419528, 0.40319073,
                0.78228083, 0.06646068, 0.6039549, 0.4939349, 0.97071057, 0.22841803, 0.34100582,
                0.76316562
            ],
            [
                0.98362205, 0.12849248, 0.40886245, 0.29058557, 0.6443919, 0.55824791, 0.96385307,
                0.72632263, 0.47670252, 0.81263257, 0.83128826, 0.35596777, 0.20116615, 0.3840827,
                0.1266189
            ],
            [
                0.43126488, 0.81041313, 0.53948317, 0.59545697, 0.24013516, 0.90256735, 0.11772668,
                0.76156531, 0.03378446, 0.1619906, 0.66089564, 0.40856043, 0.51406205, 0.99050555,
                0.06775481
            ]
        ],
        [
            [
                0.39971558, 0.72250972, 0.95678422, 0.84409069, 0.14843525, 0.84027192, 0.14924688,
                0.96973222, 0.92370101, 0.66152495, 0.70252829, 0.97607547, 0.82755572, 0.75655721,
                0.13057262
            ],
            [
                0.65537451, 0.13100509, 0.550075, 0.03573983, 0.94526589, 0.20338611, 0.33698197,
                0.03989459, 0.53521657, 0.52000984, 0.67105421, 0.77762869, 0.01753597, 0.38843844,
                0.9398104
            ],
            [
                0.01065648, 0.34669801, 0.58483019, 0.4035074, 0.62355837, 0.33805928, 0.6767775,
                0.38985527, 0.65302985, 0.31221408, 0.79567073, 0.85889064, 0.07739386, 0.97936596,
                0.0775787
            ],
            [
                0.09888739, 0.47735121, 0.17827183, 0.12922778, 0.42643289, 0.49927197, 0.62646807,
                0.23585345, 0.41761714, 0.09500003, 0.99949082, 0.16705709, 0.49163584, 0.98983411,
                0.74133139
            ],
            [
                0.94691144, 0.1053163, 0.58996094, 0.64045099, 0.91351818, 0.26407223, 0.64379566,
                0.23944081, 0.66479747, 0.52586858, 0.00668735, 0.55749787, 0.80731011, 0.75044195,
                0.23981997
            ],
            [
                0.78645305, 0.17125841, 0.89487276, 0.17804679, 0.30240453, 0.76599663, 0.91765735,
                0.23396461, 0.54762003, 0.18364938, 0.12599571, 0.38194449, 0.68159871, 0.62554402,
                0.70120092
            ],
            [
                0.32246166, 0.71205748, 0.93329558, 0.49071212, 0.84238767, 0.70688616, 0.30376019,
                0.2207995, 0.84144879, 0.83963578, 0.71558489, 0.79340419, 0.47623811, 0.18088572,
                0.78911584
            ],
            [
                0.7005145, 0.29562468, 0.53553076, 0.21978133, 0.83805527, 0.3837122, 0.13018785,
                0.12840837, 0.21173448, 0.18783508, 0.79273001, 0.49953455, 0.21326534, 0.31036261,
                0.93722244
            ],
            [
                0.45619474, 0.8366536, 0.75622759, 0.80820392, 0.33659638, 0.08216117, 0.88946837,
                0.3752628, 0.89359923, 0.39055564, 0.02040852, 0.01812589, 0.46110821, 0.86564598,
                0.93671025
            ],
            [
                0.41400406, 0.35889434, 0.19520377, 0.03328433, 0.51722214, 0.08536235, 0.64397994,
                0.84666075, 0.25180594, 0.04745248, 0.40402666, 0.99938223, 0.41303217, 0.29931079,
                0.51938214
            ]
        ],
        [
            [
                0.55963521, 0.68012908, 0.17374655, 0.25033656, 0.64831854, 0.87417918, 0.96361297,
                0.93363294, 0.24296009, 0.80799608, 0.78451613, 0.1656064, 0.81673899, 0.57701231,
                0.23647762
            ],
            [
                0.35383784, 0.46875703, 0.73632692, 0.13271599, 0.0811053, 0.44705517, 0.95582423,
                0.40865291, 0.41705441, 0.14643014, 0.32334185, 0.72586919, 0.79551175, 0.84256063,
                0.71449273
            ],
            [
                0.66725144, 0.76950282, 0.09751261, 0.82022355, 0.43093319, 0.08507466, 0.33988429,
                0.1262919, 0.4553589, 0.50808977, 0.30726091, 0.86826462, 0.54010042, 0.38545121,
                0.57092791
            ],
            [
                0.4147855, 0.78607483, 0.34907384, 0.50597257, 0.12329532, 0.41619204, 0.9329879,
                0.58009933, 0.29878961, 0.24184026, 0.02598915, 0.2865987, 0.35510611, 0.07561034,
                0.34710955
            ],
            [
                0.33699454, 0.55373834, 0.76567457, 0.6156644, 0.13011694, 0.06010303, 0.60831833,
                0.17862077, 0.33087459, 0.50262781, 0.14146422, 0.64076063, 0.48090568, 0.97895851,
                0.66825564
            ],
            [
                0.20614247, 0.16689018, 0.57478931, 0.04157939, 0.08523397, 0.40889815, 0.66485499,
                0.54764136, 0.40198414, 0.12718133, 0.73480478, 0.34777096, 0.23616308, 0.87368933,
                0.47155297
            ],
            [
                0.88276085, 0.17957127, 0.38464944, 0.45216264, 0.21904909, 0.37326433, 0.19080913,
                0.16157833, 0.56050253, 0.5951232, 0.07219929, 0.87486496, 0.35757763, 0.79269676,
                0.37903344
            ],
            [
                0.50261425, 0.17502521, 0.46825428, 0.14853953, 0.22394064, 0.59830895, 0.23588572,
                0.28434729, 0.50368541, 0.03650436, 0.90267636, 0.39498105, 0.43872164, 0.55697273,
                0.05620179
            ],
            [
                0.84519896, 0.62749291, 0.75034188, 0.4519843, 0.40451953, 0.68011113, 0.42570132,
                0.29756952, 0.73516599, 0.12862578, 0.8068416, 0.18190542, 0.73744015, 0.81609922,
                0.19002475
            ],
            [
                0.53768361, 0.00046573, 0.5981654, 0.86440441, 0.4253033, 0.54187085, 0.4271245,
                0.5590328, 0.07657996, 0.79591682, 0.2706652, 0.90806613, 0.28685412, 0.45481335,
                0.14749219
            ]
        ]
    ];

    let kernel27: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.69113795, 0.04432987, 0.84585464, 0.65820251, 0.56923281, 0.54193173, 0.6127437,
            0.09859947, 0.06338396, 0.99002818, 0.72849322, 0.98708489, 0.46884269, 0.90038789,
            0.32614702, 0.97481602, 0.00522763, 0.26788389, 0.2118759, 0.44928705, 0.47922688,
            0.64054423, 0.51471545, 0.90980008, 0.57766383, 0.88734118, 0.81692209, 0.36663311,
            0.93593421, 0.13942754, 0.58514822, 0.62612599, 0.54658961, 0.00545988, 0.07321159,
            0.24611687, 0.56017263, 0.67574926, 0.83052649, 0.59747244, 0.20322645, 0.20985058,
            0.90631443, 0.42977262, 0.99401653, 0.55413437, 0.28697443, 0.7165074, 0.27121915,
            0.50980794, 0.21154375, 0.00298325, 0.85546516, 0.62107428,
        ],
    )
    .unwrap();
    let conv_layer27 = TransposedConvolutionLayer::new(kernel27, 1, Padding::Same);
    let target_output27 = array![
        [
            [
                3.15221329, 5.12266044, 4.88763586, 4.7270122, 3.79074395, 4.933438, 4.90560716,
                6.03744919, 4.82365263, 4.95771397, 5.28221443, 5.53969724, 6.1018444, 6.07931182,
                3.99668098
            ],
            [
                5.63513999, 7.97349565, 7.62144373, 6.7483669, 7.09071557, 7.0761044, 8.67412917,
                8.93889054, 7.74709298, 8.23076596, 8.39299312, 8.2383321, 9.30128582, 8.3957843,
                6.34249057
            ],
            [
                4.14779197, 6.49401624, 5.88855571, 6.24886418, 5.60593072, 6.82937989, 7.27249676,
                8.09285864, 6.28314147, 7.02724889, 6.97092239, 7.14393849, 8.29722418, 9.13228699,
                5.4500836
            ],
            [
                5.18947922, 7.75509133, 6.78185085, 7.34458592, 7.45655765, 8.05867632, 7.09859498,
                8.32555544, 6.96778329, 7.0752219, 6.93860631, 5.77576602, 8.53606522, 8.2280886,
                5.00939404
            ],
            [
                4.37415941, 6.24821085, 6.60154291, 6.99021333, 6.45902159, 6.87740135, 7.23807557,
                8.64344339, 6.65346792, 6.42653072, 5.74038834, 6.63883386, 8.57495436, 8.58103483,
                5.76220992
            ],
            [
                4.89184405, 8.17112661, 8.07542739, 8.24896839, 7.09457221, 7.66098883, 6.86124152,
                7.56361415, 7.22501276, 7.37958014, 7.41333902, 8.21775258, 8.55065313, 8.55144866,
                6.06490332
            ],
            [
                4.59407845, 8.19478376, 6.01788952, 5.96288219, 5.87691896, 6.65665439, 6.18215697,
                6.02303663, 6.45584016, 7.19440667, 8.27304855, 7.95795334, 7.67146983, 8.4211656,
                5.69885503
            ],
            [
                6.68157238, 8.85566605, 7.24335512, 7.42935547, 7.18194284, 7.4167639, 6.10493796,
                7.34249657, 7.22114194, 8.61036474, 7.56925594, 7.32542924, 6.782432, 7.80421953,
                5.45679136
            ],
            [
                6.03695152, 7.4487834, 6.3589762, 6.87615199, 5.9848749, 6.674932, 7.7746958,
                6.36038539, 5.89549115, 6.38893812, 7.05050464, 7.52940064, 7.63451366, 8.24765446,
                4.65399646
            ],
            [
                3.87864546, 4.98165809, 4.46786426, 4.72227729, 4.30327468, 5.24640072, 5.27878679,
                5.16835569, 4.0031006, 3.72735849, 4.61450036, 4.42011612, 4.80651993, 4.91688829,
                2.55486815
            ]
        ],
        [
            [
                3.15852757, 4.87893173, 4.09722327, 3.78356676, 3.57865309, 4.24838516, 4.83067019,
                4.25667188, 4.15636594, 4.20490426, 4.87738554, 5.29245519, 5.33710885, 5.02364903,
                3.03597222
            ],
            [
                4.35237259, 5.96878692, 6.42326502, 6.78123102, 5.5318284, 5.82044548, 7.21016954,
                7.21565885, 6.6824158, 6.74491355, 6.87638867, 7.18212085, 8.36417909, 7.68339638,
                5.13081914
            ],
            [
                4.03782369, 5.62338905, 4.50160949, 5.1208177, 5.06792712, 7.21193191, 5.53874067,
                6.77927476, 4.69935819, 6.06075572, 6.11858471, 5.74424255, 7.54646843, 7.1321861,
                4.85585374
            ],
            [
                4.08092847, 5.52119241, 5.8509865, 5.95640273, 6.13172759, 6.87121472, 5.84707714,
                8.00132341, 5.96950808, 6.17781485, 5.76181962, 5.33867528, 7.56771313, 6.16240456,
                4.26918647
            ],
            [
                3.57019215, 6.06748568, 5.50551667, 5.63677564, 5.77068303, 6.58298277, 6.2145054,
                7.72348187, 5.33705318, 5.55805443, 4.60341546, 5.63201483, 6.59842365, 7.60005568,
                5.23994208
            ],
            [
                3.399075, 7.16853912, 6.3815907, 6.61147125, 5.60800449, 6.93767867, 5.12060017,
                6.73525041, 6.50269791, 6.52171409, 7.0293444, 6.34795961, 7.66100627, 7.45162064,
                4.88980556
            ],
            [
                4.13605271, 7.42558667, 4.53878636, 5.9488022, 5.62429539, 6.41351981, 5.16857145,
                5.48565193, 4.85761854, 7.09970273, 6.55292608, 6.56965788, 6.62081375, 6.47985551,
                4.71073954
            ],
            [
                4.96496666, 6.9398892, 6.06402705, 6.55993061, 5.94580519, 5.99028023, 6.0012098,
                5.88977591, 5.49018539, 7.3690942, 7.16455491, 5.88033295, 6.18674542, 6.7962907,
                3.95622535
            ],
            [
                4.23851046, 6.82417568, 5.47577822, 5.83804232, 5.02051385, 6.55885909, 5.98395013,
                6.08111619, 4.82690613, 6.2021581, 5.45011026, 6.534963, 6.23020066, 5.97461878,
                3.49687338
            ],
            [
                3.60397627, 4.88028226, 4.55373664, 4.55332495, 4.62499341, 4.51914173, 4.50513804,
                5.06825984, 3.2913391, 4.3887653, 4.15781021, 4.12020824, 4.98667011, 4.29199641,
                2.58122717
            ]
        ]
    ];
    let current_output27 = conv_layer27.transposed_convolve(&test_input27);

    assert!(
        arr_allclose(&current_output27, &target_output27),
        "{:?} was not equal to {:?}",
        current_output27,
        target_output27
    );

    let test_input28 = array![
        [
            [
                0.92360243, 0.43601506, 0.4338689, 0.15406101, 0.43424634, 0.63299855, 0.15012271,
                0.82394349, 0.10845271, 0.38491207, 0.46830685, 0.91309983, 0.73020746, 0.58451165,
                0.99682123
            ],
            [
                0.38483648, 0.61052533, 0.99304038, 0.39893616, 0.52141627, 0.14956462, 0.61849579,
                0.06813567, 0.8222107, 0.65235689, 0.32278819, 0.84579415, 0.18556746, 0.95414526,
                0.20767286
            ],
            [
                0.15578296, 0.15946276, 0.46103274, 0.73575512, 0.81041631, 0.02958763, 0.35078364,
                0.17020473, 0.86231123, 0.86052556, 0.87824449, 0.95700806, 0.53297185, 0.35722273,
                0.55112061
            ],
            [
                0.61254827, 0.79677792, 0.76791281, 0.1915737, 0.76241244, 0.97710235, 0.81840342,
                0.18577827, 0.08516511, 0.66965114, 0.2010773, 0.53281648, 0.40985717, 0.67425021,
                0.86758147
            ],
            [
                0.30551153, 0.57150463, 0.62356933, 0.96995336, 0.02986461, 0.93990298, 0.13516724,
                0.01436975, 0.71162206, 0.12800713, 0.51341276, 0.32029891, 0.55969508, 0.41986146,
                0.93841957
            ],
            [
                0.98371145, 0.13532161, 0.45188781, 0.00924854, 0.16833771, 0.87602216, 0.99867051,
                0.19169662, 0.67791865, 0.00443609, 0.3774687, 0.95066234, 0.70944679, 0.58767782,
                0.03172767
            ],
            [
                0.6285938, 0.98233835, 0.03557209, 0.83148056, 0.75442625, 0.38569495, 0.25909921,
                0.95153044, 0.81172662, 0.88158227, 0.07801159, 0.58134909, 0.77661828, 0.24579029,
                0.36638219
            ],
            [
                0.59304502, 0.11644165, 0.88262138, 0.38765801, 0.77495797, 0.25623823, 0.58456335,
                0.81630517, 0.49439427, 0.41682283, 0.16960712, 0.37704077, 0.22635966, 0.20513158,
                0.84864706
            ],
            [
                0.66104415, 0.89163844, 0.32323684, 0.04870174, 0.49266649, 0.03915601, 0.8964746,
                0.69952844, 0.53271312, 0.7900404, 0.59835907, 0.6082029, 0.94017503, 0.05741822,
                0.42909053
            ],
            [
                0.67005054, 0.28204503, 0.85819335, 0.0209764, 0.20048926, 0.01390582, 0.46196642,
                0.15762445, 0.49961701, 0.17955705, 0.50539068, 0.08512774, 0.7657655, 0.89461754,
                0.46455797
            ]
        ],
        [
            [
                0.41900118, 0.94264817, 0.06247951, 0.93805775, 0.67081356, 0.72960073, 0.99668363,
                0.13935266, 0.88149269, 0.71436094, 0.46699954, 0.70369419, 0.86109163, 0.5170714,
                0.10468922
            ],
            [
                0.10358261, 0.68282386, 0.09809778, 0.36897844, 0.10924568, 0.66690347, 0.99931854,
                0.45706579, 0.0053557, 0.63773349, 0.38177421, 0.78964703, 0.22144185, 0.25461559,
                0.29020689
            ],
            [
                0.02204337, 0.01328651, 0.20315679, 0.89128756, 0.7233385, 0.61033539, 0.64626336,
                0.43063964, 0.89974196, 0.81109744, 0.77374251, 0.5617421, 0.13211827, 0.71818852,
                0.7370741
            ],
            [
                0.76509212, 0.25061273, 0.52416607, 0.59124335, 0.749399, 0.06644251, 0.86116066,
                0.87452862, 0.37337268, 0.32470487, 0.86293371, 0.32300462, 0.59494465, 0.5109057,
                0.19303699
            ],
            [
                0.53840572, 0.34216975, 0.10760719, 0.19907883, 0.89787819, 0.40345181, 0.59778985,
                0.5956558, 0.87140828, 0.81677199, 0.93678799, 0.75164976, 0.75292013, 0.35624229,
                0.6503287
            ],
            [
                0.44359318, 0.45867691, 0.73844459, 0.32330677, 0.07823597, 0.57146207, 0.4948407,
                0.1610259, 0.02523749, 0.64902901, 0.82702765, 0.61491889, 0.93847485, 0.64382324,
                0.49198729
            ],
            [
                0.91097988, 0.00277769, 0.29285987, 0.16027041, 0.65083205, 0.99576299, 0.97108684,
                0.39584368, 0.51881031, 0.08690484, 0.60646334, 0.56343193, 0.91129237, 0.30895234,
                0.46832309
            ],
            [
                0.70290803, 0.71988061, 0.6040845, 0.39307591, 0.50462973, 0.23936176, 0.66654719,
                0.28772652, 0.79279533, 0.13527313, 0.58754167, 0.21439199, 0.30696237, 0.61960513,
                0.04181933
            ],
            [
                0.73775754, 0.02812541, 0.98431387, 0.90633452, 0.42185846, 0.92761085, 0.15007966,
                0.55021776, 0.289677, 0.1833292, 0.30842447, 0.49076863, 0.96669616, 0.04084129,
                0.35507885
            ],
            [
                0.01814007, 0.7479788, 0.89054232, 0.18131162, 0.19868158, 0.040903, 0.65749748,
                0.57093875, 0.31510695, 0.64917907, 0.25859907, 0.2167227, 0.60372491, 0.85155627,
                0.59342479
            ]
        ],
        [
            [
                0.45086634, 0.77940007, 0.87364648, 0.59892529, 0.82868867, 0.15409156, 0.50362887,
                0.28591669, 0.61360739, 0.2652203, 0.97139078, 0.79893598, 0.64536715, 0.29538261,
                0.10122196
            ],
            [
                0.60875168, 0.30008333, 0.14871118, 0.00413612, 0.2107808, 0.5432134, 0.02036078,
                0.69118627, 0.96890045, 0.35667476, 0.91332982, 0.07994127, 0.48464362, 0.53717007,
                0.83916715
            ],
            [
                0.03976207, 0.36710664, 0.94632589, 0.85345725, 0.56128335, 0.64364484, 0.3926361,
                0.41704729, 0.47033503, 0.70935533, 0.57946534, 0.76140451, 0.20673601, 0.02936963,
                0.43874254
            ],
            [
                0.81053117, 0.74795406, 0.50848794, 0.43798094, 0.13376763, 0.41153214, 0.82740403,
                0.39059167, 0.07979204, 0.61979954, 0.50408398, 0.62902388, 0.32398036, 0.39374669,
                0.89219906
            ],
            [
                0.23442266, 0.66439507, 0.85124666, 0.49032412, 0.96387126, 0.1122576, 0.32035058,
                0.35236392, 0.65337421, 0.18329354, 0.32617879, 0.60637839, 0.76755867, 0.44953195,
                0.68041481
            ],
            [
                0.86294836, 0.72663987, 0.22153868, 0.86824974, 0.52593288, 0.84534546, 0.18415472,
                0.34274704, 0.04164672, 0.45520981, 0.10496355, 0.2327848, 0.35637232, 0.46164096,
                0.58657899
            ],
            [
                0.37128884, 0.59741094, 0.41323514, 0.44130583, 0.73764908, 0.71878198, 0.95671585,
                0.1044322, 0.16972985, 0.35110535, 0.49803264, 0.034162, 0.13330385, 0.8390908,
                0.52084948
            ],
            [
                0.09820733, 0.9408774, 0.66711492, 0.55581394, 0.89639057, 0.73756531, 0.14148175,
                0.94796797, 0.01578032, 0.71088841, 0.09141636, 0.61776313, 0.96225776, 0.78956375,
                0.43049823
            ],
            [
                0.26723672, 0.21532028, 0.80645573, 0.26337162, 0.94534794, 0.14602911, 0.14453587,
                0.08474473, 0.40467848, 0.26673343, 0.65234366, 0.45077805, 0.87205951, 0.36576106,
                0.04412812
            ],
            [
                0.90619169, 0.52903136, 0.78883399, 0.542214, 0.9633163, 0.66593822, 0.71387596,
                0.24455306, 0.68463976, 0.86825637, 0.36915916, 0.58109006, 0.78367648, 0.74148058,
                0.29041968
            ]
        ]
    ];

    let kernel28: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.27071622, 0.3096645, 0.43780545, 0.28946808, 0.04104009, 0.95437836, 0.14940617,
            0.26448897, 0.28370051, 0.73703936, 0.20896952, 0.57508225, 0.37947781, 0.86406438,
            0.94915072, 0.64203796, 0.35661011, 0.73098282, 0.7336554, 0.86937772, 0.9386434,
            0.62070508, 0.97770918, 0.83098184, 0.73339999, 0.65373802, 0.87296558, 0.24981211,
            0.72182436, 0.35535764, 0.34826712, 0.58369778, 0.16817525, 0.37823163, 0.13544826,
            0.943128, 0.68938486, 0.17785989, 0.67452256, 0.40073132, 0.6776065, 0.66042069,
            0.68244997, 0.83328646, 0.53185765, 0.95012034, 0.71586762, 0.08795565, 0.85794658,
            0.62507999, 0.086858, 0.74366428, 0.69963003, 0.28912175, 0.69418098, 0.3045057,
            0.37725106, 0.21402417, 0.99095802, 0.94444691, 0.96419754, 0.78544171, 0.29067732,
            0.27387304, 0.49124829, 0.93768968, 0.05329061, 0.58051914, 0.13008866, 0.43624557,
            0.31007829, 0.2068124, 0.87948582, 0.39172128, 0.79164041, 0.00728843, 0.56209843,
            0.21866381, 0.07425721, 0.68860992, 0.60878292, 0.25238475, 0.34377145, 0.2867535,
            0.4734937, 0.40107102, 0.2429393, 0.94011342, 0.51804712, 0.88465524, 0.62620818,
            0.56404786, 0.6939464, 0.39654461, 0.26370256, 0.2780351, 0.00836088, 0.14558306,
            0.26807053, 0.47943611, 0.96500632, 0.34639998, 0.74213489, 0.14086223, 0.94934594,
            0.8577047, 0.88866834, 0.54098139, 0.78483558, 0.66801328, 0.05912417, 0.0251855,
            0.02245575, 0.89104522, 0.95775902, 0.25694834, 0.80633349, 0.57868783, 0.81568537,
            0.32308508, 0.60503381, 0.66641554, 0.10564744, 0.49661636, 0.78163574, 0.28800975,
            0.50745852, 0.01879729, 0.66064976, 0.07793587, 0.32657917, 0.85818806, 0.51340289,
            0.67864981, 0.88531659, 0.5262063, 0.61533437, 0.96728046, 0.74938798, 0.08317636,
            0.08443606, 0.05819454, 0.90168471, 0.142612, 0.00963548, 0.59426773, 0.54289368,
            0.15533587, 0.20150587, 0.71967247,
        ],
    )
    .unwrap();
    let conv_layer28 = TransposedConvolutionLayer::new(kernel28, 1, Padding::Same);
    let target_output28 = array![
        [
            [
                4.39119782,
                7.02855729,
                10.86295847,
                11.60421588,
                12.33040761,
                12.29798953,
                12.21032423,
                11.92579565,
                13.07089295,
                13.49133353,
                14.12734718,
                13.45092091,
                13.13893789,
                10.85438112,
                7.29157582
            ],
            [
                8.75651196,
                12.93418078,
                16.94184687,
                16.62755127,
                16.77861352,
                15.85587988,
                17.55327139,
                17.16851677,
                17.3205525,
                17.08885405,
                18.61763893,
                17.97685274,
                17.54434815,
                13.73685653,
                11.30414101
            ],
            [
                11.02411903,
                15.1849229,
                19.99002736,
                19.66811203,
                22.65922184,
                19.98234244,
                20.92267086,
                20.86442689,
                20.53907113,
                22.27268048,
                22.3310527,
                22.89320636,
                23.0577303,
                19.55180501,
                14.16186348
            ],
            [
                9.45594425,
                15.09554396,
                19.23581116,
                19.727846,
                20.94726669,
                19.08308875,
                19.23896097,
                21.40785338,
                21.14952214,
                20.18350565,
                22.79072272,
                22.19307097,
                23.04442264,
                18.3553788,
                14.53646767
            ],
            [
                11.76011673,
                14.81623823,
                20.63130642,
                20.66373108,
                22.01562032,
                22.6195095,
                21.59759008,
                19.88448552,
                20.24362836,
                19.66949566,
                22.33963496,
                21.10205154,
                20.90080175,
                18.80581208,
                14.6932107
            ],
            [
                11.28947946,
                17.40899382,
                21.99031237,
                21.68786761,
                21.8845248,
                21.75636588,
                22.06926462,
                19.88898443,
                19.99294694,
                17.73095884,
                19.65845901,
                18.86800362,
                20.52693644,
                19.43680747,
                14.47262769
            ],
            [
                12.50158235,
                15.75248425,
                22.54589288,
                21.49742787,
                20.72785235,
                20.50744571,
                19.4515459,
                19.08445557,
                18.03256096,
                17.90503214,
                19.77177026,
                20.93403745,
                20.72304358,
                18.3198367,
                13.89953222
            ],
            [
                12.51966792,
                16.81991131,
                21.66456068,
                20.6836334,
                21.12249463,
                20.10746668,
                19.37154212,
                19.41715076,
                18.42474533,
                18.60486153,
                18.53257182,
                19.45752027,
                20.83245298,
                17.62730889,
                14.70898014
            ],
            [
                11.07636782,
                12.15721455,
                17.28228788,
                16.48828145,
                17.23998333,
                13.9173041,
                16.51227376,
                14.24091002,
                16.87200663,
                14.07582692,
                14.62337018,
                15.28351553,
                15.19184969,
                12.85566568,
                10.4444469
            ],
            [
                7.31954685,
                10.08929429,
                13.60039706,
                13.72103807,
                12.6117774,
                10.31747868,
                11.80582891,
                11.24882348,
                11.2417358,
                10.8292908,
                12.04004282,
                12.01276253,
                10.94525976,
                9.76826344,
                9.22686969
            ]
        ],
        [
            [
                5.47323361,
                7.59299296,
                10.31675912,
                9.71463807,
                10.56000688,
                10.00388956,
                9.34517486,
                11.92878434,
                10.6852068,
                11.4832517,
                12.00773583,
                11.83083908,
                11.9607227,
                8.4595656,
                5.32438621
            ],
            [
                8.73998476,
                12.11036607,
                14.70625978,
                12.73571428,
                14.501717,
                14.96142366,
                13.55531096,
                14.0066389,
                15.79902387,
                16.28330387,
                15.49406799,
                14.64311433,
                13.99360225,
                11.41089897,
                8.05913163
            ],
            [
                9.8551761,
                13.41500649,
                18.12305578,
                19.03198579,
                18.40222915,
                18.77586658,
                18.64795854,
                18.01446508,
                19.12441528,
                20.24671679,
                20.55999692,
                20.07046067,
                19.69493702,
                14.94685484,
                10.87811204
            ],
            [
                10.58813038,
                14.99225218,
                16.47745591,
                17.46467988,
                17.66680777,
                17.29063187,
                17.49170688,
                17.93885062,
                17.27316406,
                19.50048073,
                18.80451598,
                19.96164429,
                17.86835151,
                15.5354229,
                10.74476339
            ],
            [
                9.81016521,
                14.42364712,
                18.05855373,
                19.56772661,
                19.97976406,
                18.44313494,
                18.17476536,
                17.29530443,
                18.96126709,
                18.47638094,
                18.16128704,
                19.0164698,
                18.54610305,
                16.32744432,
                10.98579991
            ],
            [
                12.63056985,
                15.8050803,
                18.08886735,
                17.84698837,
                19.84640134,
                19.39101632,
                18.84748389,
                16.94548148,
                17.21983454,
                16.62000361,
                16.41478889,
                17.83994444,
                18.08015069,
                15.79009109,
                10.39421048
            ],
            [
                12.08127154,
                16.8848243,
                17.7538108,
                19.5144506,
                18.10585209,
                18.0531633,
                17.73560774,
                16.81282445,
                15.25638903,
                16.70356797,
                18.21753026,
                18.0500942,
                18.48771095,
                15.08880847,
                11.31066567
            ],
            [
                12.60245201,
                14.78594412,
                17.7424493,
                16.85085791,
                19.85412099,
                17.49559794,
                17.10366936,
                16.43859017,
                16.27709351,
                14.93090019,
                15.93074459,
                18.76356229,
                18.02039529,
                15.41374465,
                10.65490902
            ],
            [
                10.87254271,
                13.39569393,
                14.84032925,
                16.28324123,
                15.25546057,
                14.6313348,
                13.91308317,
                14.27885629,
                14.3829337,
                13.31213105,
                14.22128004,
                15.0586933,
                15.11427288,
                11.39593313,
                7.67204968
            ],
            [
                9.27116247,
                10.03617511,
                12.41924035,
                11.46061264,
                11.77512229,
                9.57910072,
                11.12960311,
                9.45060582,
                10.22207101,
                9.31609796,
                10.13880385,
                11.04197351,
                10.8380052,
                9.0879179,
                6.52746586
            ]
        ]
    ];
    let current_output28 = conv_layer28.transposed_convolve(&test_input28);

    assert!(
        arr_allclose(&current_output28, &target_output28),
        "{:?} was not equal to {:?}",
        current_output28,
        target_output28
    );

    let test_input29 = array![
        [
            [
                0.72830146, 0.12628911, 0.21088025, 0.49349033, 0.43138953, 0.34552415, 0.74509539,
                0.97053166, 0.46846383, 0.62323279, 0.70434835, 0.6836244, 0.31152936, 0.94308263,
                0.43000143
            ],
            [
                0.33454095, 0.14056973, 0.61140502, 0.27392065, 0.43273309, 0.64145634, 0.89486119,
                0.67937463, 0.02869601, 0.42724634, 0.35241677, 0.04600743, 0.78698757, 0.54485179,
                0.3284605
            ],
            [
                0.49451344, 0.21562184, 0.44458547, 0.25720898, 0.1242256, 0.64278252, 0.34415206,
                0.61284912, 0.37608313, 0.14403661, 0.38643095, 0.41014571, 0.32212971, 0.34485013,
                0.33282576
            ],
            [
                0.0460793, 0.25332452, 0.44446904, 0.64195253, 0.50148189, 0.40299275, 0.30419076,
                0.22077623, 0.93352778, 0.37332575, 0.11432823, 0.67092516, 0.67013307, 0.22819203,
                0.02291649
            ],
            [
                0.15169823, 0.47379535, 0.51348475, 0.99575152, 0.18616559, 0.34876946, 0.04149048,
                0.9083124, 0.26675963, 0.46418854, 0.40885165, 0.53293742, 0.01732482, 0.93910902,
                0.81244464
            ],
            [
                0.78512515, 0.71074297, 0.71019448, 0.79231338, 0.9993663, 0.54635275, 0.85271941,
                0.34598657, 0.32072913, 0.14892793, 0.54386401, 0.33485237, 0.79446355, 0.57385169,
                0.11753287
            ],
            [
                0.48184918, 0.27829846, 0.26945495, 0.00687684, 0.32211359, 0.40955108, 0.74533988,
                0.10542034, 0.10177517, 0.1964794, 0.6590129, 0.54292526, 0.58120901, 0.97207652,
                0.38797416
            ],
            [
                0.77053129, 0.03351595, 0.11553944, 0.28048759, 0.69780876, 0.41498303, 0.54379225,
                0.63825153, 0.48976401, 0.5235754, 0.51193646, 0.07972992, 0.77662808, 0.24890616,
                0.43797859
            ],
            [
                0.8254111, 0.78517931, 0.41174976, 0.71481775, 0.57449398, 0.60719815, 0.0409529,
                0.53773463, 0.93606211, 0.33819309, 0.35035085, 0.09973032, 0.29451315, 0.36838105,
                0.29073937
            ],
            [
                0.92917357, 0.66205224, 0.74917738, 0.39614667, 0.86199472, 0.31398644, 0.83245674,
                0.91986791, 0.50500654, 0.86213193, 0.15356343, 0.46905826, 0.20415573, 0.76482031,
                0.07480988
            ]
        ],
        [
            [
                0.4810423, 0.34039716, 0.97821962, 0.63296364, 0.83252402, 0.19085021, 0.40025954,
                0.0326517, 0.81868348, 0.73258343, 0.41122816, 0.6526222, 0.36910674, 0.7136264,
                0.25965686
            ],
            [
                0.53819304, 0.11709321, 0.58894733, 0.6138686, 0.28326781, 0.66539231, 0.41513366,
                0.42952411, 0.09743365, 0.58706857, 0.93710643, 0.49820793, 0.66467032, 0.84335975,
                0.44126457
            ],
            [
                0.62379098, 0.79868735, 0.99410169, 0.76568321, 0.43892093, 0.58856748, 0.61389092,
                0.41979283, 0.55150396, 0.73826284, 0.42829567, 0.87643567, 0.77321034, 0.16042677,
                0.45909578
            ],
            [
                0.15327883, 0.56448136, 0.09073992, 0.32729541, 0.85383408, 0.82137699, 0.61525808,
                0.01471354, 0.19805598, 0.9826014, 0.69645983, 0.15713291, 0.30370896, 0.06043342,
                0.89258994
            ],
            [
                0.04033276, 0.90393057, 0.15386185, 0.96156891, 0.6203435, 0.7905859, 0.88237697,
                0.32635626, 0.29856467, 0.54563109, 0.47385227, 0.00915442, 0.53801313, 0.71369444,
                0.14149519
            ],
            [
                0.65815046, 0.87843838, 0.91552661, 0.71971808, 0.14472856, 0.09964891, 0.50462041,
                0.97068754, 0.56878077, 0.63791183, 0.76876046, 0.45858192, 0.84355894, 0.91463454,
                0.90978505
            ],
            [
                0.29654261, 0.8341575, 0.29191147, 0.67013004, 0.81577414, 0.56924309, 0.16895083,
                0.81064937, 0.33738821, 0.60443203, 0.20035183, 0.59400908, 0.6614016, 0.69123246,
                0.65821965
            ],
            [
                0.91230326, 0.01167769, 0.85134036, 0.3706558, 0.25848428, 0.32535981, 0.21403822,
                0.46848046, 0.81251535, 0.14009007, 0.24669136, 0.99339743, 0.93340108, 0.02075709,
                0.70622113
            ],
            [
                0.97535657, 0.75037722, 0.10823288, 0.81256214, 0.34410151, 0.26588269, 0.19256027,
                0.44302414, 0.88194471, 0.39127982, 0.1290875, 0.766889, 0.71124637, 0.40134143,
                0.91092513
            ],
            [
                0.6483908, 0.72450224, 0.79595828, 0.22098504, 0.68060061, 0.47037923, 0.64567511,
                0.4129692, 0.10004629, 0.99257859, 0.99438223, 0.2298542, 0.37104839, 0.7948807,
                0.02188961
            ]
        ],
        [
            [
                0.29747529, 0.66862301, 0.7027586, 0.28309257, 0.12966096, 0.2102668, 0.00434357,
                0.85370736, 0.63845371, 0.28613988, 0.07200554, 0.9220898, 0.29156445, 0.20230391,
                0.12076156
            ],
            [
                0.92621692, 0.46858289, 0.54507136, 0.63722897, 0.22608623, 0.8070677, 0.65882021,
                0.09731943, 0.66976017, 0.44286728, 0.5556714, 0.72961775, 0.3757277, 0.91530331,
                0.30326085
            ],
            [
                0.93730107, 0.82334846, 0.6013252, 0.17847821, 0.93316104, 0.43297369, 0.34233875,
                0.05711227, 0.31655025, 0.81548324, 0.15421378, 0.50955838, 0.63099546, 0.05136881,
                0.58640178
            ],
            [
                0.2841808, 0.17580464, 0.24830963, 0.22112616, 0.14183968, 0.1538982, 0.40688464,
                0.6403477, 0.5033122, 0.32590673, 0.27765568, 0.55745612, 0.58164865, 0.83864451,
                0.10407941
            ],
            [
                0.93224623, 0.44768435, 0.93922664, 0.62725557, 0.6381474, 0.1170303, 0.19262674,
                0.77319761, 0.44253885, 0.45300107, 0.34005156, 0.76790694, 0.75952364, 0.0758354,
                0.09234455
            ],
            [
                0.04076992, 0.76872423, 0.99094179, 0.20562992, 0.70018261, 0.62174463, 0.98539901,
                0.55664802, 0.64827769, 0.39525425, 0.63168535, 0.18450474, 0.76438383, 0.76688608,
                0.88423392
            ],
            [
                0.51201638, 0.86253592, 0.89941671, 0.72245406, 0.90494099, 0.92042747, 0.76105989,
                0.44392367, 0.01097407, 0.99678026, 0.86405489, 0.85744247, 0.08438116, 0.96406471,
                0.31949061
            ],
            [
                0.62963116, 0.75707014, 0.73732537, 0.49274814, 0.27244011, 0.51402527, 0.53541868,
                0.05470187, 0.6003584, 0.03887321, 0.87924409, 0.0748783, 0.27293207, 0.20637059,
                0.51803579
            ],
            [
                0.39701788, 0.72405593, 0.79549945, 0.77494412, 0.2867524, 0.20061469, 0.81692408,
                0.55709774, 0.7601233, 0.50198548, 0.42288147, 0.08264151, 0.0716691, 0.27649702,
                0.47881735
            ],
            [
                0.68508871, 0.56579994, 0.19379972, 0.4292294, 0.74686694, 0.28073508, 0.89885856,
                0.91401573, 0.18914955, 0.76787716, 0.87540447, 0.38148748, 0.06747322, 0.53072729,
                0.85205882
            ]
        ]
    ];

    let kernel29: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.50530854, 0.97504238, 0.9426884, 0.89748624, 0.07379336, 0.44949003, 0.07702624,
            0.58448555, 0.94199225, 0.92478791, 0.74485209, 0.02757184, 0.54734364, 0.40951341,
            0.34430747, 0.57895466, 0.36468079, 0.70209401, 0.42561462, 0.72403331, 0.35258939,
            0.8684342, 0.05176349, 0.45348759, 0.29978636, 0.68130542, 0.61952281, 0.9412474,
            0.49756898, 0.64340843, 0.43305028, 0.49434406, 0.78730003, 0.02698292, 0.74206104,
            0.83714838, 0.63883968, 0.22828955, 0.60320863, 0.19989622, 0.40699668, 0.23004848,
            0.33230867, 0.57542592, 0.92092388, 0.24726972, 0.28718422, 0.01286999, 0.47823747,
            0.76813358, 0.70387658, 0.76817199, 0.2309508, 0.69046209, 0.97214409, 0.45720653,
            0.98188175, 0.76853514, 0.55286584, 0.93719436, 0.31309557, 0.35013177, 0.92419954,
            0.01397917, 0.33568095, 0.21494278, 0.00972885, 0.71777475, 0.80669126, 0.20298374,
            0.1474263, 0.74547544, 0.29411135, 0.83393848, 0.58989935, 0.29956097, 0.83461504,
            0.32731466, 0.12421637, 0.35614855, 0.02120854, 0.93362157, 0.22670202, 0.74599473,
            0.79463097, 0.99299239, 0.13419491, 0.09957198, 0.21009063, 0.55404741, 0.65914135,
            0.93309804, 0.20652905, 0.3130356, 0.62718194, 0.93904083, 0.92252886, 0.30511644,
            0.1139876, 0.11635401, 0.31261827, 0.19285401, 0.280705, 0.56200038, 0.01224133,
            0.7102519, 0.49543427, 0.62446453, 0.81952609, 0.12662244, 0.95435146, 0.68265326,
            0.41329094, 0.10928836, 0.92658905, 0.39157891, 0.92095968, 0.76154379, 0.18214851,
            0.81376395, 0.36687313, 0.75394823, 0.55985729, 0.20492053, 0.04716021, 0.77011498,
            0.03941628, 0.80579599, 0.99227833, 0.38292917, 0.44932705, 0.297381, 0.71088735,
            0.40025624, 0.76151003, 0.3181267, 0.91652895, 0.56650757, 0.06015028, 0.27462521,
            0.55107172, 0.02963078, 0.61154255, 0.36307881, 0.36007801, 0.50875645, 0.63788966,
            0.05874534, 0.89963142, 0.983706,
        ],
    )
    .unwrap();
    let conv_layer29 = TransposedConvolutionLayer::new(kernel29, 1, Padding::Same);
    let target_output29 = array![
        [
            [
                8.83519412,
                10.22842675,
                11.54221026,
                10.74483081,
                10.87969408,
                9.95484543,
                9.28826403,
                12.24186573,
                11.8089283,
                11.12530588,
                11.56967967,
                11.86885957,
                10.97706406,
                6.96329843,
                5.0001538
            ],
            [
                9.82761869,
                11.53626837,
                13.99677845,
                15.15272143,
                15.53368749,
                14.47351266,
                14.27635066,
                13.62896054,
                14.52787754,
                15.65207395,
                15.80018215,
                15.20064219,
                14.12016101,
                10.81456569,
                7.08506598
            ],
            [
                12.64222973,
                17.36762797,
                17.37798758,
                18.85636006,
                19.12597646,
                19.19003439,
                18.80453479,
                18.37088708,
                16.73559676,
                18.6391772,
                20.42626165,
                18.48304781,
                17.26255128,
                13.36527494,
                10.06196736
            ],
            [
                12.81320892,
                17.67485428,
                20.17922123,
                20.71305008,
                20.45560569,
                19.65853769,
                19.02205474,
                19.0462362,
                18.32809121,
                18.07851135,
                18.50572431,
                20.13888729,
                19.86192141,
                14.99089168,
                9.66164206
            ],
            [
                13.98173836,
                18.5220075,
                21.22093459,
                20.88944908,
                21.27148054,
                18.55495948,
                18.59159662,
                19.26732586,
                18.8450441,
                17.77967732,
                19.80946012,
                20.82189374,
                19.73859693,
                14.49400539,
                11.10565334
            ],
            [
                13.2271817,
                17.38132142,
                20.18824675,
                19.81701779,
                20.03210959,
                20.2609539,
                19.33750004,
                19.09561766,
                19.78930972,
                18.45491878,
                18.79964324,
                20.56874274,
                20.31984689,
                15.600823,
                9.84738743
            ],
            [
                15.77852828,
                18.7202665,
                23.54979642,
                21.55400793,
                21.31752621,
                20.27586402,
                19.70605509,
                18.35746236,
                19.42288284,
                18.05434468,
                20.20301924,
                19.34341286,
                19.60917812,
                13.69901227,
                12.02673894
            ],
            [
                15.48951562,
                19.50572934,
                21.87925319,
                21.45930169,
                21.28260712,
                22.46013856,
                20.49046846,
                20.19061149,
                20.32552631,
                19.53075845,
                19.29036726,
                20.58067353,
                20.44150944,
                14.62342932,
                10.30676372
            ],
            [
                11.86348674,
                14.11072573,
                18.85845542,
                17.19952346,
                16.39510111,
                16.7429352,
                16.79477437,
                15.83118658,
                17.12869104,
                17.14925493,
                13.7834364,
                15.17433315,
                15.68311806,
                11.43582475,
                7.12472069
            ],
            [
                9.92817439,
                12.69461606,
                12.70531124,
                12.38841122,
                12.54180628,
                12.63994578,
                12.29065813,
                12.95201749,
                13.0720853,
                12.68977406,
                11.27062659,
                10.16634332,
                10.03929417,
                8.17635967,
                5.68803856
            ]
        ],
        [
            [
                7.53479106,
                9.48117933,
                12.11293637,
                11.41122825,
                10.93305628,
                11.63207595,
                10.42969669,
                11.23834683,
                11.33060229,
                10.42939367,
                11.49809296,
                12.09894403,
                11.08796328,
                9.28232137,
                6.98241617
            ],
            [
                8.06082589,
                11.10011104,
                12.29508255,
                13.82854549,
                15.03491979,
                13.49269933,
                13.92234842,
                12.46924965,
                13.33143074,
                15.61087412,
                14.31016942,
                14.56711765,
                13.73560183,
                11.29900383,
                8.56357765
            ],
            [
                9.94295845,
                14.62467321,
                17.1365969,
                18.91575194,
                18.60723486,
                18.18727898,
                16.55348308,
                17.10766012,
                16.01090216,
                18.77623528,
                18.93502675,
                17.6768832,
                16.05012424,
                14.85946903,
                9.53250303
            ],
            [
                11.66238194,
                14.40152971,
                19.81127161,
                19.03372857,
                19.80415893,
                18.93451271,
                19.69731503,
                18.84265211,
                17.05075734,
                15.79743373,
                18.24177348,
                18.58162477,
                18.74062259,
                15.76267758,
                11.64495413
            ],
            [
                11.54849105,
                16.30157839,
                21.19992454,
                21.02695161,
                19.84899295,
                18.29669926,
                17.80894355,
                17.96111196,
                18.36856213,
                16.57750485,
                16.98670806,
                19.34931765,
                18.15929868,
                15.55807104,
                12.40832123
            ],
            [
                11.30860437,
                14.22818407,
                19.35482476,
                17.00077915,
                18.71217289,
                18.21730248,
                17.84207419,
                16.19451682,
                17.03811377,
                17.90015359,
                18.16587523,
                18.62092066,
                18.74881482,
                15.54248286,
                12.6233534
            ],
            [
                13.06619666,
                17.38354632,
                21.26075428,
                20.19104572,
                19.77604325,
                19.2460668,
                18.59084009,
                17.07342524,
                18.79072848,
                17.44317392,
                18.61098663,
                17.57177998,
                18.11793065,
                15.03325573,
                11.99638925
            ],
            [
                13.70764619,
                18.48310454,
                22.70803495,
                21.38610201,
                20.06048446,
                18.29149354,
                18.92510325,
                18.91329909,
                19.71993497,
                19.58558337,
                17.3018046,
                18.73643578,
                17.9941433,
                15.44407521,
                10.75515114
            ],
            [
                9.77601708,
                13.51163372,
                15.68255178,
                15.35589672,
                15.19458325,
                14.75978881,
                15.30551612,
                14.46808986,
                14.67476371,
                14.13737034,
                13.71200919,
                13.88595932,
                13.86404776,
                11.21321421,
                7.99428641
            ],
            [
                7.4575593,
                8.77602676,
                10.45542531,
                9.93094277,
                10.31798976,
                10.11082818,
                9.48165738,
                10.42128761,
                10.78093498,
                9.12715013,
                8.51516551,
                9.15731587,
                9.57776343,
                6.30594995,
                4.27256291
            ]
        ]
    ];
    let current_output29 = conv_layer29.transposed_convolve(&test_input29);

    assert!(
        arr_allclose(&current_output29, &target_output29),
        "{:?} was not equal to {:?}",
        current_output29,
        target_output29
    );

    let test_input30 = array![
        [
            [
                0.56676178, 0.47099028, 0.47917756, 0.45727775, 0.27296266, 0.3946846, 0.66280784,
                0.03331715, 0.49148887, 0.59586259, 0.01606598, 0.95042964, 0.71248929, 0.15454087,
                0.12836388
            ],
            [
                0.75212753, 0.11432699, 0.60128043, 0.86433271, 0.17594509, 0.28163853, 0.99160874,
                0.7874973, 0.80251555, 0.32389107, 0.95163565, 0.15414724, 0.38786727, 0.22434441,
                0.36910076
            ],
            [
                0.6870394, 0.23646269, 0.35967446, 0.4150253, 0.97400709, 0.32576141, 0.27652602,
                0.95125163, 0.23454542, 0.09603767, 0.59679744, 0.41278226, 0.52654783, 0.38265473,
                0.64929487
            ],
            [
                0.38452544, 0.92784276, 0.7618796, 0.8277444, 0.16376636, 0.53257053, 0.72296808,
                0.61122619, 0.44207693, 0.23045352, 0.16744782, 0.0356647, 0.37670268, 0.82136603,
                0.77063458
            ],
            [
                0.3181389, 0.64781268, 0.61040846, 0.15665839, 0.06507343, 0.9880099, 0.45063683,
                0.70745673, 0.3394063, 0.47413571, 0.00417143, 0.51150428, 0.55957563, 0.28336376,
                0.20063439
            ],
            [
                0.1948837, 0.5315253, 0.59695165, 0.357809, 0.12895541, 0.6529207, 0.97824769,
                0.89964603, 0.94980123, 0.60196691, 0.0485845, 0.56272191, 0.12700435, 0.29388432,
                0.34907413
            ],
            [
                0.8361791, 0.92869443, 0.11734205, 0.57116467, 0.45399173, 0.00822227, 0.74244894,
                0.70879229, 0.36706751, 0.12790425, 0.28086791, 0.65706385, 0.60008967, 0.55780597,
                0.40614347
            ],
            [
                0.96709904, 0.02119358, 0.76233197, 0.1335385, 0.5544648, 0.84080836, 0.50564719,
                0.61273176, 0.82810399, 0.02627662, 0.69914078, 0.8764322, 0.2854147, 0.95856047,
                0.54751695
            ],
            [
                0.27424161, 0.58757964, 0.53866594, 0.12254147, 0.67245907, 0.34793956, 0.19376806,
                0.50672498, 0.22224124, 0.16964852, 0.11521567, 0.33801489, 0.32355503, 0.79831687,
                0.83189893
            ],
            [
                0.38369514, 0.26684986, 0.26137857, 0.8601494, 0.76127538, 0.5854671, 0.49431488,
                0.23544747, 0.97814245, 0.20782107, 0.75460296, 0.86213845, 0.6136204, 0.1428586,
                0.74553276
            ]
        ],
        [
            [
                0.0615097, 0.20476887, 0.07993042, 0.667372, 0.35334712, 0.54035351, 0.59218412,
                0.97238638, 0.10852766, 0.23591947, 0.14727278, 0.78827293, 0.40342536, 0.91729671,
                0.67827153
            ],
            [
                0.0885525, 0.13105007, 0.71030562, 0.8489956, 0.34692028, 0.5237413, 0.98716794,
                0.16775067, 0.76060827, 0.48478109, 0.08279882, 0.91985405, 0.80139391, 0.45085528,
                0.26740267
            ],
            [
                0.58077243, 0.57331732, 0.04986718, 0.93287323, 0.05021113, 0.77452326, 0.46467259,
                0.75457195, 0.35166551, 0.9564967, 0.92545127, 0.36499264, 0.19698261, 0.81250489,
                0.00992131
            ],
            [
                0.57042378, 0.42519064, 0.53880832, 0.963891, 0.71877583, 0.94419451, 0.31255575,
                0.40342178, 0.0014252, 0.75604062, 0.06046879, 0.05295985, 0.06846811, 0.20416067,
                0.05742439
            ],
            [
                0.42463787, 0.9787505, 0.57119205, 0.76032299, 0.98050973, 0.56514397, 0.34798228,
                0.72981094, 0.3247372, 0.81740283, 0.09636248, 0.03579908, 0.62093698, 0.1778051,
                0.77371356
            ],
            [
                0.93435143, 0.89571637, 0.08518937, 0.36859959, 0.95145815, 0.23018053, 0.72776826,
                0.20666202, 0.45572925, 0.20725567, 0.56479756, 0.71743948, 0.5364489, 0.61967464,
                0.46438594
            ],
            [
                0.59790052, 0.51770316, 0.74731666, 0.12481042, 0.31901593, 0.04100234, 0.00186503,
                0.58062709, 0.83947021, 0.01636839, 0.40118744, 0.50362354, 0.15961704, 0.42394294,
                0.02571392
            ],
            [
                0.6550488, 0.22493349, 0.88472325, 0.47986632, 0.57170807, 0.12507368, 0.96629082,
                0.29380217, 0.92096991, 0.20907215, 0.45186043, 0.71682438, 0.8384509, 0.48852058,
                0.44777776
            ],
            [
                0.06533771, 0.69151663, 0.76260469, 0.46192428, 0.67224644, 0.67754903, 0.87868545,
                0.39687311, 0.03901054, 0.58271718, 0.81207471, 0.41569331, 0.53191701, 0.08031714,
                0.11900131
            ],
            [
                0.57013234, 0.93563836, 0.23327391, 0.7704617, 0.15995595, 0.24310802, 0.77192157,
                0.27448081, 0.95520748, 0.23724664, 0.63934966, 0.02262862, 0.06705096, 0.62448985,
                0.44170189
            ]
        ],
        [
            [
                0.59308924, 0.59913121, 0.73476076, 0.22280538, 0.71753199, 0.25907315, 0.67275291,
                0.89796298, 0.48374769, 0.51088791, 0.61347638, 0.61531819, 0.78334141, 0.54200788,
                0.92409688
            ],
            [
                0.85558446, 0.31820816, 0.10115151, 0.07551479, 0.9777943, 0.68369944, 0.50133833,
                0.76188896, 0.41748646, 0.95380533, 0.84875966, 0.33436136, 0.81046601, 0.93027728,
                0.30759851
            ],
            [
                0.44584537, 0.07434042, 0.74348592, 0.39288392, 0.05018714, 0.63737779, 0.03931055,
                0.05808247, 0.58985513, 0.50732198, 0.51649343, 0.85961935, 0.92285202, 0.64551107,
                0.32994861
            ],
            [
                0.34296579, 0.81074446, 0.40738177, 0.91922941, 0.59661091, 0.40765412, 0.4672099,
                0.17243456, 0.79983165, 0.1655954, 0.53781073, 0.80582981, 0.36791065, 0.11123637,
                0.22371608
            ],
            [
                0.78628775, 0.22441991, 0.83121973, 0.14220246, 0.68434915, 0.00031969, 0.07502594,
                0.0637355, 0.85434451, 0.58337854, 0.09831745, 0.41955475, 0.47344962, 0.90437984,
                0.98706117
            ],
            [
                0.64975547, 0.71805047, 0.23386012, 0.44216574, 0.38779064, 0.78058597, 0.04839599,
                0.18846696, 0.6188481, 0.01519543, 0.54789798, 0.95779071, 0.57433462, 0.49206603,
                0.2684415
            ],
            [
                0.1387522, 0.3020447, 0.13914646, 0.03782934, 0.96977939, 0.92114475, 0.91893645,
                0.55230947, 0.03046237, 0.12353099, 0.5072917, 0.61984391, 0.18660152, 0.24114371,
                0.97263596
            ],
            [
                0.31776157, 0.37243055, 0.02969686, 0.27061637, 0.14747076, 0.43885142, 0.26169126,
                0.30070016, 0.4919067, 0.03301751, 0.5209841, 0.21731513, 0.18078179, 0.6365186,
                0.71199629
            ],
            [
                0.46206689, 0.90874196, 0.15252946, 0.70473914, 0.45243503, 0.28129471, 0.59062466,
                0.28510861, 0.12205662, 0.77331355, 0.86641887, 0.39632503, 0.17231515, 0.87105428,
                0.74207233
            ],
            [
                0.66105673, 0.26450386, 0.80924997, 0.87507289, 0.19343477, 0.22950833, 0.10453979,
                0.86698734, 0.00974295, 0.11811279, 0.19300883, 0.36536372, 0.53729319, 0.28143153,
                0.48863336
            ]
        ]
    ];

    let kernel30: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.94922691, 0.41179124, 0.82408072, 0.91125882, 0.56090447, 0.24533414, 0.27897461,
            0.19164045, 0.253367, 0.00792358, 0.43128837, 0.40488669, 0.10464846, 0.34664158,
            0.5441599, 0.10855968, 0.48210514, 0.96567095, 0.28461906, 0.70336024, 0.20942406,
            0.69001963, 0.69849619, 0.06679389, 0.45182634, 0.02423216, 0.96988983, 0.81255079,
            0.39074138, 0.26046671, 0.01168756, 0.09931149, 0.42283415, 0.33630532, 0.63446504,
            0.26917826, 0.79411627, 0.02465508, 0.53390844, 0.62976799, 0.82886269, 0.45748711,
            0.09085662, 0.43935732, 0.2174027, 0.85528025, 0.21284347, 0.06316733, 0.9976707,
            0.42789794, 0.87520768, 0.74749867, 0.40441403, 0.76325788, 0.22450494, 0.51497988,
            0.5347564, 0.24169367, 0.42965255, 0.66428911, 0.7857891, 0.32416475, 0.27693877,
            0.79546614, 0.24560789, 0.54690304, 0.11924994, 0.44189199, 0.78711771, 0.66094374,
            0.59043, 0.56964617, 0.67634569, 0.07601654, 0.8675113, 0.58216119, 0.91824736,
            0.77033093, 0.92340006, 0.50115365, 0.22094135, 0.38615051, 0.93935687, 0.79677013,
            0.48681433, 0.21031151, 0.43076046, 0.3705898, 0.96330353, 0.09928917, 0.60163838,
            0.34939328, 0.981366, 0.64742163, 0.59107353, 0.43766172, 0.97527363, 0.36867949,
            0.46762909, 0.48972946, 0.05696018, 0.79728857, 0.72252262, 0.43851714, 0.85187839,
            0.29709867, 0.47002542, 0.64607047, 0.81212076, 0.22026359, 0.80249754, 0.36786792,
            0.86260913, 0.19603604, 0.98471579, 0.04300088, 0.85541665, 0.6850494, 0.40122688,
            0.44593769, 0.20637396, 0.54217981, 0.23370974, 0.05460318, 0.11931613, 0.16595953,
            0.88520374, 0.47926221, 0.14420728, 0.38770079, 0.87728816, 0.67663798, 0.64419123,
            0.01059729, 0.64494216, 0.10876061, 0.50505142, 0.7889577, 0.27715786, 0.05322019,
            0.05595717, 0.86899229, 0.6531775, 0.13865112, 0.09313866, 0.03322331, 0.48607621,
            0.80292695, 0.73466859, 0.34085481,
        ],
    )
    .unwrap();
    let conv_layer30 = TransposedConvolutionLayer::new(kernel30, 1, Padding::Same);
    let target_output30 = array![
        [
            [
                5.08241092,
                6.98113692,
                10.02765831,
                9.57787012,
                10.46628041,
                9.81020373,
                10.01502019,
                10.2480831,
                10.16115639,
                11.83452492,
                12.15005255,
                11.92809891,
                11.95772625,
                7.96324731,
                6.03149889
            ],
            [
                7.89163058,
                12.772153,
                12.26266932,
                13.14694197,
                14.7500431,
                15.20905274,
                14.4230984,
                15.11559947,
                13.95192993,
                14.56754668,
                14.29917012,
                14.68093777,
                12.71165408,
                9.57638849,
                7.33313024
            ],
            [
                9.80437991,
                14.08344553,
                16.63326409,
                18.03773661,
                18.09141539,
                19.37552839,
                17.72883291,
                17.12185249,
                16.86522034,
                16.66589461,
                16.47685712,
                16.24235854,
                15.29109916,
                14.23925899,
                10.94145062
            ],
            [
                10.22680549,
                14.83956475,
                18.22419456,
                18.7069879,
                16.68701679,
                17.90270953,
                17.25707804,
                17.6756098,
                16.88264926,
                16.23219925,
                16.76476579,
                17.49807106,
                17.4105638,
                12.40915088,
                10.08161793
            ],
            [
                9.8829602,
                13.94156775,
                17.69011026,
                17.43572763,
                18.30262524,
                16.6512251,
                16.55218542,
                15.65319502,
                14.46022616,
                16.01804406,
                15.60067421,
                15.28263376,
                15.56690684,
                11.79305238,
                8.66973279
            ],
            [
                10.64814117,
                11.94009498,
                17.71334571,
                18.92387534,
                16.97878926,
                16.9264671,
                16.57763729,
                15.14780491,
                15.61836126,
                16.67902819,
                14.00718931,
                13.55855724,
                15.03503006,
                12.5068292,
                9.94993828
            ],
            [
                10.25966617,
                13.07732692,
                17.35136428,
                16.7189805,
                15.93849175,
                15.92869126,
                18.36406567,
                15.20278592,
                15.7281472,
                15.66749052,
                14.19185193,
                16.09944902,
                18.06462195,
                13.72118774,
                10.34451539
            ],
            [
                9.95029391,
                13.34523813,
                17.47151296,
                16.98073504,
                16.78502314,
                16.14273926,
                16.64132108,
                14.67890548,
                14.8777883,
                16.66689556,
                15.62058575,
                14.56038962,
                17.1349769,
                11.23747487,
                9.214676
            ],
            [
                7.91378564,
                10.67521931,
                12.63746642,
                12.16379196,
                12.53517164,
                12.67466561,
                13.61452244,
                10.6778565,
                13.51460506,
                11.58482193,
                11.04590658,
                11.76000859,
                12.83703697,
                10.04212178,
                8.25196392
            ],
            [
                5.72664976,
                8.05157868,
                9.99623478,
                8.76997866,
                10.27236869,
                9.96069002,
                10.1731906,
                8.92502537,
                9.439714,
                9.55357317,
                8.4808704,
                9.96300972,
                11.35015567,
                7.8946022,
                6.39573021
            ]
        ],
        [
            [
                6.07089318,
                9.32567509,
                10.71299031,
                10.51032406,
                12.53720762,
                13.39825062,
                12.40889169,
                13.22649928,
                13.13056812,
                13.10678852,
                14.0318352,
                12.93473306,
                13.373106,
                10.39179744,
                7.15708006
            ],
            [
                8.64023229,
                12.39105772,
                15.14704439,
                14.72946337,
                16.52810705,
                15.59253623,
                16.1490199,
                15.84780667,
                15.19351146,
                17.00162539,
                15.8898136,
                16.60841301,
                15.48268612,
                11.21291811,
                8.55595455
            ],
            [
                10.67572245,
                16.88833831,
                17.87263217,
                19.83103315,
                19.37373788,
                19.56024166,
                18.33709535,
                19.59170574,
                17.36892839,
                17.54720657,
                17.57129664,
                17.70615632,
                17.15683098,
                13.69336787,
                9.55377087
            ],
            [
                12.77345619,
                15.76894709,
                19.66480751,
                20.6878672,
                21.19053688,
                18.89413533,
                18.88325261,
                18.62674148,
                16.7439517,
                17.1851361,
                16.75564727,
                16.42093345,
                16.40737895,
                12.5794798,
                9.50677253
            ],
            [
                12.02418341,
                17.50093154,
                19.28841614,
                19.78749429,
                18.97305858,
                18.36539022,
                17.9230183,
                16.80889835,
                16.70110313,
                16.05578124,
                16.6702044,
                15.30745684,
                15.75582055,
                14.768311,
                9.56591676
            ],
            [
                13.04929589,
                14.82148132,
                19.27366844,
                18.94821991,
                18.65974196,
                19.0239834,
                19.24406064,
                16.84258303,
                15.52914061,
                16.27844007,
                15.16835408,
                14.61790082,
                16.12333814,
                13.20078206,
                8.79587956
            ],
            [
                11.93825399,
                13.98723448,
                18.0314585,
                16.55017644,
                17.01799507,
                18.16812533,
                19.12876917,
                18.17745974,
                16.34554533,
                17.09727168,
                15.6828402,
                14.89551276,
                18.10585385,
                14.06500272,
                9.56577426
            ],
            [
                12.01531932,
                15.79626159,
                17.15682463,
                16.72841807,
                17.08422167,
                16.08969829,
                19.40243725,
                17.09678664,
                16.76877373,
                17.36458566,
                16.7030915,
                17.12900622,
                18.95931808,
                13.89659787,
                9.83176409
            ],
            [
                10.35600166,
                13.64588339,
                16.58884874,
                15.70701166,
                14.70558453,
                16.24945291,
                15.12428443,
                13.14416774,
                14.84628275,
                14.45204309,
                14.3651599,
                14.31739427,
                15.80609472,
                12.2627244,
                8.30546073
            ],
            [
                7.4423466,
                9.86106192,
                11.83225944,
                11.33451733,
                11.64412645,
                10.43054353,
                11.35902621,
                9.64637772,
                9.75143274,
                10.89685085,
                9.17124188,
                10.22747301,
                11.72755861,
                9.02466976,
                6.15344769
            ]
        ]
    ];
    let current_output30 = conv_layer30.transposed_convolve(&test_input30);

    assert!(
        arr_allclose(&current_output30, &target_output30),
        "{:?} was not equal to {:?}",
        current_output30,
        target_output30
    );

    let test_input31 = array![
        [
            [
                0.22366413, 0.95598221, 0.39359121, 0.91876601, 0.24713755, 0.97354287, 0.30031595,
                0.64684602, 0.86100615, 0.59273071
            ],
            [
                0.77701443, 0.73534884, 0.75909895, 0.15749992, 0.72520421, 0.41859902, 0.29734526,
                0.04394295, 0.08683281, 0.56033915
            ],
            [
                0.89778493, 0.93563907, 0.58046073, 0.11317083, 0.58915785, 0.16632993, 0.13378483,
                0.41938089, 0.87546382, 0.70123385
            ],
            [
                0.38857201, 0.28411996, 0.9058133, 0.75711783, 0.07648814, 0.00579745, 0.99264772,
                0.4134118, 0.72972003, 0.40353672
            ],
            [
                0.20193496, 0.57876709, 0.74426936, 0.36564475, 0.34799758, 0.65371695, 0.2493377,
                0.11057585, 0.15321027, 0.04929706
            ],
            [
                0.15874591, 0.91822302, 0.53264793, 0.28466523, 0.18983061, 0.15093485, 0.63706066,
                0.24862709, 0.15147327, 0.2301554
            ],
            [
                0.0564075, 0.41640759, 0.0494167, 0.39736766, 0.61883769, 0.48573248, 0.60750871,
                0.38294655, 0.55927306, 0.74589961
            ],
            [
                0.37258523, 0.83356719, 0.54759804, 0.23857857, 0.39679579, 0.2904877, 0.0599105,
                0.66563141, 0.60404165, 0.53209304
            ],
            [
                0.61384071, 0.02453119, 0.24123603, 0.5009664, 0.75515633, 0.85536169, 0.76883378,
                0.58215337, 0.71071153, 0.34048932
            ],
            [
                0.11938791, 0.3079397, 0.58423049, 0.52923066, 0.70045172, 0.92207818, 0.96440867,
                0.58591942, 0.97069462, 0.93834573
            ],
            [
                0.82625589, 0.94433634, 0.60393887, 0.78578314, 0.2540799, 0.1222535, 0.76506976,
                0.62882137, 0.65616585, 0.49536439
            ],
            [
                0.94766991, 0.61218487, 0.04060835, 0.29578766, 0.28489803, 0.93029072, 0.02829797,
                0.60764006, 0.36120783, 0.20330453
            ],
            [
                0.92832137, 0.69648265, 0.09161746, 0.33105221, 0.13664949, 0.49587064, 0.59203153,
                0.12048565, 0.29602908, 0.64903052
            ],
            [
                0.05182126, 0.43509422, 0.68261261, 0.29358103, 0.11258401, 0.90331849, 0.56950291,
                0.95304703, 0.89367309, 0.56095282
            ],
            [
                0.28479084, 0.04034042, 0.56229874, 0.62318029, 0.06696031, 0.46665604, 0.7837567,
                0.91977829, 0.25997232, 0.88225582
            ]
        ],
        [
            [
                0.47500425, 0.45390588, 0.91328348, 0.11114157, 0.58130014, 0.42161283, 0.22435201,
                0.6786595, 0.62604199, 0.90527451
            ],
            [
                0.49089827, 0.83234238, 0.43142704, 0.30292293, 0.10168498, 0.60941204, 0.59296571,
                0.42794032, 0.35090571, 0.64152
            ],
            [
                0.73762674, 0.71849393, 0.90201442, 0.96666177, 0.22773704, 0.58568766, 0.54191948,
                0.26351039, 0.81138734, 0.17099198
            ],
            [
                0.17488659, 0.36350129, 0.83560824, 0.31047368, 0.59667213, 0.78727364, 0.85256768,
                0.27676636, 0.03707253, 0.98432702
            ],
            [
                0.08750064, 0.00369101, 0.01803041, 0.82741547, 0.37063412, 0.25904296, 0.74002335,
                0.06362637, 0.38593335, 0.80894352
            ],
            [
                0.35067967, 0.30580632, 0.99468339, 0.92289781, 0.91575415, 0.88695537, 0.82010887,
                0.0423787, 0.78767792, 0.14608072
            ],
            [
                0.51388733, 0.42593618, 0.99256147, 0.15876527, 0.91182795, 0.87449227, 0.98620846,
                0.81160708, 0.75233644, 0.00490773
            ],
            [
                0.88070222, 0.82566391, 0.79418174, 0.329496, 0.62387276, 0.92899051, 0.61645669,
                0.84931304, 0.68667867, 0.68875671
            ],
            [
                0.45732894, 0.72385153, 0.33933627, 0.47798293, 0.62440126, 0.26071765, 0.63110769,
                0.11611937, 0.74333297, 0.10704688
            ],
            [
                0.77574753, 0.28960332, 0.83815664, 0.96379265, 0.43227805, 0.58860293, 0.59747725,
                0.08082705, 0.810778, 0.18842922
            ],
            [
                0.48358884, 0.12607654, 0.35534696, 0.01038352, 0.17007514, 0.74828364, 0.63407022,
                0.62118106, 0.35729039, 0.29816568
            ],
            [
                0.94198835, 0.20344801, 0.30099279, 0.03229384, 0.80060039, 0.66699049, 0.04867727,
                0.16373641, 0.96934607, 0.38638079
            ],
            [
                0.95091891, 0.9466293, 0.05188827, 0.55839172, 0.57317044, 0.38338074, 0.70773385,
                0.11791705, 0.82375499, 0.1516157
            ],
            [
                0.80213977, 0.0516218, 0.69805873, 0.92406479, 0.72320439, 0.80369216, 0.133951,
                0.40795344, 0.43683325, 0.05010282
            ],
            [
                0.98390937, 0.84939843, 0.51507595, 0.05771473, 0.57006906, 0.49431022, 0.13318006,
                0.15619799, 0.04104833, 0.78385923
            ]
        ],
        [
            [
                0.95769645, 0.25668709, 0.27613528, 0.32087893, 0.95667417, 0.55994194, 0.2624386,
                0.02422112, 0.05377948, 0.97354597
            ],
            [
                0.06656002, 0.70389223, 0.90608605, 0.07507769, 0.60286599, 0.57158165, 0.13600525,
                0.37787155, 0.9256403, 0.08165248
            ],
            [
                0.19910416, 0.22040464, 0.36501739, 0.73497315, 0.83711265, 0.85433769, 0.67837052,
                0.05674714, 0.70366618, 0.1903114
            ],
            [
                0.37970833, 0.47569475, 0.20422158, 0.45125271, 0.49025434, 0.20219063, 0.12852823,
                0.48944199, 0.24683714, 0.40804845
            ],
            [
                0.58064859, 0.04441526, 0.45377526, 0.29813927, 0.98630588, 0.85976016, 0.70147347,
                0.86118032, 0.31853242, 0.52678287
            ],
            [
                0.74087045, 0.87608269, 0.98305223, 0.17809791, 0.730012, 0.35616568, 0.42846883,
                0.06058928, 0.49429509, 0.76039434
            ],
            [
                0.24494596, 0.778694, 0.21488863, 0.67240968, 0.67360793, 0.33566441, 0.6073431,
                0.39084828, 0.95355043, 0.83678327
            ],
            [
                0.34418702, 0.49005046, 0.98560483, 0.40789449, 0.28375405, 0.01750298, 0.25805416,
                0.70511659, 0.69059177, 0.13958348
            ],
            [
                0.61949519, 0.50355275, 0.15333778, 0.16799726, 0.78735089, 0.88734744, 0.02828593,
                0.50652613, 0.24965903, 0.67713154
            ],
            [
                0.11988576, 0.26481518, 0.74598975, 0.28146773, 0.360051, 0.55963813, 0.88763332,
                0.65505901, 0.37980557, 0.64380378
            ],
            [
                0.7719998, 0.21507288, 0.15550959, 0.9577405, 0.18271949, 0.82106526, 0.40619711,
                0.26731093, 0.59189596, 0.13568457
            ],
            [
                0.65886748, 0.92340719, 0.78579335, 0.36487816, 0.99638424, 0.34897111, 0.10377744,
                0.39401645, 0.92458779, 0.56512849
            ],
            [
                0.98249959, 0.13688357, 0.45855844, 0.62439797, 0.65771364, 0.3379914, 0.90286547,
                0.51919752, 0.35878651, 0.26316375
            ],
            [
                0.43393333, 0.79580679, 0.18941753, 0.22869922, 0.41520794, 0.23490934, 0.98844968,
                0.8521515, 0.3087069, 0.39243167
            ],
            [
                0.77493842, 0.10794633, 0.62875806, 0.15465101, 0.52933855, 0.29298806, 0.30647523,
                0.63665378, 0.51852053, 0.26033267
            ]
        ]
    ];

    let kernel31: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.15431551, 0.41460785, 0.44530493, 0.18466089, 0.05273764, 0.13751565, 0.48702549,
            0.81449027, 0.18555306, 0.25868818, 0.97848636, 0.10551306, 0.41106374, 0.43838975,
            0.38703176, 0.74589571, 0.59377576, 0.25400713, 0.31428658, 0.70387005, 0.88027855,
            0.34916332, 0.63033231, 0.37520495, 0.50064042, 0.11340645, 0.9073929, 0.0667114,
            0.52689399, 0.86163507, 0.0950383, 0.67262701, 0.98851465, 0.08098584, 0.1521318,
            0.27832077, 0.93884063, 0.02375987, 0.25068944, 0.36675641, 0.55840271, 0.37249003,
            0.82559233, 0.2034177, 0.47021034, 0.28686063, 0.44204348, 0.09638841, 0.61639642,
            0.65711486, 0.44769376, 0.56713084, 0.87605194, 0.20373637,
        ],
    )
    .unwrap();
    let conv_layer31 = TransposedConvolutionLayer::new(kernel31, 1, Padding::Same);
    let target_output31 = array![
        [
            [
                2.76340404, 4.25034728, 4.47951608, 4.19087842, 4.0602496, 3.27309271, 3.86266584,
                3.12813685, 4.39446615, 3.2840186
            ],
            [
                4.12442452, 7.17305026, 6.33384762, 6.07505942, 6.11485822, 5.94502804, 4.81593334,
                4.85776337, 5.2862095, 3.56114798
            ],
            [
                3.66263596, 6.57094379, 6.71471869, 7.01505843, 5.46980209, 5.64445665, 4.75303315,
                5.61093946, 4.61992347, 3.93592095
            ],
            [
                2.69515767, 4.81388493, 4.87503122, 6.60937996, 6.59009976, 6.40958975, 5.33235967,
                5.94283334, 4.79011854, 3.6429401
            ],
            [
                2.46535017, 4.43807251, 6.15433079, 6.41052859, 6.02020859, 6.36659207, 5.40724198,
                4.97854678, 4.24717793, 3.31451939
            ],
            [
                3.22874978, 5.84855675, 5.91606478, 7.04400425, 6.81754443, 7.56853281, 6.08396172,
                6.38577153, 5.46446637, 3.87848362
            ],
            [
                4.21530042, 7.06779014, 6.58707911, 7.30795835, 5.50770317, 7.05417378, 6.08072997,
                6.60946928, 6.36162117, 4.21174357
            ],
            [
                4.20246484, 6.07289016, 6.37601105, 5.52811064, 5.80423434, 6.46060861, 6.48539719,
                6.87186334, 6.75514711, 4.34346257
            ],
            [
                3.69561391, 5.94284127, 5.25120363, 6.44727095, 5.91918181, 5.99837565, 5.87391966,
                6.84756605, 5.57791348, 4.5886915
            ],
            [
                2.91065576, 5.69677652, 5.36912341, 5.59650084, 6.55909571, 6.50386375, 6.84168735,
                6.33508629, 5.6816685, 3.88637112
            ],
            [
                3.40048276, 5.92712977, 5.29135846, 5.3918802, 5.78740582, 6.66129155, 6.08616001,
                5.92009037, 6.09844365, 3.98582087
            ],
            [
                4.49542399, 7.04372192, 5.3439851, 4.46792407, 6.28521915, 4.89878291, 5.6371777,
                6.00644641, 5.01007195, 3.7072676
            ],
            [
                5.06697186, 6.21128495, 5.94521486, 5.76605937, 5.90349498, 6.10792165, 5.64908939,
                5.91631683, 5.21530452, 3.75607861
            ],
            [
                3.80131192, 6.55552443, 4.9802426, 5.73555327, 5.68821811, 5.7896137, 6.49041001,
                5.64197274, 5.21027066, 3.15044611
            ],
            [
                3.23877588, 4.05617351, 3.30555747, 3.40054516, 3.67159086, 3.79264527, 4.2855427,
                4.14449412, 4.65069111, 1.64985649
            ]
        ],
        [
            [
                3.0002812, 4.41653062, 4.29863495, 3.36604343, 3.88072972, 4.2474684, 3.29564131,
                3.2290819, 3.92766538, 3.00993601
            ],
            [
                4.6266737, 7.0866459, 7.13407817, 6.42213473, 6.52636298, 6.31490848, 5.22304476,
                5.3511542, 5.43804459, 4.97473346
            ],
            [
                4.47673882, 6.53557652, 5.88087773, 6.03459063, 6.10459967, 6.03427133, 4.93950712,
                4.45024518, 5.54475104, 3.69463626
            ],
            [
                3.70007066, 5.10971497, 5.7956807, 5.3521025, 5.63404055, 5.7554055, 5.36961205,
                5.7372773, 5.85456378, 4.17238953
            ],
            [
                3.09198503, 6.19087916, 6.48097824, 7.04091673, 6.12758102, 7.15336867, 6.27547013,
                5.74514276, 4.48257221, 3.91800094
            ],
            [
                3.65968512, 6.58632026, 6.1450187, 6.55829412, 6.25285984, 7.19710992, 5.99663137,
                5.32512571, 4.53091066, 4.02292992
            ],
            [
                4.17302473, 6.78026451, 6.90023277, 6.17310612, 6.12741272, 6.32835965, 6.42277008,
                6.19391623, 6.43786713, 4.66008992
            ],
            [
                3.97506364, 5.89791397, 5.59140285, 5.74964161, 5.56348322, 6.2443709, 5.31372589,
                6.58693075, 6.2879038, 4.79010496
            ],
            [
                3.88910895, 6.44515211, 5.97800426, 5.80404576, 6.30458439, 6.14809772, 6.2008923,
                6.4689656, 6.16288478, 4.20702961
            ],
            [
                3.15887766, 4.41152645, 4.48910747, 5.74836121, 6.59807295, 7.3883836, 7.39559727,
                6.61610329, 6.24016865, 4.00641906
            ],
            [
                4.09123134, 6.32215906, 5.62104579, 6.1649988, 6.4409876, 6.66444185, 6.51460102,
                6.53297, 6.40404034, 5.15792332
            ],
            [
                6.55754767, 6.83845424, 5.86141451, 5.34492383, 5.47252222, 6.39721392, 5.33473066,
                6.17979269, 5.52585732, 4.10572042
            ],
            [
                5.3734892, 6.87465235, 4.4499961, 5.12266061, 6.50552783, 6.05513714, 5.74427845,
                5.42154822, 5.16861853, 3.48534087
            ],
            [
                5.60921441, 6.3580075, 5.02823372, 4.51311835, 4.77198013, 5.92706392, 5.64117955,
                5.68846457, 5.86341964, 3.3979304
            ],
            [
                2.34817734, 4.14820383, 3.58432755, 3.18891913, 3.47219098, 4.29693264, 4.7390587,
                4.71393981, 4.21525906, 2.97024582
            ]
        ]
    ];
    let current_output31 = conv_layer31.transposed_convolve(&test_input31);

    assert!(
        arr_allclose(&current_output31, &target_output31),
        "{:?} was not equal to {:?}",
        current_output31,
        target_output31
    );

    let test_input32 = array![
        [
            [
                0.27123894, 0.25475977, 0.76688642, 0.06911058, 0.45762166, 0.19771431, 0.17999981,
                0.40458818, 0.972418, 0.81991797
            ],
            [
                0.93044527, 0.55336852, 0.915383, 0.52413078, 0.98055369, 0.1704253, 0.62391711,
                0.79693218, 0.86265327, 0.14754384
            ],
            [
                0.32911999, 0.88146431, 0.79716739, 0.78743209, 0.5561277, 0.0177031, 0.69646716,
                0.39157388, 0.93268543, 0.30876376
            ],
            [
                0.91422432, 0.24893699, 0.1819684, 0.23486935, 0.26168018, 0.69108448, 0.25471523,
                0.67022038, 0.88759521, 0.87807231
            ],
            [
                0.47314035, 0.31084669, 0.91822879, 0.50544957, 0.039055, 0.15108511, 0.41170538,
                0.86253531, 0.89946556, 0.62739763
            ],
            [
                0.07177843, 0.44464005, 0.70372949, 0.52959422, 0.5185303, 0.39385682, 0.73444233,
                0.02605194, 0.58722203, 0.39850043
            ],
            [
                0.98985023, 0.30054071, 0.16408822, 0.42462426, 0.63699961, 0.00571945, 0.79801559,
                0.95953562, 0.08723956, 0.87902869
            ],
            [
                0.48867705, 0.1475966, 0.22570877, 0.15296296, 0.06758836, 0.78658975, 0.55379491,
                0.88447644, 0.42971601, 0.52476551
            ],
            [
                0.61579455, 0.48401226, 0.48021863, 0.38902782, 0.7585289, 0.92196393, 0.90806069,
                0.82952693, 0.72815132, 0.18144435
            ],
            [
                0.42306708, 0.64623054, 0.82973694, 0.13372118, 0.87873156, 0.37426912, 0.195186,
                0.99151151, 0.42578654, 0.76744612
            ],
            [
                0.25253761, 0.28738715, 0.67726647, 0.29977326, 0.53512597, 0.87778981, 0.94740194,
                0.47417759, 0.84128272, 0.15063959
            ],
            [
                0.90660217, 0.73523603, 0.11790983, 0.26490994, 0.49443926, 0.19714477, 0.29334284,
                0.75289166, 0.12610584, 0.179585
            ],
            [
                0.66034124, 0.38383447, 0.38457967, 0.22543585, 0.0418756, 0.1392253, 0.35778307,
                0.96357978, 0.32928566, 0.47363354
            ],
            [
                0.10196569, 0.72038919, 0.77843888, 0.0080448, 0.65070682, 0.28715538, 0.77359609,
                0.78987484, 0.15095101, 0.63586436
            ],
            [
                0.59458697, 0.41322805, 0.72781092, 0.91400965, 0.78385947, 0.77705057, 0.76024027,
                0.23231152, 0.59227651, 0.31265621
            ]
        ],
        [
            [
                0.96076191, 0.98333798, 0.44375485, 0.66588801, 0.77717451, 0.77929267, 0.04950647,
                0.18508341, 0.03639585, 0.09267449
            ],
            [
                0.64448901, 0.23740662, 0.53695128, 0.28598787, 0.94286321, 0.70666296, 0.91217921,
                0.34603308, 0.10483618, 0.40233821
            ],
            [
                0.16371936, 0.63196858, 0.88807912, 0.01381858, 0.0446909, 0.65969555, 0.74194559,
                0.94717652, 0.67107606, 0.1345869
            ],
            [
                0.57128431, 0.50722602, 0.0287422, 0.86885496, 0.14450895, 0.40538366, 0.24959958,
                0.50145295, 0.43695837, 0.02603532
            ],
            [
                0.07244907, 0.9323446, 0.03978212, 0.06027399, 0.54818185, 0.61008981, 0.59623905,
                0.05084841, 0.82102306, 0.30075985
            ],
            [
                0.47476913, 0.35447294, 0.6985968, 0.32269333, 0.40450977, 0.90782097, 0.71061406,
                0.14398163, 0.6175431, 0.29263958
            ],
            [
                0.96495698, 0.4804398, 0.49897761, 0.12305231, 0.44949692, 0.9140025, 0.53750367,
                0.13389887, 0.19339294, 0.92975616
            ],
            [
                0.40155313, 0.36470608, 0.36595656, 0.21548178, 0.39905995, 0.64136933, 0.62307724,
                0.81463918, 0.9206014, 0.51325607
            ],
            [
                0.76182594, 0.44664624, 0.33466795, 0.35649163, 0.07579028, 0.95911912, 0.06404968,
                0.91653933, 0.97158862, 0.33618838
            ],
            [
                0.67616089, 0.46713153, 0.31858218, 0.12114367, 0.28284694, 0.75696725, 0.50348959,
                0.18458705, 0.16303097, 0.44720768
            ],
            [
                0.88895617, 0.59612311, 0.32683849, 0.74607325, 0.46747229, 0.36873223, 0.40775748,
                0.78699712, 0.95118822, 0.48872461
            ],
            [
                0.05987948, 0.05762041, 0.12035189, 0.27911294, 0.86563278, 0.90835056, 0.78036702,
                0.92566342, 0.76898302, 0.53749615
            ],
            [
                0.8450462, 0.93648152, 0.92224051, 0.77002236, 0.72640053, 0.23352704, 0.90664915,
                0.29917085, 0.11980062, 0.33431747
            ],
            [
                0.41759513, 0.52357812, 0.51721827, 0.97931582, 0.11866722, 0.04391732, 0.02646681,
                0.70370694, 0.62497407, 0.19993573
            ],
            [
                0.48451889, 0.03120568, 0.56651917, 0.91825485, 0.31821679, 0.2717065, 0.37213528,
                0.96494826, 0.19322889, 0.89616362
            ]
        ],
        [
            [
                0.16238886, 0.04934809, 0.91351561, 0.56770889, 0.29084717, 0.90572718, 0.68025632,
                0.20875117, 0.689319, 0.2170015
            ],
            [
                0.94474569, 0.38960553, 0.28745596, 0.96770977, 0.58086799, 0.64819172, 0.3087516,
                0.96539035, 0.60774715, 0.36109188
            ],
            [
                0.65511146, 0.35166884, 0.40624503, 0.62547367, 0.39857359, 0.30847135, 0.37874322,
                0.84163567, 0.28955428, 0.13427325
            ],
            [
                0.22238751, 0.29856752, 0.90076719, 0.20906866, 0.82730113, 0.25606984, 0.99259873,
                0.28031978, 0.41000588, 0.88746537
            ],
            [
                0.81454615, 0.0052199, 0.43335877, 0.80474702, 0.00935874, 0.57530178, 0.10368044,
                0.798089, 0.19485743, 0.03557918
            ],
            [
                0.2854216, 0.0878918, 0.01423985, 0.85818416, 0.84441495, 0.56792851, 0.88910668,
                0.24644252, 0.6723672, 0.7561011
            ],
            [
                0.52620496, 0.56677304, 0.04310033, 0.39450356, 0.67738713, 0.29729494, 0.90321641,
                0.19710934, 0.7033385, 0.83412407
            ],
            [
                0.11669488, 0.58224944, 0.47142734, 0.77580868, 0.82671464, 0.54548325, 0.06253681,
                0.6328484, 0.04127725, 0.03063479
            ],
            [
                0.18519483, 0.95941215, 0.04606932, 0.86761032, 0.12376604, 0.92580419, 0.33137133,
                0.16955226, 0.34692583, 0.96049764
            ],
            [
                0.90859588, 0.09133178, 0.55179239, 0.48548945, 0.01102468, 0.96368529, 0.40183439,
                0.94968535, 0.27293482, 0.99151022
            ],
            [
                0.06216944, 0.03845026, 0.50411069, 0.12539351, 0.53750045, 0.09209576, 0.31733655,
                0.04715738, 0.02350844, 0.48797405
            ],
            [
                0.14698329, 0.61728634, 0.44762007, 0.44341771, 0.72442732, 0.27748031, 0.59072081,
                0.62550861, 0.90352963, 0.20770459
            ],
            [
                0.45572538, 0.4143518, 0.79592942, 0.2494421, 0.08886264, 0.53222515, 0.65777683,
                0.39593857, 0.09867492, 0.37973137
            ],
            [
                0.72127466, 0.04400805, 0.16879582, 0.05517174, 0.60318694, 0.21645352, 0.37806736,
                0.20714076, 0.61399569, 0.68624535
            ],
            [
                0.71249346, 0.32159684, 0.6417801, 0.53773319, 0.98615719, 0.02837782, 0.8200725,
                0.57431704, 0.0464029, 0.72660589
            ]
        ]
    ];

    let kernel32: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.62417083, 0.06128551, 0.32178353, 0.15175516, 0.5686399, 0.14021157, 0.91652803,
            0.28734131, 0.59169637, 0.75519177, 0.7453247, 0.80011215, 0.23278458, 0.96737163,
            0.708869, 0.84120216, 0.77216755, 0.14788179, 0.806601, 0.67196795, 0.88025001,
            0.68145309, 0.84228608, 0.75536845, 0.04224503, 0.67281545, 0.7357494, 0.17175993,
            0.36744105, 0.10604992, 0.40809689, 0.85877999, 0.23185539, 0.39392675, 0.9427737,
            0.4785206, 0.43396241, 0.42408309, 0.85129731, 0.39602842, 0.36610579, 0.31749709,
            0.11389459, 0.05309011, 0.83804966, 0.50632893, 0.17152104, 0.36011708, 0.02909578,
            0.65161826, 0.05278487, 0.76540759, 0.23484992, 0.9945197,
        ],
    )
    .unwrap();
    let conv_layer32 = TransposedConvolutionLayer::new(kernel32, 1, Padding::Same);
    let target_output32 = array![
        [
            [
                3.77607556, 6.10663715, 5.88934477, 7.04297358, 6.06340663, 6.73730264, 5.12705706,
                5.00188511, 4.15246587, 2.77659459
            ],
            [
                6.02048412, 8.00413395, 8.2467572, 9.28729105, 8.71462495, 8.44411408, 8.17755572,
                8.59494564, 6.52226238, 4.54874029
            ],
            [
                4.87311617, 8.46165206, 8.02288343, 7.48141604, 8.08898967, 7.50274878, 9.2644969,
                8.45103583, 8.46495032, 4.89407344
            ],
            [
                5.15572245, 6.98734542, 7.61690002, 6.54887375, 6.23192806, 6.94123045, 7.54722054,
                8.85463615, 6.8270169, 4.95729921
            ],
            [
                4.12459379, 6.14904669, 6.73313321, 7.82021101, 7.03251339, 7.88028143, 7.26534627,
                8.12267265, 7.01193333, 5.13453542
            ],
            [
                4.41558693, 6.92845515, 5.67754638, 7.25429854, 7.90880694, 8.52152686, 8.01448182,
                7.25408366, 8.42850951, 4.56014015
            ],
            [
                4.84753391, 6.50034431, 5.79398596, 6.84575836, 8.51027406, 8.82296691, 8.5699032,
                8.26213415, 7.49227268, 5.90737716
            ],
            [
                5.44732333, 7.10980168, 6.19790677, 6.36622601, 8.17678755, 8.88899099, 8.68323901,
                8.46604884, 9.3415366, 5.95257481
            ],
            [
                5.21408254, 7.11639958, 6.89074348, 6.47597907, 7.86386123, 8.09338549, 9.32083302,
                7.66196313, 9.08255882, 4.74675706
            ],
            [
                5.18121875, 7.26231565, 6.98971397, 5.81588553, 7.89431419, 7.93050807, 8.55637306,
                8.36467307, 8.04000728, 5.99643199
            ],
            [
                4.68273941, 6.67299442, 6.03144022, 6.642748, 7.00636576, 7.98255788, 8.73839988,
                7.72257983, 9.06162429, 4.70644393
            ],
            [
                4.40436773, 7.01127376, 6.44743868, 7.08104701, 6.83864936, 8.19461139, 7.85429007,
                8.66922481, 7.74148329, 4.24207328
            ],
            [
                5.16814708, 7.40877465, 7.93055869, 7.92600783, 6.71558352, 7.33002395, 7.67221823,
                8.23460725, 7.66531017, 3.88298653
            ],
            [
                5.03626084, 8.45229989, 8.17704146, 8.0716352, 6.91413736, 6.24324528, 7.39402386,
                6.70252474, 7.3052862, 4.40600757
            ],
            [
                3.21623886, 4.42956469, 4.93748469, 6.1207955, 4.32610317, 4.4222358, 4.8025827,
                5.41331519, 5.55688173, 3.39007153
            ]
        ],
        [
            [
                2.26735762, 3.61248728, 3.96736886, 4.0505658, 4.0936963, 3.75596459, 3.36386646,
                2.95202601, 4.00195207, 3.0070414
            ],
            [
                4.10177111, 6.81903611, 6.25145773, 7.11169865, 6.80257577, 5.8542957, 5.85571905,
                5.77122881, 5.27270116, 3.73190892
            ],
            [
                3.31284243, 6.64279411, 5.54018914, 6.56473198, 5.81004655, 6.66000954, 5.64708769,
                6.72708004, 6.12536956, 3.77865783
            ],
            [
                3.12406439, 5.83744084, 4.8421897, 4.53108772, 5.08953962, 4.28574323, 6.18402375,
                5.86648038, 6.76867249, 4.68942214
            ],
            [
                2.9452528, 4.47802102, 5.07104282, 5.42429465, 5.0790344, 5.50465958, 4.63143623,
                6.53192504, 5.68560679, 4.18362642
            ],
            [
                3.10297232, 4.53750596, 4.58392354, 4.93506645, 5.99667444, 5.82931516, 5.22560465,
                5.66243461, 5.37632721, 4.58739449
            ],
            [
                3.36090779, 4.78689139, 4.00108348, 4.57444051, 6.36080751, 6.52519753, 6.30942861,
                6.48847965, 5.52712933, 4.31296726
            ],
            [
                3.48124384, 5.10807049, 4.77817393, 3.60020597, 5.89028255, 6.08988823, 6.39436345,
                7.0760292, 6.1620471, 3.46672452
            ],
            [
                3.06982125, 5.51818562, 4.52087745, 4.69775162, 6.0804977, 6.45032572, 7.67370211,
                6.25469843, 7.29734504, 3.94310254
            ],
            [
                3.61007805, 4.85886361, 5.53509417, 4.52206441, 5.6132353, 5.4963306, 6.64445981,
                6.19300154, 6.41138982, 4.37721505
            ],
            [
                2.66946707, 4.91391443, 4.46439739, 4.98113962, 5.41068648, 5.8045951, 6.84417574,
                6.12927064, 6.12225289, 3.58052105
            ],
            [
                3.49214582, 5.9495207, 4.86430438, 5.21231136, 4.79147021, 5.09464981, 5.43086577,
                6.18700182, 5.57348933, 2.85282545
            ],
            [
                2.97017278, 5.09959029, 5.03502105, 4.75746221, 3.70177861, 5.42717079, 5.62382451,
                6.61259205, 5.84006078, 3.90242456
            ],
            [
                3.33995389, 6.38006656, 6.4669801, 6.67529172, 4.49720388, 5.65649268, 5.15480239,
                6.08550417, 5.49318986, 2.77271089
            ],
            [
                2.10477452, 3.98253544, 4.57018203, 4.60736535, 4.1202247, 3.69396895, 4.02488167,
                4.11863975, 3.5586189, 3.10335648
            ]
        ]
    ];
    let current_output32 = conv_layer32.transposed_convolve(&test_input32);

    assert!(
        arr_allclose(&current_output32, &target_output32),
        "{:?} was not equal to {:?}",
        current_output32,
        target_output32
    );

    let test_input33 = array![
        [
            [
                0.54633783, 0.24511013, 0.97774922, 0.69050992, 0.27977652, 0.90654937, 0.57515926,
                0.24321788, 0.53263522, 0.07565403
            ],
            [
                0.05434246, 0.26618787, 0.72318462, 0.43516472, 0.99268718, 0.43552541, 0.68551267,
                0.64693729, 0.76979012, 0.63241168
            ],
            [
                0.29845408, 0.5382067, 0.66399105, 0.46639143, 0.79114506, 0.48233854, 0.63575113,
                0.40660446, 0.92244613, 0.49206444
            ],
            [
                0.80571662, 0.82787251, 0.80693965, 0.90912678, 0.26092742, 0.95664336, 0.29978432,
                0.02473691, 0.60125411, 0.60070925
            ],
            [
                0.78243106, 0.60010071, 0.44357089, 0.85266108, 0.675747, 0.82724146, 0.20722397,
                0.59975286, 0.5042818, 0.12529623
            ],
            [
                0.76556279, 0.34968521, 0.91995845, 0.51566084, 0.20966067, 0.78876712, 0.57592297,
                0.78506145, 0.205856, 0.70799518
            ],
            [
                0.30424088, 0.44280463, 0.11662215, 0.35319197, 0.46881175, 0.86059511, 0.63319756,
                0.59271555, 0.42732622, 0.98056247
            ],
            [
                0.40943377, 0.08736204, 0.71414951, 0.02837266, 0.81552531, 0.02289614, 0.76723763,
                0.1173388, 0.82497201, 0.53015014
            ],
            [
                0.7377907, 0.62719797, 0.7086393, 0.73161111, 0.87289593, 0.20523417, 0.71212701,
                0.68582129, 0.24446411, 0.60463413
            ],
            [
                0.18942199, 0.95210287, 0.01657294, 0.55725469, 0.95109936, 0.38959227, 0.28407176,
                0.95209661, 0.40447855, 0.71501733
            ],
            [
                0.59002381, 0.98060001, 0.11093972, 0.01488827, 0.13965633, 0.23179671, 0.58850364,
                0.96796344, 0.07589323, 0.49488764
            ],
            [
                0.75471488, 0.42257424, 0.46737375, 0.56864999, 0.66625124, 0.05517857, 0.16380031,
                0.46145923, 0.15882404, 0.02506812
            ],
            [
                0.35248876, 0.80154351, 0.91352024, 0.72497926, 0.60175127, 0.34736298, 0.28637486,
                0.6757847, 0.78334029, 0.88746301
            ],
            [
                0.34994327, 0.50264178, 0.95540769, 0.67426575, 0.58840273, 0.11392497, 0.36673201,
                0.50156932, 0.07588513, 0.65326088
            ],
            [
                0.99176916, 0.33047233, 0.77538636, 0.78758259, 0.03383781, 0.19371769, 0.45534521,
                0.89121258, 0.89200937, 0.979078
            ]
        ],
        [
            [
                0.14136378, 0.68612811, 0.42269909, 0.57890961, 0.23714265, 0.87804097, 0.6716795,
                0.18069328, 0.72638976, 0.11987385
            ],
            [
                0.29228648, 0.54633165, 0.02802026, 0.50526024, 0.75106456, 0.88182022, 0.93242602,
                0.35120465, 0.5854956, 0.4499466
            ],
            [
                0.53175735, 0.701881, 0.37155066, 0.35350097, 0.83142115, 0.69990206, 0.71345654,
                0.72049417, 0.24144431, 0.68425282
            ],
            [
                0.99164757, 0.74371608, 0.38216989, 0.49239221, 0.75307389, 0.90825589, 0.62442701,
                0.58129102, 0.32334333, 0.01425953
            ],
            [
                0.90228399, 0.57870273, 0.19597261, 0.17998803, 0.01473868, 0.69967598, 0.50453191,
                0.10049864, 0.41223644, 0.36699277
            ],
            [
                0.12324517, 0.82835311, 0.99595505, 0.22217043, 0.86721276, 0.05724551, 0.00227537,
                0.54678287, 0.98861131, 0.69528861
            ],
            [
                0.4457745, 0.08733197, 0.07807443, 0.73419354, 0.95236828, 0.94127354, 0.63572064,
                0.33092292, 0.50407683, 0.96704506
            ],
            [
                0.13291514, 0.11796268, 0.85688275, 0.32689602, 0.73428449, 0.2260136, 0.07261418,
                0.62869817, 0.88499448, 0.59125265
            ],
            [
                0.17175686, 0.75578227, 0.65876399, 0.45672348, 0.78175688, 0.40402798, 0.86699464,
                0.52854505, 0.54919731, 0.39217444
            ],
            [
                0.43886227, 0.87633145, 0.98955722, 0.8110191, 0.85019501, 0.15625102, 0.99321231,
                0.36615691, 0.23434374, 0.58433064
            ],
            [
                0.75917474, 0.5770703, 0.21508744, 0.01203728, 0.1035213, 0.80089672, 0.73771457,
                0.27955082, 0.5298586, 0.2177599
            ],
            [
                0.28608976, 0.09119173, 0.36885206, 0.36523802, 0.90553059, 0.06103494, 0.47982117,
                0.83992451, 0.47333171, 0.86444047
            ],
            [
                0.30405685, 0.6097887, 0.27184127, 0.43936662, 0.25087379, 0.0884422, 0.60883367,
                0.9107224, 0.63233961, 0.35501132
            ],
            [
                0.05707325, 0.28812404, 0.30072556, 0.12395685, 0.44218451, 0.03757849, 0.19107571,
                0.16689722, 0.23344701, 0.65167962
            ],
            [
                0.07916018, 0.84454265, 0.33082817, 0.15329788, 0.55687659, 0.73493761, 0.51132644,
                0.20894305, 0.8198042, 0.97975307
            ]
        ],
        [
            [
                0.42908755, 0.8672759, 0.17690783, 0.70560382, 0.76196205, 0.13069929, 0.13675449,
                0.09911298, 0.58084835, 0.92963229
            ],
            [
                0.1004836, 0.11953733, 0.34219892, 0.20040872, 0.47369165, 0.79545743, 0.44925164,
                0.5006503, 0.77092145, 0.50573882
            ],
            [
                0.16627123, 0.40736891, 0.85948235, 0.77469367, 0.07748227, 0.32502119, 0.99115263,
                0.49979938, 0.03903624, 0.45098575
            ],
            [
                0.40630326, 0.35183752, 0.82211552, 0.14105703, 0.227326, 0.83141239, 0.69107378,
                0.00025815, 0.37125575, 0.26917789
            ],
            [
                0.15205021, 0.78528623, 0.18507508, 0.11155977, 0.72963227, 0.55972416, 0.02126993,
                0.31910167, 0.80083311, 0.00567722
            ],
            [
                0.41979991, 0.27020734, 0.68196129, 0.56849524, 0.52824944, 0.62016676, 0.58644366,
                0.19804583, 0.90372638, 0.24526173
            ],
            [
                0.25416795, 0.1574701, 0.88019975, 0.03448753, 0.57768596, 0.19106585, 0.96476043,
                0.10343831, 0.37371256, 0.98782566
            ],
            [
                0.11502933, 0.57072535, 0.22614866, 0.72363857, 0.75930148, 0.63348889, 0.8536877,
                0.99785625, 0.51448592, 0.94924801
            ],
            [
                0.87518568, 0.31102133, 0.85403441, 0.10243613, 0.75013848, 0.16738603, 0.80542812,
                0.45326026, 0.30407329, 0.87454515
            ],
            [
                0.59428147, 0.12408072, 0.85938895, 0.58185948, 0.91455103, 0.71053732, 0.44424602,
                0.21789879, 0.29508548, 0.59330144
            ],
            [
                0.23873305, 0.89336336, 0.50276651, 0.4189281, 0.34902763, 0.6593175, 0.70450031,
                0.31841912, 0.81208947, 0.50125501
            ],
            [
                0.52000306, 0.03721511, 0.56604362, 0.40087107, 0.20641831, 0.24329998, 0.60486471,
                0.26063501, 0.69902617, 0.85722696
            ],
            [
                0.86291226, 0.44850219, 0.63793008, 0.63367391, 0.63402799, 0.86558166, 0.89874099,
                0.86648539, 0.54153247, 0.43470187
            ],
            [
                0.69931702, 0.32786556, 0.41515501, 0.0913713, 0.36485343, 0.90767924, 0.24020902,
                0.27320311, 0.00529139, 0.52433727
            ],
            [
                0.51490241, 0.17749024, 0.35303734, 0.04551869, 0.08317022, 0.41465418, 0.17218769,
                0.71720955, 0.5745436, 0.22950321
            ]
        ]
    ];

    let kernel33: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.6020403, 0.27022606, 0.63083193, 0.30292658, 0.96809431, 0.819106, 0.79777052,
            0.16225311, 0.00457407, 0.60750894, 0.46640407, 0.68809668, 0.4374607, 0.60818987,
            0.81660293, 0.47694276, 0.9496088, 0.99802029, 0.9993323, 0.33134598, 0.66847872,
            0.9229204, 0.36808706, 0.23564495, 0.90766032, 0.72902993, 0.36569181, 0.38004756,
            0.73416886, 0.50158224, 0.41028751, 0.45120648, 0.26561119, 0.61462658, 0.35742876,
            0.33983811, 0.00899099, 0.15988262, 0.60277043, 0.44374641, 0.91808642, 0.43329178,
            0.60934184, 0.04837284, 0.42185227, 0.67898826, 0.4041995, 0.26418261, 0.1565183,
            0.32122391, 0.43884348, 0.31449165, 0.61095888, 0.86979142,
        ],
    )
    .unwrap();
    let conv_layer33 = TransposedConvolutionLayer::new(kernel33, 1, Padding::Same);
    let target_output33 = array![
        [
            [
                2.29511929, 3.52779992, 5.18053281, 5.37398937, 5.99887026, 7.05989561, 5.8980386,
                5.68845478, 5.33725496, 4.13625909
            ],
            [
                4.13827742, 6.58038433, 8.96882223, 8.07270535, 8.7450772, 9.81969311, 9.32770314,
                8.78990081, 7.57790987, 5.38478531
            ],
            [
                4.56664552,
                8.06017192,
                8.31809342,
                8.1333836,
                10.03656323,
                9.86414536,
                9.91285857,
                8.68604401,
                7.24654568,
                4.7478121
            ],
            [
                6.30219503, 9.29586205, 8.48503073, 7.68638285, 8.69074648, 9.50260849, 8.61478338,
                7.14976524, 6.87040398, 4.22164627
            ],
            [
                6.54620373,
                10.02970412,
                8.51214988,
                8.28766889,
                8.36445536,
                8.8550358,
                7.52449747,
                7.38384343,
                7.14851872,
                4.63304592
            ],
            [
                5.25498904, 7.07634026, 7.50259522, 7.96041415, 7.45445385, 8.71083176, 7.42683772,
                7.84343021, 7.59899732, 6.49212598
            ],
            [
                3.65256196,
                6.86113714,
                7.09883453,
                9.06464225,
                8.03669951,
                10.05992302,
                7.98239117,
                9.66867881,
                9.3246099,
                8.08759707
            ],
            [
                4.15901211,
                6.98936046,
                6.75692393,
                8.95681383,
                8.77225509,
                10.36811724,
                8.41964642,
                8.47640439,
                10.04998983,
                6.9337267
            ],
            [
                4.78213179,
                7.71025325,
                9.21417115,
                10.49398092,
                9.05720182,
                9.32688819,
                8.12831473,
                8.24136615,
                9.15841316,
                5.86662328
            ],
            [
                6.01547398, 9.42550924, 8.66281077, 8.87139933, 8.11152007, 9.24272648, 8.70555687,
                9.20206075, 7.74873663, 5.20943493
            ],
            [
                5.07176934, 8.84735538, 7.38173032, 8.24260552, 6.93597847, 7.44047807, 7.77846844,
                8.7075759, 7.3446365, 5.61368279
            ],
            [
                6.37486004, 8.10966092, 6.77250776, 6.92455312, 7.07969414, 7.90609476, 8.94145937,
                9.65441508, 8.29664071, 5.62122328
            ],
            [
                4.40364119, 7.40229927, 6.94606958, 7.7933146, 6.86111019, 6.61544192, 6.53157858,
                7.48381671, 8.46944469, 5.15820533
            ],
            [
                4.67482559, 7.96019394, 7.35097078, 6.46418174, 6.04581536, 5.65031954, 7.3437577,
                8.36108539, 8.95457741, 5.97270234
            ],
            [
                2.97235863, 4.11688471, 4.47366513, 3.91693035, 3.03485142, 3.23938801, 3.91959912,
                3.85636414, 4.97092169, 4.39635476
            ]
        ],
        [
            [
                1.50929837, 3.46120666, 3.62426208, 3.80796859, 4.32002647, 4.90427642, 4.02344493,
                3.82274284, 3.75366431, 2.63384037
            ],
            [
                2.68843703, 5.57729063, 5.83197221, 5.86182654, 6.85848651, 7.53967131, 6.33862021,
                6.033953, 5.57647283, 4.4104846
            ],
            [
                3.42228925, 6.0257591, 5.6068554, 6.22404, 7.00836441, 7.45918847, 6.87033898,
                6.6415836, 5.33983999, 4.10259506
            ],
            [
                4.96836445, 6.62010451, 6.19637232, 6.43581779, 6.60375316, 6.16118842, 6.22922331,
                5.90605686, 4.39879086, 2.93049201
            ],
            [
                4.61754523, 6.54932581, 6.60828605, 6.20446479, 6.16755675, 6.33733942, 5.74968466,
                4.9924507, 4.51242215, 3.68280158
            ],
            [
                3.25300732, 6.00079462, 5.26265666, 4.65854157, 6.24103894, 6.51245179, 5.80353526,
                5.42306553, 6.0303309, 4.62011142
            ],
            [
                2.88469022, 4.53863592, 4.79635866, 6.8680302, 5.99885302, 6.95328155, 5.75702908,
                6.11179417, 7.16091762, 5.75960082
            ],
            [
                2.33149308, 4.71185131, 5.34924149, 6.70286145, 6.14094239, 7.23545619, 5.73115769,
                7.10120178, 7.26691092, 4.67435278
            ],
            [
                2.78070473, 6.37714692, 6.29248307, 7.53128054, 6.5039021, 6.74507023, 6.0058739,
                6.84050227, 6.86716243, 4.25799047
            ],
            [
                4.67609683, 7.02089366, 6.48994304, 6.49695903, 5.36551273, 6.2297367, 6.79915056,
                6.35165195, 5.6882547, 3.68245133
            ],
            [
                4.45769121, 5.84370696, 5.31159894, 5.47585943, 5.22634538, 6.56472777, 5.7328145,
                5.49736619, 5.67132712, 3.46351706
            ],
            [
                3.80546142, 5.59334864, 5.68015227, 5.13294261, 5.28614489, 4.79111478, 5.89312892,
                6.52086724, 6.00572348, 4.61524933
            ],
            [
                3.10660147, 5.81218827, 5.17085342, 6.35046071, 5.15008041, 4.52393781, 5.23454386,
                5.70459759, 6.10052206, 3.95631431
            ],
            [
                3.25101948, 6.42742261, 5.7675651, 5.23059459, 4.76146466, 4.500623, 6.24536119,
                5.80961843, 6.51850124, 4.78829469
            ],
            [
                2.07193332, 4.3428964, 3.2363818, 2.91065918, 2.48579183, 2.98213231, 3.61996648,
                3.05498257, 4.53586033, 2.93934886
            ]
        ]
    ];
    let current_output33 = conv_layer33.transposed_convolve(&test_input33);

    assert!(
        arr_allclose(&current_output33, &target_output33),
        "{:?} was not equal to {:?}",
        current_output33,
        target_output33
    );

    let test_input34 = array![
        [
            [
                0.24347919, 0.40963667, 0.63046388, 0.75179944, 0.80969514, 0.2812572, 0.11798965,
                0.49123767, 0.73792547, 0.22850095
            ],
            [
                0.62749545, 0.89611953, 0.31128858, 0.80628721, 0.21004042, 0.3544465, 0.8088834,
                0.85645072, 0.46399202, 0.20020892
            ],
            [
                0.08549125, 0.35634012, 0.03540009, 0.77337723, 0.70889044, 0.09217655, 0.87673543,
                0.9426528, 0.58291622, 0.30130406
            ],
            [
                0.16301909, 0.0944681, 0.23441528, 0.90797043, 0.90145279, 0.24369994, 0.2838537,
                0.32066758, 0.79607784, 0.56776601
            ],
            [
                0.50041421, 0.34351262, 0.87097508, 0.25846851, 0.073712, 0.9854414, 0.60836831,
                0.4639875, 0.96524579, 0.62289318
            ],
            [
                0.3737181, 0.30079423, 0.45311149, 0.25970123, 0.9429725, 0.41643037, 0.69547592,
                0.73089413, 0.0905933, 0.03334849
            ],
            [
                0.29520317, 0.56612268, 0.87598385, 0.93907558, 0.41250329, 0.88977554, 0.4284044,
                0.92078727, 0.73429885, 0.31191634
            ],
            [
                0.24273861, 0.69013932, 0.79549046, 0.28346228, 0.11162559, 0.9433393, 0.43174559,
                0.25342619, 0.97997188, 0.59608303
            ],
            [
                0.01020594, 0.17467396, 0.40597111, 0.09651362, 0.75093255, 0.93793651, 0.6906772,
                0.51348118, 0.06181999, 0.32160864
            ],
            [
                0.83901932, 0.83502749, 0.65370291, 0.43052903, 0.09720926, 0.33532811, 0.98038,
                0.07002939, 0.67309957, 0.03085073
            ],
            [
                0.32178713, 0.4738019, 0.56926561, 0.14488118, 0.51752584, 0.23400443, 0.80049902,
                0.93996754, 0.17341075, 0.03602418
            ],
            [
                0.98975373, 0.82341714, 0.05961503, 0.73146342, 0.06353119, 0.03754231, 0.63790369,
                0.6027391, 0.49273726, 0.2512326
            ],
            [
                0.19610796, 0.09570289, 0.04465344, 0.78414181, 0.1981256, 0.97743477, 0.62677189,
                0.94379323, 0.988714, 0.78618207
            ],
            [
                0.02465102, 0.48378264, 0.24973846, 0.567762, 0.50358063, 0.20003983, 0.84032411,
                0.54944956, 0.64089587, 0.22300935
            ],
            [
                0.24467071, 0.61783527, 0.8582606, 0.77554787, 0.5126941, 0.0230855, 0.9588296,
                0.45325498, 0.683872, 0.75535528
            ]
        ],
        [
            [
                0.90468352, 0.60722577, 0.48729266, 0.01828734, 0.55155872, 0.02171726, 0.55979637,
                0.39773066, 0.62877269, 0.34299508
            ],
            [
                0.13617096, 0.22381137, 0.89989186, 0.28058093, 0.624826, 0.68141172, 0.73368046,
                0.21469765, 0.35325025, 0.04351308
            ],
            [
                0.83614248, 0.44486797, 0.2680516, 0.24527767, 0.68573928, 0.12456267, 0.30580729,
                0.60448478, 0.42652364, 0.70030772
            ],
            [
                0.83405675, 0.08900488, 0.30584645, 0.34385299, 0.06450016, 0.33126374, 0.59831811,
                0.77379525, 0.54153732, 0.58397647
            ],
            [
                0.68535022, 0.71969319, 0.96733229, 0.27877971, 0.41049452, 0.80110875, 0.36608541,
                0.17686931, 0.60172473, 0.49907431
            ],
            [
                0.89941189, 0.18797121, 0.10839786, 0.7990956, 0.00780931, 0.65771893, 0.74264273,
                0.06487331, 0.57531947, 0.2183497
            ],
            [
                0.82032319, 0.39532875, 0.13500708, 0.24393125, 0.24904966, 0.6434753, 0.39092495,
                0.85790158, 0.71120442, 0.25900781
            ],
            [
                0.67265618, 0.39667855, 0.46194788, 0.04589476, 0.96615008, 0.66905059, 0.19752927,
                0.76460449, 0.17361285, 0.75835558
            ],
            [
                0.73965278, 0.548008, 0.11726482, 0.4329183, 0.20413886, 0.30405672, 0.42594294,
                0.15392463, 0.63994197, 0.08576126
            ],
            [
                0.15898854, 0.01823248, 0.07116336, 0.56922323, 0.73808075, 0.19046576, 0.30617487,
                0.5020335, 0.5407328, 0.69176406
            ],
            [
                0.00428626, 0.65561724, 0.61406088, 0.02854472, 0.47540663, 0.29656564, 0.72377891,
                0.82019403, 0.79970537, 0.41112671
            ],
            [
                0.94812499, 0.40705784, 0.31219292, 0.61573525, 0.39289419, 0.44004992, 0.23984882,
                0.14184482, 0.51329168, 0.74445659
            ],
            [
                0.67951568, 0.22880991, 0.75851502, 0.11000468, 0.1739437, 0.78593124, 0.35241284,
                0.21768595, 0.37378608, 0.91304193
            ],
            [
                0.24466188, 0.56357547, 0.89810349, 0.38986935, 0.22162441, 0.27213954, 0.21961822,
                0.17127731, 0.27279264, 0.63400014
            ],
            [
                0.51283934, 0.27180223, 0.70780036, 0.46033949, 0.01668165, 0.07096933, 0.7827301,
                0.8978265, 0.80056171, 0.18399844
            ]
        ],
        [
            [
                0.47314249, 0.86921247, 0.95562974, 0.04734821, 0.42094677, 0.63521049, 0.9649235,
                0.28408016, 0.79151296, 0.19306875
            ],
            [
                0.13554665, 0.1633328, 0.76315687, 0.84441454, 0.53877719, 0.05251975, 0.79337929,
                0.75173919, 0.06500999, 0.43850119
            ],
            [
                0.69816248, 0.6846752, 0.34605654, 0.96546158, 0.22902155, 0.03259082, 0.91854363,
                0.71687768, 0.44551404, 0.74946473
            ],
            [
                0.28756074, 0.08960919, 0.1504656, 0.00027517, 0.90605489, 0.15447486, 0.61860231,
                0.80449299, 0.32701141, 0.67936611
            ],
            [
                0.5214441, 0.02228682, 0.94790417, 0.17437271, 0.10160465, 0.905918, 0.8720237,
                0.11822662, 0.29906486, 0.73652102
            ],
            [
                0.6750893, 0.02313892, 0.2191324, 0.21096338, 0.87218304, 0.95184779, 0.03589433,
                0.52363878, 0.70597609, 0.95876525
            ],
            [
                0.15409674, 0.69822298, 0.57747238, 0.07672973, 0.20543934, 0.12059071, 0.22073089,
                0.6251803, 0.56495953, 0.14152616
            ],
            [
                0.65048585, 0.82848393, 0.64076772, 0.52548448, 0.42764381, 0.87510546, 0.1761435,
                0.1872986, 0.66374146, 0.52372973
            ],
            [
                0.31344927, 0.43795346, 0.58385119, 0.61369352, 0.40753573, 0.22222173, 0.35040123,
                0.18531, 0.34900957, 0.61408456
            ],
            [
                0.42606665, 0.17143779, 0.86827121, 0.01832453, 0.67363574, 0.85726322, 0.30173766,
                0.5006929, 0.65501488, 0.96728469
            ],
            [
                0.51000435, 0.96227773, 0.42686778, 0.42617895, 0.93278277, 0.43877955, 0.14248393,
                0.22887372, 0.24376215, 0.63123974
            ],
            [
                0.58244146, 0.48135027, 0.96926086, 0.51262372, 0.67349477, 0.4486914, 0.48540265,
                0.11459019, 0.28885736, 0.62988748
            ],
            [
                0.49702555, 0.84473474, 0.2107247, 0.15507113, 0.78666898, 0.86842649, 0.26662722,
                0.40488556, 0.12784363, 0.60226463
            ],
            [
                0.51268086, 0.73620858, 0.83027626, 0.51128653, 0.16209527, 0.19405387, 0.5287593,
                0.09636498, 0.49485251, 0.70122978
            ],
            [
                0.75046489, 0.24232137, 0.28558206, 0.44918119, 0.4269658, 0.85322418, 0.68977981,
                0.16423885, 0.1453211, 0.70120077
            ]
        ]
    ];

    let kernel34: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.24273652, 0.67968707, 0.18765942, 0.99651706, 0.88996416, 0.86496958, 0.01413134,
            0.18041472, 0.92680912, 0.67749169, 0.73981748, 0.96671593, 0.10672154, 0.93596465,
            0.72950961, 0.68890187, 0.9459864, 0.47556961, 0.47170237, 0.34875945, 0.1234179,
            0.98466107, 0.45740373, 0.83530281, 0.44633841, 0.0870765, 0.40952955, 0.25765672,
            0.25925851, 0.53559016, 0.95371341, 0.01269416, 0.09122105, 0.62964726, 0.76467897,
            0.99306194, 0.34219163, 0.49390666, 0.50514804, 0.5770512, 0.40260163, 0.74138982,
            0.47966902, 0.42614142, 0.3335815, 0.46910306, 0.14822806, 0.72673336, 0.21819024,
            0.16026213, 0.642094, 0.71613216, 0.84836879, 0.12422563, 0.16952076, 0.69457865,
            0.15433822, 0.03430253, 0.12812127, 0.69403721, 0.33373702, 0.96088737, 0.09232027,
            0.3147696, 0.79055691, 0.97123837, 0.34256576, 0.9667018, 0.67973114, 0.20387095,
            0.59346559, 0.48344154, 0.61946233, 0.78040874, 0.14745255, 0.79790367, 0.8170525,
            0.18386856, 0.47463322, 0.84008337, 0.64186554, 0.38952332, 0.95664142, 0.58203895,
            0.22674556, 0.63191438, 0.1253313, 0.31589504, 0.20299436, 0.88821202, 0.32073591,
            0.26933621, 0.18764928, 0.40689033, 0.01249406, 0.04439951, 0.91816512, 0.45398696,
            0.76417686, 0.64216268, 0.51827282, 0.34041367, 0.51581155, 0.38103898, 0.626012,
            0.05526076, 0.91771805, 0.3109327, 0.32282108, 0.95785978, 0.08613525, 0.72165012,
            0.89460875, 0.95951866, 0.07959401, 0.42207908, 0.95887871, 0.85354974, 0.35312378,
            0.23533817, 0.94346024, 0.95725598, 0.12951233, 0.75168857, 0.75669426, 0.564987,
            0.93386381, 0.39094511, 0.89592202, 0.07432933, 0.48156448, 0.07481741, 0.95235692,
            0.58520721, 0.71022034, 0.31448707, 0.69144874, 0.17468196, 0.97790375, 0.19466851,
            0.59434766, 0.72717535, 0.85805033, 0.85533476, 0.10377402, 0.19074684, 0.70653358,
            0.40852476, 0.90537235, 0.79482583,
        ],
    )
    .unwrap();
    let conv_layer34 = TransposedConvolutionLayer::new(kernel34, 1, Padding::Same);
    let target_output34 = array![
        [
            [
                6.26978396,
                8.41315568,
                11.88655044,
                11.82803629,
                11.784341,
                10.55454352,
                11.42992981,
                11.83328244,
                10.35605879,
                7.9102917
            ],
            [
                6.84410176,
                10.61395347,
                13.44574906,
                13.50296746,
                15.03104785,
                15.2626093,
                14.64289401,
                16.01572755,
                15.15165384,
                10.69694503
            ],
            [
                10.9726416,
                16.36475465,
                17.00439995,
                15.95887389,
                20.43867108,
                19.84180931,
                18.79878236,
                19.41022576,
                16.58678599,
                12.35255004
            ],
            [
                9.74040254,
                12.59439111,
                17.96572197,
                17.57901366,
                17.24655112,
                20.92647536,
                20.77617622,
                19.1560715,
                15.9312757,
                12.47697695
            ],
            [
                10.19224864,
                12.82421071,
                16.60215459,
                17.01562495,
                17.57797217,
                17.33078433,
                21.23125309,
                21.42000003,
                16.48429727,
                12.56918626
            ],
            [
                10.48611604,
                14.88445834,
                17.05412074,
                18.18312216,
                18.23710315,
                18.64130633,
                21.20380143,
                21.24056416,
                16.8853808,
                13.1439313
            ],
            [
                11.38044483,
                13.50395882,
                17.44211074,
                17.91752414,
                17.51086501,
                19.56822249,
                18.96869463,
                17.46288047,
                14.15828925,
                11.7513012
            ],
            [
                10.07368719,
                13.17827536,
                16.98133878,
                18.93282668,
                18.70697703,
                18.01677669,
                20.10457063,
                19.457179,
                13.81161029,
                12.19194587
            ],
            [
                11.77411856,
                15.29101643,
                18.02135224,
                18.47971232,
                17.68175816,
                17.7948476,
                19.96607309,
                19.92822029,
                15.10640726,
                10.42845211
            ],
            [
                12.16217301,
                13.82348634,
                17.9903818,
                18.51285635,
                18.41096322,
                17.273582,
                16.98978707,
                18.19316595,
                14.45218992,
                11.07382654
            ],
            [
                10.40050897,
                14.10187857,
                18.48388934,
                17.32777026,
                17.94365841,
                16.86575785,
                17.94137776,
                17.0025719,
                15.34514843,
                11.54875745
            ],
            [
                10.56654455,
                14.85535082,
                17.70308771,
                17.80212553,
                17.39263306,
                18.05274503,
                17.83339079,
                18.64253181,
                14.53925724,
                12.08452106
            ],
            [
                11.03709169,
                15.13296349,
                18.80537024,
                17.31049617,
                16.66516877,
                17.00706555,
                18.48217532,
                18.95204865,
                15.37727616,
                11.19140308
            ],
            [
                8.18679003,
                11.29520093,
                13.31066644,
                14.46772936,
                14.68207576,
                13.42045075,
                13.76056344,
                15.24056393,
                12.31240142,
                10.23962723
            ],
            [
                5.10531564,
                8.05775372,
                8.858138,
                10.36240736,
                11.06558049,
                10.28263752,
                10.03512674,
                11.29279273,
                9.59461905,
                6.71159786
            ]
        ],
        [
            [
                6.52024267,
                9.9791779,
                11.86167439,
                11.17140992,
                12.667241,
                12.60117909,
                11.46705548,
                12.21734903,
                8.76058943,
                6.41842617
            ],
            [
                8.85332351,
                12.50606679,
                17.03341087,
                14.84958301,
                15.70196522,
                16.67818781,
                16.86051458,
                15.04877837,
                14.30934128,
                10.14271373
            ],
            [
                11.06522082,
                13.97062434,
                19.11754438,
                16.98114743,
                19.52692341,
                20.29240837,
                20.56723747,
                20.61137306,
                17.17457227,
                11.39053616
            ],
            [
                10.92573739,
                14.71535097,
                17.45650882,
                19.44185347,
                19.64287694,
                20.33327644,
                20.27528977,
                20.75283077,
                17.03442522,
                11.92525301
            ],
            [
                9.76195141,
                13.53201523,
                18.76678237,
                16.27582768,
                16.91792334,
                20.77802742,
                21.24607793,
                20.34394327,
                16.92517152,
                13.07284986
            ],
            [
                11.00442692,
                14.22120788,
                17.07449612,
                18.64406376,
                18.92120791,
                17.95241214,
                22.56460062,
                20.45665052,
                16.11965617,
                12.98763687
            ],
            [
                12.03499006,
                14.0879446,
                17.82902255,
                19.66136561,
                19.51571848,
                19.23423076,
                20.34974428,
                20.4530176,
                15.45780598,
                10.99363647
            ],
            [
                11.73098415,
                14.01030062,
                18.06273609,
                16.51119103,
                19.05586086,
                17.79703037,
                18.31293071,
                19.82780902,
                13.87715666,
                10.87599276
            ],
            [
                11.95444905,
                13.30268794,
                17.73660597,
                19.58935543,
                19.53696209,
                18.5500368,
                19.25010683,
                19.20876181,
                13.86928838,
                11.99653561
            ],
            [
                11.54232083,
                14.62910728,
                17.66376402,
                19.4998571,
                18.3569602,
                17.70257212,
                18.39069882,
                18.75444821,
                15.162401,
                10.61448289
            ],
            [
                10.63470679,
                12.65984129,
                19.6999512,
                18.79382182,
                18.91917495,
                18.93330084,
                18.7569006,
                19.19576336,
                14.61428253,
                11.00811996
            ],
            [
                11.2076618,
                15.76424423,
                18.78121512,
                18.65056003,
                18.49784638,
                17.46363195,
                18.93070279,
                18.59712818,
                14.98313202,
                10.88024371
            ],
            [
                13.24866395,
                14.80229676,
                19.46550426,
                19.29986728,
                19.87041659,
                17.83966438,
                18.39038173,
                17.399715,
                15.06995714,
                11.6539354
            ],
            [
                9.73071354,
                12.96233053,
                16.20233052,
                15.10562681,
                14.82091123,
                15.38668581,
                14.59782349,
                17.01577964,
                13.43156821,
                9.6774023
            ],
            [
                6.74198415,
                9.27519265,
                10.26388098,
                11.83732016,
                11.17395025,
                10.66814887,
                10.60989526,
                12.74930748,
                10.88854519,
                6.70117331
            ]
        ]
    ];
    let current_output34 = conv_layer34.transposed_convolve(&test_input34);

    assert!(
        arr_allclose(&current_output34, &target_output34),
        "{:?} was not equal to {:?}",
        current_output34,
        target_output34
    );

    let test_input35 = array![
        [
            [
                0.07687633, 0.56237901, 0.37210397, 0.32402095, 0.86020532, 0.53920453, 0.08114164,
                0.74336782, 0.25469407, 0.35685664
            ],
            [
                0.86973363, 0.53688057, 0.36899362, 0.10202847, 0.66700953, 0.94219908, 0.49954032,
                0.66072563, 0.82686581, 0.87665627
            ],
            [
                0.93275626, 0.21397021, 0.0644439, 0.20575599, 0.32709081, 0.66181032, 0.91093795,
                0.39366161, 0.04630919, 0.37089431
            ],
            [
                0.29092696, 0.05031264, 0.2996979, 0.74127116, 0.20186162, 0.89749388, 0.10420715,
                0.86447023, 0.73982952, 0.20779297
            ],
            [
                0.11139946, 0.76284263, 0.97084379, 0.0490358, 0.49036919, 0.64358393, 0.19578648,
                0.43352267, 0.51367435, 0.78662504
            ],
            [
                0.65377947, 0.17670311, 0.17367328, 0.00233923, 0.00231021, 0.00389791, 0.64294849,
                0.08434474, 0.33114253, 0.81666937
            ],
            [
                0.33826818, 0.12183399, 0.33545557, 0.54685839, 0.84521248, 0.9941385, 0.12511869,
                0.26069344, 0.85642479, 0.00879662
            ],
            [
                0.59791569, 0.09688276, 0.78280287, 0.27385159, 0.92959044, 0.78584508, 0.83231436,
                0.20524552, 0.01878213, 0.71677075
            ],
            [
                0.15887981, 0.40059455, 0.66439459, 0.64788268, 0.77512519, 0.7662864, 0.73911353,
                0.69836235, 0.39738613, 0.62336482
            ],
            [
                0.54919855, 0.36349991, 0.8054252, 0.83659259, 0.36451011, 0.50518927, 0.54042159,
                0.91212539, 0.71555643, 0.01313191
            ],
            [
                0.49326824, 0.65492613, 0.07114062, 0.36996741, 0.14404186, 0.81237088, 0.06082703,
                0.20571426, 0.39945283, 0.92132861
            ],
            [
                0.21043441, 0.37812721, 0.7624879, 0.89544203, 0.90565295, 0.75942208, 0.93384645,
                0.68878532, 0.61727574, 0.05089346
            ],
            [
                0.18379262, 0.22028614, 0.14761167, 0.29403458, 0.64421536, 0.47628883, 0.99768081,
                0.61404986, 0.88343812, 0.35366099
            ],
            [
                0.73580491, 0.5680527, 0.41924085, 0.99446478, 0.05723348, 0.19985354, 0.64271567,
                0.04568463, 0.31229604, 0.75534709
            ],
            [
                0.75325526, 0.00187753, 0.30964698, 0.22865262, 0.90302865, 0.98850331, 0.8284429,
                0.37859115, 0.18685541, 0.56195393
            ]
        ],
        [
            [
                0.633839, 0.2505139, 0.98390644, 0.13879821, 0.20664348, 0.18246315, 0.01311236,
                0.99554476, 0.89341886, 0.65550328
            ],
            [
                0.13707118, 0.57918429, 0.11910439, 0.42623381, 0.40042325, 0.94536603, 0.63565252,
                0.18806016, 0.54368017, 0.1023385
            ],
            [
                0.72477878, 0.05042625, 0.51689068, 0.2186272, 0.29398299, 0.0580248, 0.65191026,
                0.47664133, 0.39239797, 0.80301844
            ],
            [
                0.51822142, 0.57412097, 0.67280204, 0.06715751, 0.90230054, 0.17326476, 0.70182403,
                0.9209419, 0.88240291, 0.41356801
            ],
            [
                0.50792738, 0.86763878, 0.22796531, 0.33063061, 0.42940367, 0.52140736, 0.34581758,
                0.06805818, 0.6986198, 0.66336206
            ],
            [
                0.46031763, 0.4801953, 0.50815961, 0.49503893, 0.49589577, 0.59841743, 0.02095615,
                0.87332976, 0.5110638, 0.79257407
            ],
            [
                0.10385484, 0.63126825, 0.11150351, 0.27857724, 0.94487827, 0.94937091, 0.47886338,
                0.84670179, 0.38021401, 0.05884617
            ],
            [
                0.5415833, 0.41261146, 0.54442057, 0.60545826, 0.41381993, 0.87026292, 0.81860203,
                0.46709782, 0.40898376, 0.62087361
            ],
            [
                0.58759569, 0.0388279, 0.63224294, 0.27584866, 0.25958149, 0.27021021, 0.24461499,
                0.00961369, 0.8730841, 0.84942417
            ],
            [
                0.3442888, 0.59520939, 0.94475042, 0.39766042, 0.78973585, 0.07774603, 0.39311471,
                0.34959214, 0.56123125, 0.2203316
            ],
            [
                0.50574416, 0.47059801, 0.63118128, 0.83281698, 0.50045646, 0.93172548, 0.96874178,
                0.58185736, 0.53389046, 0.08471105
            ],
            [
                0.61946159, 0.8411948, 0.19904476, 0.52920376, 0.50989917, 0.40828152, 0.47725748,
                0.23428046, 0.25948038, 0.32125949
            ],
            [
                0.40714146, 0.40239849, 0.69953792, 0.22782035, 0.60896634, 0.30122299, 0.14788272,
                0.49422114, 0.22982639, 0.74424353
            ],
            [
                0.16851175, 0.86501438, 0.48694533, 0.4772659, 0.28980161, 0.29526738, 0.32476527,
                0.23135523, 0.76617144, 0.54947747
            ],
            [
                0.00431055, 0.50093917, 0.71765946, 0.26999854, 0.6046516, 0.34861084, 0.0269638,
                0.84930651, 0.01711699, 0.6910144
            ]
        ],
        [
            [
                0.00019201, 0.52309218, 0.54264997, 0.31141325, 0.91818535, 0.4625155, 0.9630007,
                0.85334151, 0.42821297, 0.32305949
            ],
            [
                0.62076594, 0.28923176, 0.29709434, 0.16611195, 0.85863437, 0.74362109, 0.20855806,
                0.12420983, 0.91952608, 0.94560366
            ],
            [
                0.64503006, 0.91203787, 0.90902175, 0.70866051, 0.74816811, 0.28084424, 0.79666318,
                0.9200906, 0.82739282, 0.23791489
            ],
            [
                0.29862003, 0.55451781, 0.30733632, 0.50336585, 0.30773362, 0.6186373, 0.27947529,
                0.33497574, 0.2355387, 0.10877129
            ],
            [
                0.0074059, 0.25183305, 0.7474263, 0.22444085, 0.73111453, 0.47786355, 0.06713644,
                0.38374988, 0.82775855, 0.60824179
            ],
            [
                0.22622707, 0.11856117, 0.82261454, 0.12131448, 0.94247262, 0.69715089, 0.2832979,
                0.42199442, 0.88183937, 0.81624494
            ],
            [
                0.78333484, 0.08888702, 0.2163541, 0.90094151, 0.13213386, 0.78276805, 0.88790586,
                0.93591083, 0.78930382, 0.43551798
            ],
            [
                0.54510887, 0.57379165, 0.29487029, 0.05387269, 0.34582293, 0.08032885, 0.2825168,
                0.71204413, 0.74454925, 0.9028417
            ],
            [
                0.22379005, 0.22507085, 0.69986985, 0.6868782, 0.60622379, 0.31198405, 0.68357368,
                0.50696226, 0.38162776, 0.21361107
            ],
            [
                0.34874115, 0.31975977, 0.25752734, 0.70165557, 0.75739887, 0.00322214, 0.4226255,
                0.43170354, 0.42811545, 0.35398061
            ],
            [
                0.67954128, 0.69092268, 0.60331189, 0.16861578, 0.40303023, 0.46866209, 0.40683198,
                0.41161722, 0.27997675, 0.87613357
            ],
            [
                0.38696921, 0.11339175, 0.75498722, 0.01799585, 0.03165611, 0.11710421, 0.98530619,
                0.33407968, 0.27630681, 0.10566978
            ],
            [
                0.41321653, 0.95684915, 0.54136849, 0.26203885, 0.05826038, 0.41444726, 0.87565059,
                0.15835214, 0.77575012, 0.13757225
            ],
            [
                0.61043015, 0.96306026, 0.25118007, 0.22126025, 0.32102252, 0.23228435, 0.89464567,
                0.87763587, 0.37358906, 0.13714333
            ],
            [
                0.47440106, 0.23950769, 0.9768618, 0.10685845, 0.83712214, 0.03419947, 0.34246589,
                0.08168512, 0.74862323, 0.88137543
            ]
        ]
    ];

    let kernel35: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.18473074, 0.98918114, 0.11134234, 0.13754723, 0.89887823, 0.30941917, 0.96470469,
            0.7652193, 0.72445341, 0.59369228, 0.10347938, 0.00596059, 0.46408174, 0.35232718,
            0.2175819, 0.53706421, 0.5802638, 0.47013968, 0.43169781, 0.58037295, 0.45881144,
            0.98573424, 0.14545081, 0.58244896, 0.70341062, 0.76931158, 0.14252781, 0.80080476,
            0.56032999, 0.4510186, 0.45594714, 0.91920902, 0.4904178, 0.6672297, 0.16251512,
            0.42775919, 0.16341152, 0.16981455, 0.58287087, 0.77058162, 0.06189989, 0.59737728,
            0.01001601, 0.73397514, 0.08388381, 0.60907708, 0.63557665, 0.52742458, 0.9724405,
            0.91718839, 0.83102775, 0.50172464, 0.27221084, 0.24141601, 0.92517186, 0.32296499,
            0.13749518, 0.28644226, 0.54031546, 0.54578341, 0.73527721, 0.96255358, 0.35702972,
            0.87984228, 0.30499904, 0.22845407, 0.55339915, 0.82495197, 0.85508135, 0.31527687,
            0.80873753, 0.90334527, 0.13617619, 0.73329576, 0.67739194, 0.96404635, 0.03399309,
            0.30864336, 0.75824452, 0.33783556, 0.5952234, 0.55284646, 0.50661466, 0.86376353,
            0.25140095, 0.09224023, 0.80539047, 0.79440794, 0.64622477, 0.40517598, 0.58200681,
            0.26597037, 0.99858957, 0.94154566, 0.39119188, 0.73835412, 0.69295827, 0.13366043,
            0.46008273, 0.9617593, 0.17908163, 0.9568281, 0.834809, 0.53836743, 0.21015688,
            0.08070394, 0.69065871, 0.51967306, 0.40612924, 0.05469618, 0.00813945, 0.39472164,
            0.64434471, 0.33651929, 0.65121471, 0.16662634, 0.02011058, 0.32754743, 0.54623501,
            0.07961485, 0.88741469, 0.81034217, 0.63586668, 0.34002563, 0.2497398, 0.17590073,
            0.2236522, 0.66177194, 0.19450006, 0.83005305, 0.75825053, 0.18694969, 0.51255782,
            0.24576005, 0.32921042, 0.76369396, 0.92903198, 0.770093, 0.04474735, 0.15989853,
            0.13125397, 0.71769207, 0.67708173, 0.9314477, 0.54738229, 0.80075834, 0.42184463,
            0.5656662, 0.59004674, 0.82015253,
        ],
    )
    .unwrap();
    let conv_layer35 = TransposedConvolutionLayer::new(kernel35, 1, Padding::Same);
    let target_output35 = array![
        [
            [
                6.49926933,
                6.49709722,
                10.69919821,
                9.61906797,
                11.0439351,
                11.0717982,
                13.19452177,
                12.76133101,
                9.270291,
                6.76226916
            ],
            [
                7.10367338,
                10.40851,
                13.3633986,
                14.43837063,
                15.41727724,
                14.96588014,
                16.58800746,
                15.38331941,
                14.31074985,
                10.69387937
            ],
            [
                9.89945804,
                11.88618024,
                16.73261023,
                18.04400354,
                18.15952557,
                18.9985073,
                20.99915093,
                20.04568402,
                15.15234294,
                12.86199461
            ],
            [
                10.57368004,
                11.42074647,
                18.05201408,
                18.49646677,
                18.23587063,
                16.68921457,
                20.94321279,
                21.66756828,
                16.34935487,
                11.73523721
            ],
            [
                9.23733451,
                11.33466974,
                17.33397716,
                16.85888365,
                18.70848301,
                18.36633117,
                20.4129602,
                19.53880089,
                16.37385737,
                12.75787956
            ],
            [
                9.25061766,
                11.83116662,
                15.81621868,
                18.72470351,
                17.57305403,
                18.06915942,
                21.28637383,
                20.41860906,
                15.10421176,
                13.51335842
            ],
            [
                9.60740601,
                12.11564567,
                16.61656166,
                18.8115217,
                19.63032962,
                17.22989834,
                19.71633138,
                20.26930374,
                16.71460509,
                12.36002752
            ],
            [
                9.05675404,
                12.57271704,
                16.97874475,
                17.94802063,
                20.30873134,
                19.61692202,
                20.15032695,
                20.97711473,
                16.0747886,
                12.18042297
            ],
            [
                9.53263274,
                14.82001306,
                18.12462973,
                19.55233616,
                20.79541345,
                20.59498819,
                21.04935912,
                19.97765211,
                15.15133161,
                11.94181403
            ],
            [
                10.42891044,
                12.68611096,
                18.63309951,
                18.07121029,
                20.25089577,
                17.84226308,
                18.75985286,
                19.93180734,
                15.17308362,
                10.1877336
            ],
            [
                11.71688763,
                13.79405974,
                19.32609381,
                18.31235352,
                20.92948649,
                18.70340003,
                19.0104747,
                16.77045778,
                15.40985542,
                10.19702139
            ],
            [
                10.4648161,
                15.02046144,
                18.83336219,
                18.92863984,
                19.29152479,
                18.34111458,
                19.57799474,
                17.64860322,
                15.55627494,
                9.95854923
            ],
            [
                11.05148895,
                13.52264143,
                18.90295071,
                17.15570352,
                17.51396764,
                16.74344783,
                17.56156388,
                20.37056587,
                15.03737486,
                9.57727927
            ],
            [
                8.77511125,
                11.21743813,
                15.10499703,
                14.72095559,
                15.78061448,
                13.81599777,
                15.57004428,
                14.12342994,
                13.29849516,
                8.21892557
            ],
            [
                6.65244873,
                7.82062542,
                10.19170236,
                10.45097932,
                10.35897656,
                10.52362733,
                10.24747479,
                10.82572665,
                8.86320341,
                6.9928653
            ]
        ],
        [
            [
                6.445433,
                7.69147948,
                11.12023212,
                10.62900632,
                12.30816596,
                12.37256044,
                12.46419042,
                12.33476427,
                11.11338711,
                8.05881817
            ],
            [
                8.16447397,
                10.09071865,
                13.69056728,
                14.25062815,
                14.24892126,
                16.09329538,
                17.50784987,
                15.63328353,
                14.03267806,
                11.10728116
            ],
            [
                10.53191422,
                11.78045494,
                16.79542974,
                17.57315528,
                18.22918247,
                18.35542509,
                21.56648984,
                20.93945695,
                15.02484409,
                12.37074187
            ],
            [
                7.92582837,
                11.45492239,
                15.9822104,
                16.29414054,
                17.84754054,
                16.20805472,
                18.82459292,
                19.75894323,
                15.90037825,
                12.25253945
            ],
            [
                9.25377136,
                10.95129701,
                18.04912704,
                17.18366463,
                15.92859887,
                18.14210141,
                20.90827318,
                19.1145677,
                15.83309619,
                14.28875671
            ],
            [
                9.5938845,
                10.97146531,
                15.29366695,
                18.05697549,
                17.07448657,
                17.19081348,
                18.82954249,
                20.78119119,
                15.20613866,
                13.30033147
            ],
            [
                8.67956664,
                11.79773951,
                15.227289,
                17.62588538,
                19.15009601,
                19.09393165,
                20.14766673,
                19.04715465,
                15.32170388,
                12.74584193
            ],
            [
                8.73976535,
                11.87343942,
                16.70747339,
                17.7041738,
                19.53177544,
                18.87330836,
                20.74243994,
                19.02115485,
                15.08865176,
                12.38631151
            ],
            [
                9.2526848,
                13.3107029,
                17.79878972,
                18.34060408,
                20.19286504,
                18.97542818,
                19.19449803,
                19.84114943,
                15.28654958,
                11.13715025
            ],
            [
                10.42932201,
                14.02938094,
                18.9829882,
                18.46918711,
                20.08845827,
                19.58793281,
                19.24864319,
                17.85057094,
                15.2317028,
                11.12052298
            ],
            [
                10.56545963,
                13.64691422,
                17.99760249,
                17.97614143,
                19.42166115,
                19.43639822,
                19.47216385,
                17.45710747,
                15.33916763,
                10.74775336
            ],
            [
                10.10126253,
                14.15729985,
                17.78588675,
                17.27446567,
                17.92349833,
                16.99721781,
                18.14225371,
                17.479813,
                14.82653575,
                9.73194808
            ],
            [
                10.23666467,
                13.68317463,
                17.7083836,
                18.6677315,
                17.75589416,
                16.67904535,
                17.91931611,
                19.25794634,
                15.10034301,
                10.10376104
            ],
            [
                8.56483479,
                10.48619559,
                13.29751177,
                13.47574769,
                15.27113137,
                13.67038242,
                14.61113604,
                14.89218828,
                12.17523567,
                10.00579567
            ],
            [
                6.40306397,
                8.16419301,
                10.71230515,
                9.94962858,
                10.71166199,
                9.52432217,
                9.92198474,
                11.06343794,
                9.05864953,
                7.54592309
            ]
        ]
    ];
    let current_output35 = conv_layer35.transposed_convolve(&test_input35);

    assert!(
        arr_allclose(&current_output35, &target_output35),
        "{:?} was not equal to {:?}",
        current_output35,
        target_output35
    );

    let test_input36 = array![
        [
            [
                0.14744335, 0.27474906, 0.24179935, 0.86823641, 0.56367074, 0.0704467, 0.29423888,
                0.87814266, 0.32037255, 0.36204019
            ],
            [
                0.04796435, 0.97183304, 0.76150623, 0.34112372, 0.31838857, 0.49590603, 0.92035381,
                0.79724616, 0.65137201, 0.7487701
            ],
            [
                0.49727457, 0.32119304, 0.84639637, 0.13675515, 0.68881865, 0.46670304, 0.01120028,
                0.85437147, 0.69455339, 0.33060711
            ],
            [
                0.45552251, 0.13203587, 0.90051819, 0.82701612, 0.95279021, 0.75807249, 0.49412043,
                0.20060162, 0.15141631, 0.24051304
            ],
            [
                0.16673861, 0.73915232, 0.20078433, 0.78915489, 0.30156609, 0.74811154, 0.78543182,
                0.3505642, 0.68032597, 0.58793135
            ],
            [
                0.5155471, 0.75134017, 0.41742912, 0.12312055, 0.43200329, 0.73915007, 0.16522277,
                0.19335277, 0.15157908, 0.07246574
            ],
            [
                0.96423313, 0.76062287, 0.88389369, 0.51571577, 0.52317563, 0.14464663, 0.10081304,
                0.42420647, 0.27160276, 0.02735503
            ],
            [
                0.65433181, 0.23541764, 0.20024499, 0.65018764, 0.62857684, 0.86092524, 0.26301194,
                0.8023518, 0.1087136, 0.55767337
            ],
            [
                0.9438549, 0.42205876, 0.48934633, 0.41629242, 0.62701791, 0.76865805, 0.53023434,
                0.8911174, 0.78418882, 0.73013424
            ],
            [
                0.50025973, 0.50868391, 0.90785407, 0.9309513, 0.28811681, 0.82237065, 0.48133192,
                0.49489418, 0.98279463, 0.80675121
            ],
            [
                0.79999332, 0.93675639, 0.9931557, 0.74948029, 0.56091425, 0.57785481, 0.86057987,
                0.86176524, 0.65635674, 0.22974118
            ],
            [
                0.13721496, 0.12129743, 0.20838259, 0.62454133, 0.26131329, 0.68237341, 0.68801291,
                0.33856528, 0.74370387, 0.3974338
            ],
            [
                0.52712456, 0.6003864, 0.23537809, 0.42321115, 0.43368893, 0.86083298, 0.49741832,
                0.50288332, 0.92872772, 0.26821067
            ],
            [
                0.89416932, 0.82582761, 0.48346464, 0.1432244, 0.33314272, 0.9155206, 0.85788491,
                0.03859916, 0.23407573, 0.84823863
            ],
            [
                0.93264404, 0.38202415, 0.94571847, 0.05046099, 0.48662594, 0.06154156, 0.87838069,
                0.95873825, 0.11859934, 0.50421708
            ]
        ],
        [
            [
                0.44881726, 0.5931673, 0.40400938, 0.28658122, 0.89329518, 0.02320533, 0.03034396,
                0.75402058, 0.14406462, 0.45788714
            ],
            [
                0.00839418, 0.59410407, 0.91868208, 0.92302679, 0.6097287, 0.79199237, 0.27916058,
                0.27122402, 0.82228719, 0.73517806
            ],
            [
                0.45182158, 0.52004101, 0.58354144, 0.39632239, 0.71153679, 0.16250566, 0.92856131,
                0.91238993, 0.16039995, 0.19652619
            ],
            [
                0.37596802, 0.65410342, 0.17839981, 0.06927952, 0.70495503, 0.72366526, 0.50808782,
                0.85203178, 0.74189142, 0.97485578
            ],
            [
                0.8749136, 0.35329154, 0.9820577, 0.26745335, 0.97681504, 0.40532886, 0.7912286,
                0.78630783, 0.30606501, 0.54949427
            ],
            [
                0.55701438, 0.8649087, 0.68969448, 0.92054993, 0.99912515, 0.66868106, 0.58346085,
                0.00113209, 0.47074102, 0.19266835
            ],
            [
                0.38524381, 0.25737019, 0.90755766, 0.31581315, 0.63644824, 0.09872102, 0.79017714,
                0.65233287, 0.48419539, 0.40488295
            ],
            [
                0.44561166, 0.52903243, 0.42656753, 0.39578637, 0.62058886, 0.7099823, 0.64892847,
                0.9732401, 0.42929162, 0.64263622
            ],
            [
                0.97280717, 0.47910936, 0.0154238, 0.30995611, 0.16241976, 0.46165012, 0.52038246,
                0.56117954, 0.54011283, 0.01210845
            ],
            [
                0.4283894, 0.14862853, 0.81590324, 0.48243631, 0.18747853, 0.69892482, 0.01179654,
                0.91370552, 0.09571361, 0.95533602
            ],
            [
                0.40565212, 0.2903195, 0.94823819, 0.19820047, 0.66951295, 0.42051716, 0.58038341,
                0.66435681, 0.28484772, 0.84491364
            ],
            [
                0.85153552, 0.02146405, 0.43236678, 0.53697427, 0.15343292, 0.1516315, 0.92080352,
                0.31300076, 0.83189112, 0.68853183
            ],
            [
                0.25830106, 0.79091031, 0.33316581, 0.41191933, 0.15103392, 0.76397561, 0.53218738,
                0.67208272, 0.65135998, 0.11634087
            ],
            [
                0.23144175, 0.41275221, 0.29944476, 0.19735679, 0.40494954, 0.06145637, 0.43546273,
                0.84339784, 0.08275017, 0.32855141
            ],
            [
                0.00890028, 0.7184284, 0.07065999, 0.82624813, 0.40715668, 0.69790582, 0.84586942,
                0.00000332, 0.85141331, 0.46330082
            ]
        ],
        [
            [
                0.24589908, 0.74793659, 0.63412468, 0.0549946, 0.68832872, 0.61294067, 0.5338761,
                0.89421655, 0.24979178, 0.12588895
            ],
            [
                0.71162716, 0.12240926, 0.83907365, 0.5178171, 0.23339208, 0.32547936, 0.67288975,
                0.28765338, 0.09377953, 0.75647258
            ],
            [
                0.2243251, 0.51384738, 0.98362487, 0.8633966, 0.03329961, 0.63557295, 0.9559139,
                0.37260453, 0.1630564, 0.13237824
            ],
            [
                0.59179998, 0.03602529, 0.1194161, 0.39272583, 0.08259113, 0.78851075, 0.91774833,
                0.75968786, 0.90229512, 0.56193226
            ],
            [
                0.84950987, 0.50477573, 0.88879171, 0.88052091, 0.58644972, 0.19650132, 0.92035094,
                0.59458665, 0.47080988, 0.75337563
            ],
            [
                0.26083139, 0.3283828, 0.77941395, 0.26333271, 0.34509008, 0.10943655, 0.27528195,
                0.46809964, 0.64637179, 0.12866787
            ],
            [
                0.69210669, 0.57007235, 0.9193569, 0.03087827, 0.11762658, 0.16121963, 0.74233299,
                0.63368632, 0.02730842, 0.52676918
            ],
            [
                0.92748027, 0.13649083, 0.72125885, 0.4059104, 0.05442869, 0.94360785, 0.05971876,
                0.55683117, 0.6870902, 0.587034
            ],
            [
                0.78791344, 0.28771716, 0.13252011, 0.39844673, 0.07239221, 0.30240331, 0.244513,
                0.29087691, 0.15943104, 0.52535878
            ],
            [
                0.9150655, 0.2018939, 0.14664387, 0.99723713, 0.56759683, 0.94873551, 0.21085006,
                0.91722421, 0.71209494, 0.9426647
            ],
            [
                0.3840625, 0.67782236, 0.41096005, 0.67764391, 0.82404368, 0.86567376, 0.39080777,
                0.8798289, 0.76532114, 0.27110548
            ],
            [
                0.83005267, 0.77389467, 0.08493471, 0.1904791, 0.46803958, 0.71593679, 0.3787137,
                0.42343215, 0.21949037, 0.82482719
            ],
            [
                0.5192152, 0.65928477, 0.28158224, 0.72445931, 0.80917689, 0.82699381, 0.14482398,
                0.48982612, 0.65747561, 0.82749607
            ],
            [
                0.99097864, 0.41747055, 0.25592588, 0.42734138, 0.17804485, 0.51439547, 0.94073287,
                0.23157611, 0.19056652, 0.64877469
            ],
            [
                0.06861266, 0.56075208, 0.39927631, 0.69513597, 0.5128271, 0.7744788, 0.42552201,
                0.23811352, 0.08004551, 0.97199181
            ]
        ]
    ];

    let kernel36: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.44189274, 0.35273224, 0.34018835, 0.99794289, 0.72773742, 0.06306537, 0.69505916,
            0.16330826, 0.1009869, 0.79675776, 0.84824988, 0.86103806, 0.16946437, 0.64684975,
            0.83008558, 0.62681603, 0.73975147, 0.90003187, 0.75302117, 0.66171364, 0.71855689,
            0.18436821, 0.98116717, 0.00093033, 0.2571168, 0.38397153, 0.89225879, 0.88514917,
            0.71530973, 0.88996907, 0.80435373, 0.80481122, 0.28081726, 0.50458688, 0.6516086,
            0.7360286, 0.87077282, 0.30737344, 0.53498175, 0.98524584, 0.34672759, 0.14686009,
            0.80448412, 0.99494183, 0.87277282, 0.57045179, 0.8621303, 0.2889688, 0.87345357,
            0.64978987, 0.24831195, 0.83349987, 0.3446254, 0.72145152, 0.94247339, 0.01238921,
            0.819498, 0.32281055, 0.08497369, 0.0071336, 0.05203346, 0.66084098, 0.10108794,
            0.56165096, 0.80708334, 0.28380761, 0.87905844, 0.5866165, 0.06800676, 0.0775333,
            0.00274038, 0.74695519, 0.44392092, 0.89197814, 0.41484535, 0.22997511, 0.77702889,
            0.86297947, 0.19322978, 0.50695612, 0.0514909, 0.29257269, 0.98233844, 0.9021486,
            0.1891498, 0.67275263, 0.67084452, 0.03340911, 0.38762634, 0.53311319, 0.29873172,
            0.9958155, 0.26465671, 0.18809871, 0.36512851, 0.64779928, 0.35486719, 0.82661808,
            0.61714057, 0.45104528, 0.86829475, 0.66135411, 0.2476291, 0.96241307, 0.32367118,
            0.28180112, 0.18014109, 0.02249233, 0.7238061, 0.49854496, 0.30269502, 0.53254739,
            0.41782997, 0.06027863, 0.07938977, 0.03492576, 0.53417404, 0.26585601, 0.11348119,
            0.29946155, 0.95153601, 0.42511151, 0.92493292, 0.71188184, 0.5969804, 0.0197016,
            0.82848436, 0.89561909, 0.64954203, 0.48776894, 0.43345733, 0.12409457, 0.31419478,
            0.57764804, 0.92371171, 0.58395863, 0.00156582, 0.95185973, 0.37268251, 0.16136306,
            0.94298951, 0.16060303, 0.71391422, 0.55694451, 0.41990466, 0.83710755, 0.68912517,
            0.41190581, 0.84631192, 0.31827479,
        ],
    )
    .unwrap();
    let conv_layer36 = TransposedConvolutionLayer::new(kernel36, 1, Padding::Same);
    let target_output36 = array![
        [
            [
                6.91286172,
                9.47311771,
                12.22819333,
                11.49987299,
                11.67977009,
                12.60235874,
                11.07017972,
                11.22695722,
                10.06875148,
                7.41221877
            ],
            [
                9.0577818,
                12.03087484,
                15.53785463,
                17.18172296,
                18.23342935,
                16.73096988,
                16.08596772,
                15.71399992,
                12.7745621,
                9.76655515
            ],
            [
                11.31447105,
                15.15469234,
                20.65572432,
                21.49849681,
                23.66914937,
                22.82659952,
                21.9027801,
                22.66205886,
                16.67811873,
                13.74684127
            ],
            [
                14.53903643,
                17.60553191,
                23.73712791,
                22.90780267,
                24.42673475,
                24.50015973,
                22.81681017,
                22.19925901,
                17.61218008,
                12.69378906
            ],
            [
                14.36447349,
                17.69597744,
                22.4647067,
                22.50674112,
                21.65599538,
                21.60364203,
                20.26601995,
                19.39145122,
                15.67751501,
                10.62114758
            ],
            [
                13.87366878,
                18.0395552,
                22.23469254,
                22.11558602,
                22.56123657,
                21.61111165,
                22.63032288,
                20.50374687,
                15.53505518,
                12.54808079
            ],
            [
                14.85636563,
                17.72700365,
                22.65174327,
                21.41938161,
                22.80814748,
                21.79086663,
                21.48100973,
                20.11453259,
                15.15699431,
                12.14370695
            ],
            [
                14.02340835,
                17.38585776,
                20.96691442,
                19.31418314,
                20.18963281,
                19.79237386,
                18.95030632,
                18.11193115,
                14.9847494,
                11.84527536
            ],
            [
                13.82543603,
                18.55255682,
                23.04148588,
                20.48525165,
                21.01911241,
                22.1329636,
                20.68412861,
                23.11943091,
                17.45771079,
                15.40400248
            ],
            [
                12.90199054,
                16.74330496,
                20.41660928,
                20.99179729,
                20.37782481,
                23.98761431,
                22.9517749,
                24.03724782,
                18.21068612,
                14.69254597
            ],
            [
                12.72234373,
                16.17006847,
                19.31124462,
                20.67352171,
                18.88471245,
                22.49691864,
                22.50412079,
                23.79337746,
                18.16590031,
                14.94241197
            ],
            [
                12.93950374,
                18.09022973,
                19.53896161,
                22.09046127,
                20.29610723,
                22.41369524,
                22.58494286,
                25.00824824,
                16.88433428,
                14.66290342
            ],
            [
                12.6521034,
                17.00399465,
                20.41190605,
                19.78622206,
                20.47652904,
                20.994749,
                22.13838924,
                22.61129534,
                16.46562692,
                13.56706928
            ],
            [
                8.43323301,
                13.48166527,
                15.41241255,
                17.2122513,
                15.81741106,
                17.14504587,
                17.82002843,
                19.90275208,
                14.30013731,
                9.69372187
            ],
            [
                6.44469286,
                9.48308555,
                11.4857518,
                12.2919806,
                11.93544357,
                11.68490957,
                12.51211898,
                13.19630306,
                9.55717601,
                7.52315462
            ]
        ],
        [
            [
                5.86898716,
                7.62658413,
                12.50423715,
                11.07350453,
                12.37517706,
                12.28501861,
                11.4872209,
                10.96094317,
                8.56128663,
                7.47030896
            ],
            [
                9.47909015,
                9.17794721,
                13.52575105,
                15.35456589,
                15.43353158,
                16.28369524,
                16.08999156,
                15.83570218,
                12.50700744,
                10.16630938
            ],
            [
                11.38690115,
                14.65663106,
                18.39811044,
                20.57680798,
                20.80880663,
                19.55177625,
                20.54113853,
                18.57832273,
                14.8261811,
                11.18725879
            ],
            [
                10.5433245,
                15.39397712,
                18.4395428,
                19.20023674,
                21.66042555,
                19.00498632,
                19.23197917,
                18.79735414,
                14.64213334,
                10.58062517
            ],
            [
                11.99403955,
                14.36292222,
                20.71740329,
                18.4641028,
                21.20627542,
                18.32056742,
                18.9445976,
                17.14179028,
                13.96167738,
                9.85536198
            ],
            [
                12.13156081,
                13.0804747,
                19.48842451,
                18.70262041,
                20.43875609,
                18.86164041,
                17.6693642,
                17.84167251,
                14.09136675,
                10.37804843
            ],
            [
                12.29428742,
                14.80387636,
                19.13061107,
                17.66880982,
                17.36492666,
                17.07429677,
                16.73131719,
                16.39096599,
                12.35766433,
                9.79290847
            ],
            [
                11.82675391,
                14.59997288,
                18.24923789,
                17.60204722,
                16.75071902,
                18.69854828,
                17.06873176,
                18.10603144,
                13.3262784,
                12.32247053
            ],
            [
                11.61324089,
                14.71626625,
                19.10662451,
                19.01001942,
                18.33139239,
                19.26023093,
                19.20712598,
                20.1526416,
                14.60318282,
                12.93954522
            ],
            [
                10.62764989,
                14.48296751,
                18.48472499,
                17.54184471,
                18.58270231,
                19.96962922,
                19.57105299,
                21.30023315,
                15.18887868,
                12.75702557
            ],
            [
                9.89595775,
                13.89318087,
                18.14839693,
                18.32090744,
                19.27020278,
                20.54436041,
                20.08217417,
                21.24162464,
                15.75851954,
                13.36358712
            ],
            [
                10.26793679,
                14.67037633,
                18.78074591,
                17.88747785,
                18.00986059,
                19.54266553,
                20.85651282,
                20.44277818,
                15.45177037,
                12.12830158
            ],
            [
                9.24952883,
                13.15499139,
                18.10280275,
                18.63806212,
                18.93342162,
                18.54663923,
                19.02722195,
                20.7731493,
                14.97844069,
                10.16007365
            ],
            [
                8.56335324,
                10.07547022,
                12.35970383,
                14.41525366,
                14.81432048,
                13.68991549,
                13.63135928,
                16.88093665,
                11.76418671,
                7.31141591
            ],
            [
                6.28835474,
                7.76359318,
                9.69263875,
                10.88326557,
                10.8354919,
                11.80155481,
                10.43089911,
                10.42482223,
                9.47131313,
                5.79119183
            ]
        ]
    ];
    let current_output36 = conv_layer36.transposed_convolve(&test_input36);

    assert!(
        arr_allclose(&current_output36, &target_output36),
        "{:?} was not equal to {:?}",
        current_output36,
        target_output36
    );
}

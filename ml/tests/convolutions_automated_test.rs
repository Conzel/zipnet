// This file has been automatically generated by Jinja2 via the
// script generate_tests.py.
// Please do not change this file by hand.
use ml::convolutions::*;
use ml::transposed_convolutions::*;
use ndarray::{array, Array, Array4, Dimension};

fn arr_allclose<D: Dimension>(arr1: &Array<f32, D>, arr2: &Array<f32, D>) -> bool {
    (arr1 - arr2).map(|x| (*x as f32).abs()).sum() < 1e-3
}

#[test]
fn test_py_implementation_random_arrays_conv2d() {
    let test_input1 = array![[
        [0.17014849, 0.43056882, 0.5715329, 0.06520256, 0.12669588],
        [0.75015649, 0.98379819, 0.55574155, 0.04181346, 0.23677547],
        [0.51154924, 0.02844254, 0.60484786, 0.72306337, 0.22177844],
        [0.16487044, 0.46672951, 0.54035134, 0.69223571, 0.27845532],
        [0.66966338, 0.41083884, 0.45831479, 0.70402897, 0.61773261]
    ]];

    let kernel1: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.92697753, 0.91485179, 0.85028299, 0.26970649, 0.55898563, 0.84558665, 0.75231163,
            0.90343251, 0.07658575, 0.56033562, 0.33565241, 0.96145765, 0.24242379, 0.5888119,
            0.04742411, 0.96925828, 0.2795916, 0.71978642, 0.90980128, 0.37189406, 0.55666793,
            0.79448488, 0.44166553, 0.23985275, 0.12854726, 0.75676637, 0.13313323,
        ],
    )
    .unwrap();
    let conv_layer1 = ConvolutionLayer::new(kernel1, 1, Padding::Valid);
    let target_output1 = array![
        [
            [2.9474429, 2.44179495, 2.53109307],
            [2.98536571, 3.01744503, 2.9285788],
            [2.78870154, 2.87868392, 3.08772285]
        ],
        [
            [2.66867103, 1.68862836, 1.51167395],
            [2.12464074, 2.26698925, 1.99459124],
            [2.35424635, 2.45525932, 2.31466052]
        ],
        [
            [2.07651615, 1.75432276, 1.5320527],
            [2.47174107, 2.6484499, 1.78529989],
            [1.77446713, 1.96781507, 2.37691218]
        ]
    ];
    let current_output1 = conv_layer1.convolve(&test_input1);

    assert!(
        arr_allclose(&current_output1, &target_output1),
        "{:?} was not equal to {:?}",
        current_output1,
        target_output1
    );

    let test_input2 = array![[
        [0.69580542, 0.12692, 0.38484825, 0.77533601, 0.52113837],
        [0.43646371, 0.14352315, 0.89971072, 0.64410552, 0.04471071],
        [0.76767201, 0.43464628, 0.16569944, 0.18875163, 0.12285258],
        [0.27811149, 0.53907282, 0.50665719, 0.97435566, 0.39133722],
        [0.7964828, 0.98891903, 0.35985747, 0.00756764, 0.53660642]
    ]];

    let kernel2: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.8659267, 0.0067116, 0.38848336, 0.94803988, 0.00785977, 0.07988323, 0.8462714,
            0.1022715, 0.16570753, 0.8576183, 0.65220493, 0.00744711, 0.45711016, 0.32536872,
            0.62830051, 0.70536446, 0.7567798, 0.64872344, 0.81628793, 0.72789614, 0.87157013,
            0.89837223, 0.09833383, 0.82418534, 0.92891332, 0.23972042, 0.14438818,
        ],
    )
    .unwrap();
    let conv_layer2 = ConvolutionLayer::new(kernel2, 1, Padding::Valid);
    let target_output2 = array![
        [
            [1.50500637, 1.41817504, 1.62480514],
            [1.53598703, 1.957206, 1.78222871],
            [1.723006, 1.21462485, 0.7067985]
        ],
        [
            [2.32475332, 1.93524522, 2.08178716],
            [2.51149814, 2.42335428, 2.22986004],
            [2.57485814, 2.07382375, 1.61421209]
        ],
        [
            [2.63821622, 2.05955266, 2.54145456],
            [2.7220629, 2.92977301, 2.82436621],
            [3.10913976, 2.51436792, 1.37472232]
        ]
    ];
    let current_output2 = conv_layer2.convolve(&test_input2);

    assert!(
        arr_allclose(&current_output2, &target_output2),
        "{:?} was not equal to {:?}",
        current_output2,
        target_output2
    );

    let test_input3 = array![[
        [0.62861935, 0.34163022, 0.03235205, 0.25922647, 0.59344524],
        [0.9308157, 0.22162326, 0.91818294, 0.97700956, 0.18019114],
        [0.775954, 0.14120784, 0.34261811, 0.5417864, 0.77682263],
        [0.34603763, 0.61141032, 0.97160413, 0.51576948, 0.50755494],
        [0.66598025, 0.62932201, 0.60627973, 0.27978492, 0.28792505]
    ]];

    let kernel3: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.75477028, 0.39898983, 0.98625484, 0.89887627, 0.36253916, 0.56175294, 0.36264111,
            0.69587743, 0.92333792, 0.0509604, 0.69086773, 0.22876499, 0.65723281, 0.3678665,
            0.55667271, 0.37613921, 0.48700338, 0.85647198, 0.10449678, 0.55113011, 0.75677498,
            0.69558298, 0.88718722, 0.70358317, 0.92412781, 0.71353725, 0.36252776,
        ],
    )
    .unwrap();
    let conv_layer3 = ConvolutionLayer::new(kernel3, 1, Padding::Valid);
    let target_output3 = array![
        [
            [3.04491918, 2.31410617, 2.67810801],
            [3.4158079, 3.52951861, 4.2268949],
            [3.44283667, 2.7857155, 2.97611598]
        ],
        [
            [1.99005112, 1.78992017, 2.52204812],
            [2.54500926, 2.59216792, 2.51510515],
            [2.22032051, 2.18826289, 2.31494236]
        ],
        [
            [2.50878051, 2.47597282, 3.15561158],
            [2.94162729, 3.66637323, 3.44801821],
            [3.0889231, 3.32499028, 3.24581713]
        ]
    ];
    let current_output3 = conv_layer3.convolve(&test_input3);

    assert!(
        arr_allclose(&current_output3, &target_output3),
        "{:?} was not equal to {:?}",
        current_output3,
        target_output3
    );

    let test_input4 = array![[
        [0.93732308, 0.01684272, 0.34317795, 0.92199302, 0.36392413],
        [0.7462054, 0.7556754, 0.31284245, 0.40316649, 0.73762665],
        [0.79263411, 0.36348056, 0.84374106, 0.03665259, 0.23846497],
        [0.82509994, 0.97324104, 0.96826524, 0.77620416, 0.84270752],
        [0.4298905, 0.76771309, 0.54514445, 0.78783929, 0.21897991]
    ]];

    let kernel4: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.97565903, 0.60892437, 0.21606163, 0.92175004, 0.6390296, 0.69994045, 0.02602104,
            0.33579683, 0.19149331, 0.81350477, 0.76087948, 0.50874046, 0.25765271, 0.14780204,
            0.90738844, 0.14890751, 0.33294667, 0.30113343, 0.00207204, 0.98120834, 0.21943341,
            0.33126613, 0.42324699, 0.90198509, 0.46724817, 0.73295322, 0.86124849, 0.87119263,
            0.21606776, 0.59770577, 0.86701023, 0.30423533, 0.2313126, 0.42403409, 0.36853562,
            0.62354497, 0.16869895, 0.37489849, 0.46443273, 0.78289449, 0.86106661, 0.17949399,
            0.8142977, 0.359202, 0.67269244, 0.16440929, 0.11996287, 0.8179498, 0.21363449,
            0.17302094,
        ],
    )
    .unwrap();
    let conv_layer4 = ConvolutionLayer::new(kernel4, 1, Padding::Valid);
    let target_output4 = array![[[7.1600162]], [[7.20539965]]];
    let current_output4 = conv_layer4.convolve(&test_input4);

    assert!(
        arr_allclose(&current_output4, &target_output4),
        "{:?} was not equal to {:?}",
        current_output4,
        target_output4
    );

    let test_input5 = array![[
        [0.39839588, 0.78055173, 0.85763607, 0.73359811, 0.52934056],
        [0.95292788, 0.78965247, 0.46750202, 0.08403921, 0.73126567],
        [0.34934824, 0.34592319, 0.54770445, 0.68714256, 0.29283326],
        [0.53392634, 0.88501508, 0.69093564, 0.44388365, 0.9043074],
        [0.99497239, 0.64743849, 0.36691285, 0.53965846, 0.53726039]
    ]];

    let kernel5: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.47547423, 0.65661539, 0.74741314, 0.69067845, 0.16371862, 0.34716286, 0.28848995,
            0.96499193, 0.224454, 0.73003109, 0.94379529, 0.06870039, 0.52087113, 0.75431514,
            0.05700503, 0.15765554, 0.47194286, 0.13247306, 0.81208641, 0.44457256, 0.86233215,
            0.61117267, 0.17877894, 0.77037488, 0.15101007, 0.44373917, 0.38794869, 0.45714312,
            0.96753695, 0.42877796, 0.21774843, 0.58141308, 0.57969916, 0.28950994, 0.94567369,
            0.51856594, 0.78543747, 0.93666833, 0.99582965, 0.19623296, 0.93507128, 0.12733267,
            0.7087714, 0.95363239, 0.5512328, 0.81734436, 0.25675833, 0.40766998, 0.683158,
            0.25140873,
        ],
    )
    .unwrap();
    let conv_layer5 = ConvolutionLayer::new(kernel5, 1, Padding::Valid);
    let target_output5 = array![[[7.36100675]], [[8.82961298]]];
    let current_output5 = conv_layer5.convolve(&test_input5);

    assert!(
        arr_allclose(&current_output5, &target_output5),
        "{:?} was not equal to {:?}",
        current_output5,
        target_output5
    );

    let test_input6 = array![[
        [0.2031063, 0.55377507, 0.36415587, 0.70193703, 0.27669304],
        [0.85076063, 0.00186597, 0.3316532, 0.15485734, 0.35000806],
        [0.42372493, 0.03995521, 0.50671971, 0.38907994, 0.37287286],
        [0.21294773, 0.86463558, 0.10154326, 0.75313084, 0.7910046],
        [0.15368015, 0.25977604, 0.40315585, 0.635939, 0.25689794]
    ]];

    let kernel6: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.13678746, 0.45131882, 0.00020906, 0.18134635, 0.6329186, 0.6658951, 0.40131756,
            0.57013199, 0.54676576, 0.30553623, 0.70429956, 0.70350941, 0.71328582, 0.83673465,
            0.52872152, 0.15790685, 0.05433872, 0.82469879, 0.55546729, 0.72178565, 0.6432024,
            0.24740443, 0.68764621, 0.9791666, 0.85191243, 0.43744904, 0.96080875, 0.23741228,
            0.90260192, 0.30872978, 0.56468201, 0.60942906, 0.63988189, 0.33139232, 0.04431259,
            0.67241763, 0.64735606, 0.90739846, 0.05539654, 0.3358437, 0.25059524, 0.7478619,
            0.1319153, 0.91498041, 0.72704844, 0.60438922, 0.35665986, 0.84672896, 0.90003225,
            0.07464863,
        ],
    )
    .unwrap();
    let conv_layer6 = ConvolutionLayer::new(kernel6, 1, Padding::Valid);
    let target_output6 = array![[[5.47331027]], [[5.77774546]]];
    let current_output6 = conv_layer6.convolve(&test_input6);

    assert!(
        arr_allclose(&current_output6, &target_output6),
        "{:?} was not equal to {:?}",
        current_output6,
        target_output6
    );

    let test_input7 = array![[
        [
            0.86783801, 0.58492021, 0.14913943, 0.18325551, 0.40498126, 0.75359419, 0.01821492,
            0.59172363, 0.91982274, 0.52876538, 0.71512849, 0.38420153, 0.517026, 0.51501412,
            0.26934662
        ],
        [
            0.73560452, 0.97902701, 0.63627543, 0.27803295, 0.32063981, 0.83432082, 0.78711735,
            0.28247103, 0.78126878, 0.52701458, 0.4719829, 0.47535484, 0.23715672, 0.44046767,
            0.90286418
        ],
        [
            0.66611386, 0.02649495, 0.31939759, 0.1660805, 0.5121102, 0.17436478, 0.313714,
            0.47244505, 0.99067805, 0.90646706, 0.29454134, 0.99321058, 0.12515199, 0.17643406,
            0.16320723
        ],
        [
            0.48754973, 0.53866875, 0.63589709, 0.8935865, 0.82249757, 0.92702304, 0.10556214,
            0.2828355, 0.14977625, 0.53714937, 0.06378802, 0.44972161, 0.79292246, 0.53001659,
            0.68762497
        ],
        [
            0.47446238, 0.73655207, 0.42605234, 0.65925771, 0.32377991, 0.42867732, 0.87574344,
            0.70010745, 0.01496939, 0.78416554, 0.61210718, 0.98323473, 0.93168049, 0.05175687,
            0.70876055
        ],
        [
            0.52122001, 0.68573385, 0.415587, 0.87644995, 0.73337436, 0.54510111, 0.20423086,
            0.5554448, 0.48578473, 0.27645711, 0.91929458, 0.89205094, 0.34320405, 0.4283556,
            0.3897719
        ],
        [
            0.0636046, 0.72917302, 0.1946033, 0.86342539, 0.6576018, 0.96574591, 0.22873744,
            0.47843248, 0.22157177, 0.91623065, 0.02157675, 0.44649429, 0.27921922, 0.68582704,
            0.75294507
        ],
        [
            0.79195857, 0.22560764, 0.88778717, 0.80092112, 0.00003577, 0.97378775, 0.9146247,
            0.13869576, 0.70596468, 0.0936791, 0.26477472, 0.52025, 0.0330946, 0.17754779,
            0.41998119
        ],
        [
            0.02919355, 0.82382417, 0.41568551, 0.49590722, 0.69720375, 0.71553151, 0.40795937,
            0.15397235, 0.02265206, 0.70904147, 0.75877124, 0.67035423, 0.39483563, 0.86222315,
            0.99930576
        ],
        [
            0.84902793, 0.26427645, 0.86764544, 0.24274232, 0.69865254, 0.57399909, 0.76205967,
            0.29289714, 0.88402118, 0.89428535, 0.77575279, 0.16431308, 0.48939566, 0.56055365,
            0.46453193
        ]
    ]];

    let kernel7: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.9573795, 0.88556441, 0.45529486, 0.63514714, 0.61971681, 0.7403127, 0.46075394,
            0.30692965, 0.80679556, 0.88995079, 0.61877849, 0.66261278, 0.81047396, 0.3379795,
            0.06039312, 0.02808736, 0.33537497, 0.1354166, 0.16098963, 0.95374666, 0.94970221,
            0.29953358, 0.13108306, 0.08292098, 0.59781087, 0.01351478, 0.25606222,
        ],
    )
    .unwrap();
    let conv_layer7 = ConvolutionLayer::new(kernel7, 1, Padding::Valid);
    let target_output7 = array![
        [
            [
                3.3050951, 2.46830053, 1.96149221, 2.07630303, 2.53268471, 3.01181761, 3.22083593,
                3.97027262, 4.06904504, 3.47464529, 2.92260433, 2.32383046, 2.02557322
            ],
            [
                3.45738515, 3.17886518, 3.09107826, 3.13587791, 3.00334226, 2.65108734, 2.54590534,
                2.99304317, 3.34695082, 2.96808395, 2.77951869, 3.03931672, 2.50123574
            ],
            [
                2.86750636, 2.63276914, 2.95983484, 3.03589146, 3.25215906, 2.96537873, 2.30070221,
                2.96984741, 3.2261899, 3.7692262, 3.30731293, 3.34313853, 2.58310498
            ],
            [
                3.18954493, 3.77695533, 3.8702951, 4.10283335, 3.14827405, 3.06960279, 2.45982237,
                2.31892336, 2.36856574, 3.66366537, 3.50524092, 3.6481853, 3.27511182
            ],
            [
                2.85823542, 3.58600137, 3.37043332, 4.09137107, 3.23459975, 3.06401357, 2.60126281,
                3.0399387, 2.47468593, 3.47422943, 3.67768808, 3.65438138, 3.18275654
            ],
            [
                2.93782447, 3.76177138, 3.19887062, 4.17494444, 3.85232006, 3.28370437, 2.42787549,
                2.47126978, 2.43927502, 2.87977583, 2.51873711, 2.45293211, 2.16896826
            ],
            [
                2.6858739, 3.29823277, 3.43913876, 4.01666508, 3.40887682, 3.51405636, 2.05555136,
                2.26892804, 2.71590908, 2.92872296, 2.16022655, 2.7496746, 2.94240052
            ],
            [
                3.2567448, 3.24675655, 3.38650882, 3.39716983, 3.58386833, 3.57264691, 3.02967899,
                2.5016672, 3.24014129, 2.91547159, 2.67741258, 2.59324136, 2.5412508
            ]
        ],
        [
            [
                2.73627023, 1.62000055, 1.17885824, 1.23728931, 2.10840455, 1.77752683, 1.73671865,
                2.39816519, 2.8381434, 2.45892946, 1.76668348, 1.98700168, 1.59919671
            ],
            [
                2.43594825, 2.09116237, 1.81281515, 1.63237643, 2.07996139, 2.41967793, 1.74473007,
                2.09975464, 2.2941602, 2.27912174, 1.54868059, 1.76132244, 1.43573827
            ],
            [
                1.73682338, 1.73808463, 1.77054186, 2.22400932, 1.82256393, 1.55860065, 1.52565092,
                2.22560537, 2.06037884, 2.26779818, 2.11914314, 2.42910016, 1.87579579
            ],
            [
                2.01680486, 2.43888374, 2.33589864, 2.84788505, 2.6717298, 2.16328404, 1.3455706,
                1.52426656, 1.51308177, 1.92372487, 2.1765468, 2.66822921, 2.29230004
            ],
            [
                1.83736708, 2.48986703, 1.99204654, 2.576779, 1.89173511, 2.42205555, 2.03469341,
                1.7122877, 1.57347077, 2.67139409, 2.43230967, 2.84881274, 1.70726174
            ],
            [
                2.04097822, 2.0898135, 2.37020407, 3.13267033, 2.09290777, 2.22084652, 1.73313879,
                1.72123332, 1.64550735, 1.88864624, 2.01999516, 2.05549732, 1.41016669
            ],
            [
                1.64247392, 2.1772993, 2.11129285, 2.61828499, 2.5706882, 2.53609704, 1.72982021,
                1.18634323, 1.65825227, 1.77378388, 1.3364102, 1.62036077, 1.49583955
            ],
            [
                2.04453023, 2.01976067, 2.7820441, 1.80339613, 2.22581708, 2.71009959, 1.90063246,
                1.40752232, 1.9645883, 1.89424976, 2.07692977, 1.54656159, 1.477057
            ]
        ],
        [
            [
                1.95917913, 1.36347073, 1.41686386, 1.16463355, 1.30876681, 1.69582505, 2.11913564,
                1.82876232, 2.64600559, 2.2395634, 1.44909275, 2.0138184, 0.86992389
            ],
            [
                2.10566525, 1.37690965, 1.59933219, 2.02167202, 2.17262142, 1.71432937, 1.21495791,
                1.60582364, 1.83656775, 2.05754125, 1.07385472, 2.00550974, 1.82761766
            ],
            [
                1.47108569, 1.71205073, 1.68424303, 2.01968247, 1.7968978, 1.96528094, 1.81761681,
                2.07827199, 1.05718585, 2.40190228, 1.45165841, 1.86716931, 2.07617716
            ],
            [
                1.83309208, 2.48875993, 2.01401875, 2.654167, 1.6440095, 1.55989631, 1.48287057,
                1.73037464, 1.06815173, 1.78305222, 2.37917307, 2.67266821, 2.06369725
            ],
            [
                1.31502053, 2.29036802, 1.40558106, 2.52061268, 2.2409019, 2.36267193, 0.94744005,
                1.89049797, 1.40712355, 2.27987321, 2.0773814, 1.99267312, 1.49279148
            ],
            [
                1.69478984, 1.98441603, 1.98507635, 2.61936813, 1.4752852, 2.4746717, 1.83442004,
                1.11217571, 1.78831903, 1.9799976, 1.00631844, 1.51648996, 0.93664342
            ],
            [
                1.34436571, 1.97805506, 2.24921334, 2.4023484, 1.49785577, 2.31331156, 1.61863863,
                1.24687512, 1.28678076, 1.4599191, 1.50260083, 1.95859553, 1.46336881
            ],
            [
                1.91766253, 2.01303994, 1.87676669, 1.72056867, 2.50896688, 1.93495646, 1.99478317,
                1.0296552, 1.53715338, 2.14587439, 1.91080126, 1.2427312, 1.44289102
            ]
        ]
    ];
    let current_output7 = conv_layer7.convolve(&test_input7);

    assert!(
        arr_allclose(&current_output7, &target_output7),
        "{:?} was not equal to {:?}",
        current_output7,
        target_output7
    );

    let test_input8 = array![[
        [
            0.80891573, 0.97702754, 0.41249681, 0.43591018, 0.87333111, 0.1396195, 0.5204747,
            0.88564532, 0.29781444, 0.21130918, 0.83071965, 0.3337948, 0.97835617, 0.42070098,
            0.55396016
        ],
        [
            0.16172562, 0.76349668, 0.36205767, 0.48491393, 0.49804138, 0.60014838, 0.65126087,
            0.36919112, 0.11615072, 0.26983074, 0.86905251, 0.74464162, 0.47161298, 0.72900704,
            0.842964
        ],
        [
            0.21457536, 0.93840097, 0.41665936, 0.05351101, 0.43856344, 0.72531127, 0.85203244,
            0.41512332, 0.35101932, 0.73887608, 0.3592986, 0.67414793, 0.99658078, 0.31170342,
            0.86057029
        ],
        [
            0.94308546, 0.8192489, 0.31478795, 0.75032399, 0.36604243, 0.78454617, 0.039194,
            0.23696694, 0.2418382, 0.24788351, 0.56222231, 0.15428482, 0.50688076, 0.37682603,
            0.44385925
        ],
        [
            0.00051633, 0.53422697, 0.5675659, 0.53845215, 0.2130759, 0.86445095, 0.43288101,
            0.62559181, 0.39425651, 0.07226853, 0.09869356, 0.32627373, 0.85439629, 0.85603164,
            0.25422712
        ],
        [
            0.24929269, 0.36793317, 0.39957173, 0.90795348, 0.86575798, 0.82237727, 0.60374194,
            0.76580248, 0.0215734, 0.47320398, 0.65947816, 0.86392706, 0.85666667, 0.48541846,
            0.54855826
        ],
        [
            0.58605551, 0.158874, 0.10558709, 0.19664533, 0.39609066, 0.27843866, 0.49128444,
            0.75033016, 0.35650546, 0.46870382, 0.61598491, 0.25470009, 0.17250927, 0.07203952,
            0.87246574
        ],
        [
            0.14018923, 0.12091745, 0.47703981, 0.43290495, 0.63567976, 0.76194442, 0.23835071,
            0.95481588, 0.49641545, 0.70660178, 0.10666513, 0.06810815, 0.79673209, 0.29373888,
            0.55241187
        ],
        [
            0.23906927, 0.18915932, 0.02753429, 0.14385741, 0.54197413, 0.71984385, 0.12837073,
            0.55637453, 0.14355855, 0.10225686, 0.87554918, 0.62895285, 0.21388301, 0.30016333,
            0.49605926
        ],
        [
            0.82451067, 0.45287652, 0.68369415, 0.28745724, 0.50312577, 0.26911621, 0.92149793,
            0.71658926, 0.04745785, 0.55642488, 0.34654749, 0.83168657, 0.8410765, 0.7668131,
            0.84094905
        ]
    ]];

    let kernel8: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.6012723, 0.14233574, 0.73587477, 0.43380973, 0.45914945, 0.3247378, 0.61445724,
            0.88037591, 0.59195756, 0.92569946, 0.13930365, 0.58652497, 0.62281451, 0.30819194,
            0.67601919, 0.52457897, 0.69272485, 0.37883573, 0.66010622, 0.58387869, 0.85065928,
            0.45852852, 0.70949814, 0.44835041, 0.06486581, 0.50569828, 0.77964994,
        ],
    )
    .unwrap();
    let conv_layer8 = ConvolutionLayer::new(kernel8, 1, Padding::Valid);
    let target_output8 = array![
        [
            [
                2.56528912, 2.59359776, 2.26999206, 2.16395166, 2.88791962, 2.6195639, 2.21419466,
                1.99183266, 2.39763196, 2.8449924, 3.19949952, 2.85218604, 3.59912486
            ],
            [
                2.62552227, 2.43532723, 1.89604116, 2.85934563, 2.65287337, 2.46047044, 1.49297268,
                1.70856559, 2.01769552, 2.31675556, 3.1372766, 2.42942003, 2.91849262
            ],
            [
                2.0894878, 2.59575096, 1.97343425, 2.61080761, 2.24247521, 2.54611419, 1.99044752,
                1.85005205, 1.76758237, 1.72199372, 2.40230008, 2.63992993, 2.9563559
            ],
            [
                2.40036741, 2.83884793, 2.3566639, 3.46362517, 2.65439252, 2.76143705, 1.67664659,
                1.58405455, 1.33451836, 1.90437395, 2.90543486, 2.9378474, 2.59220602
            ],
            [
                1.68236012, 2.20106605, 2.31775153, 2.6362624, 2.47416519, 2.96901156, 2.04668598,
                2.07246572, 1.90916612, 2.11319452, 2.60871672, 2.32256805, 2.53584461
            ],
            [
                1.2291609, 1.69683455, 2.48804641, 2.85783417, 2.72132931, 3.35601967, 2.21609959,
                2.72580986, 2.0896211, 2.27015874, 2.22642708, 1.850966, 2.89715129
            ],
            [
                1.23527762, 1.11282041, 1.60628246, 2.19341893, 2.01956117, 2.80082651, 2.10943602,
                2.39628782, 1.94231615, 1.64693743, 2.30989241, 1.61632986, 1.95418451
            ],
            [
                1.7335093, 1.43730972, 2.30662997, 2.4415183, 2.38300197, 2.72091951, 2.20156819,
                2.33087329, 1.92950648, 2.49757892, 2.20791853, 2.35812226, 2.91664116
            ]
        ],
        [
            [
                3.0004221, 2.79620244, 2.10305764, 2.26010354, 2.94424681, 2.61672687, 2.38793662,
                2.15100639, 2.38591645, 2.64100325, 3.21138175, 3.08029559, 3.45384368
            ],
            [
                2.64910708, 2.46040319, 2.10730203, 2.70370389, 2.8112175, 2.38245927, 1.65832775,
                1.62987667, 1.77937887, 2.44623564, 3.08990958, 2.55834582, 2.88402906
            ],
            [
                2.18004013, 2.78816486, 1.95536786, 2.25131458, 2.49795369, 2.74202016, 2.3035927,
                1.93058432, 1.79063648, 1.80878796, 2.35438418, 2.9402535, 3.23845108
            ],
            [
                2.65258663, 2.8002605, 2.51947628, 3.50296303, 2.73644936, 2.74276631, 1.71692676,
                1.40174398, 1.40112858, 1.97771444, 2.88397116, 2.82768438, 2.53412525
            ],
            [
                1.54698832, 2.17290247, 2.25266299, 2.53619125, 2.36166049, 3.00879843, 2.26267127,
                2.16235087, 1.82673452, 1.95496529, 2.29314961, 2.29714408, 2.58676638
            ],
            [
                1.21796403, 1.81405087, 2.5524894, 3.12574029, 3.08987175, 3.21873453, 2.56712946,
                2.67294637, 2.09070346, 2.24589508, 2.29217588, 2.41630384, 2.90886527
            ],
            [
                1.36262746, 0.96379354, 1.38693775, 2.08228645, 2.13942416, 2.51812312, 2.28626012,
                2.40008479, 1.79089381, 2.01975333, 2.42685006, 1.46671994, 1.76271013
            ],
            [
                1.61475866, 1.60733623, 2.25422179, 2.49275048, 2.40042674, 2.93217358, 2.40741101,
                2.41947372, 2.14886897, 2.35173723, 2.10719963, 2.42170126, 3.00647241
            ]
        ],
        [
            [
                2.75605323, 2.83703675, 2.05647305, 2.44487374, 3.08276195, 2.71009858, 2.65449738,
                2.25588048, 1.95610682, 3.00797343, 3.4239958, 3.097587, 3.75198144
            ],
            [
                2.8970893, 2.99507585, 1.88624482, 2.71063924, 2.5414227, 2.82637301, 1.904377,
                1.6828129, 1.92284647, 2.2353804, 3.08038347, 2.6656953, 2.88467668
            ],
            [
                2.57250672, 3.02380427, 2.11962707, 2.60555408, 2.37384848, 2.91929082, 2.04495692,
                1.68347833, 1.63992992, 1.67797014, 2.20136803, 2.89048541, 2.9531792
            ],
            [
                2.37350835, 2.92072574, 2.8187235, 3.41843209, 3.13643564, 3.24675855, 1.91994265,
                1.99497518, 1.38582602, 2.08042057, 2.81216545, 3.08574825, 3.1450032
            ],
            [
                1.54286783, 1.94109527, 2.43747255, 2.63142373, 2.80419754, 3.14760348, 2.53720599,
                2.46370273, 1.97528158, 2.16866265, 2.47408491, 2.37054807, 2.95425917
            ],
            [
                1.41287811, 1.40636021, 2.2332115, 2.83362501, 2.73319527, 3.25938599, 2.76844564,
                3.05985533, 1.94844586, 2.21230272, 2.25708068, 1.9462815, 2.65682608
            ],
            [
                1.18508183, 1.07943681, 1.60317065, 2.34517257, 2.33715494, 2.65825333, 2.22969306,
                2.57357243, 2.18590952, 2.10095453, 2.24164001, 1.87043396, 1.85972813
            ],
            [
                1.90411427, 1.44525971, 2.04958305, 2.13913466, 2.94363487, 2.66769663, 2.3118088,
                2.4468234, 1.81776798, 2.7958527, 2.54236228, 2.78253513, 3.00006785
            ]
        ]
    ];
    let current_output8 = conv_layer8.convolve(&test_input8);

    assert!(
        arr_allclose(&current_output8, &target_output8),
        "{:?} was not equal to {:?}",
        current_output8,
        target_output8
    );

    let test_input9 = array![[
        [
            0.32748001, 0.44507304, 0.74884216, 0.14428215, 0.87857769, 0.15468395, 0.66387251,
            0.30651525, 0.94925148, 0.55669755, 0.08302987, 0.45890567, 0.05946975, 0.9099885,
            0.30235246
        ],
        [
            0.24214035, 0.42138378, 0.38782486, 0.21880286, 0.91822054, 0.85290708, 0.50703254,
            0.52722338, 0.71761002, 0.560904, 0.22129431, 0.26244272, 0.65570881, 0.00633,
            0.66032144
        ],
        [
            0.45500924, 0.65239857, 0.14666249, 0.32440838, 0.28057192, 0.42671443, 0.74477623,
            0.91189731, 0.53352833, 0.36968936, 0.56937558, 0.36426733, 0.11819326, 0.95361023,
            0.13343851
        ],
        [
            0.59402418, 0.72822953, 0.93200069, 0.46956547, 0.50878742, 0.79529177, 0.73709416,
            0.33586889, 0.03185031, 0.27057355, 0.26166973, 0.58431293, 0.53371387, 0.19571388,
            0.1192536
        ],
        [
            0.75616852, 0.97167399, 0.71154076, 0.26672949, 0.07128377, 0.3383284, 0.80085631,
            0.95049468, 0.59714341, 0.78477727, 0.92326205, 0.24163639, 0.12968541, 0.5954836,
            0.6734995
        ],
        [
            0.08627631, 0.74857154, 0.87824841, 0.68631546, 0.72643531, 0.08944888, 0.68172634,
            0.4284322, 0.48237634, 0.68565236, 0.04009921, 0.0687674, 0.9063645, 0.42620142,
            0.61030612
        ],
        [
            0.10040135, 0.50107219, 0.76305701, 0.25769316, 0.88161141, 0.77701313, 0.23345616,
            0.62762325, 0.15315742, 0.73589576, 0.27520672, 0.85641517, 0.74394841, 0.65813059,
            0.40562607
        ],
        [
            0.13899311, 0.26460667, 0.91797941, 0.96651816, 0.89336775, 0.18948041, 0.93711783,
            0.71248111, 0.96575491, 0.62036752, 0.32684848, 0.11439406, 0.07654371, 0.95680341,
            0.97286393
        ],
        [
            0.60558715, 0.00439729, 0.85256128, 0.3167563, 0.1349921, 0.68338643, 0.79550468,
            0.21689218, 0.28267041, 0.12328367, 0.68900431, 0.59066495, 0.41700743, 0.30266365,
            0.57165983
        ],
        [
            0.12726786, 0.35587692, 0.16889892, 0.31148919, 0.13098989, 0.24026695, 0.55435273,
            0.34375766, 0.4225387, 0.37165097, 0.62029453, 0.60695333, 0.05756182, 0.0153275,
            0.84975781
        ]
    ]];

    let kernel9: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.79796967, 0.71562921, 0.56803027, 0.04944435, 0.89416437, 0.56024177, 0.67900197,
            0.6412177, 0.36936092, 0.40719958, 0.09058711, 0.87562728, 0.59729163, 0.30899736,
            0.58685749, 0.61268537, 0.26750944, 0.37185488, 0.19325097, 0.33372015, 0.57711325,
            0.39304133, 0.3348802, 0.75167765, 0.67232878, 0.03709449, 0.35425208,
        ],
    )
    .unwrap();
    let conv_layer9 = ConvolutionLayer::new(kernel9, 1, Padding::Valid);
    let target_output9 = array![
        [
            [
                2.26867134, 1.851355, 2.63189519, 2.28719864, 3.57788797, 2.76264362, 3.61486802,
                3.00158199, 2.71883852, 2.19101551, 1.51396569, 2.39055729, 1.84673759
            ],
            [
                2.57005454, 2.4192683, 2.49910363, 2.40129589, 3.18587777, 3.60845354, 3.22702477,
                2.51230555, 2.09441817, 2.16009042, 2.11688019, 1.92718209, 2.45159859
            ],
            [
                3.40551273, 3.4528122, 2.31659952, 2.17982205, 2.82439562, 3.43202218, 3.05787377,
                2.6117202, 2.38302059, 2.42504766, 2.31228225, 2.39475635, 1.52152383
            ],
            [
                3.80185473, 3.61938833, 3.05749216, 2.24128761, 2.5274185, 3.05779572, 3.23776338,
                2.93753019, 2.61047983, 2.60503284, 1.95610033, 2.00052736, 2.55270608
            ],
            [
                3.04841319, 3.56003597, 3.24080302, 2.57143978, 2.67669581, 2.70724569, 2.81257881,
                3.21255669, 2.72713091, 2.29509281, 2.41901257, 2.88285239, 2.95240982
            ],
            [
                2.27762933, 3.33447811, 3.96269087, 3.23476601, 3.48211964, 2.45904176, 3.00737371,
                3.0641554, 2.40699275, 2.49541717, 2.3685966, 2.55044143, 3.47854475
            ],
            [
                2.20906186, 2.83961237, 4.02585743, 2.89677153, 3.06344806, 3.40209463, 2.92607099,
                3.10637957, 2.28500602, 2.66610478, 2.02868127, 2.6118077, 3.05333049
            ],
            [
                2.06534433, 2.29321625, 2.68564782, 2.06873291, 2.99007976, 2.59477031, 3.04679198,
                2.09380199, 2.45491411, 2.45473114, 2.32070812, 2.11706039, 2.05972805
            ]
        ],
        [
            [
                1.9497015, 1.7114117, 1.70090775, 1.81739287, 2.11229951, 2.17209525, 2.82150406,
                2.7014777, 1.96329119, 1.54014778, 1.37717985, 1.7509328, 1.70373474
            ],
            [
                2.16402381, 2.08770812, 2.32062256, 2.39582208, 2.73681235, 2.7397445, 2.30737419,
                1.74672731, 1.36167501, 1.43600556, 1.61486021, 1.7246448, 1.642956
            ],
            [
                2.68990651, 2.39916607, 1.59710072, 1.37482061, 1.87321842, 2.68664831, 2.83500753,
                2.50368791, 2.27015081, 2.29432615, 1.86733088, 1.58251485, 1.55365578
            ],
            [
                2.64839434, 2.94623095, 2.57956479, 2.1795923, 2.40112614, 2.13997628, 2.07400026,
                1.71531596, 1.71814408, 1.69496674, 1.38805312, 1.64849139, 2.05391171
            ],
            [
                2.46401536, 2.48924974, 2.12589907, 1.70100409, 2.31236455, 2.58259452, 2.21257049,
                2.50890533, 2.21216707, 2.23630218, 1.88729116, 2.37222618, 2.38667564
            ],
            [
                2.00673485, 2.72981694, 3.30043757, 2.71283119, 2.39125135, 1.99733539, 2.68290716,
                2.6050199, 2.27665927, 1.50364321, 1.48308589, 1.81488662, 2.36712019
            ],
            [
                1.99748368, 2.00583442, 2.60819204, 2.13256857, 2.17136034, 2.48359535, 2.05613158,
                1.72847922, 1.61321055, 1.9084818, 2.26984523, 2.36075466, 2.26272445
            ],
            [
                1.44445732, 2.12335742, 2.08906847, 1.73544258, 1.94915014, 2.10268959, 2.45782169,
                2.07419484, 2.03081851, 1.81515248, 1.5255452, 1.51279088, 1.85832526
            ]
        ],
        [
            [
                1.78293321, 1.35763039, 1.45675962, 1.43863393, 2.03429428, 2.10002142, 2.56363587,
                2.30195069, 1.68109364, 1.49016122, 1.06673416, 1.66815576, 1.65016251
            ],
            [
                2.06929867, 1.9470177, 2.01735286, 2.12983516, 2.27027328, 2.27623059, 2.05052412,
                1.57137555, 1.1453537, 1.2592155, 1.6824477, 1.316939, 1.43426885
            ],
            [
                2.33848087, 2.16448661, 1.46802057, 1.14381731, 1.76529164, 2.64694195, 2.60887869,
                2.04267697, 2.00374739, 1.97223803, 1.39586713, 1.58686106, 1.49648265
            ],
            [
                2.55536526, 2.73048947, 2.31624126, 1.92466505, 1.80124663, 1.80140333, 1.78994191,
                1.6583607, 1.59274344, 1.57822931, 1.42881347, 1.47239514, 1.58756268
            ],
            [
                2.02338203, 2.17018836, 1.78652237, 1.86931954, 2.15841586, 2.13948207, 1.97945678,
                2.01399038, 2.17569979, 1.85674233, 1.49673636, 2.12691335, 2.24750053
            ],
            [
                1.73528435, 2.56871301, 2.87428841, 2.18478265, 2.18694192, 2.00020625, 2.33672019,
                2.37829534, 1.83687967, 1.20824209, 1.3521193, 1.6779293, 2.34473014
            ],
            [
                1.55323757, 1.75717094, 2.28257762, 2.07382978, 1.90248102, 2.13655936, 1.70419063,
                1.6417655, 1.54591324, 1.94520243, 2.02954094, 1.76124136, 1.72787966
            ],
            [
                1.38402591, 1.80316512, 1.93153531, 1.20490995, 1.63316003, 2.06360162, 2.1870371,
                1.75363349, 1.55434417, 1.51480929, 1.43739806, 1.4424481, 1.65243463
            ]
        ]
    ];
    let current_output9 = conv_layer9.convolve(&test_input9);

    assert!(
        arr_allclose(&current_output9, &target_output9),
        "{:?} was not equal to {:?}",
        current_output9,
        target_output9
    );

    let test_input10 = array![[
        [
            0.24336163, 0.01027582, 0.26715372, 0.83992415, 0.49819484, 0.78318667, 0.70054486,
            0.87018632, 0.49413828, 0.84670646, 0.80696486, 0.09345899, 0.93408288, 0.8206956,
            0.70209366
        ],
        [
            0.32817393, 0.74420299, 0.39091238, 0.43911496, 0.92919486, 0.29325069, 0.62813333,
            0.81314307, 0.19520658, 0.47931833, 0.42483748, 0.47526902, 0.28184402, 0.09741595,
            0.45691563
        ],
        [
            0.44086095, 0.96384089, 0.33859608, 0.26381833, 0.29839757, 0.68755939, 0.09156765,
            0.58584655, 0.04617033, 0.14705709, 0.81179596, 0.16751295, 0.06864621, 0.63087308,
            0.38993102
        ],
        [
            0.3644169, 0.68174503, 0.27240898, 0.23609332, 0.21866773, 0.80119156, 0.01742986,
            0.49270406, 0.37920174, 0.90869633, 0.81912677, 0.7636344, 0.78277877, 0.96949662,
            0.79533533
        ],
        [
            0.00732174, 0.83721131, 0.94490713, 0.76702527, 0.50964799, 0.78430691, 0.73653134,
            0.71123123, 0.89694641, 0.9544987, 0.16811895, 0.97018675, 0.25394835, 0.55851589,
            0.51973415
        ],
        [
            0.4357872, 0.29419306, 0.51803759, 0.80581654, 0.71900277, 0.52249017, 0.52525959,
            0.33191478, 0.33889579, 0.18619475, 0.6839338, 0.72234724, 0.25884648, 0.79801009,
            0.36219833
        ],
        [
            0.70463167, 0.92843939, 0.46896498, 0.23158234, 0.32747797, 0.9097073, 0.74404828,
            0.03255624, 0.30697422, 0.62468214, 0.19074459, 0.98433641, 0.40385719, 0.57477091,
            0.65160056
        ],
        [
            0.68225169, 0.98408772, 0.18341686, 0.52884058, 0.92906401, 0.87780553, 0.90901809,
            0.82569947, 0.20383635, 0.71666433, 0.17061437, 0.91526777, 0.08598402, 0.70100875,
            0.40537684
        ],
        [
            0.59719821, 0.92796125, 0.15859715, 0.78590811, 0.85644881, 0.35816406, 0.79062704,
            0.96448833, 0.13154315, 0.31929042, 0.80048305, 0.07180242, 0.52815667, 0.45786336,
            0.91537885
        ],
        [
            0.97833131, 0.25753945, 0.42799363, 0.07738555, 0.92942058, 0.07022415, 0.60058223,
            0.61962778, 0.90083461, 0.04155484, 0.82207746, 0.41282525, 0.99496077, 0.31092708,
            0.47614527
        ]
    ]];

    let kernel10: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.76158205, 0.83548332, 0.17608605, 0.37469909, 0.77314743, 0.07713356, 0.71846745,
            0.51991456, 0.34880425, 0.49225648, 0.62511915, 0.06056971, 0.50451729, 0.41293453,
            0.97382413, 0.21521498, 0.00944792, 0.27621789, 0.12076204, 0.17542631, 0.1842307,
            0.35231607, 0.39297875, 0.88948243, 0.81067127, 0.35893061, 0.26307009, 0.18067755,
            0.81942836, 0.65954227, 0.61239278, 0.06132602, 0.19053963, 0.79505838, 0.52115808,
            0.88098775, 0.71349824, 0.7456122, 0.890512, 0.97795639, 0.89468117, 0.07349233,
            0.48649722, 0.20799449, 0.45519892, 0.10784956, 0.85339613, 0.54849164, 0.24437675,
            0.70959754,
        ],
    )
    .unwrap();
    let conv_layer10 = ConvolutionLayer::new(kernel10, 1, Padding::Valid);
    let target_output10 = array![
        [
            [
                5.3249673, 6.44939409, 5.0990485, 6.87680757, 6.00840875, 6.86435549, 6.48918243,
                7.13973772, 5.63156061, 6.84980114, 6.07442087
            ],
            [
                5.65490277, 6.72712519, 5.72646697, 5.67362325, 6.16344918, 5.49688379, 5.30147029,
                6.14699665, 4.73336016, 6.50181777, 5.71021176
            ],
            [
                5.93027301, 6.79893497, 5.24278352, 5.14690334, 5.47800914, 5.85630415, 4.53320905,
                5.92459277, 5.03425512, 6.60776762, 6.16016483
            ],
            [
                5.57658101, 7.41657333, 6.76115872, 6.40425219, 6.02985054, 7.19367195, 4.87377733,
                7.21508025, 5.3228233, 7.27361109, 5.90622969
            ],
            [
                6.29362636, 6.81944588, 7.15772482, 7.66248017, 6.58839543, 6.80044569, 5.77394695,
                5.96662911, 4.6424094, 6.03599596, 5.8376089
            ],
            [
                7.15815376, 5.46072836, 6.54679292, 6.15481023, 6.70037803, 5.90763111, 6.25537347,
                4.4710309, 5.91891082, 4.9145924, 6.6659765
            ]
        ],
        [
            [
                6.43989462, 7.05672232, 7.07198374, 7.70532673, 7.06016436, 7.90335827, 6.91607818,
                8.31512205, 6.99929919, 7.73881005, 7.3287599
            ],
            [
                6.35690346, 8.09263315, 6.91777853, 7.63099729, 6.45230701, 6.87513289, 7.0659991,
                7.20518108, 6.92734648, 7.50605195, 6.3446461
            ],
            [
                6.50972256, 7.2980817, 6.60414007, 7.12855135, 6.52010735, 6.87504792, 5.64612519,
                6.85428682, 6.22121029, 7.55793767, 6.97061309
            ],
            [
                7.45287471, 7.76078021, 7.40550743, 7.67079337, 7.77576131, 7.56200459, 6.27288239,
                7.96665528, 6.35830184, 8.7783626, 7.07273964
            ],
            [
                8.05018116, 8.30454269, 8.32670779, 8.83094112, 8.47357457, 7.95002859, 7.77769098,
                7.1392934, 6.37321638, 7.27940478, 6.49956012
            ],
            [
                7.31315895, 7.40505127, 8.13714345, 7.69151038, 7.91946495, 6.71963214, 6.46806697,
                6.76428316, 6.50974999, 6.82585111, 7.21070142
            ]
        ]
    ];
    let current_output10 = conv_layer10.convolve(&test_input10);

    assert!(
        arr_allclose(&current_output10, &target_output10),
        "{:?} was not equal to {:?}",
        current_output10,
        target_output10
    );

    let test_input11 = array![[
        [
            0.5087082, 0.78796805, 0.03310984, 0.20805902, 0.45704819, 0.9133983, 0.5689028,
            0.04247752, 0.55938283, 0.9835293, 0.04525762, 0.7176199, 0.82096801, 0.55757172,
            0.57441078
        ],
        [
            0.97806886, 0.34563605, 0.33249309, 0.8797563, 0.14932355, 0.1134909, 0.56457033,
            0.30096473, 0.40968749, 0.57031528, 0.88738927, 0.62423742, 0.77620891, 0.68192901,
            0.24701218
        ],
        [
            0.74485577, 0.61556436, 0.63869127, 0.05875124, 0.32109321, 0.96946657, 0.09463911,
            0.62756373, 0.34162355, 0.74390863, 0.87367778, 0.95139082, 0.24045336, 0.70034751,
            0.87750343
        ],
        [
            0.16564245, 0.63149631, 0.21785555, 0.76549871, 0.13988015, 0.03287261, 0.82226164,
            0.60896695, 0.13331373, 0.62307175, 0.23316076, 0.96002043, 0.55291535, 0.29808274,
            0.87651269
        ],
        [
            0.98263546, 0.27148732, 0.11101003, 0.2754741, 0.4540411, 0.19701396, 0.08459944,
            0.98017716, 0.98008131, 0.62585703, 0.18621969, 0.58363214, 0.17965507, 0.81336418,
            0.94554825
        ],
        [
            0.28304926, 0.32718146, 0.46701642, 0.91682272, 0.61429792, 0.19277428, 0.28408902,
            0.25507235, 0.98004533, 0.36125832, 0.96792002, 0.33258556, 0.95086255, 0.84245811,
            0.8130291
        ],
        [
            0.77749758, 0.17691322, 0.9389267, 0.22419458, 0.33442206, 0.76145851, 0.37563835,
            0.70754575, 0.1499497, 0.98738371, 0.71669681, 0.40278858, 0.22288306, 0.3279577,
            0.07722609
        ],
        [
            0.59875502, 0.8143903, 0.87905453, 0.83061284, 0.9923988, 0.61964943, 0.53640598,
            0.06662867, 0.83588266, 0.28182984, 0.66218105, 0.99850966, 0.60448395, 0.12318801,
            0.91713258
        ],
        [
            0.85405983, 0.19103892, 0.59296137, 0.9118344, 0.93811131, 0.34217221, 0.8149188,
            0.95955951, 0.02717085, 0.89163091, 0.97555751, 0.27588442, 0.59208006, 0.00008138,
            0.95520374
        ],
        [
            0.12578068, 0.01249961, 0.05413999, 0.5153533, 0.40144865, 0.86988112, 0.6468678,
            0.8840439, 0.34315115, 0.52290096, 0.66408887, 0.98115785, 0.85046167, 0.79799048,
            0.94447943
        ]
    ]];

    let kernel11: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.69304133, 0.41451566, 0.28908367, 0.11111139, 0.03633394, 0.911567, 0.00536506,
            0.34687061, 0.93070823, 0.28782295, 0.90457691, 0.47926103, 0.93169004, 0.10532705,
            0.60003114, 0.43418502, 0.02230139, 0.5576108, 0.20754221, 0.85578995, 0.42869946,
            0.48593593, 0.69407915, 0.34729281, 0.39191914, 0.90735816, 0.62247083, 0.4153976,
            0.19382912, 0.7482733, 0.45996496, 0.33826838, 0.2242362, 0.91885547, 0.73823089,
            0.17170428, 0.0032256, 0.3198661, 0.88550457, 0.32597429, 0.69308426, 0.35960107,
            0.17364207, 0.97926296, 0.14142897, 0.92443411, 0.86064773, 0.88076497, 0.71126234,
            0.05517358,
        ],
    )
    .unwrap();
    let conv_layer11 = ConvolutionLayer::new(kernel11, 1, Padding::Valid);
    let target_output11 = array![
        [
            [
                4.75609996, 4.35271596, 4.46924593, 5.06724854, 5.21777813, 6.72055389, 6.21021462,
                6.34076278, 6.75406945, 6.38589376, 7.29421463
            ],
            [
                5.50746127, 4.91191657, 4.3057824, 4.70280733, 4.27481424, 5.57580055, 5.97388575,
                7.24539972, 6.57585929, 7.44282227, 7.72385557
            ],
            [
                4.78441885, 4.78729712, 4.7358785, 5.318269, 5.43851603, 6.10631322, 6.1517019,
                7.67271681, 5.90389896, 7.17708769, 6.26446069
            ],
            [
                5.93263183, 6.46577688, 5.2264267, 4.90109472, 5.15700938, 5.64063743, 6.39830638,
                6.12101325, 7.0525281, 7.02988303, 6.71314369
            ],
            [
                6.54699561, 5.88467903, 5.59117375, 6.23434649, 6.00065006, 6.0157132, 6.76483083,
                7.61287099, 6.67626276, 5.47074476, 5.90090671
            ],
            [
                6.43478276, 6.6845551, 7.61195647, 6.99045618, 5.68088487, 5.89225062, 6.76505256,
                6.49446187, 7.82995774, 7.64052117, 7.43474819
            ]
        ],
        [
            [
                6.20313666, 5.34701793, 4.98130647, 5.24157282, 5.046023, 7.2120135, 6.7847927,
                7.33143239, 8.0192583, 7.91684365, 7.32928317
            ],
            [
                5.25899983, 4.95380932, 5.41718174, 5.99907888, 5.2570321, 6.5752854, 7.41778241,
                8.19091484, 6.92046908, 7.46674619, 8.75705953
            ],
            [
                6.24398541, 6.03811919, 5.87069242, 5.64167026, 5.76988719, 6.8702703, 6.97150535,
                8.58892034, 7.1910481, 8.44857034, 8.83658254
            ],
            [
                6.48240558, 5.95086206, 5.95253153, 7.48315318, 6.9978839, 5.92377296, 7.00493198,
                7.23027563, 7.85180859, 6.87152056, 7.40847434
            ],
            [
                8.10552449, 6.82052094, 6.76382514, 7.50708407, 7.42485446, 6.96108234, 6.85567834,
                7.93567038, 7.71558513, 8.0656455, 7.74456857
            ],
            [
                6.97926714, 6.86974153, 7.46325659, 7.42504788, 7.57283974, 7.48161278, 8.26120966,
                7.50636788, 7.85012389, 7.54613938, 8.12876336
            ]
        ]
    ];
    let current_output11 = conv_layer11.convolve(&test_input11);

    assert!(
        arr_allclose(&current_output11, &target_output11),
        "{:?} was not equal to {:?}",
        current_output11,
        target_output11
    );

    let test_input12 = array![[
        [
            0.60509269, 0.96882702, 0.47373445, 0.76571182, 0.50472077, 0.53850234, 0.05837096,
            0.56728834, 0.3979838, 0.2393961, 0.36507484, 0.01646563, 0.27730469, 0.62646277,
            0.94121945
        ],
        [
            0.66457145, 0.84257754, 0.4301739, 0.68211767, 0.60596876, 0.76295831, 0.56038121,
            0.48163054, 0.43719102, 0.43973155, 0.29997744, 0.21913478, 0.66115144, 0.20978799,
            0.176356
        ],
        [
            0.88925514, 0.14793598, 0.36509595, 0.56160287, 0.66173851, 0.30053072, 0.36820947,
            0.62227125, 0.49574589, 0.69923053, 0.32276483, 0.97024119, 0.56792343, 0.13432134,
            0.74309131
        ],
        [
            0.19231907, 0.26170298, 0.10480803, 0.00958306, 0.20726651, 0.20851518, 0.17973869,
            0.23704102, 0.11638671, 0.27359049, 0.85379089, 0.40302999, 0.75797636, 0.34342997,
            0.74670873
        ],
        [
            0.82946825, 0.91931369, 0.96549747, 0.18782941, 0.10021565, 0.05109123, 0.30693651,
            0.10895161, 0.98912135, 0.62504833, 0.50799401, 0.47125, 0.84314244, 0.60549933,
            0.92367508
        ],
        [
            0.69538954, 0.37023903, 0.67128026, 0.43450755, 0.28869845, 0.27641537, 0.83697122,
            0.68564831, 0.26890948, 0.65425914, 0.84581688, 0.51146319, 0.48995436, 0.52071318,
            0.80564772
        ],
        [
            0.67052099, 0.38358571, 0.47078377, 0.51005312, 0.82525114, 0.02126783, 0.95831531,
            0.23316967, 0.94875039, 0.96095887, 0.95734006, 0.00943314, 0.75214318, 0.46106156,
            0.84370508
        ],
        [
            0.16933449, 0.71423986, 0.53166463, 0.64001515, 0.96389141, 0.69432027, 0.85816409,
            0.70813744, 0.28369829, 0.33953485, 0.89505429, 0.20262088, 0.81930759, 0.0955688,
            0.22266188
        ],
        [
            0.63842744, 0.83041857, 0.12425002, 0.75820649, 0.09737789, 0.84872884, 0.17490041,
            0.37569722, 0.66691882, 0.89706689, 0.22398192, 0.29424526, 0.56277038, 0.41113177,
            0.78824639
        ],
        [
            0.24159204, 0.54609149, 0.2969013, 0.31420748, 0.76481112, 0.04421633, 0.96366841,
            0.98529966, 0.26998707, 0.13811645, 0.97249976, 0.41856613, 0.13321315, 0.0937838,
            0.47424142
        ]
    ]];

    let kernel12: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.79873264, 0.98567013, 0.5680892, 0.44598027, 0.37360683, 0.5493846, 0.54690884,
            0.48540582, 0.89306789, 0.55443299, 0.05176858, 0.64969627, 0.12335967, 0.21437034,
            0.68178569, 0.95553601, 0.24000139, 0.25711667, 0.64894369, 0.28551314, 0.05664136,
            0.01756373, 0.18204255, 0.77900323, 0.70093376, 0.16213139, 0.01680514, 0.19350345,
            0.32297582, 0.26240813, 0.6481355, 0.85939877, 0.78698719, 0.24216229, 0.90017566,
            0.17029644, 0.8382851, 0.14544042, 0.38366762, 0.95833224, 0.089831, 0.36792266,
            0.05608724, 0.86506391, 0.85106284, 0.92318648, 0.65967179, 0.9562488, 0.35299378,
            0.4791875,
        ],
    )
    .unwrap();
    let conv_layer12 = ConvolutionLayer::new(kernel12, 1, Padding::Valid);
    let target_output12 = array![
        [
            [
                6.36828954, 5.39023893, 4.5706853, 4.39228864, 5.14710988, 4.62749886, 5.19327883,
                5.67624786, 5.56321371, 5.67130442, 6.31359984
            ],
            [
                6.17956405, 5.23358405, 5.10830341, 4.6098348, 5.167667, 5.75188406, 5.73154495,
                6.11178065, 6.3227871, 7.10201179, 6.45374125
            ],
            [
                5.69416245, 4.68424861, 5.23967875, 4.46852711, 5.07164134, 5.38258002, 6.61986105,
                5.87327328, 7.5567915, 6.82409476, 7.08907895
            ],
            [
                6.53653416, 5.78525944, 5.9107058, 5.18815023, 4.73289365, 5.59434957, 6.75630536,
                6.0388779, 6.90083876, 7.12633852, 6.59234795
            ],
            [
                6.80461341, 6.80272234, 5.94292555, 6.10049453, 5.37833156, 6.53806979, 6.859792,
                6.36680306, 6.99348829, 7.20740803, 6.11505035
            ],
            [
                6.22922511, 5.46133017, 6.40390409, 6.37779444, 6.88071475, 6.12768364, 7.90923434,
                6.5313496, 6.69959023, 6.38589877, 6.2706202
            ]
        ],
        [
            [
                6.51942487, 5.30764945, 4.55947283, 4.93083725, 4.75314445, 4.89697909, 5.53395127,
                6.27088696, 6.14522159, 5.71005071, 7.15842841
            ],
            [
                5.62225937, 5.0681527, 4.86800146, 5.02450556, 5.06899519, 6.21969043, 6.57236147,
                6.1918034, 7.26905168, 6.64905887, 7.0984237
            ],
            [
                5.40215914, 4.55091359, 4.74563759, 5.10507828, 5.40838907, 5.96205129, 6.73746304,
                7.85411073, 7.97605217, 6.66405926, 7.69708656
            ],
            [
                6.40951124, 5.92736725, 5.64615142, 5.83210662, 5.6292367, 6.56433832, 7.84617449,
                6.58949954, 6.95689546, 7.18658846, 7.32558644
            ],
            [
                6.61649252, 5.91427999, 6.60858426, 5.63531166, 6.7522883, 7.29191643, 6.97880784,
                6.84352375, 7.75777543, 6.80139184, 6.56509048
            ],
            [
                6.48865145, 5.73099043, 7.27163415, 6.94709597, 6.39067431, 8.06136981, 8.34249863,
                6.16876587, 7.01999224, 6.19061334, 5.4537313
            ]
        ]
    ];
    let current_output12 = conv_layer12.convolve(&test_input12);

    assert!(
        arr_allclose(&current_output12, &target_output12),
        "{:?} was not equal to {:?}",
        current_output12,
        target_output12
    );

    let test_input13 = array![[
        [
            0.58050109, 0.98031991, 0.97033705, 0.48236644, 0.66855665, 0.35855146, 0.25242765,
            0.67179667, 0.26290379, 0.53677227
        ],
        [
            0.18097793, 0.07985484, 0.79416143, 0.72152353, 0.42313013, 0.6529702, 0.00384528,
            0.08442256, 0.78389844, 0.98068301
        ],
        [
            0.36212954, 0.61172485, 0.52636618, 0.8496614, 0.13177402, 0.91755979, 0.04323238,
            0.03087392, 0.03482862, 0.36226456
        ],
        [
            0.60595438, 0.29194582, 0.34645593, 0.94099127, 0.60953088, 0.86102549, 0.16275521,
            0.89393591, 0.66327933, 0.48094536
        ],
        [
            0.06551107, 0.86129209, 0.65446064, 0.95927759, 0.80004129, 0.21450381, 0.64425328,
            0.46971877, 0.84573214, 0.34651903
        ],
        [
            0.18830031, 0.57119009, 0.27269889, 0.79159571, 0.21737069, 0.04463017, 0.393406,
            0.84414825, 0.77705368, 0.63151758
        ],
        [
            0.85228959, 0.16809768, 0.2230516, 0.77322296, 0.96781482, 0.2237789, 0.89826148,
            0.27191299, 0.34780892, 0.49277796
        ],
        [
            0.14560463, 0.33638618, 0.1585067, 0.18610527, 0.69630838, 0.94298206, 0.40789625,
            0.20056698, 0.37306354, 0.93670611
        ],
        [
            0.71033061, 0.06833509, 0.48335183, 0.45182208, 0.96346166, 0.00378525, 0.33689301,
            0.28288215, 0.75004079, 0.1607512
        ],
        [
            0.51417499, 0.35879079, 0.36688787, 0.00774159, 0.15532039, 0.01133456, 0.94680933,
            0.052598, 0.73530349, 0.80965635
        ],
        [
            0.70976442, 0.37942106, 0.38656326, 0.13763146, 0.99930646, 0.67476802, 0.06055128,
            0.8463604, 0.44607292, 0.33209084
        ],
        [
            0.94373863, 0.53976141, 0.05766413, 0.64256255, 0.73574592, 0.09256811, 0.88329454,
            0.03911254, 0.78255398, 0.40048119
        ],
        [
            0.80732702, 0.80103792, 0.28867772, 0.78029255, 0.94905287, 0.53957024, 0.13691019,
            0.45134852, 0.1162144, 0.9589836
        ],
        [
            0.24819063, 0.31490639, 0.22322156, 0.39812055, 0.45308355, 0.57115231, 0.97817532,
            0.06805564, 0.53866458, 0.66998012
        ],
        [
            0.18794561, 0.84073161, 0.64728754, 0.53731097, 0.63207714, 0.00916763, 0.46754488,
            0.86709823, 0.1932068, 0.43971534
        ]
    ]];

    let kernel13: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.10441232, 0.08035297, 0.98297565, 0.76790192, 0.27582647, 0.01153891, 0.85515021,
            0.77450939, 0.55476546, 0.46486123, 0.05671094, 0.50859663, 0.23872072, 0.33816597,
            0.66960699, 0.19610136, 0.14011143, 0.52878305, 0.22910197, 0.90919751, 0.22395916,
            0.03931138, 0.42012834, 0.12918297, 0.85550643, 0.47505256, 0.50677415,
        ],
    )
    .unwrap();
    let conv_layer13 = ConvolutionLayer::new(kernel13, 1, Padding::Valid);
    let target_output13 = array![
        [
            [
                2.94987155, 3.12301811, 2.23430138, 2.89653236, 0.94218802, 1.84424429, 1.45995875,
                1.9453229
            ],
            [
                2.15605689, 2.90060009, 2.0670962, 3.18359627, 1.54542524, 1.59706021, 1.31280936,
                2.89525054
            ],
            [
                1.79263394, 3.42883933, 2.67780194, 2.95634204, 2.31415733, 1.44071428, 1.93925927,
                1.63075404
            ],
            [
                1.67641325, 3.0976728, 2.61460551, 2.57189253, 1.9188707, 2.05478505, 2.93453983,
                2.74244043
            ],
            [
                2.57523875, 2.74379732, 2.66281787, 1.95144844, 2.58590359, 2.06588108, 3.09653821,
                2.31076104
            ],
            [
                1.21402408, 2.05561084, 2.34724898, 1.50424124, 2.1502138, 2.54787818, 2.38058632,
                2.44543735
            ],
            [
                1.6032367, 1.38834961, 3.06287426, 2.40999561, 2.80700951, 1.45383087, 1.72757801,
                1.93727814
            ],
            [
                1.57244615, 1.16595188, 2.11147982, 1.68119476, 2.16308542, 0.94676749, 2.54085932,
                1.97191366
            ],
            [
                1.88092911, 1.35447615, 2.30919142, 1.36365632, 2.1641894, 1.93731698, 1.87063774,
                2.59842097
            ],
            [
                2.06991993, 1.45723436, 1.49233414, 1.63054697, 2.36220881, 1.62253744, 2.6546876,
                1.98041402
            ],
            [
                1.9283844, 2.23471308, 2.57158657, 2.76232719, 2.45812298, 1.90444075, 1.92982164,
                2.22108318
            ],
            [
                1.44317009, 1.93144486, 2.5774613, 2.16703321, 2.22899734, 1.76255992, 2.27810709,
                2.20333857
            ],
            [
                1.77950568, 2.49977317, 2.91270102, 2.41153368, 2.46286009, 1.41129499, 1.55161395,
                2.72789967
            ]
        ],
        [
            [
                1.71482486, 2.26899191, 1.95197266, 1.73520107, 1.39551313, 0.92077821, 0.52894946,
                1.11817815
            ],
            [
                1.24695525, 1.57798604, 2.08864445, 2.12780059, 1.64976248, 1.41158989, 1.22552998,
                1.63608201
            ],
            [
                1.55533893, 2.22573259, 2.29486511, 2.12351773, 1.52851731, 1.46090307, 1.5281598,
                1.42452629
            ],
            [
                1.4284313, 1.69920574, 1.7625166, 1.6785445, 1.07744974, 1.64275212, 1.90923078,
                2.31298331
            ],
            [
                1.27042331, 1.62397009, 2.14669671, 1.96327923, 1.74905071, 1.4585443, 1.81695899,
                1.519091
            ],
            [
                0.7969124, 1.05478618, 1.34152262, 1.89064969, 1.64652169, 1.493534, 1.26742651,
                1.75096141
            ],
            [
                1.2869035, 0.97909964, 1.705383, 1.88944416, 1.76568551, 0.96839239, 1.45128294,
                1.30594836
            ],
            [
                1.00594748, 0.89358524, 0.84376455, 0.90355447, 1.3191484, 1.39640378, 1.43608887,
                1.60543508
            ],
            [
                1.46265436, 0.9058513, 1.38385368, 1.59127369, 1.65223666, 1.29711893, 1.37912888,
                1.61190795
            ],
            [
                1.49124076, 1.08032273, 1.25997959, 1.35159324, 1.45717126, 1.07815649, 1.83826124,
                1.35979574
            ],
            [
                1.84008414, 1.44910057, 1.90332142, 2.0507342, 1.75066289, 1.40829573, 0.92394135,
                1.70248025
            ],
            [
                1.39111105, 1.1632141, 1.35738924, 1.74116775, 1.92292847, 1.38316488, 1.57798814,
                1.23236993
            ],
            [
                1.77579405, 1.88856952, 1.74057686, 1.65228249, 1.52756618, 1.520971, 1.26871196,
                1.50839448
            ]
        ],
        [
            [
                2.00389908, 2.06000661, 2.33384024, 2.25981558, 1.21403728, 1.52892096, 0.75183511,
                1.69042797
            ],
            [
                1.90931202, 2.43474659, 1.97848235, 2.73014774, 0.98195789, 1.75592829, 1.23171774,
                1.63355603
            ],
            [
                1.85309351, 2.50931953, 1.94255462, 2.93237381, 1.62986599, 1.88352195, 1.5131127,
                2.02832207
            ],
            [
                1.43317269, 2.96359002, 2.28943029, 2.51433382, 1.69011541, 2.14587439, 2.41567916,
                2.19880031
            ],
            [
                1.47511442, 2.51197322, 2.19616589, 1.67857553, 1.84703324, 1.38714649, 2.38363096,
                2.18682897
            ],
            [
                1.40676526, 1.62278847, 1.67938209, 2.05351834, 2.27326113, 1.82340662, 2.19057301,
                1.95946356
            ],
            [
                1.1545622, 1.47633845, 2.11743115, 1.54391949, 2.60901503, 1.63093491, 1.63847755,
                1.52332865
            ],
            [
                1.43377662, 0.85402462, 1.88818736, 1.721651, 2.09923068, 0.8345295, 1.79342474,
                2.02772984
            ],
            [
                1.77532417, 1.10988325, 1.97413432, 0.72417647, 1.44651518, 1.27704829, 2.31116505,
                1.38866105
            ],
            [
                1.74444703, 1.1299704, 1.57002454, 1.16896241, 2.69121852, 1.28047677, 2.0700343,
                2.16110534
            ],
            [
                2.05102186, 1.65221822, 2.26719879, 2.15617822, 1.78634624, 1.72213801, 1.7679013,
                1.65221283
            ],
            [
                1.70384675, 2.1970268, 2.04007837, 2.05695507, 2.75343812, 1.14066935, 1.74353696,
                1.72145238
            ],
            [
                1.40614208, 1.97583836, 2.02888232, 1.707967, 1.85203651, 1.97958472, 1.63700984,
                1.97684005
            ]
        ]
    ];
    let current_output13 = conv_layer13.convolve(&test_input13);

    assert!(
        arr_allclose(&current_output13, &target_output13),
        "{:?} was not equal to {:?}",
        current_output13,
        target_output13
    );

    let test_input14 = array![[
        [
            0.14234911, 0.51528562, 0.64461424, 0.9118427, 0.81935076, 0.98913505, 0.78423016,
            0.59264964, 0.35247177, 0.48483033
        ],
        [
            0.22649785, 0.04158387, 0.58142059, 0.8653732, 0.45242769, 0.44947337, 0.55191289,
            0.79122763, 0.75131983, 0.93151158
        ],
        [
            0.03313805, 0.41213845, 0.45310237, 0.01799934, 0.43282272, 0.23842481, 0.20688592,
            0.57869384, 0.9324833, 0.43915926
        ],
        [
            0.53123089, 0.53241858, 0.41495372, 0.22217223, 0.0080786, 0.65063344, 0.76816233,
            0.84216271, 0.27179126, 0.68530317
        ],
        [
            0.99556169, 0.77906156, 0.18006649, 0.59751925, 0.65555307, 0.94982658, 0.96909938,
            0.51224708, 0.38403579, 0.87572036
        ],
        [
            0.72604293, 0.04691354, 0.40678895, 0.35535267, 0.19270385, 0.23519029, 0.66655291,
            0.2640271, 0.55168146, 0.08576613
        ],
        [
            0.95672032, 0.57141143, 0.20602622, 0.75538652, 0.96776002, 0.44755464, 0.82362134,
            0.29203538, 0.30861593, 0.39762704
        ],
        [
            0.26186081, 0.9658112, 0.27424003, 0.50570756, 0.81148425, 0.5536027, 0.59788685,
            0.05054026, 0.28394442, 0.6402348
        ],
        [
            0.02258505, 0.60606998, 0.68343238, 0.80049993, 0.33494932, 0.42950821, 0.37033585,
            0.0394791, 0.50698832, 0.29841292
        ],
        [
            0.93881605, 0.84357476, 0.29760668, 0.25654386, 0.71037216, 0.14646495, 0.99062756,
            0.9552909, 0.79662907, 0.60948931
        ],
        [
            0.72719878, 0.09518696, 0.39577461, 0.61575269, 0.31079138, 0.46793707, 0.85144907,
            0.86081384, 0.82082742, 0.2372746
        ],
        [
            0.69777578, 0.79387192, 0.94631988, 0.99063906, 0.29514915, 0.87954188, 0.74155299,
            0.03520088, 0.83411528, 0.47134156
        ],
        [
            0.26704507, 0.28724008, 0.04289522, 0.58365099, 0.94414074, 0.5729697, 0.72244124,
            0.7707775, 0.02079507, 0.22973805
        ],
        [
            0.18128673, 0.05054512, 0.65237513, 0.27093725, 0.32479269, 0.53774402, 0.08921466,
            0.18494033, 0.78120433, 0.15868788
        ],
        [
            0.81183357, 0.21792394, 0.66204943, 0.6886836, 0.39724786, 0.59319295, 0.02472531,
            0.21891201, 0.53421341, 0.40418788
        ]
    ]];

    let kernel14: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.53426074, 0.04187773, 0.62382413, 0.7835011, 0.97746942, 0.59153586, 0.73207744,
            0.04763152, 0.81208469, 0.2046122, 0.2388364, 0.41020241, 0.47930118, 0.64151327,
            0.66274745, 0.55179525, 0.75958186, 0.22876394, 0.29362341, 0.63051956, 0.57102816,
            0.28956241, 0.41629992, 0.64542708, 0.37774231, 0.13098117, 0.6206928,
        ],
    )
    .unwrap();
    let conv_layer14 = ConvolutionLayer::new(kernel14, 1, Padding::Valid);
    let target_output14 = array![
        [
            [
                1.66193654, 2.59891884, 3.19521643, 2.81401035, 2.85048509, 2.91381892, 3.20229584,
                3.02885609
            ],
            [
                1.98837414, 2.33030919, 1.77388935, 2.25278774, 2.27267859, 3.03575749, 3.2816376,
                3.89260641
            ],
            [
                2.4628833, 2.10460538, 1.80611423, 2.10333986, 3.00020123, 3.11311058, 3.33432098,
                2.95273335
            ],
            [
                2.62754338, 1.56778239, 1.64496284, 1.83905231, 2.87911581, 3.33285264, 2.84879374,
                2.16382029
            ],
            [
                2.4718916, 2.503019, 2.77910104, 3.14979556, 3.61089943, 3.31926475, 2.44967795,
                2.45769782
            ],
            [
                2.28824305, 2.04061978, 2.55913137, 2.75698646, 2.61165726, 2.41896871, 1.93495856,
                1.68833822
            ],
            [
                3.00535246, 2.78473031, 3.12671685, 3.37650966, 2.83800447, 2.22728356, 1.64882896,
                1.56594296
            ],
            [
                3.04963729, 2.74324623, 2.87813784, 2.39183331, 3.09074973, 2.63620903, 2.47513866,
                2.79173175
            ],
            [
                2.69666086, 2.57728348, 2.39811794, 2.66459916, 2.16881329, 3.06310023, 3.32007817,
                2.69972865
            ],
            [
                3.19611754, 3.15134845, 2.92932823, 2.65956467, 3.03706627, 3.46253934, 3.93788575,
                3.32854945
            ],
            [
                1.97444848, 2.49568849, 3.08215242, 2.67481155, 3.57799963, 3.72136818, 2.75895233,
                2.79566603
            ],
            [
                2.65434212, 2.61001823, 2.94608422, 3.17684151, 2.6168509, 2.38197282, 2.61851287,
                1.78729156
            ],
            [
                1.66019045, 2.35388749, 2.62199817, 2.97177675, 2.64448875, 2.11739972, 1.80556527,
                2.15598571
            ]
        ],
        [
            [
                1.54459801, 2.43126133, 2.35553267, 2.31220128, 2.27298798, 2.33500483, 2.53081333,
                2.89209179
            ],
            [
                1.66927343, 1.71170368, 1.55122322, 1.35032701, 1.6362689, 2.3909713, 2.97110749,
                2.78835673
            ],
            [
                2.20385639, 1.44915265, 1.20777071, 1.79200774, 2.43989797, 2.90421155, 2.58928216,
                2.3686918
            ],
            [
                1.88915964, 1.55600307, 1.56657749, 2.02035762, 2.62677989, 2.80227864, 2.13718394,
                2.20817251
            ],
            [
                2.0072415, 1.66124737, 1.9629919, 2.40134261, 2.70934352, 2.42206493, 2.0053379,
                1.66950657
            ],
            [
                1.95730967, 1.93669333, 2.26206664, 2.30794454, 2.50036018, 2.00527137, 1.52952927,
                1.29090808
            ],
            [
                2.04102992, 2.30789078, 2.83202305, 2.57584399, 2.37687075, 1.63229969, 1.16374509,
                1.52808416
            ],
            [
                2.59340092, 2.40129754, 2.13206382, 2.13974238, 2.01321233, 1.73302706, 2.02382774,
                2.12030808
            ],
            [
                2.11559303, 1.92275891, 2.12511809, 1.7551781, 2.12722505, 2.6364407, 2.93653041,
                2.56929328
            ],
            [
                2.32485577, 2.38059371, 2.4136918, 1.97884969, 2.65696222, 3.20404255, 2.99754044,
                2.50107079
            ],
            [
                2.11726761, 2.37786836, 2.25371247, 2.62340218, 2.88799191, 2.58151556, 2.68494028,
                1.98452178
            ],
            [
                1.58318565, 2.21716435, 2.45459162, 2.45919359, 2.54298642, 2.06260454, 1.64954447,
                1.66892011
            ],
            [
                1.41613778, 1.72347721, 2.20469483, 2.25111678, 1.9185009, 1.52475244, 1.53950203,
                1.49661623
            ]
        ],
        [
            [
                1.23694575, 1.60296919, 2.08792544, 2.1091048, 1.89735664, 1.98705276, 2.38123756,
                2.59777213
            ],
            [
                1.45453258, 1.6680501, 1.32743455, 1.31357139, 1.77207476, 2.2929725, 2.31935901,
                2.69402319
            ],
            [
                2.09426141, 1.72852171, 1.55230893, 1.80320769, 2.23973855, 2.67464991, 2.57345554,
                2.4236557
            ],
            [
                2.13988672, 1.5147548, 1.21862432, 1.56068326, 2.0921861, 2.52939889, 2.3401176,
                1.74247747
            ],
            [
                2.15951962, 1.68020002, 2.1090586, 2.39290321, 2.49300672, 2.18178213, 2.03074754,
                1.6125334
            ],
            [
                2.19163338, 1.85319001, 1.85293975, 2.34291099, 2.47265194, 1.75850192, 1.71214039,
                1.24387519
            ],
            [
                1.95556759, 2.58619913, 2.24934254, 2.3401633, 2.24364852, 1.59358429, 1.42982199,
                1.09423435
            ],
            [
                2.08148585, 2.15854705, 2.11797176, 1.98890674, 2.17797417, 2.10087825, 2.29049981,
                2.05191084
            ],
            [
                2.14473246, 2.05961315, 1.76281024, 1.81359609, 2.00921856, 2.22918873, 2.9895985,
                2.4535256
            ],
            [
                2.68053295, 2.4151929, 2.33955415, 2.21737323, 2.32397582, 2.4556704, 2.83502985,
                2.50796797
            ],
            [
                1.6494937, 1.95338204, 2.44686162, 2.60853716, 2.55511615, 2.84887923, 2.32371947,
                1.60739248
            ],
            [
                1.62686503, 1.77483146, 1.81887993, 2.24279307, 2.13782878, 1.72869467, 1.97732001,
                1.66296152
            ],
            [
                1.41374674, 1.6353783, 2.17402131, 2.05551577, 1.78141465, 1.55957168, 1.16572734,
                1.50240773
            ]
        ]
    ];
    let current_output14 = conv_layer14.convolve(&test_input14);

    assert!(
        arr_allclose(&current_output14, &target_output14),
        "{:?} was not equal to {:?}",
        current_output14,
        target_output14
    );

    let test_input15 = array![[
        [
            0.19057496, 0.46227381, 0.97724451, 0.17967562, 0.27354005, 0.48198409, 0.09082693,
            0.62176847, 0.0965838, 0.89049918
        ],
        [
            0.53370575, 0.17222154, 0.62424076, 0.95776685, 0.99836098, 0.15088301, 0.28713444,
            0.35105018, 0.17659021, 0.96740326
        ],
        [
            0.65025777, 0.19593079, 0.31190461, 0.55247457, 0.38556734, 0.18145509, 0.94255226,
            0.70360031, 0.34025519, 0.16401337
        ],
        [
            0.28418577, 0.55049183, 0.61480714, 0.77402505, 0.37459208, 0.25677746, 0.80441073,
            0.17314304, 0.59462265, 0.30094626
        ],
        [
            0.06480476, 0.57987543, 0.62549654, 0.6065069, 0.9259787, 0.36779149, 0.69532606,
            0.83565686, 0.39276573, 0.18570695
        ],
        [
            0.61698795, 0.90647069, 0.01547038, 0.2551995, 0.11438051, 0.03861368, 0.65245317,
            0.36442749, 0.08230381, 0.79969247
        ],
        [
            0.27816204, 0.3741886, 0.44356521, 0.27386905, 0.41718068, 0.14990133, 0.4750283,
            0.63582629, 0.77572674, 0.7072159
        ],
        [
            0.34310366, 0.36999545, 0.82008522, 0.46510442, 0.92308568, 0.86201534, 0.04691705,
            0.12260284, 0.89921829, 0.47400049
        ],
        [
            0.74925438, 0.05440097, 0.28273951, 0.9184355, 0.90649879, 0.70278021, 0.19125042,
            0.86701486, 0.08634489, 0.72265401
        ],
        [
            0.7754086, 0.00211577, 0.64434053, 0.23444229, 0.98491788, 0.98933159, 0.87634913,
            0.48734385, 0.8760625, 0.53053114
        ],
        [
            0.01152504, 0.67888745, 0.7615684, 0.46805379, 0.07214947, 0.549209, 0.83832534,
            0.00365476, 0.97821559, 0.74190564
        ],
        [
            0.40790307, 0.00302504, 0.80174474, 0.76896708, 0.50054826, 0.16478458, 0.89107825,
            0.77630429, 0.73042728, 0.41667555
        ],
        [
            0.73489738, 0.71259014, 0.93557405, 0.37013117, 0.14954912, 0.33766477, 0.39673003,
            0.03940821, 0.2414454, 0.93733051
        ],
        [
            0.84819097, 0.92724316, 0.86047886, 0.92845491, 0.80238469, 0.06647867, 0.12827316,
            0.02774826, 0.89827949, 0.1193029
        ],
        [
            0.37523486, 0.28379654, 0.0638791, 0.08446726, 0.68760882, 0.26305929, 0.01052708,
            0.45302406, 0.10402057, 0.55390824
        ]
    ]];

    let kernel15: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.39986407, 0.17578217, 0.24024557, 0.12796782, 0.32475841, 0.97708859, 0.69089755,
            0.08430128, 0.72536879, 0.53770445, 0.55867786, 0.60874841, 0.80071911, 0.91969988,
            0.99522821, 0.58509184, 0.83232371, 0.26021663, 0.24856173, 0.71616314, 0.474187,
            0.38390577, 0.46712968, 0.77498844, 0.71101062, 0.49657015, 0.88695781,
        ],
    )
    .unwrap();
    let conv_layer15 = ConvolutionLayer::new(kernel15, 1, Padding::Valid);
    let target_output15 = array![
        [
            [
                1.58681589, 1.50035961, 2.00211097, 1.58624075, 1.43613632, 2.25821575, 1.52271502,
                1.69730354
            ],
            [
                1.9230784, 2.28720368, 2.50440494, 1.59083173, 1.74744348, 1.71019187, 1.49836448,
                1.92024731
            ],
            [
                1.81701675, 2.05206371, 2.26738761, 1.99223851, 2.13184706, 2.37417653, 2.21823042,
                1.40635275
            ],
            [
                1.90644329, 1.60777103, 1.32471214, 1.17426482, 1.61771893, 1.59727563, 1.75388573,
                1.39139433
            ],
            [
                1.69060713, 1.6387838, 1.73949214, 1.28253483, 1.57664236, 2.02416461, 2.19438285,
                2.09461935
            ],
            [
                1.62002047, 2.00123411, 1.64099718, 1.97857612, 1.76158116, 0.92680543, 1.5031076,
                2.38396506
            ],
            [
                1.15342412, 1.72171477, 2.49652726, 2.33682297, 2.00354583, 1.72173249, 1.88685778,
                2.01251858
            ],
            [
                1.58008552, 1.55318515, 2.5478874, 3.15105707, 2.75449974, 2.141593, 2.30037064,
                2.09085249
            ],
            [
                1.91173433, 2.1686012, 1.8219443, 1.99459756, 2.31490058, 2.35781542, 1.54779043,
                2.76675336
            ],
            [
                1.72471682, 1.99328317, 2.56713056, 1.84866582, 2.31524207, 2.68690784, 2.7514935,
                2.25683081
            ],
            [
                2.30937829, 2.37184312, 1.54202209, 1.36743396, 1.54858214, 1.2105558, 1.7908085,
                1.97331295
            ],
            [
                2.89082529, 2.83238567, 2.7580209, 1.68276066, 1.35704483, 1.0692197, 1.77270641,
                1.82702798
            ],
            [
                1.9679786, 1.3729621, 1.64186153, 1.71278524, 0.98042059, 0.67079272, 0.95840783,
                1.61317546
            ]
        ],
        [
            [
                2.69253636, 3.17714624, 3.72999227, 2.94376833, 2.18224823, 2.567847, 2.59602713,
                2.90604073
            ],
            [
                2.47404862, 3.15738448, 3.93204346, 3.12778243, 2.68534437, 3.07224427, 2.81242549,
                2.51420795
            ],
            [
                2.64512176, 3.32890747, 3.42815135, 3.08910767, 3.12972002, 3.42469541, 3.729998,
                2.58875135
            ],
            [
                3.32520915, 3.2788245, 3.14066439, 2.64219912, 2.58983609, 3.19166318, 3.1842932,
                2.23981358
            ],
            [
                2.71354772, 2.64107328, 2.3534472, 2.18358538, 2.36845161, 2.89788167, 3.1648108,
                3.16049515
            ],
            [
                2.72586472, 2.65649534, 2.32881432, 2.33897634, 2.67251532, 2.40960828, 2.57116927,
                3.47994497
            ],
            [
                2.50708319, 2.61816956, 3.6781704, 4.03943674, 3.27085998, 2.3035332, 3.10759392,
                3.46861376
            ],
            [
                2.30633368, 2.88615828, 3.99247398, 4.80571119, 4.33821867, 3.46420492, 2.87209147,
                3.53515955
            ],
            [
                2.46415181, 2.87493088, 3.76138841, 3.99078494, 4.16025851, 3.97223907, 3.28308028,
                3.64653991
            ],
            [
                2.52026435, 3.1233682, 3.41005627, 3.28766681, 3.77826958, 3.78884481, 4.16503821,
                4.10109038
            ],
            [
                3.29337171, 4.08899381, 3.3750559, 2.11991518, 2.67224473, 3.13708061, 3.18934529,
                3.17980282
            ],
            [
                4.19855258, 4.32256993, 3.98389591, 2.91711066, 2.2347543, 2.01798728, 2.32640338,
                3.21224842
            ],
            [
                4.08347512, 3.68935796, 3.19128531, 2.63252439, 1.88221526, 0.98899725, 1.71532745,
                2.22733087
            ]
        ],
        [
            [
                2.42915407, 2.33301512, 2.81463426, 2.44130475, 2.40512134, 2.45383722, 2.08127933,
                2.38186951
            ],
            [
                2.46140572, 2.94783246, 3.12925431, 2.27958512, 2.42927496, 2.21570933, 2.54738286,
                2.39702018
            ],
            [
                2.25950033, 2.92472053, 3.13959393, 2.60261739, 2.96417347, 3.00732166, 3.02427073,
                1.83869552
            ],
            [
                2.35579336, 2.60002305, 2.21396068, 1.81222143, 2.60672982, 2.34610349, 2.43737402,
                2.30533225
            ],
            [
                2.37176201, 2.36273502, 2.02638508, 1.60924754, 2.02500934, 2.46909102, 2.85732013,
                2.71702694
            ],
            [
                2.28344226, 2.24741199, 2.4039629, 2.30074626, 2.25921403, 1.71803641, 2.29784535,
                3.03511101
            ],
            [
                2.0021819, 2.39656986, 3.42484329, 3.28852798, 2.73017134, 2.62231767, 2.29031707,
                2.82092284
            ],
            [
                2.45364704, 2.07290012, 3.4811867, 4.2650338, 3.67723524, 2.92316746, 2.85320433,
                3.11340476
            ],
            [
                2.49149326, 2.52127786, 2.91530553, 2.9602233, 3.43718239, 3.13781693, 3.00006122,
                3.20204593
            ],
            [
                2.26211699, 2.79376851, 3.17040824, 2.68015142, 3.12763493, 3.17286005, 3.78767109,
                2.96641263
            ],
            [
                3.22718006, 2.94368923, 2.46535724, 1.99179085, 2.3872525, 1.88323097, 2.70161792,
                3.04520413
            ],
            [
                3.88036832, 3.91649955, 3.6068247, 2.12413401, 1.82885756, 1.53727126, 2.34035,
                2.19122561
            ],
            [
                3.04384055, 2.58551478, 2.63499858, 2.26851532, 1.65753218, 0.92027677, 1.28463859,
                2.05439325
            ]
        ]
    ];
    let current_output15 = conv_layer15.convolve(&test_input15);

    assert!(
        arr_allclose(&current_output15, &target_output15),
        "{:?} was not equal to {:?}",
        current_output15,
        target_output15
    );

    let test_input16 = array![[
        [
            0.51814858, 0.58713257, 0.76900614, 0.57457772, 0.81429287, 0.78002182, 0.70697715,
            0.33134555, 0.74070271, 0.58577558
        ],
        [
            0.40479861, 0.75061174, 0.11343616, 0.87953979, 0.83064, 0.88583721, 0.3898591,
            0.93507648, 0.96733689, 0.64465624
        ],
        [
            0.0283905, 0.22112075, 0.13918551, 0.34128339, 0.65248053, 0.29187398, 0.70765273,
            0.32796223, 0.22921298, 0.59572685
        ],
        [
            0.57266627, 0.72872377, 0.8248998, 0.29288607, 0.92347337, 0.25887515, 0.91578676,
            0.80078502, 0.76703621, 0.89904613
        ],
        [
            0.84243075, 0.70455592, 0.43518324, 0.48451255, 0.31151697, 0.10086012, 0.52423534,
            0.19001916, 0.01069371, 0.01020448
        ],
        [
            0.12606936, 0.04778918, 0.8456499, 0.57045124, 0.46361541, 0.75325534, 0.62787766,
            0.3127784, 0.9686197, 0.96754895
        ],
        [
            0.57661321, 0.64639047, 0.63473378, 0.52757851, 0.55145215, 0.08155768, 0.13378454,
            0.22621571, 0.73179848, 0.54283262
        ],
        [
            0.90943681, 0.2528448, 0.24383227, 0.74464061, 0.5544842, 0.01949351, 0.13375893,
            0.04438102, 0.84890004, 0.6848837
        ],
        [
            0.92208021, 0.00185038, 0.44556107, 0.00844186, 0.8082305, 0.33159012, 0.51384732,
            0.65069796, 0.93000012, 0.58097034
        ],
        [
            0.54131552, 0.57145609, 0.21683556, 0.85481279, 0.02262598, 0.62476623, 0.33444465,
            0.98826235, 0.03221937, 0.12669063
        ],
        [
            0.50246466, 0.42635268, 0.91064157, 0.77929238, 0.07601635, 0.6067355, 0.3940292,
            0.30074375, 0.1328066, 0.72018455
        ],
        [
            0.34319455, 0.62951615, 0.03357495, 0.03066352, 0.51702978, 0.92831143, 0.36689134,
            0.63273019, 0.37459056, 0.93406816
        ],
        [
            0.33968035, 0.59511477, 0.43509081, 0.70945081, 0.29612544, 0.80898664, 0.7905302,
            0.47484182, 0.69897064, 0.85952836
        ],
        [
            0.70326394, 0.38940283, 0.37933361, 0.22292, 0.3949557, 0.27719193, 0.86197712,
            0.9255003, 0.30563156, 0.58444322
        ],
        [
            0.36121983, 0.09087573, 0.23811614, 0.17829578, 0.93985691, 0.04807154, 0.75882014,
            0.05337733, 0.19222781, 0.98696714
        ]
    ]];

    let kernel16: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.32119673, 0.31823837, 0.26693419, 0.97081367, 0.28105716, 0.74463385, 0.86644696,
            0.28257244, 0.11623824, 0.07089514, 0.0084233, 0.77927851, 0.05098573, 0.09732427,
            0.00085336, 0.10247752, 0.59327534, 0.94160771, 0.20617688, 0.04615124, 0.00353958,
            0.96525836, 0.07020015, 0.96018511, 0.53420082, 0.38722879, 0.96274444, 0.70544795,
            0.3117258, 0.69428951, 0.62609767, 0.82056452, 0.02662205, 0.19467542, 0.71485813,
            0.31085488, 0.61566939, 0.82932135, 0.43287596, 0.23516754, 0.60939456, 0.33567884,
            0.91014123, 0.88570485, 0.59699445, 0.22236562, 0.47292595, 0.84250683, 0.09430943,
            0.75324224,
        ],
    )
    .unwrap();
    let conv_layer16 = ConvolutionLayer::new(kernel16, 1, Padding::Valid);
    let target_output16 = array![
        [
            [5.45125981, 5.54166698, 5.90192109, 6.33325154, 6.35368225, 5.48325622],
            [4.32044273, 4.31771572, 4.83527079, 5.05724884, 4.76172233, 4.51821193],
            [4.95847282, 4.16942632, 4.99304364, 5.23768753, 5.38820971, 5.98714062],
            [5.17186257, 4.04722125, 4.12205003, 3.92008087, 3.95114121, 4.08750549],
            [5.59429097, 4.41096051, 4.05182127, 4.02087124, 5.20633447, 5.11473219],
            [5.25443011, 4.02149648, 3.78061984, 3.74364214, 4.21738369, 4.44763186],
            [3.79727128, 4.65285496, 3.72835533, 4.542083, 2.9330772, 4.16885816],
            [4.39002211, 3.73425611, 4.76032239, 4.80657761, 4.37536907, 4.90362019],
            [3.95188864, 4.85435602, 4.04153987, 4.62034324, 4.18395852, 5.21115192],
            [4.11869942, 5.08861478, 5.53551745, 4.28258784, 4.34625218, 5.1656357],
            [4.54316274, 3.84430392, 5.23636885, 4.99102447, 4.7038744, 5.60627747]
        ],
        [
            [6.8424948, 7.42761531, 7.08390987, 7.85537345, 7.52403833, 6.88790732],
            [6.30935287, 6.48557221, 7.62065463, 7.22452107, 8.53445548, 7.9381869],
            [7.12102514, 6.33687347, 6.43909709, 6.30147746, 6.1324716, 5.86039735],
            [7.8179856, 6.50211427, 6.22069699, 5.91085057, 5.81709818, 6.73780837],
            [6.76448452, 5.98782551, 5.55162995, 5.22431678, 6.16548467, 6.63409377],
            [6.62900549, 6.26543972, 5.9080454, 5.59603166, 5.97093363, 6.20462925],
            [7.24681033, 5.60033377, 6.49839458, 5.40546237, 6.04675167, 5.76372367],
            [6.52110399, 5.53803397, 5.1477276, 6.54997404, 6.10571292, 6.47279961],
            [5.72728959, 6.39639956, 6.70213636, 7.16377893, 6.02936957, 7.67670612],
            [5.95555987, 6.40295242, 7.16494094, 7.18386614, 6.2121888, 7.56214166],
            [5.75038051, 5.93489426, 5.92967496, 7.00877135, 6.96740182, 7.74111427]
        ]
    ];
    let current_output16 = conv_layer16.convolve(&test_input16);

    assert!(
        arr_allclose(&current_output16, &target_output16),
        "{:?} was not equal to {:?}",
        current_output16,
        target_output16
    );

    let test_input17 = array![[
        [
            0.38793717, 0.2669936, 0.29911963, 0.73809717, 0.17850904, 0.65695777, 0.81192583,
            0.26960827, 0.12972822, 0.65970521
        ],
        [
            0.73459294, 0.64856812, 0.22981846, 0.24392553, 0.26706977, 0.32711208, 0.95813235,
            0.31259445, 0.91530424, 0.17250775
        ],
        [
            0.715259, 0.5014661, 0.72737892, 0.23862323, 0.40936508, 0.04974006, 0.86882771,
            0.46409306, 0.20740514, 0.19872624
        ],
        [
            0.27135859, 0.02647329, 0.90772042, 0.97377277, 0.47016056, 0.06899374, 0.47393377,
            0.49847801, 0.02369655, 0.10663922
        ],
        [
            0.02373338, 0.21085606, 0.56809617, 0.70259373, 0.4123619, 0.01858313, 0.25862442,
            0.4823392, 0.47215321, 0.59388602
        ],
        [
            0.82653426, 0.06712108, 0.32281389, 0.11140465, 0.59627574, 0.49184018, 0.83955359,
            0.13370071, 0.25792847, 0.54400548
        ],
        [
            0.87923629, 0.58678147, 0.03434712, 0.81235951, 0.67917911, 0.02545591, 0.2468276,
            0.91919081, 0.02958322, 0.20474248
        ],
        [
            0.76555797, 0.82307639, 0.24628638, 0.17773866, 0.17740512, 0.4937253, 0.94664534,
            0.13741272, 0.72861299, 0.53385909
        ],
        [
            0.7898385, 0.47936276, 0.23633895, 0.85722158, 0.06004518, 0.33472239, 0.50485811,
            0.09635731, 0.18004768, 0.24514199
        ],
        [
            0.22804099, 0.05106571, 0.30884217, 0.38737775, 0.7948706, 0.50525172, 0.23866583,
            0.50680708, 0.15044465, 0.09537497
        ],
        [
            0.13518302, 0.72579789, 0.8645809, 0.71760467, 0.09527912, 0.72005635, 0.73822259,
            0.41232715, 0.54910611, 0.71836695
        ],
        [
            0.0796247, 0.04476061, 0.19437055, 0.79608139, 0.6295519, 0.98046998, 0.56819233,
            0.10505454, 0.94805061, 0.10080673
        ],
        [
            0.95383711, 0.23554011, 0.94827145, 0.46488547, 0.6026009, 0.76637876, 0.3219317,
            0.4168223, 0.25562466, 0.89971455
        ],
        [
            0.59076215, 0.22263806, 0.68407231, 0.24348243, 0.94946456, 0.34627815, 0.97489059,
            0.74076656, 0.96770884, 0.13005458
        ],
        [
            0.69001644, 0.14445187, 0.92162489, 0.03732051, 0.44508552, 0.66653196, 0.9382296,
            0.80578686, 0.97614501, 0.60987449
        ]
    ]];

    let kernel17: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.04455515, 0.00950876, 0.62839465, 0.95513747, 0.79954732, 0.64281972, 0.68798538,
            0.63705762, 0.66317318, 0.58605653, 0.66924338, 0.061506, 0.82828889, 0.43634079,
            0.21192186, 0.12576633, 0.24558065, 0.45260344, 0.76206472, 0.06249312, 0.36465631,
            0.40195073, 0.73097629, 0.26523941, 0.23130116, 0.5690737, 0.02384425, 0.67610437,
            0.44314739, 0.95100098, 0.21377263, 0.62435431, 0.74306165, 0.18731794, 0.82163815,
            0.86947585, 0.4878141, 0.39436254, 0.4686375, 0.12197075, 0.81548239, 0.15653012,
            0.66066552, 0.57885796, 0.39688331, 0.32867206, 0.52372195, 0.40489907, 0.13030814,
            0.67013899,
        ],
    )
    .unwrap();
    let conv_layer17 = ConvolutionLayer::new(kernel17, 1, Padding::Valid);
    let target_output17 = array![
        [
            [4.90207096, 4.64353713, 6.15417332, 5.23972967, 4.77880207, 4.25200115],
            [5.0435142, 4.41922026, 5.19777949, 4.77410965, 4.52303341, 4.59472944],
            [5.24415561, 4.44509034, 4.98742571, 5.10121475, 4.13420096, 4.43442761],
            [6.00678854, 5.26237319, 4.93048459, 4.62804365, 4.71767736, 4.52830146],
            [5.51237783, 4.94442424, 4.61742796, 5.07260497, 3.66027793, 5.24402771],
            [5.16405135, 3.65176584, 4.82848458, 5.37067051, 4.76664494, 4.5266893],
            [4.59820677, 5.12443683, 5.66847938, 4.80858113, 4.34070203, 5.08190549],
            [4.47585183, 4.59210256, 6.07031971, 5.50886696, 5.73287594, 5.7231038],
            [4.99428747, 5.99873381, 6.47807007, 6.05730206, 5.82164392, 6.05154546],
            [5.39436534, 6.0050533, 7.22087215, 6.18297086, 6.78213394, 5.75694752],
            [6.23875632, 6.47831842, 6.81748535, 5.89194989, 7.44921338, 7.12697146]
        ],
        [
            [5.37341063, 4.8227857, 5.5972599, 5.99934268, 5.14553947, 4.43125808],
            [5.47577544, 4.72234527, 5.43595995, 5.26740626, 5.09924742, 5.30088348],
            [6.14051626, 4.79598401, 5.24670517, 5.91080769, 4.66837618, 3.54577422],
            [6.38243391, 5.61256158, 5.10314497, 4.76709935, 5.06150884, 5.25339888],
            [5.95466946, 4.66871179, 4.87074621, 5.36865609, 4.43541293, 4.58990244],
            [5.39224117, 4.27046377, 5.07600837, 5.82097533, 4.83331586, 4.75491842],
            [5.6506082, 5.96569107, 6.01750188, 5.0171436, 5.34382309, 5.52561516],
            [4.42262277, 5.06602388, 5.93449572, 5.99505985, 6.33381706, 5.67401249],
            [6.1077105, 6.50440283, 6.62892543, 6.49502661, 5.16876218, 5.84364197],
            [5.79124678, 6.20782977, 7.33610725, 6.61678784, 7.3111375, 6.42068709],
            [6.01344383, 6.87270613, 7.65467699, 6.77612627, 7.82347205, 7.25496074]
        ]
    ];
    let current_output17 = conv_layer17.convolve(&test_input17);

    assert!(
        arr_allclose(&current_output17, &target_output17),
        "{:?} was not equal to {:?}",
        current_output17,
        target_output17
    );

    let test_input18 = array![[
        [
            0.89535372, 0.96970482, 0.71544569, 0.82037819, 0.21395261, 0.74579813, 0.71471521,
            0.05275503, 0.93545915, 0.89868745
        ],
        [
            0.86908559, 0.63580819, 0.15263816, 0.74669492, 0.62358908, 0.62486134, 0.73523241,
            0.23342585, 0.98271262, 0.93357895
        ],
        [
            0.96423954, 0.02081718, 0.47192466, 0.50718916, 0.9034243, 0.67857299, 0.48106776,
            0.27722874, 0.0061415, 0.2891619
        ],
        [
            0.99375291, 0.02278532, 0.76614291, 0.23943478, 0.75684809, 0.1846646, 0.05945846,
            0.75223735, 0.72325596, 0.56901877
        ],
        [
            0.80126183, 0.13196982, 0.25499959, 0.96842652, 0.09975351, 0.65753681, 0.01221572,
            0.56905168, 0.86330318, 0.5916843
        ],
        [
            0.73279841, 0.38392547, 0.45234742, 0.88714563, 0.48625888, 0.49746638, 0.280569,
            0.32727791, 0.73086985, 0.16297499
        ],
        [
            0.86902393, 0.58347085, 0.33016786, 0.24064531, 0.59915099, 0.8538999, 0.30761604,
            0.3641591, 0.11430371, 0.45364544
        ],
        [
            0.69845229, 0.70536543, 0.40033871, 0.38632824, 0.91106906, 0.51805139, 0.18372489,
            0.38816592, 0.16589011, 0.91154296
        ],
        [
            0.93466867, 0.90793376, 0.62180165, 0.71993128, 0.5790186, 0.58128011, 0.58975808,
            0.00632351, 0.51240735, 0.36974571
        ],
        [
            0.13892106, 0.99003674, 0.47229374, 0.56468744, 0.59834724, 0.6383385, 0.03793695,
            0.94503431, 0.96132329, 0.60619489
        ],
        [
            0.63035447, 0.51113712, 0.03746503, 0.55833499, 0.30164845, 0.68653253, 0.99669343,
            0.51277812, 0.25915265, 0.34361983
        ],
        [
            0.66471276, 0.42920146, 0.22015804, 0.22396304, 0.55329103, 0.21043802, 0.03016802,
            0.13123624, 0.4177692, 0.15363416
        ],
        [
            0.26550946, 0.97993737, 0.64686607, 0.22700246, 0.28266105, 0.75680146, 0.49555436,
            0.75771218, 0.20788052, 0.91674454
        ],
        [
            0.56273526, 0.45675125, 0.48490577, 0.82385765, 0.4200622, 0.82511256, 0.35886786,
            0.09741933, 0.50827706, 0.09494946
        ],
        [
            0.93389189, 0.41674573, 0.12654001, 0.47637335, 0.72644437, 0.22123201, 0.29542014,
            0.46568521, 0.68506433, 0.68084162
        ]
    ]];

    let kernel18: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.37799812, 0.43870836, 0.65347099, 0.21167818, 0.05481404, 0.2891591, 0.38488158,
            0.61992766, 0.33277866, 0.13763187, 0.33186396, 0.23232727, 0.42076096, 0.14874539,
            0.19455469, 0.96441959, 0.22719597, 0.88026641, 0.33960778, 0.710135, 0.04142809,
            0.76819397, 0.00992903, 0.23459853, 0.36192991, 0.80578898, 0.34610719, 0.64399242,
            0.95756755, 0.40751188, 0.69930453, 0.24301769, 0.5419032, 0.58041593, 0.38947831,
            0.97341993, 0.32100558, 0.7094996, 0.84465177, 0.22310271, 0.09362596, 0.85453414,
            0.30416232, 0.03217437, 0.38075932, 0.27610768, 0.85450962, 0.07512626, 0.86872336,
            0.57883709,
        ],
    )
    .unwrap();
    let conv_layer18 = ConvolutionLayer::new(kernel18, 1, Padding::Valid);
    let target_output18 = array![
        [
            [5.68974263, 4.67263612, 5.20769234, 4.90934195, 5.04426669, 5.38937543],
            [5.45378923, 4.67957566, 4.69375447, 4.20564702, 4.35080608, 4.76726944],
            [5.22383141, 4.13685685, 4.96241679, 4.3796385, 4.19884913, 3.76725607],
            [4.816769, 4.96993253, 4.23596124, 3.94133927, 4.34625284, 4.47492181],
            [5.60454002, 4.50073997, 4.83725734, 4.08674949, 4.27400019, 4.10926666],
            [5.84871152, 5.69402027, 4.70969235, 4.24996707, 4.61049267, 4.51944463],
            [5.7761055, 5.37267396, 5.22653606, 5.18021735, 4.44039466, 4.33052002],
            [4.99687005, 5.53777645, 4.83134465, 3.61632048, 4.57539102, 4.26536205],
            [4.98011066, 4.67878812, 4.19033624, 5.41419154, 4.73982429, 4.60248445],
            [4.4482396, 4.84531525, 4.64697761, 3.57505204, 4.09370379, 4.45796213],
            [4.64509994, 4.16003764, 3.99645255, 4.19120354, 4.63708252, 4.02182765]
        ],
        [
            [8.23477847, 6.46590585, 7.01485438, 6.91540053, 7.22191375, 6.94836821],
            [6.9022384, 6.72763385, 6.21443813, 6.80367521, 5.99322583, 5.65214431],
            [6.91616575, 6.147711, 6.03000423, 6.72806898, 6.43934287, 5.73430827],
            [7.70622303, 6.17276646, 5.84970285, 6.02829738, 5.72349718, 6.40478147],
            [7.70117961, 6.80142765, 6.06786159, 6.51539743, 5.69119516, 6.0944581],
            [7.66710901, 8.2072608, 7.06912553, 6.63586496, 6.54859456, 5.27372209],
            [7.561575, 7.69865221, 6.20676882, 7.37711264, 6.36437352, 6.61388147],
            [6.86962376, 6.89679799, 6.28788487, 6.09456022, 5.82622845, 6.08207489],
            [7.00041133, 6.84251669, 5.51166056, 6.17238221, 7.0154433, 6.11774841],
            [6.19241923, 7.22679041, 6.41281807, 6.71982006, 5.37063016, 6.46294223],
            [6.13582541, 6.28648521, 4.86516795, 5.75972118, 6.37512074, 6.04823625]
        ]
    ];
    let current_output18 = conv_layer18.convolve(&test_input18);

    assert!(
        arr_allclose(&current_output18, &target_output18),
        "{:?} was not equal to {:?}",
        current_output18,
        target_output18
    );

    let test_input19 = array![
        [
            [0.45671246, 0.68215294, 0.40237482, 0.65666055, 0.61528814, 0.10633651],
            [0.49642795, 0.14359485, 0.53526694, 0.16963241, 0.33204897, 0.95525232],
            [0.25685028, 0.25693817, 0.30001205, 0.83179815, 0.4820838, 0.65310255],
            [0.00604056, 0.16296797, 0.04446485, 0.19190631, 0.00911832, 0.81518296],
            [0.94401775, 0.52856827, 0.28076501, 0.98050101, 0.88657197, 0.88198291],
            [0.7819647, 0.72222506, 0.11044633, 0.25462821, 0.78940447, 0.90517751]
        ],
        [
            [0.02821647, 0.13092386, 0.96531998, 0.07955469, 0.83010793, 0.95870479],
            [0.02807361, 0.96717686, 0.78941801, 0.22258878, 0.6242531, 0.17685722],
            [0.96196441, 0.06693319, 0.24983038, 0.9035203, 0.22076631, 0.94143701],
            [0.67496017, 0.76942613, 0.81149441, 0.18254054, 0.20514874, 0.26495344],
            [0.54503895, 0.51207055, 0.07791043, 0.54355016, 0.36146563, 0.48148783],
            [0.49357224, 0.36648302, 0.88196934, 0.82228467, 0.46583236, 0.70023278]
        ],
        [
            [0.65663048, 0.04243296, 0.08922234, 0.30693734, 0.90806135, 0.24841434],
            [0.67816274, 0.97005397, 0.44380167, 0.54548246, 0.39491079, 0.43900622],
            [0.70541543, 0.71142706, 0.04385824, 0.99454165, 0.6613494, 0.02962555],
            [0.09254023, 0.49170364, 0.29030006, 0.13724733, 0.59104546, 0.62743607],
            [0.64316468, 0.03335644, 0.86478264, 0.03467919, 0.13580919, 0.09721046],
            [0.6708243, 0.37231641, 0.78123719, 0.328725, 0.30093508, 0.750793]
        ]
    ];

    let kernel19: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.75040493, 0.88165923, 0.90411151, 0.16955712, 0.65657977, 0.15740211, 0.90069482,
            0.05310873, 0.54084136, 0.51972126, 0.2966056, 0.90908507, 0.05444199, 0.10227188,
            0.33348853, 0.21181778, 0.78958033, 0.56740319, 0.98317071, 0.06208929, 0.48332874,
            0.15761588, 0.20003574, 0.47983043, 0.92161582, 0.38009273, 0.70394503, 0.53337294,
            0.99766619, 0.99974847, 0.76152087, 0.53518538, 0.04401799, 0.01261302, 0.13790857,
            0.48263519, 0.72387765, 0.2162454, 0.4171188, 0.28148171, 0.28489799, 0.42292984,
            0.78206101, 0.5917116, 0.62469666, 0.20632542, 0.50320556, 0.169661, 0.95890854,
            0.18222419, 0.90991353, 0.74544141, 0.27422508, 0.12639284,
        ],
    )
    .unwrap();
    let conv_layer19 = ConvolutionLayer::new(kernel19, 1, Padding::Valid);
    let target_output19 = array![
        [
            [5.66403089, 5.48564771, 6.5403916, 6.05305521],
            [5.31621245, 5.93331667, 5.41306902, 6.35018159],
            [5.89253262, 5.94253661, 4.5678006, 6.49384396],
            [5.92249619, 5.60893294, 5.47014996, 6.96235153]
        ],
        [
            [5.62851307, 4.82369047, 6.9769987, 7.25718708],
            [5.64681348, 5.80628912, 4.93785649, 5.82589609],
            [5.11184563, 5.58503788, 5.12881826, 6.31227526],
            [6.64485437, 5.68966294, 5.37171972, 5.85618592]
        ]
    ];
    let current_output19 = conv_layer19.convolve(&test_input19);

    assert!(
        arr_allclose(&current_output19, &target_output19),
        "{:?} was not equal to {:?}",
        current_output19,
        target_output19
    );

    let test_input20 = array![
        [
            [0.16602973, 0.75747912, 0.51063865, 0.25472447, 0.66492974, 0.13672463],
            [0.87988772, 0.58457098, 0.32541804, 0.85434138, 0.04858193, 0.62667716],
            [0.59885723, 0.80947357, 0.29621909, 0.78179376, 0.35345063, 0.4491099],
            [0.70367989, 0.66168623, 0.41794769, 0.89098162, 0.69679788, 0.75464064],
            [0.15431848, 0.87579246, 0.53754665, 0.67977367, 0.08134871, 0.93320845],
            [0.03809474, 0.78672022, 0.78634884, 0.39982171, 0.89870727, 0.74226097]
        ],
        [
            [0.46498439, 0.91581801, 0.6296097, 0.48130554, 0.01730853, 0.73892077],
            [0.63560668, 0.96449508, 0.10196066, 0.97105842, 0.16233305, 0.04012987],
            [0.75486132, 0.41193416, 0.86571361, 0.55146949, 0.04673942, 0.16020048],
            [0.09309967, 0.75922126, 0.85175452, 0.77955643, 0.44887285, 0.81323265],
            [0.56885447, 0.95318211, 0.23263316, 0.74194602, 0.67013964, 0.69664936],
            [0.09368633, 0.51032958, 0.56742164, 0.32429225, 0.16025589, 0.14132027]
        ],
        [
            [0.36747121, 0.02039539, 0.55201156, 0.324559, 0.77949586, 0.02376527],
            [0.22369854, 0.79775544, 0.82326738, 0.50513296, 0.65101499, 0.8986551],
            [0.92305233, 0.11411006, 0.30998129, 0.93096709, 0.2836077, 0.0033604],
            [0.8027366, 0.98626302, 0.69523071, 0.25186004, 0.44314901, 0.85127236],
            [0.29611066, 0.5536974, 0.52779298, 0.01885639, 0.42471457, 0.5644708],
            [0.52132452, 0.05583452, 0.06023929, 0.11995548, 0.33672986, 0.06929818]
        ]
    ];

    let kernel20: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.4782574, 0.71209091, 0.16471672, 0.34966558, 0.5212063, 0.2356948, 0.0573609,
            0.63527644, 0.50445548, 0.11632108, 0.85454535, 0.18019378, 0.98382828, 0.65213787,
            0.96484394, 0.36602103, 0.32906871, 0.65936247, 0.47647961, 0.10698621, 0.49676638,
            0.90295657, 0.3666493, 0.65951823, 0.66375136, 0.83307838, 0.93752427, 0.5697997,
            0.48833874, 0.39931871, 0.47131558, 0.92237302, 0.4160782, 0.8237337, 0.17045998,
            0.5347742, 0.49556066, 0.18296849, 0.04206449, 0.67772886, 0.45965454, 0.08041501,
            0.15022675, 0.39238517, 0.2873256, 0.74170323, 0.61914566, 0.8137173, 0.67075131,
            0.99957266, 0.8111227, 0.17951131, 0.24240606, 0.77539968,
        ],
    )
    .unwrap();
    let conv_layer20 = ConvolutionLayer::new(kernel20, 1, Padding::Valid);
    let target_output20 = array![
        [
            [7.83251757, 8.33260758, 6.45943966, 5.94339059],
            [9.20598964, 9.01019109, 8.09169076, 6.97788448],
            [7.82376569, 8.01541603, 7.55900259, 7.65626966],
            [7.98648173, 7.35452422, 6.16633274, 6.98076848]
        ],
        [
            [7.09471776, 7.22965189, 6.97702914, 5.48105301],
            [8.47691334, 8.01615045, 7.22627212, 7.00241538],
            [7.92391326, 7.74383406, 6.74516435, 6.75926434],
            [7.08779102, 7.31113409, 6.47694308, 6.18566231]
        ]
    ];
    let current_output20 = conv_layer20.convolve(&test_input20);

    assert!(
        arr_allclose(&current_output20, &target_output20),
        "{:?} was not equal to {:?}",
        current_output20,
        target_output20
    );

    let test_input21 = array![
        [
            [0.72337473, 0.51474295, 0.62928632, 0.09462127, 0.06431016, 0.58759433],
            [0.21980144, 0.84722637, 0.35318831, 0.75035382, 0.4653744, 0.98759052],
            [0.37862287, 0.96206714, 0.75507285, 0.10567724, 0.84723967, 0.96721133],
            [0.38427271, 0.32829218, 0.30524121, 0.04119791, 0.13365868, 0.93408337],
            [0.40976977, 0.28116078, 0.14792817, 0.09807893, 0.12152596, 0.95614773],
            [0.76020871, 0.97631707, 0.48662945, 0.77797665, 0.34835713, 0.5305259]
        ],
        [
            [0.58495981, 0.92627021, 0.33485918, 0.39446757, 0.30438656, 0.62632952],
            [0.00100083, 0.35980777, 0.25727804, 0.4171089, 0.71255461, 0.22617352],
            [0.50947449, 0.49016727, 0.45673514, 0.27288928, 0.55496893, 0.64802116],
            [0.94689554, 0.2643334, 0.50387048, 0.71312951, 0.36297328, 0.21441842],
            [0.99539249, 0.97598533, 0.83921394, 0.3419448, 0.29696486, 0.47523478],
            [0.78506594, 0.26839126, 0.70590996, 0.2436962, 0.87617954, 0.65651311]
        ],
        [
            [0.73156758, 0.29888561, 0.68505601, 0.73533658, 0.65234167, 0.4344534],
            [0.69211635, 0.88600021, 0.25435161, 0.7314984, 0.95627283, 0.74177312],
            [0.18060002, 0.45882289, 0.96909469, 0.70271284, 0.91851916, 0.21997769],
            [0.74909703, 0.34910949, 0.37622158, 0.14328648, 0.68727153, 0.91439056],
            [0.3781238, 0.36442432, 0.62525704, 0.94809758, 0.41873358, 0.25687808],
            [0.43647116, 0.08090039, 0.99664134, 0.6407154, 0.19121104, 0.52872786]
        ]
    ];

    let kernel21: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.29444506, 0.96716423, 0.95850575, 0.63829989, 0.49220118, 0.31319898, 0.84175252,
            0.20135997, 0.57593448, 0.24550702, 0.79905301, 0.82405072, 0.50059186, 0.60974809,
            0.80954467, 0.44898897, 0.25492424, 0.70183952, 0.87540913, 0.05473179, 0.58680465,
            0.62244836, 0.77621485, 0.24274388, 0.36183158, 0.69954113, 0.58241341, 0.77558901,
            0.20102102, 0.90317617, 0.51254486, 0.959262, 0.23300357, 0.94145869, 0.40562742,
            0.80855957, 0.95322045, 0.29777643, 0.77356562, 0.93735199, 0.82510736, 0.34135282,
            0.69933211, 0.58743709, 0.76145006, 0.34133301, 0.82243273, 0.50450674, 0.14624618,
            0.31383016, 0.67290714, 0.24969168, 0.11803117, 0.3309161,
        ],
    )
    .unwrap();
    let conv_layer21 = ConvolutionLayer::new(kernel21, 1, Padding::Valid);
    let target_output21 = array![
        [
            [7.81133064, 7.71028685, 8.21225855, 8.39728176],
            [8.04450529, 7.98144508, 7.74287551, 8.18963454],
            [8.38701315, 7.18624412, 7.26416206, 7.95488519],
            [8.6202937, 7.62938884, 6.92960439, 6.96168509]
        ],
        [
            [8.67398112, 7.93141117, 7.90011827, 8.06015444],
            [7.03541723, 7.14790698, 6.89031613, 9.08677537],
            [8.15523436, 7.09153098, 7.06062121, 7.1469172],
            [8.31145513, 7.09463306, 7.04416135, 7.44633797]
        ]
    ];
    let current_output21 = conv_layer21.convolve(&test_input21);

    assert!(
        arr_allclose(&current_output21, &target_output21),
        "{:?} was not equal to {:?}",
        current_output21,
        target_output21
    );

    let test_input22 = array![
        [
            [0.67546682, 0.41204399, 0.8994237, 0.69459298, 0.95296427, 0.8826578],
            [0.61120748, 0.88056745, 0.4120727, 0.42224764, 0.40275672, 0.31289253],
            [0.85605003, 0.50402257, 0.59472298, 0.28942941, 0.1757779, 0.71379829],
            [0.90917349, 0.34100041, 0.78460036, 0.9584728, 0.59341494, 0.8519623],
            [0.11542477, 0.07023699, 0.81448411, 0.56708078, 0.84016348, 0.10123584],
            [0.005051, 0.55897934, 0.51621787, 0.76241788, 0.01278013, 0.55419777]
        ],
        [
            [0.32411023, 0.84085379, 0.83643666, 0.84416068, 0.72987187, 0.44925806],
            [0.96117721, 0.94836312, 0.27696644, 0.96611448, 0.19091434, 0.23962151],
            [0.27247687, 0.58524975, 0.38096266, 0.4529504, 0.88774994, 0.82603577],
            [0.80568945, 0.32917508, 0.72724448, 0.74692632, 0.42636783, 0.43363969],
            [0.13354255, 0.35689689, 0.99201185, 0.68718494, 0.55920875, 0.26360001],
            [0.55768741, 0.35369453, 0.59068772, 0.07249359, 0.4782056, 0.04795831]
        ],
        [
            [0.39496991, 0.76511307, 0.38108206, 0.40802578, 0.07076581, 0.8213124],
            [0.3876701, 0.8974017, 0.69025475, 0.04551166, 0.44375269, 0.63893185],
            [0.19161025, 0.97299683, 0.29591832, 0.19683413, 0.52295888, 0.8461087],
            [0.79286723, 0.17503857, 0.48829707, 0.66009417, 0.9874962, 0.02657376],
            [0.5618466, 0.27853092, 0.66855964, 0.73198697, 0.27009217, 0.96576889],
            [0.90251369, 0.94294266, 0.05157892, 0.45541913, 0.76319753, 0.58152421]
        ]
    ];

    let kernel22: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.27330734, 0.47548521, 0.42322085, 0.61045031, 0.56410859, 0.45230761, 0.826404,
            0.63504065, 0.03638968, 0.97521319, 0.24505253, 0.783278, 0.8729103, 0.46475388,
            0.10122171, 0.15554731, 0.30789323, 0.28579374, 0.10987341, 0.94895509, 0.18260308,
            0.16017109, 0.9057766, 0.4556152, 0.74999444, 0.29006036, 0.89129077, 0.92553811,
            0.2879088, 0.46463864, 0.17197817, 0.36331992, 0.11709648, 0.16491043, 0.61829454,
            0.03939038, 0.74658082, 0.06899712, 0.93920061, 0.70967704, 0.13435428, 0.44194368,
            0.84640182, 0.68275111, 0.51110605, 0.03558233, 0.29351898, 0.36432304, 0.46089745,
            0.07875008, 0.18781202, 0.45979473, 0.9853486, 0.24345837, 0.56969289, 0.69870181,
            0.43612493, 0.21574858, 0.79154644, 0.3409378, 0.80118929, 0.03917093, 0.3181057,
            0.55449048, 0.83261815, 0.19166702, 0.91193131, 0.47873197, 0.14053225, 0.17711017,
            0.88772247, 0.48469457, 0.47707381, 0.30389078, 0.4188041, 0.88154588, 0.78434719,
            0.46112145, 0.99977492, 0.07862057, 0.29750833, 0.84971782, 0.15406865, 0.30595167,
            0.86021405, 0.81694578, 0.24658875, 0.52609012, 0.65852329, 0.23691536, 0.18986696,
            0.68702212, 0.08647749, 0.79093268, 0.07998311, 0.82895695, 0.00698695, 0.00922728,
            0.66896225, 0.85890063, 0.23429064, 0.15408872, 0.55322419, 0.92371205, 0.07132971,
            0.06818328, 0.98673576, 0.1119092, 0.70878765, 0.40998869, 0.5665328, 0.34663446,
            0.61684947, 0.09687402, 0.46413839, 0.38600448, 0.33855646, 0.5181164, 0.93982805,
            0.02956773, 0.14173116, 0.14280626, 0.53910845, 0.33559954, 0.73433581, 0.94584272,
            0.18853948, 0.24325794, 0.00414109, 0.89171883, 0.60906574, 0.03541405, 0.62331999,
            0.60650112, 0.49427043, 0.75747067, 0.39318948, 0.1008886, 0.56360938, 0.38735757,
            0.46490033, 0.31810584, 0.83375128, 0.49555323, 0.11328587, 0.12655612, 0.1767692,
            0.23459193, 0.73881618, 0.48477762,
        ],
    )
    .unwrap();
    let conv_layer22 = ConvolutionLayer::new(kernel22, 1, Padding::Valid);
    let target_output22 = array![
        [[17.91266863, 20.74994577], [19.24522705, 17.65863752]],
        [[20.51738582, 18.64207327], [17.68614419, 17.76900578]]
    ];
    let current_output22 = conv_layer22.convolve(&test_input22);

    assert!(
        arr_allclose(&current_output22, &target_output22),
        "{:?} was not equal to {:?}",
        current_output22,
        target_output22
    );

    let test_input23 = array![
        [
            [0.00624699, 0.81573006, 0.64821486, 0.53025379, 0.12299971, 0.59333579],
            [0.88466563, 0.9335431, 0.0064692, 0.61633665, 0.11189566, 0.88115114],
            [0.4513792, 0.59758916, 0.3575447, 0.43116545, 0.96428143, 0.65008404],
            [0.23165825, 0.35102451, 0.20369535, 0.86613916, 0.63314852, 0.67738035],
            [0.85136724, 0.55736135, 0.57193865, 0.95459734, 0.34878273, 0.8226108],
            [0.33210731, 0.92109437, 0.38955377, 0.03470363, 0.23551573, 0.29478395]
        ],
        [
            [0.62862881, 0.70090976, 0.5717835, 0.0984337, 0.06295575, 0.27819812],
            [0.33805057, 0.0900248, 0.97915132, 0.97595711, 0.66231298, 0.93577167],
            [0.21412608, 0.26163143, 0.41482433, 0.88888712, 0.67385224, 0.1288117],
            [0.01380609, 0.37587899, 0.9617992, 0.818001, 0.83272296, 0.96657098],
            [0.03105091, 0.02805966, 0.9242484, 0.19825369, 0.04700416, 0.49845084],
            [0.9764468, 0.77103208, 0.85489501, 0.623576, 0.09116794, 0.69404102]
        ],
        [
            [0.21567077, 0.8734742, 0.16271726, 0.82271061, 0.79538949, 0.70772565],
            [0.66772457, 0.08626243, 0.52760126, 0.54319958, 0.47249613, 0.61019061],
            [0.21063799, 0.57292384, 0.56862119, 0.59890786, 0.18009396, 0.60346005],
            [0.45430455, 0.79313242, 0.17212614, 0.04731771, 0.58803685, 0.59957683],
            [0.388052, 0.80824123, 0.43400673, 0.31652351, 0.89200941, 0.02590412],
            [0.53812272, 0.86606787, 0.07690383, 0.74470608, 0.13018293, 0.0967541]
        ]
    ];

    let kernel23: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.82667353, 0.11757887, 0.87975011, 0.89214319, 0.05703124, 0.58673539, 0.88107829,
            0.76902574, 0.60241874, 0.53194064, 0.31502705, 0.56150498, 0.63817888, 0.86301588,
            0.86002532, 0.52309412, 0.80053111, 0.77427592, 0.75415336, 0.71724524, 0.18392334,
            0.8595507, 0.45872805, 0.82358677, 0.75668944, 0.24422543, 0.36607083, 0.10110632,
            0.0491925, 0.10031959, 0.61692172, 0.45131599, 0.07585676, 0.23233427, 0.09277638,
            0.90410785, 0.47732064, 0.65819252, 0.3987277, 0.12023476, 0.85842835, 0.40513717,
            0.86143706, 0.59222097, 0.41190185, 0.1809689, 0.98907978, 0.68296631, 0.26042403,
            0.8824068, 0.05508777, 0.7472844, 0.93042542, 0.19189753, 0.24171719, 0.35687553,
            0.84656218, 0.06790887, 0.98901116, 0.60042985, 0.99100995, 0.21088907, 0.44280004,
            0.79984951, 0.9782188, 0.30464407, 0.4856008, 0.37103124, 0.82877622, 0.43725936,
            0.3628767, 0.27266596, 0.52331047, 0.81435255, 0.51675713, 0.00767931, 0.08762363,
            0.44695868, 0.22412037, 0.61399594, 0.38990366, 0.35692051, 0.28521551, 0.37045264,
            0.6437402, 0.15851367, 0.52739673, 0.95433893, 0.81168432, 0.69702212, 0.05274187,
            0.17473145, 0.90144795, 0.80124225, 0.91050068, 0.85564119, 0.77320267, 0.76575244,
            0.29054286, 0.55514523, 0.47754805, 0.24363868, 0.55942819, 0.53688148, 0.78280452,
            0.5919785, 0.0383365, 0.24124638, 0.42484194, 0.86937538, 0.24201743, 0.43933925,
            0.1983508, 0.68792058, 0.94646693, 0.85845118, 0.82864842, 0.28797777, 0.05390601,
            0.29969905, 0.5768042, 0.24298015, 0.23040929, 0.883912, 0.10910437, 0.30187264,
            0.08178072, 0.09035328, 0.45287938, 0.4721017, 0.9651153, 0.98832129, 0.14329627,
            0.36564677, 0.88752862, 0.46153439, 0.55242992, 0.1576808, 0.59457896, 0.38164645,
            0.00721753, 0.41349154, 0.0877872, 0.29753333, 0.70224348, 0.69780507, 0.48466381,
            0.69741451, 0.57902404, 0.33856305,
        ],
    )
    .unwrap();
    let conv_layer23 = ConvolutionLayer::new(kernel23, 1, Padding::Valid);
    let target_output23 = array![
        [[19.79061354, 21.28717411], [21.47621987, 21.34644356]],
        [[17.64558934, 19.58178907], [18.72435487, 19.02098951]]
    ];
    let current_output23 = conv_layer23.convolve(&test_input23);

    assert!(
        arr_allclose(&current_output23, &target_output23),
        "{:?} was not equal to {:?}",
        current_output23,
        target_output23
    );

    let test_input24 = array![
        [
            [0.4310923, 0.70742674, 0.60569308, 0.43765875, 0.41785501, 0.55490179],
            [0.655004, 0.3268639, 0.47542889, 0.81072357, 0.48937834, 0.40227203],
            [0.05504967, 0.12310848, 0.88188004, 0.91576679, 0.28533912, 0.24235714],
            [0.69032428, 0.05488254, 0.9355463, 0.17318112, 0.35695698, 0.41477198],
            [0.58704964, 0.19057809, 0.26191842, 0.93639778, 0.30951204, 0.44510987],
            [0.09438256, 0.0316166, 0.33316014, 0.10716959, 0.42792627, 0.45255642]
        ],
        [
            [0.43717159, 0.04574656, 0.19430637, 0.47719213, 0.81793892, 0.67156732],
            [0.09111205, 0.77552781, 0.31814524, 0.00102462, 0.122188, 0.84508294],
            [0.02137936, 0.00158825, 0.12094666, 0.91879824, 0.30878847, 0.45707442],
            [0.09853197, 0.70532216, 0.38260134, 0.21472166, 0.22671694, 0.18007399],
            [0.29501828, 0.36531091, 0.36934672, 0.42698747, 0.1389484, 0.68366704],
            [0.365831, 0.87382413, 0.56221596, 0.93341087, 0.48052303, 0.99052713]
        ],
        [
            [0.22416041, 0.62335471, 0.94640953, 0.45312902, 0.03511541, 0.61512813],
            [0.49298652, 0.77209026, 0.52555005, 0.51096868, 0.22519494, 0.43985214],
            [0.26612981, 0.75761557, 0.13906257, 0.8513396, 0.12668495, 0.77128291],
            [0.43307764, 0.34688667, 0.48385892, 0.77769447, 0.18250433, 0.98278629],
            [0.46143154, 0.93977063, 0.14449089, 0.12815461, 0.70723682, 0.60059835],
            [0.60821446, 0.29876905, 0.33539039, 0.86064022, 0.69580782, 0.04395659]
        ]
    ];

    let kernel24: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.71055362, 0.14740173, 0.67352904, 0.79466526, 0.24183853, 0.43487665, 0.75513868,
            0.23145947, 0.06738389, 0.47117368, 0.05636088, 0.6478343, 0.10347797, 0.80654461,
            0.89712569, 0.38085341, 0.90379299, 0.32565015, 0.84075748, 0.42443379, 0.28572704,
            0.82775309, 0.08149401, 0.60480596, 0.36674044, 0.93380784, 0.19252698, 0.64539509,
            0.74729833, 0.10814751, 0.05581366, 0.15413615, 0.88258469, 0.2233036, 0.22905577,
            0.33269022, 0.66350844, 0.14642915, 0.92962374, 0.37137195, 0.19031978, 0.56865098,
            0.72865624, 0.90232325, 0.79606476, 0.81580518, 0.37304191, 0.04374503, 0.09306769,
            0.31310066, 0.01515595, 0.02814319, 0.59322684, 0.21080039, 0.58264211, 0.50119188,
            0.2631662, 0.56031989, 0.4226413, 0.83183692, 0.42102939, 0.59479696, 0.38304217,
            0.80970791, 0.27672654, 0.41320488, 0.63317855, 0.41356983, 0.70493781, 0.51166811,
            0.12281225, 0.59174454, 0.09240988, 0.00396548, 0.01080465, 0.91177765, 0.70965311,
            0.42676451, 0.54765996, 0.23543635, 0.56912596, 0.50380181, 0.15739693, 0.91630975,
            0.78273382, 0.31307654, 0.32534242, 0.37213183, 0.13412596, 0.27640049, 0.36317898,
            0.9826564, 0.82000728, 0.54675693, 0.85259345, 0.61427557, 0.22001709, 0.85722615,
            0.01006908, 0.40403319, 0.90260815, 0.79887708, 0.93520574, 0.72924789, 0.36654201,
            0.02638636, 0.82638884, 0.17851174, 0.09597177, 0.34449509, 0.37347791, 0.88396533,
            0.21561022, 0.88961373, 0.27103843, 0.46563995, 0.33996935, 0.48349918, 0.40697717,
            0.24516418, 0.26794038, 0.20307005, 0.88704216, 0.04155758, 0.72581839, 0.88177705,
            0.39099366, 0.58852909, 0.12833529, 0.1795904, 0.31323937, 0.70537729, 0.14435844,
            0.73019655, 0.12226541, 0.08686391, 0.68739475, 0.90021487, 0.92300738, 0.33046692,
            0.94399139, 0.70651505, 0.03333719, 0.17525118, 0.32966594, 0.32823457, 0.37599511,
            0.8528545, 0.29594677, 0.05479572,
        ],
    )
    .unwrap();
    let conv_layer24 = ConvolutionLayer::new(kernel24, 1, Padding::Valid);
    let target_output24 = array![
        [[14.86341014, 13.75980764], [14.6151445, 15.22744189]],
        [[14.46060222, 16.66361035], [13.98366534, 15.98152009]]
    ];
    let current_output24 = conv_layer24.convolve(&test_input24);

    assert!(
        arr_allclose(&current_output24, &target_output24),
        "{:?} was not equal to {:?}",
        current_output24,
        target_output24
    );

    let test_input25 = array![
        [
            [
                0.52210696, 0.61509339, 0.33898463, 0.45874897, 0.95512077, 0.19136074, 0.30594055,
                0.82416615, 0.07202522, 0.19128811, 0.8797602, 0.69522934, 0.10557688, 0.28930025,
                0.96985732
            ],
            [
                0.85392951, 0.24404159, 0.32723788, 0.77440342, 0.90784409, 0.05255083, 0.49884502,
                0.79299562, 0.61580642, 0.33350429, 0.36077333, 0.98458625, 0.96003669, 0.20257861,
                0.73324105
            ],
            [
                0.76707071, 0.68315824, 0.29468353, 0.14075517, 0.98014617, 0.82414292, 0.85325579,
                0.37661107, 0.04301855, 0.27527441, 0.63039673, 0.72811018, 0.21715049, 0.72915741,
                0.14437846
            ],
            [
                0.34656417, 0.95416683, 0.74494992, 0.31254604, 0.14618636, 0.91551373, 0.65795491,
                0.10943547, 0.71428937, 0.43690362, 0.03292517, 0.90262579, 0.29801483, 0.22947553,
                0.1143901
            ],
            [
                0.96802237, 0.42875673, 0.65832772, 0.04040552, 0.38902925, 0.12675387, 0.80507149,
                0.49352487, 0.9127804, 0.35417321, 0.85194333, 0.16551488, 0.33331639, 0.03959658,
                0.25632858
            ],
            [
                0.18771167, 0.03075815, 0.43225556, 0.69072249, 0.55687041, 0.38795923, 0.52294715,
                0.0789768, 0.42246844, 0.95906553, 0.15887408, 0.03306201, 0.26331436, 0.23047461,
                0.6584057
            ],
            [
                0.40959628, 0.37286272, 0.16103324, 0.63719284, 0.23002648, 0.10749895, 0.01513924,
                0.50236378, 0.55331617, 0.52681636, 0.75766638, 0.79183038, 0.26611278, 0.60754435,
                0.47772342
            ],
            [
                0.71567196, 0.59426831, 0.01671847, 0.3565012, 0.71597424, 0.30294093, 0.47319988,
                0.2910204, 0.16295868, 0.25027467, 0.6572299, 0.73934629, 0.42323233, 0.5813263,
                0.5468596
            ],
            [
                0.15655027, 0.73374209, 0.70144872, 0.74292476, 0.07253607, 0.71019414, 0.23257384,
                0.75755355, 0.43969591, 0.25122383, 0.21266471, 0.12251099, 0.06464646, 0.32502402,
                0.55681904
            ],
            [
                0.17499127, 0.28275677, 0.95863772, 0.77689142, 0.87225235, 0.55172805, 0.23772796,
                0.15089213, 0.0740529, 0.73283645, 0.99868368, 0.59491573, 0.45983208, 0.3990066,
                0.80979041
            ]
        ],
        [
            [
                0.60234382, 0.23236814, 0.57016682, 0.78067496, 0.58818042, 0.8406687, 0.85119778,
                0.44152675, 0.96407434, 0.25130446, 0.72297111, 0.91174836, 0.23464549, 0.45670657,
                0.13737751
            ],
            [
                0.74257757, 0.74318246, 0.84988172, 0.47136632, 0.68410864, 0.16184398, 0.29081446,
                0.47393437, 0.67942558, 0.75634698, 0.3897357, 0.55171785, 0.66156867, 0.02713268,
                0.04588867
            ],
            [
                0.45551614, 0.66648014, 0.85157117, 0.85626128, 0.27240537, 0.91900748, 0.70143698,
                0.67640065, 0.12136482, 0.0267396, 0.12444576, 0.26266539, 0.30699564, 0.75221894,
                0.29435056
            ],
            [
                0.99010131, 0.84239454, 0.99503728, 0.43238706, 0.09028576, 0.49814488, 0.83047029,
                0.95655823, 0.55764362, 0.04750107, 0.58849011, 0.82636202, 0.74622725, 0.68985719,
                0.25533149
            ],
            [
                0.32070743, 0.69673245, 0.95566137, 0.36515299, 0.57477368, 0.89580769, 0.18574312,
                0.04084097, 0.32315839, 0.43012724, 0.34473135, 0.25193901, 0.45628268, 0.77746038,
                0.40238795
            ],
            [
                0.47788582, 0.38190666, 0.44312598, 0.70348736, 0.68944603, 0.6902452, 0.14189826,
                0.29317726, 0.71652184, 0.15285545, 0.13075078, 0.16711909, 0.15727987, 0.84281718,
                0.22742086
            ],
            [
                0.67157058, 0.27958221, 0.48898629, 0.53397748, 0.72638501, 0.7930301, 0.25819991,
                0.84156044, 0.56238402, 0.13921388, 0.78449276, 0.72191998, 0.45631655, 0.86304334,
                0.73805947
            ],
            [
                0.27518227, 0.98282616, 0.59191654, 0.52713779, 0.33997728, 0.60102209, 0.81581173,
                0.70403956, 0.51999521, 0.01479205, 0.16784889, 0.7692465, 0.30926329, 0.17081867,
                0.32220426
            ],
            [
                0.0631674, 0.62821566, 0.25818462, 0.7893134, 0.61240185, 0.42240704, 0.35578601,
                0.44447816, 0.09476027, 0.38787512, 0.64234613, 0.11175825, 0.15909616, 0.95026743,
                0.29656869
            ],
            [
                0.28795035, 0.62251085, 0.83056019, 0.36629458, 0.14521246, 0.96212075, 0.38020674,
                0.3510485, 0.28524187, 0.24482582, 0.66772568, 0.33922874, 0.39850447, 0.71123667,
                0.12899092
            ]
        ],
        [
            [
                0.20002392, 0.28950064, 0.51984867, 0.81381022, 0.47504796, 0.04588939, 0.87731921,
                0.38872027, 0.51950771, 0.39854062, 0.62001851, 0.65982073, 0.5982146, 0.47519285,
                0.33859881
            ],
            [
                0.94443824, 0.0306461, 0.78041795, 0.2987932, 0.38890766, 0.90099065, 0.96019645,
                0.72834367, 0.47645757, 0.11874896, 0.37567438, 0.29212236, 0.06723779, 0.80878778,
                0.02181397
            ],
            [
                0.6842329, 0.31319311, 0.83927354, 0.52595836, 0.44448685, 0.22366077, 0.40568367,
                0.56091104, 0.67375731, 0.94759497, 0.72837056, 0.09959163, 0.74566257, 0.98712695,
                0.91064911
            ],
            [
                0.67545681, 0.34342708, 0.16594417, 0.5073427, 0.88932032, 0.70523752, 0.17178877,
                0.92225051, 0.4350043, 0.64436133, 0.27200706, 0.0902301, 0.51269132, 0.89290729,
                0.52610627
            ],
            [
                0.16912474, 0.5962988, 0.30900881, 0.74841679, 0.02147576, 0.57611838, 0.91033079,
                0.32406485, 0.52741554, 0.52614151, 0.22837398, 0.95738793, 0.6485293, 0.72181728,
                0.29511455
            ],
            [
                0.88639263, 0.51886615, 0.78464971, 0.48298273, 0.03431003, 0.85404577, 0.48577387,
                0.34614396, 0.03888219, 0.94362165, 0.15117891, 0.58508997, 0.39590273, 0.32108445,
                0.03719785
            ],
            [
                0.91032362, 0.23605917, 0.77691663, 0.50137311, 0.64956137, 0.25076696, 0.03015263,
                0.43133247, 0.63845594, 0.09313619, 0.86921382, 0.91970453, 0.83163739, 0.81931032,
                0.01831975
            ],
            [
                0.09057815, 0.68770772, 0.11799596, 0.42855334, 0.13702092, 0.31660683, 0.32806375,
                0.76467193, 0.10952926, 0.20828883, 0.49984224, 0.45089913, 0.94342924, 0.45052945,
                0.97337824
            ],
            [
                0.92763947, 0.44235065, 0.37731635, 0.96826619, 0.57127407, 0.3144015, 0.774386,
                0.76916295, 0.89676638, 0.52713352, 0.23638117, 0.69299388, 0.64519557, 0.57768894,
                0.68271434
            ],
            [
                0.62235627, 0.05298517, 0.53959038, 0.53110782, 0.74900091, 0.28965781, 0.41068245,
                0.28178046, 0.20798713, 0.13728051, 0.30110442, 0.78129903, 0.29452821, 0.92457685,
                0.03675647
            ]
        ]
    ];

    let kernel25: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.98098062, 0.23334436, 0.23608344, 0.41920665, 0.81249008, 0.21013618, 0.49675161,
            0.89210488, 0.70305292, 0.59541752, 0.65956025, 0.51532269, 0.6557143, 0.65711221,
            0.21312988, 0.35081707, 0.30685804, 0.76970626, 0.46600241, 0.9814129, 0.38562469,
            0.57522745, 0.72268394, 0.16640656, 0.47564269, 0.76217692, 0.72122117, 0.12195553,
            0.35525572, 0.33704031, 0.63552478, 0.46888288, 0.00794073, 0.79606961, 0.29161336,
            0.69517192, 0.99234332, 0.98428432, 0.12298316, 0.47023433, 0.44344075, 0.09544598,
            0.5810784, 0.70156509, 0.01947077, 0.42390977, 0.84742008, 0.39561589, 0.81064758,
            0.50578436, 0.39524125, 0.59502881, 0.53040796, 0.43079307,
        ],
    )
    .unwrap();
    let conv_layer25 = ConvolutionLayer::new(kernel25, 1, Padding::Valid);
    let target_output25 = array![
        [
            [
                8.11404822, 7.75521335, 9.21827147, 8.26491174, 8.52710569, 8.69212291, 8.19470328,
                7.4084812, 6.60559152, 6.99609378, 8.11096573, 7.93805379, 6.04494073
            ],
            [
                9.39228592, 7.73930789, 8.48880192, 8.56784331, 8.56306348, 8.42990658, 8.02287124,
                7.55106141, 6.76762638, 7.10502194, 7.03137282, 8.10888747, 7.67678371
            ],
            [
                9.37874445, 8.22354864, 7.34705422, 7.64858847, 8.86577793, 8.42098066, 8.21994976,
                7.40427459, 5.90830087, 6.29630775, 6.7948082, 7.73826933, 7.2102917
            ],
            [
                8.1662995, 8.55102872, 7.03024493, 7.32014683, 7.19352964, 8.11924559, 7.75934343,
                7.2300602, 6.30332024, 6.34497053, 5.60399338, 7.63377523, 6.33350374
            ],
            [
                8.02867626, 7.68682003, 7.83106791, 6.8447281, 6.63209728, 6.9061528, 6.17534108,
                6.75556572, 7.77348268, 6.76968267, 6.51269061, 7.09826419, 6.44747776
            ],
            [
                6.50889449, 6.89998623, 7.37062064, 7.19554016, 6.53428096, 6.25036298, 5.94804476,
                6.24855539, 6.78438003, 7.59970904, 7.52416133, 7.44240687, 7.48478194
            ],
            [
                6.42484029, 7.73662788, 6.56221822, 7.27305476, 5.94124903, 6.82097148, 6.52720843,
                6.5619168, 6.01280937, 6.93188873, 8.28629451, 8.66950457, 8.00967626
            ],
            [
                8.11220465, 8.27982702, 7.37720458, 7.75156402, 7.01409694, 7.13018077, 7.04445352,
                6.03802426, 5.73713302, 6.14259681, 6.66184199, 7.64883514, 7.18070886
            ]
        ],
        [
            [
                7.15231492, 6.31311572, 8.52395823, 6.89466929, 6.95614273, 7.29689023, 7.50965276,
                6.35678183, 7.08857345, 6.97379633, 6.59761388, 6.72469999, 5.53148644
            ],
            [
                7.53125432, 7.28559143, 7.77014789, 7.39263128, 7.08128043, 7.59945827, 7.33820076,
                6.37225049, 5.23138069, 6.18697698, 5.802145, 6.18144072, 6.26690441
            ],
            [
                8.08151108, 7.10759274, 6.9990278, 6.81458666, 7.29060066, 7.95210617, 7.11708807,
                6.47805773, 6.16956771, 5.39848299, 5.85380071, 6.97005518, 6.82188875
            ],
            [
                7.86444241, 7.19317968, 6.3731703, 6.64884334, 6.56702577, 6.69723603, 6.69767191,
                6.55638923, 5.32006102, 5.60700173, 5.71851883, 6.5353862, 6.05187971
            ],
            [
                6.60217945, 6.65592742, 6.54905161, 6.17026082, 5.84945809, 6.42318271, 5.19214415,
                5.43844379, 6.10408797, 5.98321674, 5.24140112, 6.32124248, 5.19726343
            ],
            [
                6.11456311, 6.22643613, 6.6689739, 6.37266539, 5.90389229, 5.51815974, 4.59342136,
                5.84819238, 6.3205602, 5.30687904, 6.50110316, 7.11010215, 6.39340294
            ],
            [
                6.00692415, 6.92115144, 5.90443819, 6.42515002, 5.00510951, 6.53308736, 6.5123937,
                6.1597175, 5.43867538, 6.18705826, 7.23407643, 7.5695671, 7.15141963
            ],
            [
                5.89784951, 7.01007715, 6.89691989, 6.73998544, 5.94913219, 6.1998449, 5.92209509,
                5.40096865, 5.10193763, 5.52155445, 5.91007095, 6.68875546, 6.43830995
            ]
        ]
    ];
    let current_output25 = conv_layer25.convolve(&test_input25);

    assert!(
        arr_allclose(&current_output25, &target_output25),
        "{:?} was not equal to {:?}",
        current_output25,
        target_output25
    );

    let test_input26 = array![
        [
            [
                0.65442199, 0.58761565, 0.37502282, 0.90727982, 0.26554953, 0.26055169, 0.23161498,
                0.85464101, 0.90648018, 0.23253885, 0.46258069, 0.13830437, 0.99768383, 0.20947075,
                0.34793916
            ],
            [
                0.42308012, 0.80669978, 0.99092943, 0.53854842, 0.68608955, 0.41847236, 0.01959337,
                0.18082423, 0.77819147, 0.45446303, 0.21870645, 0.16891658, 0.82196737, 0.56761092,
                0.05080688
            ],
            [
                0.27169822, 0.58699362, 0.48444233, 0.05775462, 0.48720175, 0.98678988, 0.8741793,
                0.24787005, 0.0098169, 0.54290943, 0.76660496, 0.24225756, 0.90794485, 0.60486086,
                0.60724494
            ],
            [
                0.39451824, 0.7739118, 0.55821842, 0.33135026, 0.4382807, 0.85274149, 0.41870592,
                0.20756939, 0.51307929, 0.71293402, 0.02912598, 0.63142023, 0.24492879, 0.23688388,
                0.45396151
            ],
            [
                0.85629206, 0.09939361, 0.60769776, 0.69535719, 0.48136758, 0.11385565, 0.97172351,
                0.39455087, 0.89547809, 0.50680615, 0.55472256, 0.52786834, 0.65543225, 0.13498626,
                0.99620887
            ],
            [
                0.44649956, 0.35815724, 0.05049731, 0.74125362, 0.80308986, 0.73715035, 0.5041107,
                0.78619929, 0.90911298, 0.81976046, 0.57626017, 0.10905766, 0.50362575, 0.31622591,
                0.12794439
            ],
            [
                0.63002571, 0.09109605, 0.99397696, 0.450994, 0.39270081, 0.88573346, 0.84918074,
                0.78383876, 0.72278243, 0.08929764, 0.61886697, 0.07829133, 0.05534032, 0.12900938,
                0.33450192
            ],
            [
                0.53035963, 0.90288111, 0.01493673, 0.60524951, 0.68300222, 0.35303902, 0.81033376,
                0.52984567, 0.15128083, 0.43051603, 0.28059771, 0.00891489, 0.18607458, 0.11024449,
                0.57106302
            ],
            [
                0.34088473, 0.51521796, 0.45517372, 0.53839099, 0.12089491, 0.08433874, 0.40649991,
                0.29841897, 0.58305656, 0.10433916, 0.66390544, 0.73143498, 0.29792643, 0.28624305,
                0.43092482
            ],
            [
                0.1289603, 0.22165332, 0.46406323, 0.68809765, 0.95369233, 0.17606957, 0.55071186,
                0.53072676, 0.10455144, 0.95716312, 0.55495818, 0.13288062, 0.44437656, 0.96837336,
                0.50635281
            ]
        ],
        [
            [
                0.33095865, 0.49653716, 0.79907188, 0.43818597, 0.27605641, 0.59765531, 0.69215128,
                0.03501532, 0.96888335, 0.44027686, 0.5722288, 0.68609085, 0.35439101, 0.30304361,
                0.91172965
            ],
            [
                0.8522385, 0.20780123, 0.68510162, 0.81079438, 0.65788951, 0.20630272, 0.83712485,
                0.03656635, 0.18088074, 0.15876008, 0.67578595, 0.85145479, 0.29569439, 0.51335655,
                0.14092551
            ],
            [
                0.43087652, 0.18927561, 0.3548947, 0.01398679, 0.39191842, 0.39567923, 0.41219148,
                0.46575391, 0.03120668, 0.551671, 0.52033461, 0.92673199, 0.11640227, 0.67949794,
                0.81439899
            ],
            [
                0.42586837, 0.26620805, 0.14920756, 0.44614497, 0.88296111, 0.90572881, 0.45508061,
                0.20021324, 0.58882958, 0.85163711, 0.49246777, 0.55997157, 0.19181061, 0.49670486,
                0.42133403
            ],
            [
                0.76669573, 0.82822982, 0.66775389, 0.23404987, 0.67087533, 0.87580873, 0.75492733,
                0.31395627, 0.2690143, 0.67623517, 0.69215521, 0.31035744, 0.03603773, 0.98521266,
                0.19921382
            ],
            [
                0.94982781, 0.02897831, 0.86107605, 0.00293741, 0.35674443, 0.41913971, 0.55641157,
                0.63351091, 0.80903275, 0.72148051, 0.95258536, 0.94602234, 0.07761287, 0.17759776,
                0.15542967
            ],
            [
                0.08167998, 0.76193048, 0.34140688, 0.34813985, 0.56429656, 0.69079582, 0.65128704,
                0.24776831, 0.92367393, 0.09322322, 0.84666561, 0.38427125, 0.33815342, 0.838805,
                0.38096664
            ],
            [
                0.28034256, 0.78340421, 0.46203192, 0.06838121, 0.1979319, 0.01351135, 0.02116127,
                0.99872666, 0.71545672, 0.23737086, 0.39736098, 0.33884784, 0.44318847, 0.59574281,
                0.99650699
            ],
            [
                0.31276717, 0.55529255, 0.03822044, 0.19699455, 0.15296015, 0.59906756, 0.14991561,
                0.99814245, 0.88311238, 0.49506863, 0.44003267, 0.22884977, 0.52720408, 0.92822552,
                0.95730779
            ],
            [
                0.71256122, 0.89570084, 0.38429326, 0.82745573, 0.92134258, 0.53414556, 0.25444789,
                0.77232088, 0.65975383, 0.56454967, 0.99726841, 0.43203549, 0.00600106, 0.52825713,
                0.616231
            ]
        ],
        [
            [
                0.37373172, 0.60941027, 0.94719638, 0.15018035, 0.15040922, 0.65847851, 0.64733315,
                0.91917506, 0.30725588, 0.44643323, 0.78549144, 0.0680802, 0.21689764, 0.67836779,
                0.36088541
            ],
            [
                0.80487376, 0.65686723, 0.89588594, 0.46694139, 0.45783393, 0.49531621, 0.57163461,
                0.75915191, 0.97228984, 0.15172001, 0.17699588, 0.8860516, 0.67956754, 0.48570012,
                0.35189822
            ],
            [
                0.82195238, 0.15438258, 0.13443873, 0.35539069, 0.73532807, 0.66819311, 0.43805563,
                0.85423167, 0.20878879, 0.4212191, 0.55199233, 0.29546981, 0.30306699, 0.26091522,
                0.1684874
            ],
            [
                0.31500932, 0.49127059, 0.26436529, 0.70298518, 0.02333054, 0.22357329, 0.93899915,
                0.47618694, 0.59889995, 0.85897657, 0.93976609, 0.44621915, 0.10366015, 0.67701245,
                0.6850384
            ],
            [
                0.85341533, 0.0080629, 0.97007126, 0.7702405, 0.98482032, 0.70942527, 0.52383514,
                0.94462168, 0.72545925, 0.03957006, 0.50038502, 0.81599204, 0.53902263, 0.16336593,
                0.10756692
            ],
            [
                0.71394465, 0.97218841, 0.0762892, 0.58428118, 0.5351153, 0.79290221, 0.04526648,
                0.24217102, 0.83993904, 0.40070922, 0.49337667, 0.39644081, 0.93221566, 0.64270771,
                0.97430723
            ],
            [
                0.75798354, 0.75383404, 0.57779241, 0.49516844, 0.26018233, 0.55985487, 0.31415002,
                0.09454908, 0.36427069, 0.8198366, 0.10928579, 0.92097811, 0.21587123, 0.70533996,
                0.80549439
            ],
            [
                0.09335517, 0.99226144, 0.7521283, 0.63061823, 0.98125646, 0.13854096, 0.74512017,
                0.55599707, 0.55498168, 0.65620621, 0.46733312, 0.61938839, 0.01808522, 0.25734401,
                0.02719511
            ],
            [
                0.19508527, 0.53429699, 0.68448043, 0.41928287, 0.34004239, 0.32895056, 0.20179559,
                0.42835028, 0.58563498, 0.40216792, 0.67188006, 0.45354383, 0.74854459, 0.22695023,
                0.99238892
            ],
            [
                0.9421077, 0.01525365, 0.29330773, 0.32582921, 0.80696934, 0.85412689, 0.65922911,
                0.41289272, 0.91647806, 0.86060405, 0.39086932, 0.02057635, 0.86474378, 0.57560819,
                0.03237248
            ]
        ]
    ];

    let kernel26: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.70649229, 0.02047214, 0.36176982, 0.45497387, 0.13223802, 0.61132301, 0.74263727,
            0.15597425, 0.58310641, 0.19121489, 0.68875934, 0.1066653, 0.69197805, 0.2962676,
            0.62072504, 0.28282913, 0.02631165, 0.99088574, 0.52211759, 0.59077987, 0.24844926,
            0.00114695, 0.62355626, 0.04456268, 0.92159183, 0.68305829, 0.98932128, 0.24617034,
            0.46281454, 0.98954595, 0.84028613, 0.20979706, 0.26047221, 0.16886179, 0.44047667,
            0.76188127, 0.89378952, 0.01173675, 0.85609133, 0.92198043, 0.82381723, 0.52674733,
            0.71575083, 0.79910343, 0.34984971, 0.920404, 0.37879743, 0.94089868, 0.68662337,
            0.19442007, 0.127301, 0.61868011, 0.13235328, 0.92298387,
        ],
    )
    .unwrap();
    let conv_layer26 = ConvolutionLayer::new(kernel26, 1, Padding::Valid);
    let target_output26 = array![
        [
            [
                6.7421719, 5.54614373, 5.80969045, 6.22315486, 6.02557842, 7.14312192, 5.6825052,
                5.96732419, 5.97636813, 5.17814954, 6.5780052, 6.18235264, 5.99157623
            ],
            [
                6.0051535, 5.88376601, 6.32664361, 6.62847179, 6.76258176, 5.69103656, 5.69577719,
                5.92185018, 5.91338834, 5.9765262, 5.39171796, 5.76278428, 4.93907697
            ],
            [
                6.08691456, 5.04284232, 5.71578878, 6.41484791, 7.53432004, 7.69274294, 5.88158631,
                5.60584347, 7.05643132, 6.87414108, 6.1060202, 5.29742584, 5.71397363
            ],
            [
                5.52883242, 6.28903174, 6.0316559, 7.40419116, 7.20828678, 6.95669458, 7.7323169,
                7.29069964, 7.4589438, 7.07830618, 5.93505222, 4.90209784, 4.75290944
            ],
            [
                7.65629929, 5.93535272, 6.699083, 6.86425319, 7.19109986, 6.43914315, 7.30067607,
                6.25064697, 6.83376202, 6.69319034, 5.70339443, 5.91911418, 6.29940719
            ],
            [
                5.72681945, 6.48820643, 5.34005328, 5.62389491, 5.67326328, 6.68868967, 7.02936148,
                6.50798993, 6.59894989, 5.9016093, 5.39943314, 4.69479119, 5.75618606
            ],
            [
                6.41987032, 6.09638588, 5.61263689, 5.3974023, 5.17801752, 5.90552729, 6.98462851,
                6.79486323, 5.84441583, 5.83310731, 4.89092233, 5.0831192, 6.05297617
            ],
            [
                5.69945063, 6.5239836, 6.86665151, 5.61978249, 5.75145289, 5.43504147, 6.90561974,
                7.22651318, 6.60555329, 5.53829003, 4.64539358, 4.67110778, 5.7150998
            ]
        ],
        [
            [
                7.77420418, 7.52464501, 8.0138999, 6.17606013, 7.48816889, 8.20236917, 7.01657108,
                7.2931096, 6.89352006, 7.3839599, 7.79824849, 6.97926774, 6.81210576
            ],
            [
                7.58234882, 7.63565077, 7.07268465, 8.00447657, 8.24443398, 7.33305315, 7.13976957,
                6.77511802, 7.45231881, 8.2266199, 7.30203006, 7.91719772, 6.95655368
            ],
            [
                7.94730339, 5.72740351, 7.51767686, 8.13566116, 9.4229292, 8.51009244, 7.93095521,
                6.96181199, 7.75894002, 8.40320337, 7.20411974, 6.68883801, 6.77225906
            ],
            [
                7.297517,
                6.87465176,
                6.78892794,
                8.75278074,
                8.9265064,
                8.23197471,
                8.16419214,
                8.74332575,
                10.59865162,
                8.56495772,
                7.97504805,
                6.51005482,
                6.99372762
            ],
            [
                8.54924189, 7.88776943, 8.10268732, 8.84503716, 8.89579236, 9.6857438, 8.8575016,
                8.46930812, 8.67080541, 8.03204515, 6.86681254, 6.40612772, 5.67940471
            ],
            [
                7.93738803, 7.77534488, 7.30721835, 7.08301505, 8.35529216, 7.02582961, 8.47132651,
                8.98525303, 8.52463449, 7.80809179, 6.20446628, 6.18833115, 5.94736298
            ],
            [
                7.05449785, 7.89315741, 5.82880883, 5.92749308, 6.18304808, 6.99036179, 8.1244133,
                7.33060894, 7.54892296, 6.82963641, 6.73551981, 6.53383685, 8.04371858
            ],
            [
                7.56852982, 6.96508023, 7.53974063, 7.20456225, 7.39744782, 6.84346829, 8.94456125,
                8.90915957, 7.90187891, 7.10751941, 6.78235692, 6.31356805, 6.97982498
            ]
        ]
    ];
    let current_output26 = conv_layer26.convolve(&test_input26);

    assert!(
        arr_allclose(&current_output26, &target_output26),
        "{:?} was not equal to {:?}",
        current_output26,
        target_output26
    );

    let test_input27 = array![
        [
            [
                0.968473, 0.01200672, 0.79086026, 0.5638385, 0.96902648, 0.19991862, 0.95133634,
                0.15507828, 0.41979294, 0.98834363, 0.01301026, 0.28899274, 0.86825993, 0.97130792,
                0.80247869
            ],
            [
                0.29034188, 0.24718882, 0.53663422, 0.46929242, 0.15322222, 0.83594127, 0.04108659,
                0.6196703, 0.07340665, 0.06401163, 0.12822088, 0.7238483, 0.30244494, 0.9491711,
                0.44141732
            ],
            [
                0.67812914, 0.22713543, 0.53551254, 0.44359769, 0.39959106, 0.66883225, 0.47769547,
                0.05377042, 0.61688896, 0.22768961, 0.28283465, 0.39900371, 0.91963109, 0.32611709,
                0.68538037
            ],
            [
                0.808091, 0.08409429, 0.35334955, 0.54894203, 0.09672975, 0.67288129, 0.38041668,
                0.90533513, 0.08379908, 0.9617579, 0.53935902, 0.8655558, 0.83468548, 0.98457923,
                0.86291792
            ],
            [
                0.50557288, 0.69113374, 0.96155456, 0.11799753, 0.24098069, 0.52010914, 0.01988209,
                0.93071466, 0.21783542, 0.6345836, 0.59978965, 0.38216811, 0.08845946, 0.66961862,
                0.30976852
            ],
            [
                0.86896496, 0.16485341, 0.22297227, 0.61939572, 0.78727603, 0.06126022, 0.65629948,
                0.92165942, 0.24574541, 0.48232094, 0.67671171, 0.7042522, 0.36677413, 0.48979158,
                0.27360516
            ],
            [
                0.58694217, 0.27611767, 0.26442292, 0.20080982, 0.91767023, 0.36463643, 0.11189529,
                0.11818971, 0.13544263, 0.71311121, 0.68724893, 0.33155695, 0.69078078, 0.80222555,
                0.53332592
            ],
            [
                0.32190927, 0.77878347, 0.08551037, 0.85251175, 0.29192793, 0.96994559, 0.45361685,
                0.11329727, 0.84638329, 0.92850368, 0.87018521, 0.46818327, 0.90702208, 0.18856684,
                0.45777323
            ],
            [
                0.35982915, 0.02530834, 0.91337963, 0.97376152, 0.07101188, 0.77520384, 0.37889206,
                0.13838367, 0.91733085, 0.430336, 0.91983052, 0.53806253, 0.5224842, 0.96556284,
                0.10147168
            ],
            [
                0.57677184, 0.34796357, 0.6165888, 0.68917644, 0.84899486, 0.15994577, 0.54054205,
                0.34836138, 0.13617612, 0.60274207, 0.99996946, 0.4703405, 0.93084307, 0.5403318,
                0.45327122
            ]
        ],
        [
            [
                0.34732912, 0.04459461, 0.427044, 0.55078714, 0.40990628, 0.05412404, 0.08358769,
                0.5525091, 0.90154667, 0.93267442, 0.94750314, 0.23282553, 0.82200572, 0.03333058,
                0.35903281
            ],
            [
                0.13700394, 0.48470175, 0.15042725, 0.90220388, 0.34881375, 0.16714396, 0.89079211,
                0.67488447, 0.29599694, 0.25583468, 0.16394943, 0.54914701, 0.7881106, 0.49022143,
                0.6618432
            ],
            [
                0.71892771, 0.18293882, 0.17122073, 0.71808742, 0.26373631, 0.26237649, 0.64253337,
                0.86013267, 0.58930393, 0.64132371, 0.42210526, 0.31809522, 0.73235176, 0.19029295,
                0.73598146
            ],
            [
                0.54846342, 0.1967719, 0.93418276, 0.89446758, 0.75848629, 0.91592125, 0.17313572,
                0.13061609, 0.92477977, 0.37667144, 0.9792834, 0.29825524, 0.72598021, 0.46687176,
                0.53019644
            ],
            [
                0.14295319, 0.59211245, 0.34359774, 0.26661384, 0.04284242, 0.86709221, 0.19314825,
                0.23294576, 0.54138702, 0.98471538, 0.48499247, 0.09907741, 0.50062149, 0.55782833,
                0.1141604
            ],
            [
                0.12097415, 0.46633621, 0.20250201, 0.53496595, 0.70335182, 0.68214495, 0.49284569,
                0.69404828, 0.55520983, 0.60592108, 0.37876701, 0.22381731, 0.2613474, 0.67423476,
                0.39544468
            ],
            [
                0.40545489, 0.67966813, 0.72399602, 0.28246298, 0.76456982, 0.96831555, 0.53951961,
                0.10945794, 0.499514, 0.07966256, 0.04232476, 0.18794546, 0.02903101, 0.87264,
                0.24646281
            ],
            [
                0.2162571, 0.5063043, 0.49260572, 0.26562026, 0.5136638, 0.38765426, 0.99569704,
                0.26731392, 0.90850284, 0.12043774, 0.46525767, 0.54725892, 0.09271611, 0.9389607,
                0.82003327
            ],
            [
                0.26917773, 0.20598832, 0.15525481, 0.05620801, 0.06457912, 0.58928205, 0.08488933,
                0.45322238, 0.76731629, 0.4033134, 0.15463824, 0.67769824, 0.91617042, 0.62659725,
                0.37210663
            ],
            [
                0.04776173, 0.92938047, 0.4602623, 0.03279204, 0.07298613, 0.23598829, 0.99730229,
                0.25666964, 0.29510999, 0.26824013, 0.66342248, 0.5264845, 0.38605881, 0.75441289,
                0.01928642
            ]
        ],
        [
            [
                0.54743405, 0.11107332, 0.28423597, 0.52096257, 0.76069827, 0.96710502, 0.18445559,
                0.75220759, 0.06932272, 0.95973786, 0.19795855, 0.28506086, 0.13914691, 0.80871649,
                0.37787569
            ],
            [
                0.39205238, 0.79027306, 0.83978633, 0.14340297, 0.62322848, 0.4264953, 0.67103004,
                0.62487622, 0.90834848, 0.43448447, 0.70240457, 0.33882854, 0.18323863, 0.52859295,
                0.13727196
            ],
            [
                0.41655356, 0.1918006, 0.22345521, 0.22415205, 0.97481106, 0.82986438, 0.4279932,
                0.49268875, 0.61891296, 0.64964072, 0.99953726, 0.26837258, 0.66651365, 0.34861882,
                0.53857045
            ],
            [
                0.17353091, 0.31993369, 0.70826129, 0.90379118, 0.50249979, 0.34614602, 0.04152303,
                0.94569021, 0.48921642, 0.71979427, 0.86110633, 0.10902968, 0.21941453, 0.35792755,
                0.71784253
            ],
            [
                0.49131493, 0.4342134, 0.80391459, 0.15955769, 0.72233696, 0.22291588, 0.63777114,
                0.33839073, 0.78856931, 0.70376681, 0.52487602, 0.30532844, 0.23987759, 0.9853742,
                0.94015058
            ],
            [
                0.70025292, 0.67187447, 0.82183464, 0.92597117, 0.12606672, 0.6032527, 0.34271527,
                0.47624903, 0.32579103, 0.67228469, 0.36134558, 0.74746864, 0.28857794, 0.89990904,
                0.26890319
            ],
            [
                0.72367474, 0.59654923, 0.43040072, 0.6599278, 0.59367387, 0.21878308, 0.29627025,
                0.65944481, 0.45294528, 0.29142585, 0.13420771, 0.46529655, 0.87343268, 0.45615639,
                0.38038794
            ],
            [
                0.58034507, 0.76173629, 0.83634587, 0.11365525, 0.52510725, 0.00939824, 0.92569699,
                0.50352102, 0.3704941, 0.67069003, 0.6889376, 0.67212213, 0.28051262, 0.90126435,
                0.74227343
            ],
            [
                0.20851454, 0.98278118, 0.54164971, 0.55001611, 0.01951568, 0.4893268, 0.69844682,
                0.28546089, 0.47535939, 0.22314279, 0.52706518, 0.29269646, 0.83632485, 0.62550989,
                0.38499138
            ],
            [
                0.13979574, 0.02366208, 0.80627349, 0.61764415, 0.51074279, 0.42557175, 0.77872316,
                0.21393713, 0.47935697, 0.09325973, 0.30268312, 0.41914598, 0.3112818, 0.23385784,
                0.31058536
            ]
        ]
    ];

    let kernel27: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.92313242, 0.04408429, 0.89109583, 0.15559341, 0.68804724, 0.7030672, 0.80859519,
            0.99013286, 0.48988731, 0.85251105, 0.83518287, 0.17727828, 0.93172921, 0.7980087,
            0.94389766, 0.88263529, 0.78152828, 0.54680753, 0.60791954, 0.96070865, 0.49979008,
            0.42527972, 0.31804043, 0.66672019, 0.99079618, 0.42641846, 0.69871773, 0.51113379,
            0.9780975, 0.29640056, 0.47655348, 0.78929911, 0.27845028, 0.82055656, 0.8503088,
            0.73562812, 0.22631838, 0.44241802, 0.2089261, 0.73171296, 0.09648527, 0.20636925,
            0.87073562, 0.39002458, 0.68185259, 0.84655061, 0.09084356, 0.56423787, 0.8793211,
            0.96192238, 0.76393695, 0.24373481, 0.69086572, 0.40215193,
        ],
    )
    .unwrap();
    let conv_layer27 = ConvolutionLayer::new(kernel27, 1, Padding::Valid);
    let target_output27 = array![
        [
            [
                7.14295786, 7.16325315, 9.50249976, 8.83011482, 9.03466323, 8.55336568, 9.35828539,
                9.56041176, 8.96605466, 8.81016693, 8.6464486, 9.31016843, 9.56425529
            ],
            [
                7.54218153, 8.3013741, 8.98680113, 9.29140988, 8.3849684, 9.53927372, 9.27037193,
                9.93870565, 8.67103145, 9.02017899, 9.28790102, 9.80080678, 9.79980368
            ],
            [
                8.22039635,
                8.14122376,
                9.29600992,
                9.28417561,
                8.69642986,
                8.60330558,
                8.56819695,
                10.5176177,
                11.5076316,
                9.27101246,
                9.70934892,
                8.32334786,
                10.39763374
            ],
            [
                9.67073528,
                9.02630516,
                9.18985779,
                9.78376808,
                7.76074987,
                9.01062107,
                8.35705174,
                10.65317439,
                10.61644175,
                10.09649931,
                8.38398807,
                9.00590787,
                9.44504619
            ],
            [
                8.86538909, 8.28691682, 9.16060554, 8.76482418, 8.3259798, 8.83638088, 7.06269214,
                9.16761913, 8.48757987, 8.56560855, 6.97586802, 8.94521958, 8.75843929
            ],
            [
                9.287348, 9.06144824, 8.90974454, 9.78918574, 9.69246898, 9.02925924, 7.95604658,
                9.36460436, 8.81540275, 8.78325663, 7.60330205, 9.66496247, 9.60668017
            ],
            [
                8.54823962,
                8.7605119,
                8.97112752,
                8.03536079,
                9.55216266,
                7.46627111,
                8.65998928,
                8.27446396,
                8.407147,
                7.70389195,
                9.44271365,
                10.12983697,
                9.56970942
            ],
            [
                8.12284713,
                9.44179075,
                7.12864251,
                7.56693985,
                8.6778441,
                8.30808237,
                9.42197148,
                7.84975542,
                9.41959804,
                9.41174061,
                10.00229363,
                10.25726698,
                10.46517234
            ]
        ],
        [
            [
                6.1748708, 6.21768952, 6.79814014, 7.75033597, 7.96818153, 7.45560447, 7.5939719,
                8.10075796, 7.04032302, 7.09916085, 6.87434703, 7.20107522, 8.12428101
            ],
            [
                6.47398256, 7.45767477, 7.49931037, 8.35759242, 6.97958842, 7.64882896, 7.30313876,
                7.61043768, 7.57517462, 7.51543771, 7.84054515, 7.69977336, 8.3247353
            ],
            [
                6.8799372, 6.48858006, 6.68527776, 7.48725739, 6.6181344, 7.99017119, 7.6878995,
                8.64091347, 8.94690938, 8.18318448, 7.73849138, 7.66320509, 8.90050455
            ],
            [
                7.52113562, 8.58991335, 8.39503752, 7.82786843, 6.00326334, 7.3423626, 6.75213073,
                9.32608619, 8.44413847, 8.79617977, 7.07437214, 7.52344552, 7.93256488
            ],
            [
                7.96122269, 7.14696183, 7.42289343, 7.11946037, 6.74134734, 6.33601678, 6.63661138,
                8.0944579, 7.58592828, 6.89544122, 6.37670074, 7.75445563, 7.09751594
            ],
            [
                7.22206934, 7.37454545, 8.32812625, 7.54522502, 7.4022671, 6.85772533, 7.33085549,
                6.69651354, 7.38359232, 7.46791062, 7.46954001, 8.30676428, 7.95547051
            ],
            [
                7.88879613, 7.56828824, 6.52203669, 7.99647798, 7.01357214, 6.47765415, 6.96415278,
                6.63907738, 7.97203005, 7.15156238, 7.63474934, 8.98742955, 8.72523743
            ],
            [
                7.1639619, 7.91563772, 7.07603143, 6.69087122, 7.37024616, 7.1381432, 7.43145421,
                6.66971857, 8.4156142, 8.05409452, 8.64699838, 8.59489666, 7.96454077
            ]
        ]
    ];
    let current_output27 = conv_layer27.convolve(&test_input27);

    assert!(
        arr_allclose(&current_output27, &target_output27),
        "{:?} was not equal to {:?}",
        current_output27,
        target_output27
    );

    let test_input28 = array![
        [
            [
                0.33184996, 0.64908034, 0.30805972, 0.32266703, 0.45468414, 0.76469586, 0.51671653,
                0.56441789, 0.57114466, 0.1499708, 0.0285126, 0.34472197, 0.43013144, 0.45248675,
                0.86351109
            ],
            [
                0.13950848, 0.31055019, 0.87944521, 0.20421512, 0.89352186, 0.84149825, 0.17070445,
                0.8472129, 0.80763392, 0.43805567, 0.92837189, 0.42566534, 0.80635439, 0.03382581,
                0.22873266
            ],
            [
                0.10301294, 0.64236861, 0.66955779, 0.93261364, 0.10865665, 0.59626133, 0.99988186,
                0.35112807, 0.13524966, 0.90124023, 0.42197251, 0.7799652, 0.87387354, 0.91006059,
                0.49740205
            ],
            [
                0.16655016, 0.98748305, 0.33358737, 0.97735418, 0.4197044, 0.88689565, 0.9949134,
                0.08079711, 0.97684611, 0.15401786, 0.7613341, 0.33150923, 0.62684278, 0.23814382,
                0.15689475
            ],
            [
                0.17239508, 0.5322748, 0.81536444, 0.40988755, 0.24133632, 0.7648658, 0.11204641,
                0.94687663, 0.31404087, 0.14600264, 0.8751561, 0.21171107, 0.16797651, 0.92516051,
                0.63095193
            ],
            [
                0.89293909, 0.12795849, 0.10989774, 0.90538735, 0.30030969, 0.64865221, 0.69226535,
                0.19131283, 0.8676397, 0.91694082, 0.93137124, 0.14831748, 0.89142022, 0.10900346,
                0.06097801
            ],
            [
                0.82975563, 0.46926925, 0.65601351, 0.35788413, 0.84590471, 0.68722954, 0.79336314,
                0.69625898, 0.60328611, 0.21245298, 0.77838677, 0.33385372, 0.18934485, 0.98988925,
                0.83544203
            ],
            [
                0.82852668, 0.48125054, 0.21471797, 0.61738714, 0.62692716, 0.13899311, 0.09477642,
                0.33909173, 0.50521873, 0.18457449, 0.20815027, 0.04814293, 0.82568176, 0.00548277,
                0.95209122
            ],
            [
                0.43334082, 0.41616559, 0.13053188, 0.82981785, 0.43391317, 0.15262189, 0.76765394,
                0.84143919, 0.22662647, 0.75768616, 0.03670884, 0.56937202, 0.40169111, 0.83430796,
                0.91996184
            ],
            [
                0.55233093, 0.60879943, 0.84842744, 0.62333464, 0.72344356, 0.93422615, 0.4833327,
                0.38079957, 0.69664333, 0.63759292, 0.05685853, 0.86841039, 0.88915733, 0.76392257,
                0.89278922
            ]
        ],
        [
            [
                0.23738323, 0.58335521, 0.87517558, 0.74558375, 0.77469293, 0.27917181, 0.14463307,
                0.11350685, 0.39833463, 0.73064126, 0.92805762, 0.18288209, 0.35543967, 0.78150373,
                0.66671311
            ],
            [
                0.57531868, 0.35594859, 0.26997161, 0.99164583, 0.35738186, 0.31955966, 0.6034462,
                0.49671843, 0.21147081, 0.43717725, 0.8128758, 0.44624192, 0.26903113, 0.48451242,
                0.299916
            ],
            [
                0.24334253, 0.81102607, 0.93565844, 0.89604715, 0.74001564, 0.49422848, 0.56603131,
                0.57117814, 0.94668282, 0.75557139, 0.47999806, 0.29572074, 0.88842474, 0.6943571,
                0.76284432
            ],
            [
                0.26878476, 0.64336683, 0.00685212, 0.72935826, 0.03449651, 0.19757592, 0.35532915,
                0.9904894, 0.44599372, 0.99797895, 0.94856582, 0.81601158, 0.08034612, 0.23848392,
                0.70573328
            ],
            [
                0.53495741, 0.07772017, 0.89346812, 0.96835217, 0.6608676, 0.78390221, 0.93657471,
                0.0319368, 0.45478264, 0.11851354, 0.24598802, 0.07832937, 0.97511008, 0.83557275,
                0.01171468
            ],
            [
                0.85650479, 0.10912379, 0.4077279, 0.35906726, 0.26236705, 0.65862478, 0.11245027,
                0.56852181, 0.69495834, 0.67337078, 0.8991999, 0.60308778, 0.73000857, 0.48400246,
                0.19118872
            ],
            [
                0.25460039, 0.91846106, 0.28075829, 0.73211796, 0.66833038, 0.33361896, 0.51849384,
                0.67916823, 0.48042778, 0.6937536, 0.9167911, 0.68012579, 0.0564688, 0.78486877,
                0.34188869
            ],
            [
                0.91241813, 0.07043128, 0.37207894, 0.49574846, 0.12505584, 0.31035821, 0.60963128,
                0.24199934, 0.40645204, 0.67775714, 0.76091386, 0.2477421, 0.23572316, 0.49046425,
                0.56703387
            ],
            [
                0.30917186, 0.06782987, 0.19831855, 0.38844033, 0.2388109, 0.78329371, 0.48872955,
                0.5716796, 0.72878735, 0.44170135, 0.54763687, 0.13181127, 0.02235833, 0.360836,
                0.79167342
            ],
            [
                0.77685972, 0.85824954, 0.96455652, 0.40896285, 0.64341777, 0.2303441, 0.88401787,
                0.89847402, 0.9301381, 0.41758482, 0.27304211, 0.48180396, 0.63210746, 0.62059747,
                0.90595636
            ]
        ],
        [
            [
                0.42945445, 0.97156673, 0.29061685, 0.39886904, 0.79654879, 0.26557566, 0.49024066,
                0.04281154, 0.2126663, 0.45918139, 0.72670998, 0.83077593, 0.75937792, 0.98412323,
                0.53401237
            ],
            [
                0.22581473, 0.94544616, 0.45676421, 0.83325416, 0.94435399, 0.0488622, 0.36290236,
                0.19694914, 0.22211873, 0.89430046, 0.73731279, 0.23623947, 0.20805733, 0.56668677,
                0.9879018
            ],
            [
                0.44374003, 0.78476408, 0.371802, 0.2305824, 0.52640328, 0.86068394, 0.48357182,
                0.8400437, 0.39311503, 0.5037727, 0.22245023, 0.78845742, 0.46210247, 0.28570879,
                0.69361483
            ],
            [
                0.58333513, 0.26489744, 0.658877, 0.96536913, 0.80373667, 0.33775257, 0.98935051,
                0.34009922, 0.09269939, 0.4328108, 0.74674775, 0.57959552, 0.86004763, 0.10764247,
                0.01841728
            ],
            [
                0.27755456, 0.11139348, 0.08395886, 0.71043001, 0.45239363, 0.11525997, 0.28355595,
                0.95543646, 0.46826618, 0.68696929, 0.51128345, 0.54206832, 0.46346098, 0.93996977,
                0.31194555
            ],
            [
                0.45759721, 0.02952798, 0.05740095, 0.55836499, 0.63975834, 0.79906203, 0.44999343,
                0.58138868, 0.98907141, 0.11409238, 0.47506758, 0.1869184, 0.87604839, 0.08230179,
                0.33851793
            ],
            [
                0.68964777, 0.61307685, 0.12817005, 0.766394, 0.87622137, 0.32000798, 0.38584011,
                0.20234333, 0.29644713, 0.08710818, 0.59548962, 0.89744274, 0.82598113, 0.3775057,
                0.80864925
            ],
            [
                0.28085634, 0.47305905, 0.10534422, 0.87061427, 0.32882456, 0.88731766, 0.97063475,
                0.32436552, 0.72868264, 0.80771195, 0.42811718, 0.73635357, 0.89212479, 0.63641548,
                0.6343222
            ],
            [
                0.22897069, 0.68388858, 0.27927719, 0.6897695, 0.47514349, 0.69722742, 0.97543495,
                0.57465926, 0.81788557, 0.74363214, 0.20077299, 0.13081091, 0.55760674, 0.56738032,
                0.33047372
            ],
            [
                0.49729655, 0.18380235, 0.12606913, 0.60540571, 0.35723292, 0.89859826, 0.70710741,
                0.76911915, 0.52791016, 0.05990019, 0.86264995, 0.60107542, 0.07892385, 0.30022189,
                0.22659946
            ]
        ]
    ];

    let kernel28: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.14760193, 0.21413611, 0.46885745, 0.66423817, 0.8391969, 0.41313492, 0.81092879,
            0.07522171, 0.09202226, 0.78546018, 0.61535142, 0.16359355, 0.92554733, 0.89040359,
            0.5301901, 0.19735775, 0.43730916, 0.26645028, 0.14086206, 0.81940349, 0.87782377,
            0.81441252, 0.94491211, 0.18393158, 0.00453156, 0.30542407, 0.027802, 0.4377543,
            0.95791441, 0.27238532, 0.6434107, 0.77950682, 0.03596852, 0.94994553, 0.31696306,
            0.41555945, 0.88981735, 0.83952223, 0.70364728, 0.19911294, 0.58806963, 0.73953919,
            0.31632706, 0.94590174, 0.3039722, 0.02226985, 0.89484024, 0.94421537, 0.29766195,
            0.64613331, 0.87160847, 0.92774295, 0.06134897, 0.09143816, 0.02453929, 0.53698071,
            0.5608989, 0.75235978, 0.79507724, 0.12966863, 0.17343595, 0.70492943, 0.20702457,
            0.16046775, 0.99582208, 0.22769123, 0.68801787, 0.83820977, 0.01911113, 0.71697519,
            0.27681004, 0.06093569, 0.43404636, 0.66175576, 0.44444508, 0.00599372, 0.26165754,
            0.43228299, 0.06268399, 0.18263739, 0.88581848, 0.62190108, 0.75219087, 0.05626365,
            0.2715362, 0.64973148, 0.11108088, 0.65209919, 0.25231564, 0.67305826, 0.69336061,
            0.60061648, 0.96312688, 0.18575046, 0.52347236, 0.33365021, 0.09777608, 0.31281238,
            0.71138199, 0.07645657, 0.72884977, 0.9319044, 0.16224979, 0.75028186, 0.66940516,
            0.45720101, 0.72729406, 0.28626589, 0.29447657, 0.45880696, 0.61887466, 0.20012106,
            0.42260578, 0.93381677, 0.61133267, 0.80442407, 0.74704049, 0.41035688, 0.778617,
            0.23559987, 0.09958417, 0.82783867, 0.29261506, 0.94091393, 0.31977178, 0.50342597,
            0.18005316, 0.20221839, 0.58713917, 0.21670068, 0.17925061, 0.52275812, 0.64913375,
            0.75073629, 0.94143581, 0.54446397, 0.54065808, 0.30891683, 0.06850107, 0.8324337,
            0.53898123, 0.95084522, 0.8525341, 0.3645535, 0.83921854, 0.18543235, 0.91676912,
            0.16094153, 0.06250098, 0.51352833,
        ],
    )
    .unwrap();
    let conv_layer28 = ConvolutionLayer::new(kernel28, 1, Padding::Valid);
    let target_output28 = array![
        [
            [
                18.52773544,
                22.53251882,
                19.8420046,
                19.38287015,
                19.54232634,
                17.6130123,
                19.62308916,
                19.11729879,
                20.34800062,
                19.85575845,
                19.98852878
            ],
            [
                18.96063454,
                20.93274307,
                21.43190268,
                22.92496565,
                19.25423938,
                21.54411937,
                21.2668017,
                18.49600965,
                20.87805804,
                19.91702215,
                18.45522687
            ],
            [
                19.19086961,
                19.87837366,
                20.1878721,
                20.14713268,
                20.39847057,
                19.75590137,
                21.00667208,
                20.84567914,
                21.27677333,
                20.63185611,
                20.54302605
            ],
            [
                18.30275347,
                19.55579426,
                19.76007985,
                19.71135821,
                20.43858572,
                17.44637982,
                21.05267637,
                19.04719293,
                19.39362021,
                19.50204905,
                18.99336043
            ],
            [
                16.65126075,
                16.89820915,
                18.69659315,
                20.00229005,
                19.56855171,
                19.59994999,
                20.57918028,
                18.74953269,
                18.41482965,
                18.79524834,
                18.22874075
            ],
            [
                17.4472206,
                17.66799828,
                19.99528351,
                20.02592019,
                21.49488246,
                20.81088759,
                19.65576777,
                19.12433472,
                20.04363703,
                17.88568081,
                18.30475212
            ]
        ],
        [
            [
                18.74568847,
                19.34535735,
                19.48879996,
                19.64281804,
                18.22777518,
                17.84827707,
                20.16293492,
                18.57923163,
                17.98698243,
                19.00076759,
                20.13698527
            ],
            [
                19.31682797,
                20.49339564,
                20.94903025,
                22.62983766,
                19.75943986,
                18.61566773,
                20.11758574,
                19.15781723,
                20.02886694,
                20.2241523,
                18.40525453
            ],
            [
                19.29682927,
                18.77750022,
                20.17891873,
                19.88614387,
                19.06791323,
                19.77149318,
                19.54654244,
                20.9003562,
                20.63091304,
                20.44587811,
                19.99911106
            ],
            [
                18.5046549,
                17.56676424,
                20.12468881,
                19.85838762,
                19.8041205,
                19.4111173,
                19.61078077,
                20.37301687,
                18.58101812,
                21.07900001,
                18.11055113
            ],
            [
                17.6299368,
                16.61099312,
                18.44916296,
                19.66302944,
                20.23748584,
                20.28907902,
                19.25627213,
                18.18945699,
                17.82076038,
                18.1523073,
                18.25000253
            ],
            [
                17.80146261,
                17.11873966,
                19.50292904,
                19.93833322,
                19.32526997,
                20.4114172,
                19.73564794,
                20.24506334,
                18.73048502,
                18.86699209,
                18.68441424
            ]
        ]
    ];
    let current_output28 = conv_layer28.convolve(&test_input28);

    assert!(
        arr_allclose(&current_output28, &target_output28),
        "{:?} was not equal to {:?}",
        current_output28,
        target_output28
    );

    let test_input29 = array![
        [
            [
                0.82848715, 0.12292414, 0.20470969, 0.95561638, 0.86255626, 0.30796449, 0.24823008,
                0.50311692, 0.98074588, 0.03213529, 0.2574467, 0.97324241, 0.21001962, 0.26517462,
                0.0038282
            ],
            [
                0.08282983, 0.79932619, 0.13075382, 0.43831323, 0.26103418, 0.56784427, 0.03319374,
                0.13130436, 0.84865194, 0.23911465, 0.4614755, 0.72813417, 0.84974216, 0.0656543,
                0.26282084
            ],
            [
                0.68387176, 0.15333543, 0.31919928, 0.67005818, 0.00915827, 0.78874909, 0.07875763,
                0.30477429, 0.43796757, 0.54534572, 0.46345224, 0.5078866, 0.47349572, 0.93777999,
                0.00917824
            ],
            [
                0.89281444, 0.14618948, 0.21801536, 0.61790164, 0.74369047, 0.83831029, 0.0566386,
                0.30938643, 0.96125232, 0.80651444, 0.70371311, 0.58040164, 0.54378764, 0.64524393,
                0.38423092
            ],
            [
                0.64454817, 0.62221509, 0.92868456, 0.04893699, 0.10405056, 0.7266609, 0.04145219,
                0.48782048, 0.548731, 0.45881257, 0.33547177, 0.54037099, 0.79101775, 0.78839544,
                0.84049743
            ],
            [
                0.9842876, 0.3631438, 0.04040196, 0.37753971, 0.4733552, 0.95901178, 0.69483556,
                0.46147575, 0.52445789, 0.26899648, 0.41173777, 0.53783194, 0.95134267, 0.60490572,
                0.15807905
            ],
            [
                0.52334199, 0.62018557, 0.45906409, 0.28503575, 0.38717397, 0.1981337, 0.98584665,
                0.83887973, 0.32806987, 0.26547596, 0.54155626, 0.90635383, 0.58438163, 0.80972454,
                0.59019595
            ],
            [
                0.67807877, 0.0958912, 0.47856296, 0.85674535, 0.70287635, 0.53743317, 0.31929256,
                0.09922413, 0.07765451, 0.446601, 0.58093805, 0.48493851, 0.20790926, 0.81503462,
                0.28842457
            ],
            [
                0.26068439, 0.71527441, 0.86428924, 0.59597006, 0.32738407, 0.22714304, 0.14223122,
                0.49853118, 0.28446306, 0.85784458, 0.50938488, 0.56399824, 0.63260813, 0.70372093,
                0.62917059
            ],
            [
                0.86995201, 0.51462922, 0.78186775, 0.62534816, 0.49688725, 0.93685856, 0.36799956,
                0.40307762, 0.69772192, 0.43395323, 0.65974034, 0.28784845, 0.76198399, 0.02110602,
                0.18104874
            ]
        ],
        [
            [
                0.12873596, 0.52158403, 0.32419515, 0.8962471, 0.16951791, 0.48415481, 0.42320151,
                0.2196024, 0.94563128, 0.49693356, 0.45553603, 0.3627867, 0.9101744, 0.41195874,
                0.68331535
            ],
            [
                0.74266544, 0.18561169, 0.92822394, 0.28829069, 0.17956546, 0.12135573, 0.29163483,
                0.4782706, 0.28834381, 0.05297824, 0.71394046, 0.32832127, 0.46872958, 0.10209152,
                0.36334252
            ],
            [
                0.02750501, 0.79784446, 0.70732907, 0.64926277, 0.52349092, 0.08833914, 0.22806701,
                0.25333271, 0.97122886, 0.68606072, 0.65992148, 0.35286993, 0.69897416, 0.29683718,
                0.36412131
            ],
            [
                0.29423689, 0.68540368, 0.02948874, 0.0048431, 0.43101178, 0.19812581, 0.72115872,
                0.0141753, 0.78953046, 0.80715594, 0.19224384, 0.43242832, 0.4958622, 0.73673742,
                0.29721686
            ],
            [
                0.69389512, 0.75789962, 0.96990104, 0.98348894, 0.89075837, 0.97847943, 0.40886414,
                0.32128148, 0.39472355, 0.87849302, 0.78958012, 0.75543073, 0.23345572, 0.54354429,
                0.16837756
            ],
            [
                0.7681288, 0.85423149, 0.51030129, 0.59577572, 0.82332438, 0.85556581, 0.25473274,
                0.87210913, 0.30302691, 0.55013153, 0.36448048, 0.58787241, 0.49309427, 0.96107544,
                0.81055479
            ],
            [
                0.00024235, 0.20580723, 0.42482692, 0.02397736, 0.72264349, 0.28624369, 0.33910661,
                0.87520554, 0.19625323, 0.29169067, 0.55841755, 0.62216193, 0.24158851, 0.78276191,
                0.94054116
            ],
            [
                0.58551256, 0.42005201, 0.68272057, 0.71152625, 0.61693936, 0.65756059, 0.02934249,
                0.86692382, 0.73534189, 0.49630404, 0.21345795, 0.82055302, 0.17480347, 0.127237,
                0.7203788
            ],
            [
                0.52442361, 0.68926451, 0.5063956, 0.85057951, 0.52149975, 0.76833694, 0.67387353,
                0.58446873, 0.3201185, 0.09514732, 0.71366805, 0.48656831, 0.51304414, 0.33208346,
                0.47421247
            ],
            [
                0.65361419, 0.91969109, 0.48471547, 0.3553714, 0.37583, 0.68677646, 0.66436833,
                0.60841759, 0.19649447, 0.05938564, 0.90802655, 0.02659295, 0.79841344, 0.54365277,
                0.24870853
            ]
        ],
        [
            [
                0.19493582, 0.06434183, 0.11837589, 0.72749725, 0.89949921, 0.50550426, 0.24034185,
                0.43426839, 0.44097563, 0.60258669, 0.44379727, 0.2487736, 0.39797535, 0.38203195,
                0.45850393
            ],
            [
                0.72705849, 0.73794276, 0.64137435, 0.49762248, 0.97447652, 0.63540921, 0.86157887,
                0.47632742, 0.99329984, 0.39004716, 0.36967712, 0.7320835, 0.53924271, 0.19136641,
                0.24959058
            ],
            [
                0.24431834, 0.98453825, 0.64511192, 0.63156655, 0.88483645, 0.51414193, 0.78832331,
                0.6694263, 0.64503408, 0.99498231, 0.91093289, 0.81354124, 0.53855813, 0.08466158,
                0.31364415
            ],
            [
                0.58694244, 0.95513807, 0.7533694, 0.83636741, 0.47684281, 0.05256698, 0.50159207,
                0.52415643, 0.92893124, 0.25863178, 0.68629023, 0.34644595, 0.69513009, 0.73902685,
                0.41607439
            ],
            [
                0.55612449, 0.8944672, 0.12573825, 0.1309708, 0.19249535, 0.88732066, 0.94225923,
                0.33589965, 0.20935446, 0.11820385, 0.61463959, 0.93286069, 0.08010993, 0.81300774,
                0.35681822
            ],
            [
                0.3387178, 0.69573399, 0.87327089, 0.19604515, 0.93222111, 0.89882571, 0.58026378,
                0.29316397, 0.43613002, 0.37700799, 0.67584548, 0.99191519, 0.87526672, 0.25857434,
                0.56145431
            ],
            [
                0.24716882, 0.59646319, 0.45910731, 0.70268539, 0.05888641, 0.86936975, 0.04178984,
                0.19628692, 0.48324485, 0.34818614, 0.43203036, 0.13312029, 0.59230624, 0.18394486,
                0.44074105
            ],
            [
                0.83411977, 0.54269039, 0.02972909, 0.78101332, 0.99540682, 0.96492665, 0.56245795,
                0.39934039, 0.00198996, 0.79839312, 0.72308261, 0.62823937, 0.10601443, 0.27046125,
                0.69916581
            ],
            [
                0.32585684, 0.38133959, 0.52138848, 0.77488746, 0.34216304, 0.36691627, 0.09267096,
                0.76446555, 0.26963411, 0.59979402, 0.88974968, 0.57541674, 0.49034654, 0.63787571,
                0.23486344
            ],
            [
                0.03662743, 0.87932213, 0.53838686, 0.99681179, 0.19825908, 0.24576979, 0.40309097,
                0.90556718, 0.12604196, 0.06919543, 0.56249222, 0.47776846, 0.79470665, 0.71139069,
                0.57747318
            ]
        ]
    ];

    let kernel29: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.61245713, 0.28628785, 0.11163998, 0.70265153, 0.35941375, 0.15993103, 0.40862007,
            0.64616002, 0.1549832, 0.98560174, 0.97785051, 0.61528493, 0.298369, 0.39290614,
            0.62659276, 0.27373014, 0.80509214, 0.22292198, 0.71498458, 0.37015311, 0.02864541,
            0.18460116, 0.2495688, 0.20685976, 0.48693478, 0.94574443, 0.37555937, 0.79570754,
            0.83116457, 0.48656109, 0.72048514, 0.09185711, 0.0451069, 0.10193888, 0.25587378,
            0.22258296, 0.77982756, 0.56598396, 0.4127133, 0.57375852, 0.73249104, 0.21926213,
            0.83723958, 0.72377337, 0.49891137, 0.38749784, 0.5780929, 0.44534237, 0.03298171,
            0.88516566, 0.96979702, 0.04331318, 0.42499141, 0.7658825, 0.36713556, 0.85812101,
            0.81429753, 0.57029749, 0.16565025, 0.63168261, 0.25811203, 0.71058422, 0.28650795,
            0.86943133, 0.4511592, 0.9107763, 0.70158083, 0.14372927, 0.32025693, 0.53325307,
            0.78058935, 0.60567654, 0.64136176, 0.28889107, 0.40765006, 0.03752139, 0.76789914,
            0.97307409, 0.46130355, 0.22646557, 0.42355735, 0.70528004, 0.01944306, 0.32756809,
            0.13691915, 0.46431799, 0.93562272, 0.47126327, 0.8382721, 0.00830113, 0.27433896,
            0.09783126, 0.76072214, 0.17257372, 0.44504768, 0.63270447, 0.55758209, 0.98542097,
            0.56188855, 0.61392414, 0.46812821, 0.43971176, 0.13753681, 0.38838806, 0.06850647,
            0.48144374, 0.82353595, 0.60988926, 0.37098823, 0.23198135, 0.62782708, 0.7211608,
            0.57679987, 0.66124401, 0.66081992, 0.68628502, 0.13207655, 0.61290087, 0.43520794,
            0.54966918, 0.44100301, 0.04024655, 0.26395977, 0.04516815, 0.26826328, 0.12823386,
            0.09780997, 0.95902903, 0.2515203, 0.97507527, 0.33813378, 0.07302681, 0.91541411,
            0.64406869, 0.90634482, 0.72843253, 0.40345481, 0.35120928, 0.91799987, 0.7095235,
            0.52486304, 0.17238653, 0.35133615, 0.22938729, 0.02767666, 0.14124235, 0.67101529,
            0.29018157, 0.37819354, 0.27840444,
        ],
    )
    .unwrap();
    let conv_layer29 = ConvolutionLayer::new(kernel29, 1, Padding::Valid);
    let target_output29 = array![
        [
            [
                19.33779172,
                19.69594737,
                17.89126671,
                17.37038018,
                17.83960205,
                18.66135015,
                19.28786632,
                17.92316294,
                20.93409041,
                19.48666425,
                18.28090371
            ],
            [
                19.30526552,
                20.14839481,
                19.76899398,
                18.91938495,
                18.89991913,
                18.84704565,
                19.22066208,
                19.16516475,
                20.89883255,
                20.20318329,
                19.59853397
            ],
            [
                20.09792784,
                20.37002882,
                19.60401949,
                18.16588147,
                18.7111976,
                19.74270918,
                19.63781604,
                20.41432852,
                19.53328928,
                21.51163538,
                20.59618827
            ],
            [
                18.9188925,
                19.93573639,
                18.77211247,
                19.81092984,
                18.75189228,
                18.06401051,
                16.18241742,
                18.95171732,
                18.98099408,
                19.49670585,
                19.98774615
            ],
            [
                20.24967471,
                21.19362801,
                20.49690709,
                19.94969969,
                17.94824297,
                18.44301683,
                16.1240077,
                18.69842592,
                18.42587522,
                19.8452789,
                20.88829383
            ],
            [
                20.1457074,
                21.18933403,
                19.71682795,
                19.94943748,
                19.49210679,
                18.21325371,
                16.32783399,
                17.8827314,
                18.28440427,
                18.93858085,
                19.99853651
            ]
        ],
        [
            [
                17.57227839,
                18.69463769,
                15.67126057,
                15.12017297,
                15.51653645,
                16.57394453,
                18.03678532,
                17.91460981,
                18.3605421,
                18.60824571,
                17.36011745
            ],
            [
                19.09870281,
                18.63902113,
                16.9913411,
                17.01810682,
                16.82824426,
                17.0138902,
                16.28470435,
                17.94107395,
                19.03518461,
                18.92461006,
                18.11169706
            ],
            [
                17.17277583,
                17.79285469,
                16.71741086,
                17.15794264,
                17.38553801,
                17.03371912,
                16.45219011,
                18.01663127,
                19.71130914,
                19.11545584,
                18.84364564
            ],
            [
                18.10226427,
                19.10259448,
                17.43672553,
                17.78223913,
                18.19154374,
                17.44112288,
                16.24516597,
                16.57097542,
                17.47229971,
                19.20665852,
                18.43951378
            ],
            [
                17.33439008,
                18.3313,
                18.65794586,
                19.71458548,
                17.2683994,
                15.86214559,
                15.14258932,
                16.99858141,
                17.88253362,
                18.63304885,
                17.729919
            ],
            [
                18.187558,
                19.14484051,
                18.01624642,
                18.40889773,
                16.45005668,
                16.79733265,
                16.14546293,
                15.62399476,
                15.98647896,
                18.24124502,
                18.4577884
            ]
        ]
    ];
    let current_output29 = conv_layer29.convolve(&test_input29);

    assert!(
        arr_allclose(&current_output29, &target_output29),
        "{:?} was not equal to {:?}",
        current_output29,
        target_output29
    );

    let test_input30 = array![
        [
            [
                0.89372281, 0.78445924, 0.58712801, 0.68114016, 0.23000366, 0.06065572, 0.84496329,
                0.17815381, 0.30446775, 0.88643997, 0.88266083, 0.68384961, 0.02779118, 0.86535265,
                0.72814707
            ],
            [
                0.68486334, 0.67593971, 0.16086548, 0.64757223, 0.94878229, 0.57993472, 0.58338782,
                0.21564776, 0.0107795, 0.53028938, 0.98573533, 0.03758357, 0.69495144, 0.63164333,
                0.00178706
            ],
            [
                0.28412483, 0.35812909, 0.10555214, 0.74310325, 0.15210662, 0.86376217, 0.83035149,
                0.43450554, 0.45277232, 0.42497007, 0.79865278, 0.89581372, 0.81917153, 0.04101894,
                0.25766372
            ],
            [
                0.2857464, 0.66271508, 0.03159403, 0.93542052, 0.74232757, 0.80547294, 0.32092867,
                0.51995739, 0.44993455, 0.57139093, 0.93578261, 0.21231654, 0.39067076, 0.41872549,
                0.62385207
            ],
            [
                0.65184226, 0.52886577, 0.01740899, 0.19255764, 0.64582922, 0.19123401, 0.82107479,
                0.78315556, 0.39581179, 0.31105782, 0.47715544, 0.29922553, 0.45532397, 0.42382213,
                0.42575221
            ],
            [
                0.56597986, 0.38580756, 0.45498174, 0.68482728, 0.97141219, 0.91654963, 0.89789514,
                0.99886152, 0.74995397, 0.2109633, 0.2595119, 0.64143605, 0.69794111, 0.91833401,
                0.65583056
            ],
            [
                0.52543861, 0.17987564, 0.04420354, 0.07644754, 0.67701851, 0.02457761, 0.19219192,
                0.86232313, 0.08402258, 0.31468205, 0.40743571, 0.98625355, 0.59068389, 0.6265308,
                0.59731365
            ],
            [
                0.21510182, 0.57183193, 0.90177902, 0.97057748, 0.03424489, 0.78139438, 0.55354594,
                0.70381685, 0.47117358, 0.95235469, 0.3368942, 0.47262584, 0.33963646, 0.53057699,
                0.0421344
            ],
            [
                0.59682315, 0.93284742, 0.05644235, 0.55691821, 0.6096802, 0.00810335, 0.73244206,
                0.73275174, 0.38904786, 0.84123703, 0.9108226, 0.54357492, 0.7924024, 0.03436404,
                0.649227
            ],
            [
                0.55308978, 0.55382131, 0.81708771, 0.99407461, 0.30411442, 0.43357349, 0.90748503,
                0.67047438, 0.95180837, 0.327034, 0.09215528, 0.03004104, 0.28787527, 0.16794387,
                0.85762239
            ]
        ],
        [
            [
                0.997754, 0.58261301, 0.25544515, 0.50827443, 0.408603, 0.154079, 0.76260163,
                0.26175068, 0.94878975, 0.420784, 0.64920469, 0.62660611, 0.58517391, 0.20996386,
                0.39318707
            ],
            [
                0.84961617, 0.64456962, 0.70874045, 0.18771773, 0.58967289, 0.91786684, 0.47667618,
                0.89133877, 0.29889567, 0.07816543, 0.30748605, 0.13146875, 0.2455884, 0.81027586,
                0.45821981
            ],
            [
                0.03629474, 0.02914437, 0.27197846, 0.79646136, 0.20802912, 0.95377633, 0.95887528,
                0.65447566, 0.91661334, 0.14067934, 0.64449096, 0.12830848, 0.42274445, 0.09930792,
                0.46413783
            ],
            [
                0.93483082, 0.97417882, 0.08091403, 0.99598936, 0.02799125, 0.99117134, 0.39836622,
                0.48990741, 0.03084684, 0.73604949, 0.87069364, 0.5704002, 0.23692592, 0.48079551,
                0.27060798
            ],
            [
                0.71227602, 0.38637865, 0.73943389, 0.89828088, 0.90009913, 0.29393503, 0.37299707,
                0.71168383, 0.97290847, 0.51860092, 0.86727587, 0.03071198, 0.62365896, 0.65666048,
                0.97928354
            ],
            [
                0.72018579, 0.46124812, 0.01468375, 0.04436485, 0.54361908, 0.82998192, 0.18899626,
                0.02270102, 0.42788859, 0.62540177, 0.02546183, 0.73727669, 0.67568086, 0.03686747,
                0.16345957
            ],
            [
                0.2864706, 0.12798377, 0.97041538, 0.14767134, 0.19173194, 0.72695231, 0.33087449,
                0.48967764, 0.73316128, 0.77017715, 0.94743479, 0.68625983, 0.22131853, 0.98268984,
                0.48969689
            ],
            [
                0.66191621, 0.28850291, 0.08790162, 0.63548346, 0.78716157, 0.56886003, 0.38486881,
                0.52164921, 0.61789879, 0.99155946, 0.1660726, 0.45400558, 0.79271979, 0.51949296,
                0.1856097
            ],
            [
                0.94973904, 0.55421731, 0.44071786, 0.20264524, 0.48095221, 0.22991579, 0.72079857,
                0.33685236, 0.70664368, 0.41910259, 0.53551847, 0.68504052, 0.75572897, 0.22152406,
                0.38674412
            ],
            [
                0.52526342, 0.68355748, 0.00781578, 0.74518463, 0.59167517, 0.64922996, 0.53241574,
                0.71958782, 0.787326, 0.41490154, 0.57506337, 0.17358405, 0.64472922, 0.54675949,
                0.77786934
            ]
        ],
        [
            [
                0.46338457, 0.74148726, 0.38590936, 0.66626601, 0.913767, 0.61952481, 0.18244016,
                0.04169152, 0.73767347, 0.0778392, 0.38854632, 0.54694177, 0.89240649, 0.13090512,
                0.32672238
            ],
            [
                0.45679869, 0.96701486, 0.88949418, 0.2012408, 0.80090126, 0.16573429, 0.95321173,
                0.17446654, 0.39913233, 0.74028524, 0.99362098, 0.86146387, 0.77066559, 0.48230579,
                0.65619095
            ],
            [
                0.45011836, 0.69193079, 0.08190992, 0.66244077, 0.50446085, 0.60208729, 0.73197966,
                0.1375018, 0.76142713, 0.44368562, 0.92738415, 0.04963118, 0.05446685, 0.52868895,
                0.83290284
            ],
            [
                0.75272588, 0.86544561, 0.14496518, 0.79414079, 0.03848875, 0.64981678, 0.14606106,
                0.53609649, 0.40801702, 0.66188473, 0.21162366, 0.72954617, 0.02214847, 0.39574632,
                0.93228407
            ],
            [
                0.09648224, 0.59184713, 0.56132905, 0.18568947, 0.14083895, 0.97096816, 0.69329291,
                0.90605891, 0.37787062, 0.82105915, 0.86623363, 0.03382622, 0.149902, 0.45536264,
                0.01637395
            ],
            [
                0.13000993, 0.73456862, 0.3311825, 0.59042015, 0.94970683, 0.68421301, 0.59009004,
                0.86184339, 0.6528449, 0.80175091, 0.02745248, 0.22952433, 0.70173411, 0.21967117,
                0.50405574
            ],
            [
                0.85770921, 0.37675844, 0.40747899, 0.62435315, 0.46982294, 0.23975594, 0.39658298,
                0.19221618, 0.19351118, 0.68409839, 0.16978115, 0.11779779, 0.04202804, 0.6135814,
                0.51994119
            ],
            [
                0.87151363, 0.50771167, 0.49242653, 0.45100801, 0.08637598, 0.40288509, 0.64877658,
                0.79412487, 0.69248389, 0.70862474, 0.68587414, 0.46214448, 0.74960237, 0.91085593,
                0.16283799
            ],
            [
                0.45783094, 0.4387137, 0.14814438, 0.04074387, 0.47096237, 0.21848392, 0.68204967,
                0.93032443, 0.66565032, 0.59142588, 0.4931909, 0.36235321, 0.39252733, 0.73895642,
                0.33436301
            ],
            [
                0.77226716, 0.38821791, 0.97707476, 0.52904606, 0.80317616, 0.6601235, 0.69454863,
                0.90204449, 0.96140549, 0.72119238, 0.42119924, 0.00080285, 0.90600003, 0.75012407,
                0.33486333
            ]
        ]
    ];

    let kernel30: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.88640977, 0.71259858, 0.74456281, 0.03754441, 0.88537117, 0.63763181, 0.39005476,
            0.42324458, 0.95586166, 0.31640234, 0.59547029, 0.7692697, 0.97494472, 0.48383069,
            0.48876185, 0.83975344, 0.40678144, 0.60285438, 0.26352007, 0.10377176, 0.81499612,
            0.80427088, 0.99888978, 0.2223024, 0.65762941, 0.74142269, 0.24283216, 0.71635485,
            0.16035181, 0.24824438, 0.03641145, 0.88133336, 0.79482712, 0.38749497, 0.92716256,
            0.24522811, 0.10074908, 0.65030685, 0.88709895, 0.46684209, 0.1023455, 0.42606649,
            0.39407017, 0.04832328, 0.83194524, 0.76636767, 0.36219997, 0.37628286, 0.99529114,
            0.92468382, 0.54252204, 0.47941734, 0.19754058, 0.78323723, 0.51153193, 0.12909189,
            0.59161954, 0.42772555, 0.13567366, 0.90997947, 0.85072468, 0.00591142, 0.62844395,
            0.20012485, 0.13939073, 0.85847047, 0.92328418, 0.83398768, 0.48977067, 0.12412303,
            0.08583226, 0.42277343, 0.23401077, 0.34888557, 0.03209783, 0.47692632, 0.20553346,
            0.21179068, 0.89399736, 0.24929681, 0.29794612, 0.54092983, 0.26319243, 0.08868469,
            0.70006971, 0.85711458, 0.01657799, 0.95646164, 0.85511381, 0.43697715, 0.863551,
            0.62936534, 0.13638273, 0.21221249, 0.03825287, 0.38785053, 0.03818879, 0.45113886,
            0.75809141, 0.80387026, 0.04009474, 0.57682237, 0.83644695, 0.69940187, 0.75166474,
            0.16722608, 0.0324995, 0.72855155, 0.1495293, 0.38665441, 0.97477299, 0.56219357,
            0.15980155, 0.36363719, 0.8870456, 0.51589403, 0.48859269, 0.06674533, 0.45603733,
            0.71169677, 0.94109128, 0.17138261, 0.12467484, 0.78135292, 0.2840905, 0.35029163,
            0.926685, 0.82449115, 0.22348203, 0.57408338, 0.15894171, 0.22166132, 0.89472645,
            0.07900955, 0.52299017, 0.67588324, 0.45705856, 0.65289095, 0.18496908, 0.15193757,
            0.86474273, 0.25023912, 0.71127338, 0.97272791, 0.22000751, 0.84066054, 0.94081557,
            0.5302998, 0.42161967, 0.19625776,
        ],
    )
    .unwrap();
    let conv_layer30 = ConvolutionLayer::new(kernel30, 1, Padding::Valid);
    let target_output30 = array![
        [
            [
                19.30490843,
                21.62882496,
                19.71111349,
                21.26804175,
                19.47495906,
                20.2551955,
                22.86566312,
                19.86128686,
                20.39774094,
                20.04995718,
                18.56783198
            ],
            [
                19.49894087,
                20.65373829,
                20.78052761,
                22.12335574,
                20.90091648,
                21.44718426,
                21.62758201,
                20.1849967,
                19.60824321,
                18.70243021,
                18.67279519
            ],
            [
                17.16439605,
                18.22241301,
                19.69005751,
                21.43810699,
                21.59634772,
                20.44281822,
                21.65932695,
                21.0951714,
                19.9855791,
                17.31820841,
                18.88474878
            ],
            [
                18.79524009,
                20.54455279,
                19.03155607,
                22.49224146,
                19.98721516,
                22.25145325,
                21.84939078,
                20.08589015,
                18.01973127,
                20.84522155,
                17.58267278
            ],
            [
                18.64105197,
                16.8375711,
                17.55336238,
                19.99460362,
                21.46457807,
                20.84147678,
                21.0543415,
                22.03762741,
                21.27837687,
                19.14169223,
                19.73667878
            ],
            [
                18.95821345,
                19.043299,
                19.82292419,
                21.04273506,
                22.47334417,
                22.69186037,
                21.86816785,
                21.86670788,
                20.15387276,
                20.17179332,
                18.38443381
            ]
        ],
        [
            [
                18.32508874,
                19.21613008,
                18.65186608,
                18.45068256,
                18.65469681,
                19.51383835,
                21.14466638,
                19.21613826,
                19.0754825,
                17.46404447,
                18.77624317
            ],
            [
                18.47826625,
                18.53428969,
                19.84009344,
                21.26409388,
                20.09063142,
                18.70608484,
                19.73184801,
                17.1997738,
                17.72255977,
                17.33631146,
                18.38139642
            ],
            [
                16.57267216,
                18.2716011,
                18.44327072,
                21.12966928,
                19.46284835,
                20.29612745,
                19.3691839,
                18.99593071,
                17.83557637,
                17.87952994,
                16.53885459
            ],
            [
                16.42999392,
                19.45463824,
                17.27912438,
                19.56309544,
                18.48774247,
                21.37696304,
                19.30346523,
                20.02886445,
                17.12092463,
                18.14156654,
                16.7687641
            ],
            [
                16.72703558,
                16.43106283,
                17.39929832,
                19.05485845,
                18.87399876,
                21.57093127,
                19.63538605,
                18.51353104,
                18.21252982,
                19.00709222,
                16.83309521
            ],
            [
                17.4630337,
                18.35187914,
                18.32475503,
                19.85801624,
                21.0890141,
                20.80689242,
                19.89009325,
                19.65021275,
                18.98233216,
                18.0339771,
                18.08936135
            ]
        ]
    ];
    let current_output30 = conv_layer30.convolve(&test_input30);

    assert!(
        arr_allclose(&current_output30, &target_output30),
        "{:?} was not equal to {:?}",
        current_output30,
        target_output30
    );

    let test_input31 = array![
        [
            [
                0.11980431, 0.05043373, 0.44856634, 0.0995127, 0.66721712, 0.99523524, 0.38974791,
                0.0062347, 0.25642252, 0.79783882
            ],
            [
                0.68729692, 0.29115056, 0.79556409, 0.77050707, 0.69040029, 0.55326157, 0.1605104,
                0.09648368, 0.98106206, 0.82000684
            ],
            [
                0.48767112, 0.90160043, 0.11782064, 0.02350398, 0.85411554, 0.54948291, 0.86921203,
                0.5469399, 0.38010216, 0.8991906
            ],
            [
                0.30023638, 0.1237447, 0.49097719, 0.72805624, 0.95301348, 0.54578071, 0.7374898,
                0.02905989, 0.88964962, 0.80966904
            ],
            [
                0.14540059, 0.8414026, 0.26861846, 0.25325528, 0.97593206, 0.7466225, 0.42966274,
                0.01035187, 0.88566147, 0.23396359
            ],
            [
                0.35538376, 0.43052002, 0.25629111, 0.43928609, 0.69094858, 0.15833754, 0.06233076,
                0.36822248, 0.04919559, 0.93492837
            ],
            [
                0.96548997, 0.86486349, 0.24502176, 0.95630357, 0.80910063, 0.21886946, 0.0567609,
                0.07057994, 0.16586034, 0.08248742
            ],
            [
                0.28810685, 0.24666146, 0.72800059, 0.21720299, 0.27971972, 0.1429008, 0.1254066,
                0.16514674, 0.79326256, 0.21495369
            ],
            [
                0.20266143, 0.59933768, 0.5696813, 0.69164119, 0.32460627, 0.94145868, 0.0734322,
                0.80689548, 0.07320249, 0.91290434
            ],
            [
                0.86054597, 0.14726785, 0.51773988, 0.26826427, 0.36311297, 0.61510392, 0.63254868,
                0.83204209, 0.48682921, 0.21009445
            ],
            [
                0.04975929, 0.80676099, 0.78489711, 0.70026565, 0.9457111, 0.85440517, 0.71804871,
                0.55172745, 0.8578678, 0.23224549
            ],
            [
                0.02310899, 0.25985479, 0.98004136, 0.72586276, 0.22645573, 0.90784464, 0.534928,
                0.75128938, 0.46953653, 0.77429137
            ],
            [
                0.49730704, 0.8848362, 0.38707261, 0.92346432, 0.79674084, 0.86324733, 0.32076064,
                0.39202869, 0.69460177, 0.24372894
            ],
            [
                0.49396161, 0.59653256, 0.1116066, 0.09670109, 0.39188403, 0.56043957, 0.2022228,
                0.50315732, 0.97677081, 0.39591292
            ],
            [
                0.90799466, 0.65592413, 0.55727569, 0.07000257, 0.30442452, 0.7739332, 0.2155859,
                0.80078561, 0.6095338, 0.68177587
            ]
        ],
        [
            [
                0.30807668, 0.12723272, 0.2624294, 0.08031525, 0.17361916, 0.65810089, 0.85241152,
                0.98641159, 0.35544557, 0.99685939
            ],
            [
                0.01807762, 0.09607173, 0.68579101, 0.86541871, 0.3497612, 0.95970744, 0.01258456,
                0.16584114, 0.68078684, 0.77186105
            ],
            [
                0.70951276, 0.78814267, 0.05957514, 0.76849564, 0.02124477, 0.02591292, 0.48664332,
                0.37939195, 0.95164127, 0.62887538
            ],
            [
                0.71587542, 0.70287865, 0.00513179, 0.97035195, 0.07550302, 0.43179563, 0.53038147,
                0.84309702, 0.04810897, 0.03910594
            ],
            [
                0.90726247, 0.11982161, 0.60190607, 0.13881885, 0.52187018, 0.85052256, 0.338509,
                0.3031956, 0.05187115, 0.25060338
            ],
            [
                0.73213949, 0.84957286, 0.93865448, 0.65920982, 0.61787501, 0.88865151, 0.41375994,
                0.15206665, 0.69296478, 0.84714531
            ],
            [
                0.10857984, 0.32165972, 0.40264117, 0.99361945, 0.0388213, 0.60990226, 0.6618832,
                0.79375072, 0.53550745, 0.7804362
            ],
            [
                0.59082873, 0.52224765, 0.17179801, 0.75876251, 0.32153467, 0.90698327, 0.1332323,
                0.60105509, 0.81028929, 0.6555247
            ],
            [
                0.51127623, 0.74778622, 0.87416848, 0.62494179, 0.70959913, 0.66309574, 0.37875827,
                0.47265751, 0.12168032, 0.84286947
            ],
            [
                0.60123306, 0.7902299, 0.33639954, 0.1295481, 0.33253833, 0.16333707, 0.45462115,
                0.97930786, 0.87573602, 0.00543618
            ],
            [
                0.45436792, 0.26881901, 0.67779648, 0.86850825, 0.24649319, 0.35102446, 0.8317649,
                0.10098601, 0.12133782, 0.50588505
            ],
            [
                0.45685568, 0.09913059, 0.25103959, 0.09967188, 0.16055934, 0.96178347, 0.68839463,
                0.66844715, 0.46234563, 0.328285
            ],
            [
                0.99242497, 0.11227968, 0.42852716, 0.73501345, 0.95016545, 0.1932244, 0.96737749,
                0.24141203, 0.75072335, 0.49899355
            ],
            [
                0.11416891, 0.12978615, 0.80415186, 0.17522074, 0.99324827, 0.07845372, 0.30105924,
                0.87208086, 0.2187118, 0.73465172
            ],
            [
                0.22369012, 0.66829443, 0.17275229, 0.35331661, 0.54720806, 0.43991743, 0.32379033,
                0.16511487, 0.78007901, 0.20005976
            ]
        ],
        [
            [
                0.13390501, 0.98241477, 0.00958934, 0.38621364, 0.21235857, 0.60438163, 0.36282186,
                0.53632268, 0.87673139, 0.93126133
            ],
            [
                0.53289114, 0.9291924, 0.24262013, 0.17621124, 0.21581873, 0.55223053, 0.97428217,
                0.13684596, 0.0038069, 0.00677892
            ],
            [
                0.43624929, 0.20579425, 0.83045637, 0.91710154, 0.11364035, 0.42192397, 0.96356675,
                0.21657681, 0.97265728, 0.94870439
            ],
            [
                0.308687, 0.56422577, 0.96346223, 0.34751764, 0.14497681, 0.24281646, 0.89710973,
                0.25471458, 0.92559078, 0.50459674
            ],
            [
                0.52693001, 0.10823907, 0.69637885, 0.0617022, 0.79595085, 0.91569148, 0.59587628,
                0.81942144, 0.51230317, 0.22599821
            ],
            [
                0.68476429, 0.67671155, 0.7209084, 0.19666668, 0.46187317, 0.68419674, 0.10668166,
                0.46758505, 0.85146294, 0.49949895
            ],
            [
                0.04954484, 0.59677982, 0.71358093, 0.27493002, 0.42418939, 0.74957039, 0.31648433,
                0.35538703, 0.91076663, 0.07774146
            ],
            [
                0.07081332, 0.15884496, 0.16601219, 0.40750048, 0.24065089, 0.4561631, 0.0730514,
                0.20042138, 0.61555564, 0.59598464
            ],
            [
                0.85234586, 0.39690518, 0.90118777, 0.64547081, 0.92651145, 0.21866481, 0.26569541,
                0.69838281, 0.64268041, 0.43912457
            ],
            [
                0.09201861, 0.24951272, 0.39910503, 0.04226355, 0.03372583, 0.35070628, 0.80232839,
                0.34594544, 0.59496605, 0.68560296
            ],
            [
                0.49572425, 0.41149921, 0.17057473, 0.75086758, 0.96657243, 0.07823556, 0.67942085,
                0.03686264, 0.2815227, 0.86441349
            ],
            [
                0.40417363, 0.79699722, 0.11597095, 0.29483115, 0.43114743, 0.63828966, 0.58409027,
                0.66343357, 0.26003667, 0.83035486
            ],
            [
                0.83261124, 0.83485613, 0.33262721, 0.24397685, 0.21724486, 0.51769137, 0.00598922,
                0.82792129, 0.97536332, 0.31899844
            ],
            [
                0.68334946, 0.10638801, 0.28193729, 0.30331546, 0.44458251, 0.09437273, 0.18510874,
                0.63173667, 0.70001813, 0.00274565
            ],
            [
                0.68718668, 0.57882502, 0.35462692, 0.61658299, 0.27519759, 0.05888736, 0.42484936,
                0.96516041, 0.213527, 0.52148439
            ]
        ]
    ];

    let kernel31: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.56371771, 0.21445233, 0.97274446, 0.96067435, 0.77400486, 0.82454912, 0.04093061,
            0.62044975, 0.64517467, 0.34419013, 0.17637333, 0.12974854, 0.6806969, 0.25830766,
            0.67223724, 0.19486532, 0.20731905, 0.22394987, 0.46725456, 0.59583681, 0.53723675,
            0.97284102, 0.3401532, 0.7913009, 0.08197373, 0.63256076, 0.05523287, 0.81873294,
            0.11806071, 0.74869779, 0.29916614, 0.63882513, 0.37664894, 0.4275515, 0.28326757,
            0.35058063, 0.70609356, 0.32952575, 0.79447089, 0.91396963, 0.21258484, 0.50744606,
            0.25447013, 0.83910975, 0.14626299, 0.23119005, 0.17714995, 0.69576324, 0.01715484,
            0.96206266, 0.78958918, 0.6507138, 0.05410179, 0.46869732,
        ],
    )
    .unwrap();
    let conv_layer31 = ConvolutionLayer::new(kernel31, 1, Padding::Valid);
    let target_output31 = array![
        [
            [
                5.59291545, 5.60105817, 5.29786526, 5.2683864, 7.08174282, 6.89131739, 6.38271797,
                7.17292927
            ],
            [
                6.09256272, 6.30277481, 7.24143939, 6.62054995, 7.09245237, 6.72688466, 6.24796763,
                6.57387715
            ],
            [
                5.91805488, 6.39891016, 6.12751701, 6.44211463, 7.50547095, 6.94013439, 6.89750503,
                6.76832205
            ],
            [
                6.4478533, 6.07368311, 6.8701447, 6.94444451, 6.89937839, 6.11270123, 4.92644294,
                6.68253461
            ],
            [
                6.69597196, 6.91458302, 6.26698967, 7.00725044, 7.13614089, 5.51641979, 4.54639319,
                5.72960175
            ],
            [
                6.16554961, 6.28048447, 6.56750545, 5.88332764, 5.3665709, 3.60475054, 4.43905098,
                5.62611829
            ],
            [
                6.20791931, 7.07546198, 6.80100613, 7.13149663, 5.53885119, 4.96552515, 4.9510361,
                6.66468344
            ],
            [
                6.00706472, 5.55128277, 5.84074527, 5.07135187, 5.49285428, 5.80825293, 6.1230485,
                7.24746332
            ],
            [
                6.03158833, 7.13207034, 7.38483704, 7.45157268, 7.47633475, 6.80621206, 7.03969647,
                5.77986376
            ],
            [
                5.63743842, 6.29098996, 5.87701052, 5.78647901, 7.11145006, 7.58570069, 7.77455913,
                7.11780231
            ],
            [
                6.39984939, 7.41697337, 7.17199585, 8.27083388, 7.48897763, 7.57597673, 6.0922029,
                7.03515657
            ],
            [
                5.65857424, 5.58996879, 5.29582344, 5.92336072, 6.04805169, 6.42846022, 7.41224299,
                7.15424802
            ],
            [
                7.50258536, 5.05842038, 5.54114477, 5.87658506, 5.59003182, 5.45864641, 6.84290277,
                8.06824726
            ]
        ],
        [
            [
                5.42901124, 5.84398945, 5.03366005, 5.78058086, 5.795873, 7.02907772, 6.96734019,
                7.29625036
            ],
            [
                5.48205118, 6.59688159, 6.74420148, 6.36868779, 6.46454821, 6.15468114, 6.16476661,
                6.62271572
            ],
            [
                6.0615179, 6.77060295, 5.24731669, 5.74757963, 7.21231202, 7.29249571, 6.40396341,
                6.82038684
            ],
            [
                7.06214152, 5.9523638, 6.26504009, 7.21494917, 7.38087124, 5.66213802, 5.96595158,
                5.74331076
            ],
            [
                6.65918059, 6.6081961, 6.46349494, 7.25561281, 6.89204335, 5.49130908, 5.3313996,
                5.38461382
            ],
            [
                6.07596816, 6.48194708, 6.03266833, 6.32961763, 5.54834162, 4.91784807, 4.21980874,
                6.61844415
            ],
            [
                5.95465593, 7.3033715, 7.19395486, 7.42896694, 5.39899685, 5.50396099, 5.55580856,
                6.41847201
            ],
            [
                6.15423511, 5.82100368, 5.65180571, 5.33387684, 5.08361475, 5.32562422, 6.44183385,
                7.43121001
            ],
            [
                5.87723863, 6.86788399, 7.23219956, 6.7478368, 6.53062286, 7.54679392, 6.30864542,
                5.52995401
            ],
            [
                6.37335503, 5.23784409, 5.31811001, 5.98900315, 6.27838936, 7.48318958, 7.09502743,
                7.31350919
            ],
            [
                6.4063926, 6.61647815, 6.77778904, 7.22601366, 7.61687386, 6.97176372, 7.10713682,
                6.0910598
            ],
            [
                5.18750708, 4.85663322, 5.77394441, 5.42954499, 6.70210591, 5.84696482, 7.08196988,
                7.87031907
            ],
            [
                6.38840398, 5.45442309, 5.86933582, 6.17389267, 5.17956253, 6.40751266, 6.48002748,
                7.27262157
            ]
        ]
    ];
    let current_output31 = conv_layer31.convolve(&test_input31);

    assert!(
        arr_allclose(&current_output31, &target_output31),
        "{:?} was not equal to {:?}",
        current_output31,
        target_output31
    );

    let test_input32 = array![
        [
            [
                0.7351389, 0.10655331, 0.77344522, 0.553476, 0.16894332, 0.8976765, 0.20382801,
                0.75384826, 0.75862404, 0.17905368
            ],
            [
                0.28606841, 0.64446747, 0.5231733, 0.02075461, 0.45745205, 0.01996619, 0.39505484,
                0.39265912, 0.1213429, 0.82586903
            ],
            [
                0.85618266, 0.7577091, 0.3459607, 0.95572013, 0.92937866, 0.07907035, 0.41537429,
                0.85995776, 0.91603121, 0.26174001
            ],
            [
                0.31216501, 0.73736545, 0.2825182, 0.93811946, 0.62593821, 0.29817144, 0.26417359,
                0.62514907, 0.06003402, 0.06863045
            ],
            [
                0.66786885, 0.73104405, 0.23246141, 0.48162453, 0.77811541, 0.41137747, 0.9972559,
                0.49030397, 0.96476976, 0.39093721
            ],
            [
                0.13691517, 0.20412358, 0.22074685, 0.05624962, 0.68899853, 0.63385394, 0.89087913,
                0.76289175, 0.96164151, 0.83766772
            ],
            [
                0.03124781, 0.86728951, 0.45569643, 0.41169245, 0.23071601, 0.65278766, 0.95353164,
                0.16538836, 0.31145655, 0.02828005
            ],
            [
                0.14747888, 0.30263219, 0.99981271, 0.92644605, 0.46344219, 0.4029006, 0.36729267,
                0.36346476, 0.36422955, 0.7725577
            ],
            [
                0.89565293, 0.54924948, 0.12382696, 0.79487141, 0.29347779, 0.28533514, 0.46504469,
                0.36790222, 0.66567503, 0.81930284
            ],
            [
                0.37452426, 0.06236777, 0.61082655, 0.94621385, 0.19448081, 0.09286012, 0.70801625,
                0.44260015, 0.27405552, 0.37098764
            ],
            [
                0.21528777, 0.19037103, 0.79290859, 0.48885154, 0.11583171, 0.2444331, 0.31950996,
                0.82152084, 0.92018557, 0.6324256
            ],
            [
                0.8988874, 0.79191956, 0.63617105, 0.64246501, 0.5914831, 0.63586736, 0.84626372,
                0.44348246, 0.45841581, 0.87631007
            ],
            [
                0.66888971, 0.89464476, 0.36634242, 0.33335866, 0.16760358, 0.61695288, 0.19301597,
                0.06703918, 0.11021607, 0.46326013
            ],
            [
                0.90998458, 0.19569386, 0.22239834, 0.16384328, 0.97118685, 0.11606233, 0.49665623,
                0.48572266, 0.83523111, 0.80498019
            ],
            [
                0.32960872, 0.79986305, 0.8312853, 0.11399209, 0.37213322, 0.56118462, 0.99523086,
                0.38572571, 0.49142755, 0.63120777
            ]
        ],
        [
            [
                0.07301666, 0.9756451, 0.61317027, 0.21154444, 0.94862154, 0.52220882, 0.13832045,
                0.96337642, 0.01639629, 0.19411111
            ],
            [
                0.04715753, 0.31424384, 0.44769425, 0.10706459, 0.44355087, 0.71309348, 0.54699335,
                0.60526183, 0.38917129, 0.88367036
            ],
            [
                0.44077539, 0.73792097, 0.14433428, 0.85192676, 0.02097251, 0.95633018, 0.45995144,
                0.10583407, 0.56784169, 0.10541193
            ],
            [
                0.87573343, 0.12863558, 0.79587993, 0.53403529, 0.21138961, 0.6925418, 0.43096246,
                0.69654607, 0.69877169, 0.98164632
            ],
            [
                0.64306772, 0.65803694, 0.7858138, 0.74894114, 0.66253483, 0.4890013, 0.83234049,
                0.48294268, 0.7292857, 0.92350285
            ],
            [
                0.34584804, 0.00624331, 0.69736786, 0.29992156, 0.89269228, 0.94817296, 0.31388246,
                0.00432913, 0.29734896, 0.40603398
            ],
            [
                0.56788189, 0.70891321, 0.94203091, 0.10524429, 0.89597745, 0.3581413, 0.84424638,
                0.63260361, 0.49300047, 0.88413816
            ],
            [
                0.90374769, 0.00271136, 0.98342794, 0.04954946, 0.78719302, 0.76861512, 0.19857672,
                0.17108533, 0.58195867, 0.88385839
            ],
            [
                0.16141163, 0.60231775, 0.294304, 0.14176326, 0.37438836, 0.10216843, 0.17332367,
                0.11517226, 0.38179011, 0.32803876
            ],
            [
                0.66434167, 0.77332523, 0.94774401, 0.00787854, 0.13019027, 0.58464369, 0.70387627,
                0.69783799, 0.99696945, 0.87614516
            ],
            [
                0.5237107, 0.83812864, 0.45777786, 0.15208962, 0.56539786, 0.26558961, 0.00088664,
                0.05462804, 0.43966387, 0.47845422
            ],
            [
                0.34291573, 0.69536623, 0.1036236, 0.68493666, 0.84170303, 0.14973171, 0.51744188,
                0.26742129, 0.05020873, 0.8967645
            ],
            [
                0.28862263, 0.73840203, 0.99305737, 0.63178033, 0.08334628, 0.59717393, 0.05311463,
                0.38400442, 0.05716073, 0.94563347
            ],
            [
                0.31587509, 0.69320916, 0.91989448, 0.26697786, 0.1736736, 0.207445, 0.98654819,
                0.94583003, 0.80740195, 0.33522689
            ],
            [
                0.01231102, 0.06471063, 0.77028167, 0.04418209, 0.05123908, 0.31676801, 0.02213015,
                0.99987621, 0.34928932, 0.75233946
            ]
        ],
        [
            [
                0.27983864, 0.05932388, 0.08217912, 0.19400314, 0.92018245, 0.21455716, 0.58815186,
                0.59598235, 0.3016201, 0.82684654
            ],
            [
                0.06193527, 0.10932652, 0.39186088, 0.5791381, 0.51992797, 0.68690148, 0.31554793,
                0.92840583, 0.77997731, 0.57404126
            ],
            [
                0.63325499, 0.23396463, 0.56662749, 0.6193624, 0.23979845, 0.01872301, 0.64512045,
                0.44843149, 0.57392231, 0.6379088
            ],
            [
                0.15632313, 0.9590727, 0.81913607, 0.79628325, 0.1876398, 0.1792817, 0.76093377,
                0.04901551, 0.12188532, 0.75263585
            ],
            [
                0.56340058, 0.07880943, 0.55886112, 0.64294605, 0.99033882, 0.06506247, 0.18129697,
                0.12433387, 0.73773443, 0.25497472
            ],
            [
                0.58844589, 0.56834318, 0.08598604, 0.25001068, 0.30140766, 0.464108, 0.57008056,
                0.92347583, 0.81149604, 0.97582668
            ],
            [
                0.12168682, 0.81502959, 0.03257993, 0.29636486, 0.23406821, 0.68854657, 0.40710647,
                0.68527244, 0.49084945, 0.08669137
            ],
            [
                0.69706857, 0.49293855, 0.91180951, 0.40840417, 0.20486033, 0.24171825, 0.32654667,
                0.30279541, 0.58513414, 0.80932314
            ],
            [
                0.06084506, 0.91577754, 0.36349937, 0.49541315, 0.73060917, 0.55541974, 0.3212567,
                0.08391169, 0.47639692, 0.56541388
            ],
            [
                0.24304809, 0.78207753, 0.08051699, 0.84173134, 0.66277754, 0.65122109, 0.44558695,
                0.32629655, 0.17646311, 0.69403932
            ],
            [
                0.44565287, 0.70450526, 0.96684875, 0.8550647, 0.63707969, 0.70200128, 0.44229119,
                0.86386947, 0.13879521, 0.52424467
            ],
            [
                0.53778486, 0.72673949, 0.56881529, 0.62562757, 0.26191136, 0.17741988, 0.89845975,
                0.5524051, 0.94144089, 0.90488428
            ],
            [
                0.01719667, 0.43135418, 0.5723982, 0.86594314, 0.14621608, 0.95570712, 0.89263908,
                0.12217854, 0.03542558, 0.80120881
            ],
            [
                0.99483611, 0.28721202, 0.64516698, 0.34233773, 0.49766175, 0.47700463, 0.67733945,
                0.30034919, 0.39818336, 0.85493217
            ],
            [
                0.21975358, 0.77274995, 0.82208912, 0.41363551, 0.16918235, 0.91666115, 0.55894298,
                0.50932685, 0.69832363, 0.96101004
            ]
        ]
    ];

    let kernel32: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.99979722, 0.27782661, 0.92208675, 0.10170663, 0.3392352, 0.49100837, 0.58505236,
            0.94955044, 0.08288938, 0.86614874, 0.9029227, 0.38428995, 0.69930185, 0.07096831,
            0.43514693, 0.35515, 0.73666345, 0.60863685, 0.89585605, 0.41573935, 0.5904251,
            0.37262206, 0.77221438, 0.58982395, 0.68248703, 0.37460857, 0.25456929, 0.42995887,
            0.69825463, 0.98112951, 0.68170774, 0.80277765, 0.11250915, 0.70728539, 0.53288117,
            0.12515384, 0.0841737, 0.62402925, 0.84727753, 0.31476195, 0.85541025, 0.49978712,
            0.20403187, 0.11740076, 0.49698647, 0.11358444, 0.16815847, 0.49291241, 0.11822088,
            0.53853285, 0.32562397, 0.44291237, 0.67491605, 0.17941345,
        ],
    )
    .unwrap();
    let conv_layer32 = ConvolutionLayer::new(kernel32, 1, Padding::Valid);
    let target_output32 = array![
        [
            [
                6.36169451, 5.85245287, 6.91368611, 7.29847025, 7.10017723, 7.07250588, 7.04155593,
                8.80595603
            ],
            [
                5.89393641, 8.1478163, 7.08838826, 7.03951716, 5.9662321, 7.40027482, 7.60840692,
                7.46600921
            ],
            [
                8.75667034, 8.74370728, 8.05393703, 7.86637224, 6.92288825, 6.92144143, 7.12745247,
                7.3372344
            ],
            [
                6.6143011, 7.76601728, 7.86301958, 7.83335959, 8.02790753, 6.73916264, 8.05189822,
                8.33014961
            ],
            [
                7.10227105, 6.37671689, 7.82558998, 7.15449748, 8.9782848, 8.04578532, 9.47312465,
                7.68715901
            ],
            [
                6.56973319, 5.85554012, 7.5949435, 6.5359115, 8.84323277, 7.32023423, 7.56212713,
                7.79943376
            ],
            [
                8.06655473, 7.84295092, 7.03851458, 6.41217064, 6.42915846, 6.33525274, 6.61044395,
                6.58067762
            ],
            [
                7.37476352, 7.05335005, 7.78509431, 6.92692556, 6.35670829, 5.50527715, 6.20345382,
                7.13854243
            ],
            [
                7.25348521, 8.11870047, 7.2359077, 6.53062621, 6.00276278, 5.46953048, 6.30416205,
                6.97372265
            ],
            [
                8.25226614, 9.1145927, 7.7419076, 6.88703502, 6.57068016, 7.09525008, 7.95671702,
                7.85743225
            ],
            [
                8.31139064, 9.33904984, 7.8783148, 6.97186474, 6.73035732, 6.89653212, 5.49656843,
                7.50445881
            ],
            [
                8.60628055, 8.04771325, 6.82582117, 7.23028988, 7.3104246, 6.93074604, 6.96896411,
                7.44614864
            ],
            [
                7.14151274, 8.38351836, 7.4732452, 5.75186211, 6.11131821, 7.86710101, 7.3919331,
                7.4213618
            ]
        ],
        [
            [
                5.40232255, 5.91183388, 5.00415455, 6.04660949, 5.5959397, 5.76078029, 6.27786621,
                6.08074912
            ],
            [
                6.41144172, 6.44260056, 6.18786276, 5.84005196, 5.15538077, 5.83441397, 5.7909424,
                6.75066333
            ],
            [
                7.01928861, 7.55437466, 7.35294008, 6.21994418, 6.38868098, 5.31920181, 6.6084195,
                6.25900672
            ],
            [
                5.67332967, 6.06256078, 6.70466444, 6.13099382, 6.6678761, 6.19404498, 6.56749892,
                6.34965227
            ],
            [
                4.65566478, 5.46774183, 5.68221433, 5.7009862, 7.64485671, 7.52552603, 8.08209194,
                7.06039475
            ],
            [
                5.44067375, 5.20762907, 6.01798872, 6.18707721, 6.91453238, 6.85235244, 6.41860206,
                5.97916248
            ],
            [
                6.00675923, 6.82484338, 5.25173719, 5.68490745, 5.69841028, 4.76498584, 4.3985405,
                4.73273161
            ],
            [
                6.58752539, 6.31025821, 5.97608053, 5.87239859, 4.6017277, 4.30491198, 5.40862139,
                6.48734164
            ],
            [
                5.77184762, 6.66392893, 6.65088344, 5.09368224, 4.46942834, 4.68867772, 5.11826304,
                6.49832162
            ],
            [
                6.55806136, 7.69330923, 6.24924737, 5.64078468, 5.29808055, 5.26915722, 5.88098699,
                6.28058975
            ],
            [
                7.19719122, 7.59764042, 6.29164852, 5.92641215, 4.95642385, 6.4084786, 5.46395573,
                5.86106575
            ],
            [
                7.68800095, 7.16282559, 6.10049247, 4.88107168, 6.67587194, 5.45256212, 5.42762872,
                5.7550406
            ],
            [
                5.93933958, 6.23123436, 5.43624474, 4.244926, 4.84296304, 5.54089495, 6.0609241,
                7.20785652
            ]
        ]
    ];
    let current_output32 = conv_layer32.convolve(&test_input32);

    assert!(
        arr_allclose(&current_output32, &target_output32),
        "{:?} was not equal to {:?}",
        current_output32,
        target_output32
    );

    let test_input33 = array![
        [
            [
                0.24435801, 0.51685951, 0.68132181, 0.54062276, 0.84024462, 0.57455207, 0.21274436,
                0.21751188, 0.6327846, 0.9325366
            ],
            [
                0.08400947, 0.83966809, 0.74549535, 0.87148379, 0.46964038, 0.59467484, 0.46486275,
                0.46776877, 0.77490347, 0.57024289
            ],
            [
                0.00275485, 0.54555528, 0.7504094, 0.0516187, 0.74270811, 0.5231299, 0.80638138,
                0.27779006, 0.33038311, 0.94963987
            ],
            [
                0.73109218, 0.21866089, 0.0114934, 0.0989068, 0.926821, 0.48527933, 0.16351804,
                0.3116739, 0.53867633, 0.36534721
            ],
            [
                0.80936283, 0.17813227, 0.43542842, 0.86026083, 0.47061769, 0.07629808, 0.71618065,
                0.94789123, 0.73321649, 0.58162109
            ],
            [
                0.897314, 0.85125346, 0.50469854, 0.98244302, 0.06972428, 0.30822515, 0.02439791,
                0.18523273, 0.53135427, 0.46648682
            ],
            [
                0.99412635, 0.19982048, 0.90395256, 0.54784577, 0.96795374, 0.22741624, 0.00554162,
                0.55170396, 0.56010681, 0.75972297
            ],
            [
                0.71794273, 0.56639508, 0.00826331, 0.11534049, 0.42596257, 0.68173687, 0.4604141,
                0.34953818, 0.69908698, 0.73615981
            ],
            [
                0.88632006, 0.68609754, 0.6732832, 0.37878715, 0.32302735, 0.57664813, 0.27476154,
                0.01185389, 0.19381722, 0.92559452
            ],
            [
                0.08145659, 0.29654609, 0.99967966, 0.12471338, 0.61783545, 0.43614203, 0.39178115,
                0.35493045, 0.49653239, 0.57551019
            ],
            [
                0.51010307, 0.91676561, 0.52303485, 0.70051905, 0.76227056, 0.06306251, 0.50691241,
                0.94569022, 0.00299157, 0.12880773
            ],
            [
                0.05983794, 0.77259356, 0.52640993, 0.25460968, 0.28755965, 0.16006813, 0.8973991,
                0.26068632, 0.26253388, 0.67275447
            ],
            [
                0.84160687, 0.1393529, 0.49849265, 0.955501, 0.91761973, 0.39986316, 0.89406526,
                0.08086525, 0.37690058, 0.94723157
            ],
            [
                0.90634656, 0.41918304, 0.94620468, 0.95395429, 0.7064477, 0.85239344, 0.10098496,
                0.34863841, 0.02051973, 0.37064746
            ],
            [
                0.34976024, 0.63522565, 0.58224157, 0.31255614, 0.7061453, 0.13239637, 0.51017932,
                0.8859752, 0.91541525, 0.0093977
            ]
        ],
        [
            [
                0.92576463, 0.14790155, 0.86361974, 0.00816072, 0.16182604, 0.71637904, 0.50981584,
                0.23436014, 0.27748674, 0.0989435
            ],
            [
                0.49678063, 0.3482415, 0.40149437, 0.44752907, 0.48441091, 0.58768096, 0.83226593,
                0.22630381, 0.91060963, 0.10668963
            ],
            [
                0.95036079, 0.00645077, 0.01176434, 0.36804477, 0.185258, 0.23739756, 0.09321253,
                0.61428419, 0.97665915, 0.37697606
            ],
            [
                0.63038553, 0.68867161, 0.70453161, 0.90386671, 0.76855408, 0.09102922, 0.30520669,
                0.27853079, 0.85340833, 0.02803171
            ],
            [
                0.38585196, 0.76870934, 0.15628383, 0.93176335, 0.53949802, 0.84650086, 0.02412173,
                0.11517583, 0.07861274, 0.64147438
            ],
            [
                0.09359703, 0.8526771, 0.18144441, 0.1424162, 0.20421812, 0.39205091, 0.42704045,
                0.65233307, 0.2849727, 0.69454806
            ],
            [
                0.01063524, 0.29424522, 0.4888085, 0.52514096, 0.703604, 0.14197118, 0.08584995,
                0.34441713, 0.56593886, 0.44932321
            ],
            [
                0.19173315, 0.07816565, 0.54254976, 0.71321382, 0.4862424, 0.0525712, 0.96248486,
                0.69026706, 0.28793439, 0.8519083
            ],
            [
                0.55267819, 0.07016035, 0.82135327, 0.62920417, 0.90577848, 0.93476227, 0.09443506,
                0.23280993, 0.65946395, 0.8947401
            ],
            [
                0.03987844, 0.38589397, 0.77658385, 0.48183946, 0.94045248, 0.11011575, 0.7308709,
                0.8328545, 0.29012534, 0.4569207
            ],
            [
                0.95294057, 0.53584658, 0.96874585, 0.44720848, 0.18282856, 0.76909697, 0.83869766,
                0.21557524, 0.94424678, 0.50224615
            ],
            [
                0.21579172, 0.9772731, 0.47108477, 0.99656238, 0.36141592, 0.70015163, 0.57343286,
                0.61278396, 0.27807142, 0.6407772
            ],
            [
                0.3605408, 0.72915195, 0.5104628, 0.59073767, 0.57172958, 0.29667477, 0.92121492,
                0.96673279, 0.47047686, 0.71601816
            ],
            [
                0.49495855, 0.27396586, 0.04238893, 0.39995442, 0.99121827, 0.70719117, 0.23122132,
                0.10337279, 0.33192209, 0.27677528
            ],
            [
                0.20377244, 0.39588143, 0.3832173, 0.26080993, 0.48032829, 0.35350803, 0.63328423,
                0.41102257, 0.2293425, 0.63983893
            ]
        ],
        [
            [
                0.36017429, 0.31631762, 0.87004618, 0.81253463, 0.99689518, 0.85961168, 0.02886825,
                0.38305257, 0.84223387, 0.60516263
            ],
            [
                0.97340894, 0.10386568, 0.4452185, 0.90387198, 0.88147925, 0.34565841, 0.64309967,
                0.70366823, 0.48822479, 0.92969259
            ],
            [
                0.14900696, 0.21402212, 0.07800543, 0.8195282, 0.2418856, 0.92642604, 0.3954864,
                0.71764105, 0.42897722, 0.88512615
            ],
            [
                0.24837622, 0.69469835, 0.35201788, 0.51265218, 0.49553608, 0.64307177, 0.49957811,
                0.13845452, 0.97655587, 0.64713535
            ],
            [
                0.58985621, 0.89900349, 0.1745854, 0.56799881, 0.05189181, 0.50658251, 0.95331388,
                0.85233842, 0.3375075, 0.71849818
            ],
            [
                0.19160785, 0.40986851, 0.47525636, 0.98820222, 0.55776209, 0.06246058, 0.32884196,
                0.8833122, 0.68437329, 0.27290355
            ],
            [
                0.06917533, 0.41777326, 0.98954149, 0.71397652, 0.11441412, 0.14224136, 0.08854763,
                0.01855595, 0.16720486, 0.38319587
            ],
            [
                0.26728697, 0.67903226, 0.89380722, 0.46833661, 0.93492688, 0.28192635, 0.43289438,
                0.51265391, 0.06127732, 0.04873959
            ],
            [
                0.35348675, 0.602, 0.18075775, 0.37063052, 0.54883824, 0.2624883, 0.74253211,
                0.17598269, 0.67435937, 0.98693223
            ],
            [
                0.76296625, 0.86821306, 0.97871967, 0.79895421, 0.71905491, 0.34765513, 0.34274808,
                0.06045034, 0.55789277, 0.2188389
            ],
            [
                0.69243168, 0.67510863, 0.58568427, 0.44401752, 0.36082301, 0.11797102, 0.93539648,
                0.28468878, 0.2590096, 0.63195637
            ],
            [
                0.90917851, 0.90224167, 0.04924011, 0.50701512, 0.02703854, 0.30561776, 0.73674763,
                0.96492469, 0.79624586, 0.12578371
            ],
            [
                0.96801484, 0.9006433, 0.89867176, 0.86861896, 0.86013336, 0.94210516, 0.05097519,
                0.59848206, 0.24334698, 0.66163847
            ],
            [
                0.28245237, 0.42253863, 0.61110426, 0.66795813, 0.90247559, 0.77630934, 0.86239354,
                0.44741335, 0.76970787, 0.4141578
            ],
            [
                0.15038555, 0.29719462, 0.74430689, 0.93509568, 0.33021633, 0.38336865, 0.07322941,
                0.27946881, 0.81592788, 0.7104612
            ]
        ]
    ];

    let kernel33: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.86655818, 0.3410254, 0.47991778, 0.08560265, 0.46590055, 0.98023208, 0.69151705,
            0.67219725, 0.65587144, 0.35742824, 0.55302912, 0.13388659, 0.39207275, 0.69832446,
            0.45037648, 0.85303368, 0.73046063, 0.88312191, 0.42087104, 0.99207644, 0.56391527,
            0.11062973, 0.02463103, 0.3228065, 0.51250188, 0.53152923, 0.81715684, 0.93765805,
            0.1897166, 0.84002591, 0.02744765, 0.01530014, 0.83162772, 0.17871671, 0.66763209,
            0.15356175, 0.60207121, 0.89934647, 0.69237571, 0.21459883, 0.99070403, 0.87442643,
            0.85760948, 0.76907682, 0.18077046, 0.64172531, 0.31536198, 0.5064835, 0.87420401,
            0.01077096, 0.77707546, 0.48142319, 0.06813734, 0.01058917,
        ],
    )
    .unwrap();
    let conv_layer33 = ConvolutionLayer::new(kernel33, 1, Padding::Valid);
    let target_output33 = array![
        [
            [
                6.80792687, 6.71608369, 7.16645597, 8.27646441, 7.8590219, 7.49821672, 7.56605689,
                7.87763736
            ],
            [
                5.70036516, 6.42788029, 6.5802983, 8.04224827, 6.81646498, 6.51169865, 7.98058861,
                7.88443146
            ],
            [
                5.35035295, 7.16228486, 7.20486669, 7.27114282, 6.2453503, 6.67943692, 8.05864901,
                7.88071551
            ],
            [
                7.11608421, 8.46248959, 7.15410058, 6.69877877, 5.75552343, 5.95920291, 6.86352599,
                7.09045555
            ],
            [
                7.11587408, 8.64092356, 7.04968081, 7.1486165, 4.74130715, 4.68298239, 5.83130984,
                7.78694252
            ],
            [
                6.85009567, 7.54712235, 7.52389522, 6.58557673, 5.34506703, 5.54635604, 5.33259176,
                6.81215023
            ],
            [
                7.36227345, 7.06094247, 8.69545436, 6.58651762, 6.82449569, 4.94529733, 5.69901444,
                7.72771559
            ],
            [
                7.73538454, 8.20735034, 8.32188114, 6.89820374, 7.73938929, 6.00561726, 6.32780494,
                6.95400421
            ],
            [
                9.31924375, 8.57746973, 8.88928536, 7.51506412, 7.52045263, 5.93853346, 7.25335672,
                6.55213603
            ],
            [
                8.97094114, 8.62814462, 7.95965827, 5.74467672, 7.57169774, 7.48103668, 7.81194755,
                6.43005971
            ],
            [
                9.02190811, 9.83519867, 8.09305033, 7.95642006, 8.32587597, 8.02253048, 7.15057257,
                7.9250818
            ],
            [
                7.56910978, 9.55506497, 9.56086654, 9.30882705, 8.75963415, 7.58167745, 6.84166336,
                7.00191435
            ],
            [
                7.66098703, 7.90856191, 8.96974379, 9.00955966, 8.29207538, 7.01752804, 7.27759766,
                7.12134193
            ]
        ],
        [
            [
                6.0664811, 5.49215048, 6.89815359, 7.12936627, 7.70925647, 6.50341843, 6.70187598,
                6.61408016
            ],
            [
                5.9507462, 5.20383128, 6.50015476, 7.61668269, 6.75282613, 5.61102554, 6.62308782,
                7.64975912
            ],
            [
                5.96783114, 5.91965964, 7.5628926, 6.75166693, 5.8754719, 6.09615099, 7.54663197,
                6.59209343
            ],
            [
                7.44760615, 7.71380842, 6.87556537, 6.73613779, 5.98859987, 4.91756367, 5.34824226,
                6.05446366
            ],
            [
                6.1705712, 7.43205266, 6.06911218, 6.99336023, 4.96665895, 4.64335865, 5.29959689,
                6.9033961
            ],
            [
                5.67292967, 6.77889587, 7.00166068, 6.83202482, 4.54556959, 5.39563458, 6.07885208,
                6.66744313
            ],
            [
                6.10370838, 6.64022135, 8.16528842, 6.309631, 6.38306987, 5.11721937, 4.54005262,
                5.85702555
            ],
            [
                6.48526727, 8.08249839, 8.2146271, 7.68723234, 7.43746138, 5.74389106, 5.79648552,
                6.57537034
            ],
            [
                8.33826277, 7.60432124, 8.55868941, 7.09051913, 6.29584848, 6.85640668, 7.03389668,
                6.53002735
            ],
            [
                8.63911213, 8.51726378, 8.76945266, 5.51155255, 6.78011851, 7.13380285, 7.12266631,
                6.38607823
            ],
            [
                8.71052094, 8.72851477, 7.89400089, 8.15568631, 7.99504985, 6.95837429, 7.75765586,
                6.76605212
            ],
            [
                6.94401666, 8.11584654, 7.49753331, 8.02397771, 8.24558773, 7.63321981, 7.40109358,
                7.10984086
            ],
            [
                7.01207884, 7.12522389, 8.00084275, 8.67689872, 7.96903866, 5.98017544, 6.08777885,
                6.4849009
            ]
        ]
    ];
    let current_output33 = conv_layer33.convolve(&test_input33);

    assert!(
        arr_allclose(&current_output33, &target_output33),
        "{:?} was not equal to {:?}",
        current_output33,
        target_output33
    );

    let test_input34 = array![
        [
            [
                0.54235333, 0.14190415, 0.59148337, 0.11199604, 0.22239626, 0.49535274, 0.10202583,
                0.53307658, 0.19252869, 0.14314991
            ],
            [
                0.71126364, 0.7039669, 0.75033962, 0.61614864, 0.59018909, 0.37142364, 0.9428474,
                0.42536419, 0.71461617, 0.97302119
            ],
            [
                0.61613714, 0.50159, 0.23079262, 0.49251168, 0.20337714, 0.46196784, 0.80737148,
                0.50388184, 0.09893909, 0.90349659
            ],
            [
                0.01722594, 0.57845507, 0.11725764, 0.80738875, 0.50780315, 0.00467546, 0.40760242,
                0.13988449, 0.84533263, 0.83071573
            ],
            [
                0.60654117, 0.18171401, 0.31007424, 0.20362667, 0.9031745, 0.55766591, 0.53338896,
                0.96843016, 0.83987904, 0.53675128
            ],
            [
                0.26183346, 0.36609648, 0.76783566, 0.10468024, 0.40905062, 0.64648789, 0.05843278,
                0.69702778, 0.09784848, 0.65296593
            ],
            [
                0.95939058, 0.51967519, 0.6337845, 0.61443019, 0.35837705, 0.23309404, 0.34644812,
                0.50217426, 0.00554681, 0.2207341
            ],
            [
                0.98550952, 0.35234871, 0.0597226, 0.1404125, 0.74202918, 0.36001204, 0.39828563,
                0.86437463, 0.34967113, 0.80019287
            ],
            [
                0.96180466, 0.50686453, 0.55900903, 0.2582814, 0.21612453, 0.80801025, 0.20993725,
                0.00845493, 0.81394259, 0.03389508
            ],
            [
                0.13004215, 0.27251563, 0.55013979, 0.11797722, 0.34076832, 0.98185355, 0.27791748,
                0.02695821, 0.48075755, 0.94135732
            ],
            [
                0.9598438, 0.47197653, 0.31927554, 0.79388622, 0.96639477, 0.41221554, 0.04869543,
                0.95668298, 0.02038087, 0.10196105
            ],
            [
                0.14647066, 0.95831466, 0.57293056, 0.24979123, 0.91831289, 0.45220875, 0.80443255,
                0.42501828, 0.08402323, 0.57557299
            ],
            [
                0.84704402, 0.24117837, 0.92321747, 0.53527257, 0.66831507, 0.84581493, 0.02265424,
                0.47793465, 0.14415831, 0.23037144
            ],
            [
                0.9375789, 0.71464308, 0.85458619, 0.1224625, 0.47318511, 0.33050995, 0.01891187,
                0.53442718, 0.063399, 0.0778811
            ],
            [
                0.87603626, 0.13885641, 0.95378457, 0.09553351, 0.60492355, 0.23765404, 0.79063565,
                0.38434003, 0.711263, 0.62435876
            ]
        ],
        [
            [
                0.97475392, 0.90132593, 0.51946688, 0.32003467, 0.97291627, 0.54243551, 0.25952704,
                0.26822981, 0.09730921, 0.94600351
            ],
            [
                0.97858765, 0.73717363, 0.9941749, 0.35973564, 0.06196258, 0.79140057, 0.43666556,
                0.78015715, 0.33209484, 0.68557511
            ],
            [
                0.67111015, 0.74436352, 0.04572792, 0.61319175, 0.781168, 0.01862379, 0.71486742,
                0.85626405, 0.05245275, 0.31138107
            ],
            [
                0.5932752, 0.26923983, 0.40164034, 0.6793183, 0.94015468, 0.84130347, 0.4710771,
                0.40220328, 0.42742897, 0.04634837
            ],
            [
                0.97791479, 0.93737433, 0.40953961, 0.38996139, 0.95724048, 0.65770666, 0.94846253,
                0.66096356, 0.40466376, 0.55692621
            ],
            [
                0.24014333, 0.66722493, 0.71030917, 0.23255507, 0.59137548, 0.59517514, 0.51399223,
                0.50475239, 0.35103089, 0.44575031
            ],
            [
                0.07333596, 0.25790987, 0.69324831, 0.86792451, 0.59633007, 0.65488359, 0.87685893,
                0.967748, 0.48245647, 0.93746062
            ],
            [
                0.38765016, 0.86497679, 0.40005399, 0.32328949, 0.0151671, 0.32235638, 0.73056589,
                0.90270169, 0.75469949, 0.25439821
            ],
            [
                0.34620104, 0.61523259, 0.21047816, 0.15493484, 0.50386606, 0.83888204, 0.58702784,
                0.90907092, 0.25651567, 0.30576277
            ],
            [
                0.608248, 0.19374174, 0.49685606, 0.73022862, 0.72125803, 0.15272116, 0.75870737,
                0.39229695, 0.76108715, 0.30246892
            ],
            [
                0.8383011, 0.94492614, 0.39669688, 0.17953912, 0.48956135, 0.17531991, 0.81426052,
                0.51194492, 0.00589341, 0.48561459
            ],
            [
                0.2117447, 0.91854632, 0.19675551, 0.60150461, 0.25964327, 0.09959481, 0.44542108,
                0.61946218, 0.52933582, 0.08988074
            ],
            [
                0.91947679, 0.97676102, 0.58543872, 0.08310746, 0.78695294, 0.11308007, 0.66036183,
                0.58312228, 0.03236333, 0.23011816
            ],
            [
                0.1625122, 0.6463952, 0.92134734, 0.66150453, 0.48125225, 0.32576006, 0.8601632,
                0.52160712, 0.19041518, 0.15599572
            ],
            [
                0.96685738, 0.52926343, 0.6078623, 0.84033139, 0.03379478, 0.31380126, 0.92111637,
                0.75843325, 0.61748166, 0.20176977
            ]
        ],
        [
            [
                0.52494562, 0.29823582, 0.74204314, 0.50086904, 0.86974588, 0.10466194, 0.62879491,
                0.50847601, 0.31764306, 0.6540288
            ],
            [
                0.32067546, 0.90192675, 0.78996001, 0.96392444, 0.83785075, 0.07532935, 0.02624486,
                0.85766182, 0.80531437, 0.69086133
            ],
            [
                0.12122969, 0.73831213, 0.19533794, 0.44526327, 0.70581635, 0.90610073, 0.50324622,
                0.24466414, 0.11470018, 0.82471947
            ],
            [
                0.70548972, 0.62891106, 0.69518119, 0.71761442, 0.35663, 0.34600323, 0.98480686,
                0.55816801, 0.45769088, 0.39555076
            ],
            [
                0.34863748, 0.01817268, 0.55591142, 0.26285828, 0.52430856, 0.75144028, 0.69645764,
                0.17514281, 0.13681252, 0.5836484
            ],
            [
                0.45519071, 0.40931306, 0.87999191, 0.38094539, 0.66255471, 0.5136288, 0.38453336,
                0.06902273, 0.99617131, 0.25736929
            ],
            [
                0.80891676, 0.98334417, 0.76697878, 0.25625055, 0.83091686, 0.26520997, 0.56456918,
                0.96909704, 0.05388465, 0.75877589
            ],
            [
                0.70755854, 0.36315935, 0.3090082, 0.77128536, 0.34408022, 0.1375511, 0.77667642,
                0.44541779, 0.35844142, 0.72871477
            ],
            [
                0.94261591, 0.12266664, 0.16580609, 0.20253018, 0.91294247, 0.7180022, 0.52850523,
                0.63151247, 0.02755868, 0.37300143
            ],
            [
                0.16874252, 0.22429509, 0.46965293, 0.38946074, 0.86716635, 0.02051389, 0.23504322,
                0.15247433, 0.22628488, 0.01136111
            ],
            [
                0.9723616, 0.21735137, 0.05186762, 0.60369669, 0.47275548, 0.84556717, 0.87818436,
                0.7431968, 0.47047342, 0.29723151
            ],
            [
                0.82616457, 0.98925644, 0.33214344, 0.26777977, 0.38164377, 0.91934493, 0.30965452,
                0.89371026, 0.81631795, 0.91843095
            ],
            [
                0.49461111, 0.99350736, 0.3386878, 0.6829108, 0.42882872, 0.07337866, 0.69046313,
                0.33399306, 0.31139955, 0.81936631
            ],
            [
                0.11950397, 0.54896967, 0.52128466, 0.7931158, 0.47184321, 0.43639142, 0.02397078,
                0.40344155, 0.02668436, 0.43387359
            ],
            [
                0.79717972, 0.32682722, 0.27223235, 0.12087691, 0.13423896, 0.70387655, 0.65776236,
                0.28824069, 0.1864088, 0.02156927
            ]
        ]
    ];

    let kernel34: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.06738148, 0.77916008, 0.88344799, 0.60268074, 0.01179794, 0.12387725, 0.46311813,
            0.46811356, 0.89907563, 0.04377226, 0.68663127, 0.37557426, 0.75357486, 0.70261325,
            0.92889114, 0.62274988, 0.35601365, 0.92466225, 0.50555759, 0.17169783, 0.71210674,
            0.82739329, 0.98956198, 0.29525921, 0.66260466, 0.2390027, 0.91088001, 0.33523661,
            0.27851092, 0.06657688, 0.08151705, 0.26757732, 0.15366211, 0.03297786, 0.63432918,
            0.023332, 0.66929566, 0.62879649, 0.49621491, 0.99435533, 0.72387776, 0.20677378,
            0.75690122, 0.53394879, 0.67676961, 0.50705937, 0.53013745, 0.978318, 0.97695178,
            0.56790004, 0.65994953, 0.9804811, 0.21515913, 0.16005383, 0.97906449, 0.64356047,
            0.71404478, 0.53114695, 0.20520075, 0.11903285, 0.82264978, 0.66615477, 0.59036101,
            0.55879021, 0.13425252, 0.88734705, 0.79260269, 0.72369506, 0.30410502, 0.32775852,
            0.22591083, 0.155887, 0.10934413, 0.10509957, 0.7603229, 0.89821458, 0.76115642,
            0.28218989, 0.89117837, 0.86186355, 0.06532436, 0.09919641, 0.25238919, 0.45873184,
            0.15706603, 0.22805685, 0.52463993, 0.07968733, 0.62342599, 0.15461008, 0.6347591,
            0.79421137, 0.23308377, 0.81622063, 0.05023352, 0.69891017, 0.99714526, 0.82807125,
            0.71163655, 0.94353932, 0.07549326, 0.5503317, 0.1015854, 0.29225165, 0.22622024,
            0.19784369, 0.28902138, 0.31431349, 0.43542771, 0.55940776, 0.59032554, 0.70255852,
            0.22009771, 0.4153414, 0.81658323, 0.59705653, 0.15500914, 0.1372336, 0.63884591,
            0.66343134, 0.12374776, 0.63807168, 0.90013693, 0.13750617, 0.22986316, 0.01747457,
            0.03202334, 0.0677837, 0.76665682, 0.01797699, 0.42640673, 0.50409789, 0.79320408,
            0.67032087, 0.81783639, 0.7051767, 0.30578546, 0.88166083, 0.40878415, 0.95622933,
            0.07542202, 0.2906491, 0.01938523, 0.82015864, 0.14548538, 0.26892264, 0.53650107,
            0.31143917, 0.64217326, 0.87461048,
        ],
    )
    .unwrap();
    let conv_layer34 = ConvolutionLayer::new(kernel34, 1, Padding::Valid);
    let target_output34 = array![
        [
            [
                21.19671305,
                20.89459553,
                21.49392512,
                20.49774153,
                18.43066999,
                19.00609181
            ],
            [
                20.49116319,
                20.36002587,
                20.44344557,
                20.40530851,
                20.24386949,
                19.91196156
            ],
            [
                20.04040967,
                20.35506587,
                20.87943067,
                22.19920093,
                21.32234328,
                19.29310854
            ],
            [
                20.22205043,
                18.46719259,
                19.74699829,
                19.90580027,
                20.14309478,
                20.88347273
            ],
            [
                18.71402444,
                18.57305596,
                19.21137455,
                21.03583523,
                20.47193643,
                18.89077461
            ],
            [
                18.55505786,
                18.45143451,
                18.5656688,
                19.58778559,
                19.11614159,
                17.84210056
            ],
            [
                19.32360412,
                17.98370457,
                17.97942884,
                19.43635412,
                18.50765489,
                17.69646465
            ],
            [
                17.76047926,
                17.74182357,
                18.39862231,
                18.42716438,
                19.26355751,
                19.05217741
            ],
            [
                18.53224775,
                18.50201665,
                18.41704816,
                19.81283239,
                18.73774985,
                15.58680965
            ],
            [
                20.81963037,
                18.79888037,
                18.36051428,
                19.31586308,
                17.63399022,
                15.64523505
            ],
            [
                21.84807519,
                19.69462574,
                18.99651445,
                18.16777014,
                17.72538671,
                16.51416424
            ]
        ],
        [
            [
                18.94852466,
                16.89808101,
                18.99029307,
                19.18364651,
                16.99672153,
                17.85083001
            ],
            [
                18.38805012,
                17.57824019,
                18.40867735,
                17.91872595,
                18.15201204,
                18.21900503
            ],
            [
                18.21028732,
                17.34419544,
                18.02495604,
                18.79705997,
                17.50364838,
                17.97299161
            ],
            [
                19.03188718,
                17.88363875,
                16.8639355,
                17.75337403,
                18.89482213,
                17.95523148
            ],
            [
                17.17293709,
                15.67643097,
                16.69676646,
                18.2059107,
                18.04526913,
                18.48024726
            ],
            [
                16.51043849,
                16.03269674,
                16.89796216,
                16.04950038,
                15.77548407,
                16.6374237
            ],
            [
                16.39222131,
                15.64503083,
                15.76332223,
                18.02770387,
                16.80860964,
                16.4176336
            ],
            [
                17.32849087,
                16.34491228,
                15.57890637,
                16.7370527,
                17.7177592,
                17.39306218
            ],
            [
                17.29483283,
                16.3034895,
                17.42178419,
                16.17133022,
                16.25713953,
                17.3477206
            ],
            [
                19.87527558,
                18.01834442,
                16.73661319,
                16.25173881,
                14.2262799,
                14.39763633
            ],
            [
                18.70621562,
                17.02791823,
                16.19321627,
                15.70249354,
                16.57620523,
                13.58970157
            ]
        ]
    ];
    let current_output34 = conv_layer34.convolve(&test_input34);

    assert!(
        arr_allclose(&current_output34, &target_output34),
        "{:?} was not equal to {:?}",
        current_output34,
        target_output34
    );

    let test_input35 = array![
        [
            [
                0.26655029, 0.29389631, 0.29072547, 0.04191615, 0.52809088, 0.34129519, 0.57593832,
                0.2514082, 0.18509477, 0.13568091
            ],
            [
                0.72699776, 0.53098687, 0.61979239, 0.82326292, 0.34076487, 0.80249839, 0.94153974,
                0.13301279, 0.29802052, 0.20752071
            ],
            [
                0.78595556, 0.87364229, 0.11152316, 0.56348731, 0.89489484, 0.14866899, 0.17686241,
                0.24096294, 0.84956124, 0.92154114
            ],
            [
                0.11643393, 0.71275232, 0.99616133, 0.81890575, 0.15552202, 0.30162073, 0.61146616,
                0.9041999, 0.91215477, 0.41252124
            ],
            [
                0.62377742, 0.62711568, 0.83928456, 0.23060308, 0.61116033, 0.39940433, 0.76753354,
                0.55483019, 0.04038839, 0.41155178
            ],
            [
                0.26794126, 0.17735237, 0.47061966, 0.68002754, 0.17411814, 0.98491503, 0.63610964,
                0.51622941, 0.16118859, 0.27965236
            ],
            [
                0.45113099, 0.99642358, 0.48360799, 0.65542875, 0.92131654, 0.62419057, 0.28075696,
                0.95138586, 0.03742034, 0.24292202
            ],
            [
                0.51126131, 0.09925622, 0.37388383, 0.35010349, 0.68311297, 0.00036895, 0.31636,
                0.52583048, 0.20907213, 0.31935102
            ],
            [
                0.46920265, 0.95483211, 0.22725932, 0.72710159, 0.98386079, 0.7348552, 0.95043266,
                0.1939531, 0.84957522, 0.84936814
            ],
            [
                0.31214204, 0.020407, 0.29198913, 0.54702243, 0.71877408, 0.96964847, 0.8560521,
                0.4610603, 0.36576655, 0.02449073
            ],
            [
                0.59270258, 0.54024611, 0.12048424, 0.54154531, 0.6322593, 0.55719324, 0.08840237,
                0.49039193, 0.6217684, 0.24218308
            ],
            [
                0.66323826, 0.88165093, 0.15960338, 0.60938352, 0.73912698, 0.31076493, 0.66177236,
                0.79462648, 0.35911654, 0.69393592
            ],
            [
                0.15214977, 0.18737185, 0.74053661, 0.71913954, 0.43812937, 0.69571447, 0.99523758,
                0.16850757, 0.73456472, 0.40491071
            ],
            [
                0.4767252, 0.66379927, 0.42989763, 0.32726992, 0.71961334, 0.96709276, 0.5945655,
                0.12965601, 0.52551712, 0.92811964
            ],
            [
                0.86373016, 0.77084631, 0.89374338, 0.25468575, 0.34347492, 0.53033798, 0.61999765,
                0.01742517, 0.47107298, 0.07118031
            ]
        ],
        [
            [
                0.82373565, 0.30740639, 0.22278657, 0.35444142, 0.62276681, 0.07482269, 0.63522647,
                0.93379417, 0.60845979, 0.81633986
            ],
            [
                0.79382941, 0.97634182, 0.19588221, 0.05417962, 0.22490515, 0.86761757, 0.42271057,
                0.01450239, 0.1089614, 0.44084754
            ],
            [
                0.29699827, 0.1825079, 0.10165259, 0.79023945, 0.32732127, 0.72059694, 0.36138167,
                0.5398071, 0.45151471, 0.32281689
            ],
            [
                0.02498931, 0.38320435, 0.10025226, 0.44458553, 0.58076191, 0.84052525, 0.77579256,
                0.5885413, 0.70433699, 0.49857915
            ],
            [
                0.58095854, 0.61327245, 0.8303008, 0.5893513, 0.2488159, 0.11897707, 0.31943668,
                0.40964801, 0.71880088, 0.6754611
            ],
            [
                0.53823624, 0.6197911, 0.87098824, 0.23997463, 0.42630667, 0.023685, 0.66366728,
                0.48614911, 0.13860539, 0.00709001
            ],
            [
                0.78944407, 0.85572855, 0.39250163, 0.00926249, 0.26704809, 0.62992356, 0.63806643,
                0.15112722, 0.12904108, 0.96106272
            ],
            [
                0.71219521, 0.45871279, 0.44769825, 0.90325622, 0.37947366, 0.80309021, 0.03485033,
                0.46171709, 0.64797223, 0.53539134
            ],
            [
                0.27882159, 0.2423434, 0.58643429, 0.67460908, 0.4692506, 0.07147343, 0.76442557,
                0.85664367, 0.29966144, 0.05329819
            ],
            [
                0.60962341, 0.92857024, 0.32679624, 0.39032642, 0.64249887, 0.96716244, 0.897583,
                0.24524814, 0.52139105, 0.32803341
            ],
            [
                0.51819417, 0.51220167, 0.18159197, 0.86656647, 0.97853778, 0.7287427, 0.77866222,
                0.29876544, 0.75457318, 0.20196797
            ],
            [
                0.17440334, 0.39972378, 0.90310672, 0.0279216, 0.07560093, 0.4063533, 0.89307876,
                0.26793156, 0.54531776, 0.7670494
            ],
            [
                0.24446123, 0.56554091, 0.85527597, 0.46456698, 0.67473855, 0.25479088, 0.75530261,
                0.47348525, 0.4810381, 0.01440958
            ],
            [
                0.89691706, 0.37802501, 0.4112019, 0.35186991, 0.38309375, 0.97874444, 0.25838066,
                0.16904165, 0.53067167, 0.42017522
            ],
            [
                0.45530656, 0.4978779, 0.14543204, 0.55258467, 0.94792101, 0.23003382, 0.71651061,
                0.79403926, 0.11938072, 0.26642636
            ]
        ],
        [
            [
                0.28121006, 0.40319065, 0.21566778, 0.59493501, 0.99950364, 0.95387172, 0.32445627,
                0.82740845, 0.7941346, 0.7832342
            ],
            [
                0.24875637, 0.3654985, 0.91466755, 0.2876998, 0.34424197, 0.24573819, 0.84973081,
                0.12739219, 0.45345631, 0.32884086
            ],
            [
                0.86961945, 0.86532808, 0.30172202, 0.12142149, 0.16754848, 0.48512898, 0.34082386,
                0.52981262, 0.01440341, 0.9658324
            ],
            [
                0.74842569, 0.31247431, 0.60567857, 0.2570787, 0.05135555, 0.06775604, 0.75543489,
                0.43739402, 0.71699253, 0.77542008
            ],
            [
                0.35906683, 0.54546532, 0.18900541, 0.16549692, 0.99599045, 0.15867555, 0.56480473,
                0.16849967, 0.05252765, 0.56760148
            ],
            [
                0.61594402, 0.53880623, 0.0603164, 0.32445189, 0.2310866, 0.17943049, 0.30550994,
                0.78047165, 0.24022589, 0.99179139
            ],
            [
                0.71554165, 0.08051511, 0.64055591, 0.49451136, 0.41497941, 0.72737785, 0.72403002,
                0.04702903, 0.40806047, 0.15293901
            ],
            [
                0.44103094, 0.22449211, 0.68232305, 0.18933063, 0.83893034, 0.15520982, 0.21666723,
                0.45026394, 0.99160832, 0.29856463
            ],
            [
                0.2287987, 0.12699115, 0.45396761, 0.72245786, 0.72674458, 0.03087187, 0.67366552,
                0.89165211, 0.22144382, 0.51589164
            ],
            [
                0.20851571, 0.39927887, 0.95807106, 0.2943695, 0.90529515, 0.79524361, 0.26358748,
                0.4270144, 0.49643677, 0.52485584
            ],
            [
                0.10436007, 0.95743341, 0.12942687, 0.22447351, 0.00970959, 0.6722845, 0.55595505,
                0.96391112, 0.07906571, 0.66087625
            ],
            [
                0.51526877, 0.00945449, 0.92360486, 0.57159379, 0.54495326, 0.61592543, 0.14274224,
                0.01026518, 0.46913605, 0.17376864
            ],
            [
                0.38009069, 0.26423023, 0.57912685, 0.73671803, 0.7878329, 0.96754213, 0.39445185,
                0.3428721, 0.06958814, 0.56590062
            ],
            [
                0.71229554, 0.69547217, 0.97742863, 0.87228008, 0.38645523, 0.05056721, 0.28056801,
                0.7337121, 0.79937049, 0.97495489
            ],
            [
                0.49178642, 0.62299961, 0.46538924, 0.79535008, 0.74067035, 0.51276685, 0.31285285,
                0.44514382, 0.53394766, 0.60886297
            ]
        ]
    ];

    let kernel35: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.61271988, 0.52722879, 0.84627388, 0.45846484, 0.24009439, 0.81341506, 0.82088939,
            0.19391126, 0.60945815, 0.15300871, 0.32021995, 0.07215097, 0.20116507, 0.1060043,
            0.0768621, 0.95817911, 0.3644227, 0.0401813, 0.96085127, 0.14144829, 0.98016811,
            0.0866156, 0.38643878, 0.67231378, 0.39703202, 0.63766024, 0.51491323, 0.45527728,
            0.81632676, 0.83262923, 0.14867568, 0.54233809, 0.11626041, 0.16734742, 0.63693319,
            0.80877446, 0.43495061, 0.79464135, 0.95939173, 0.02565966, 0.72012891, 0.83819449,
            0.56197967, 0.82884103, 0.56961156, 0.23243731, 0.20690504, 0.41845899, 0.57740441,
            0.74138161, 0.92387773, 0.99671417, 0.16546801, 0.34192114, 0.56454203, 0.47811388,
            0.70454847, 0.83806275, 0.59271626, 0.80685817, 0.15508978, 0.32704812, 0.96608514,
            0.09722981, 0.87349369, 0.42030758, 0.78284553, 0.51113233, 0.89623898, 0.07851031,
            0.95514954, 0.86893994, 0.58276262, 0.73308328, 0.09790236, 0.57685302, 0.10275049,
            0.19355602, 0.35040325, 0.08234657, 0.23035104, 0.39562112, 0.98580118, 0.00720319,
            0.10750511, 0.82838977, 0.7547516, 0.64581351, 0.80422682, 0.51176087, 0.95054453,
            0.3185606, 0.47440121, 0.12880406, 0.68080261, 0.92859271, 0.76108785, 0.7972437,
            0.5635491, 0.34609278, 0.09857575, 0.86302017, 0.07187212, 0.45164116, 0.81366645,
            0.28062829, 0.35418032, 0.96403877, 0.14712231, 0.55479336, 0.38209473, 0.05219934,
            0.51350849, 0.54439926, 0.81959425, 0.2628233, 0.18509601, 0.44840698, 0.89940333,
            0.09299238, 0.01609867, 0.81923143, 0.68313035, 0.8294056, 0.50219776, 0.58972345,
            0.83670457, 0.19925202, 0.01926605, 0.41107583, 0.91340118, 0.17121982, 0.68620998,
            0.54784408, 0.87786778, 0.88160743, 0.80690433, 0.2866232, 0.53889499, 0.91212026,
            0.08099908, 0.14064423, 0.34871952, 0.00895003, 0.09498501, 0.2603031, 0.08369987,
            0.24505354, 0.71820231, 0.7560407,
        ],
    )
    .unwrap();
    let conv_layer35 = ConvolutionLayer::new(kernel35, 1, Padding::Valid);
    let target_output35 = array![
        [
            [
                16.95403395,
                17.04451342,
                18.00741679,
                19.019506,
                19.49319764,
                19.93590952
            ],
            [
                17.88347098,
                18.22933911,
                18.55354272,
                17.69004021,
                15.00752479,
                17.17764582
            ],
            [
                19.27126796,
                17.33530562,
                18.05739671,
                17.05512276,
                16.77232505,
                19.14386956
            ],
            [
                18.51768609,
                17.82846406,
                18.65293238,
                18.17634135,
                17.63187378,
                18.05883647
            ],
            [
                18.79408128,
                18.55088988,
                17.29714401,
                18.88028612,
                17.31516202,
                17.01088665
            ],
            [
                20.71572679,
                19.41309572,
                20.42098214,
                20.83286632,
                19.37476867,
                18.3539877
            ],
            [
                20.40244692,
                21.41512141,
                20.45933105,
                20.85071885,
                21.60394834,
                18.97109655
            ],
            [
                19.36346895,
                19.45323231,
                20.04956746,
                21.96649639,
                20.5518727,
                18.07362682
            ],
            [
                19.50619504,
                20.26805428,
                21.88729005,
                22.99606297,
                22.64194166,
                20.56744515
            ],
            [
                20.11196992,
                22.80330735,
                22.82529848,
                20.5385675,
                20.42296048,
                19.26927815
            ],
            [
                20.09855351,
                21.25144304,
                21.0271737,
                20.87403876,
                19.12729598,
                18.78535832
            ]
        ],
        [
            [
                16.55182957,
                16.1522976,
                17.72723303,
                15.91719744,
                17.21503914,
                16.36325545
            ],
            [
                18.26187421,
                15.27877715,
                17.1375546,
                15.68018145,
                15.69099931,
                17.29768933
            ],
            [
                18.18215755,
                17.00982208,
                14.70756495,
                15.34446948,
                16.02295375,
                17.16596012
            ],
            [
                16.55140622,
                16.62504094,
                16.86505151,
                16.13156705,
                16.34325986,
                16.01798534
            ],
            [
                18.08541465,
                16.77098201,
                18.50871884,
                17.40775459,
                15.48142909,
                15.50154089
            ],
            [
                18.22322905,
                18.343427,
                18.61304307,
                19.0490253,
                16.86739411,
                16.4659376
            ],
            [
                18.46800814,
                19.01947048,
                19.68555738,
                20.1167983,
                18.96153123,
                17.804373
            ],
            [
                17.34583447,
                18.29821371,
                19.7351693,
                18.64311774,
                18.98667098,
                15.62854207
            ],
            [
                17.95453428,
                19.95476333,
                22.23900475,
                19.66764343,
                20.01269386,
                18.08523092
            ],
            [
                18.52040058,
                19.928032,
                19.42919196,
                19.8656246,
                18.62681202,
                17.54390464
            ],
            [
                17.67502314,
                18.73749104,
                20.03513174,
                17.72962671,
                17.12464646,
                18.45406785
            ]
        ]
    ];
    let current_output35 = conv_layer35.convolve(&test_input35);

    assert!(
        arr_allclose(&current_output35, &target_output35),
        "{:?} was not equal to {:?}",
        current_output35,
        target_output35
    );

    let test_input36 = array![
        [
            [
                0.55048226, 0.76262215, 0.02017781, 0.20396212, 0.2315043, 0.28059694, 0.0384257,
                0.92572651, 0.85304476, 0.92270759
            ],
            [
                0.61218124, 0.01549418, 0.58469681, 0.95146344, 0.28302717, 0.21812608, 0.21556447,
                0.97975387, 0.96327586, 0.27143422
            ],
            [
                0.66015848, 0.32269348, 0.19323848, 0.047074, 0.06797581, 0.90267074, 0.74642358,
                0.43391777, 0.46971908, 0.36561351
            ],
            [
                0.76844286, 0.7132774, 0.68262099, 0.38312289, 0.18582676, 0.94923413, 0.61902883,
                0.49807011, 0.70999422, 0.46828214
            ],
            [
                0.44120147, 0.87946804, 0.24645624, 0.0769704, 0.53293884, 0.80550374, 0.34428265,
                0.17744416, 0.11456152, 0.35435796
            ],
            [
                0.61676294, 0.2724277, 0.28065883, 0.55199182, 0.70613555, 0.06217905, 0.18036312,
                0.65311458, 0.67581988, 0.03111337
            ],
            [
                0.11921299, 0.76781567, 0.89182181, 0.74734408, 0.55322683, 0.6964844, 0.10984504,
                0.59089476, 0.6066833, 0.27276049
            ],
            [
                0.1006932, 0.04537489, 0.47227802, 0.50795033, 0.96480779, 0.85706862, 0.72912632,
                0.53507909, 0.00238096, 0.11027454
            ],
            [
                0.1789127, 0.59824154, 0.1731958, 0.37650405, 0.59797183, 0.40831715, 0.54864365,
                0.02069527, 0.65538532, 0.80163413
            ],
            [
                0.81776086, 0.79711788, 0.08406905, 0.50802597, 0.11442149, 0.04620427, 0.34978441,
                0.45462497, 0.07369657, 0.52332806
            ],
            [
                0.74098633, 0.4604948, 0.33960004, 0.93051933, 0.71563728, 0.79997257, 0.00534251,
                0.83967542, 0.91428852, 0.62511096
            ],
            [
                0.60291023, 0.6333335, 0.77002693, 0.23793669, 0.82069023, 0.33741378, 0.26670293,
                0.08686233, 0.1029643, 0.40082249
            ],
            [
                0.95465164, 0.81819686, 0.66963007, 0.73063439, 0.0549346, 0.8426447, 0.96914834,
                0.6678507, 0.57052804, 0.34104946
            ],
            [
                0.28146711, 0.61166998, 0.41391013, 0.12344587, 0.62523547, 0.94266544, 0.5703369,
                0.21797805, 0.88097751, 0.29241283
            ],
            [
                0.02982224, 0.44230436, 0.11709308, 0.10283989, 0.4274258, 0.66300993, 0.11320372,
                0.08474967, 0.84980601, 0.8935719
            ]
        ],
        [
            [
                0.0988896, 0.36921417, 0.69639486, 0.37377915, 0.91501776, 0.77607257, 0.41136658,
                0.19929982, 0.435523, 0.24557048
            ],
            [
                0.02676343, 0.47552215, 0.5351139, 0.36544808, 0.68463501, 0.02301173, 0.92400077,
                0.80055226, 0.76702583, 0.04667937
            ],
            [
                0.30812186, 0.90651703, 0.89449199, 0.15186749, 0.71019569, 0.18382857, 0.54372056,
                0.21931883, 0.41600464, 0.89717296
            ],
            [
                0.93577815, 0.16475675, 0.05393951, 0.25017266, 0.58476522, 0.40716596, 0.27133583,
                0.13783294, 0.41899429, 0.54188859
            ],
            [
                0.56188396, 0.02054715, 0.14384301, 0.83838864, 0.32704464, 0.3063715, 0.46858207,
                0.60181303, 0.59114001, 0.77906116
            ],
            [
                0.94683791, 0.01428977, 0.00778698, 0.08802161, 0.79319471, 0.47630212, 0.68084379,
                0.64131043, 0.88006237, 0.33597425
            ],
            [
                0.25126496, 0.11956753, 0.54221573, 0.1025933, 0.29599847, 0.34388151, 0.60961519,
                0.74966765, 0.03922288, 0.22169069
            ],
            [
                0.54000635, 0.77202866, 0.08456346, 0.09107142, 0.49166625, 0.69694859, 0.30650784,
                0.33481097, 0.68851917, 0.9201642
            ],
            [
                0.78163998, 0.56275489, 0.51618158, 0.85731034, 0.47906099, 0.70012182, 0.8242743,
                0.43211794, 0.86505033, 0.69807686
            ],
            [
                0.70200929, 0.64812482, 0.72819445, 0.01313858, 0.71393589, 0.00338423, 0.37015088,
                0.6825711, 0.29473899, 0.34203872
            ],
            [
                0.64924839, 0.78417208, 0.35578284, 0.92984385, 0.50673162, 0.1436599, 0.80710122,
                0.30427325, 0.8632821, 0.44121639
            ],
            [
                0.98984245, 0.13985265, 0.50355775, 0.71038558, 0.75199635, 0.20438518, 0.302565,
                0.32253315, 0.24522461, 0.38874564
            ],
            [
                0.01596426, 0.03268935, 0.51990713, 0.97307511, 0.25791696, 0.72531515, 0.8901288,
                0.3369298, 0.77066147, 0.58939577
            ],
            [
                0.24533354, 0.45030525, 0.09461671, 0.65658491, 0.66725406, 0.36014386, 0.16459827,
                0.72068753, 0.66180914, 0.19687269
            ],
            [
                0.2568436, 0.69032482, 0.47962426, 0.33293529, 0.31321532, 0.61263672, 0.15715665,
                0.04113929, 0.31686948, 0.54813901
            ]
        ],
        [
            [
                0.36342481, 0.69651571, 0.1327469, 0.86270794, 0.05492407, 0.68144649, 0.07444459,
                0.60906745, 0.34991544, 0.75244364
            ],
            [
                0.68665997, 0.62334859, 0.71658511, 0.58597032, 0.33453105, 0.1716157, 0.87333373,
                0.38515111, 0.89840884, 0.89716263
            ],
            [
                0.99445567, 0.42958102, 0.41707778, 0.42941825, 0.21114524, 0.38053169, 0.98692306,
                0.64791367, 0.03177308, 0.02432681
            ],
            [
                0.47288648, 0.46218839, 0.04056123, 0.5441924, 0.44094404, 0.70403798, 0.49946983,
                0.75838682, 0.94878401, 0.28150013
            ],
            [
                0.16930467, 0.36957731, 0.44379707, 0.28551422, 0.48172624, 0.26814867, 0.08870029,
                0.52649629, 0.54202284, 0.23198477
            ],
            [
                0.8001697, 0.39779025, 0.09425906, 0.92948606, 0.59009778, 0.30325877, 0.80255471,
                0.73011105, 0.66947609, 0.11015231
            ],
            [
                0.69373706, 0.23382042, 0.69890019, 0.24523091, 0.33235383, 0.44655515, 0.6824109,
                0.4055674, 0.5139047, 0.16944606
            ],
            [
                0.38137078, 0.3950377, 0.99505395, 0.49050682, 0.12798251, 0.55041501, 0.0107817,
                0.98041151, 0.01554713, 0.5638509
            ],
            [
                0.73606554, 0.02244601, 0.71388938, 0.88223379, 0.41637896, 0.52044709, 0.31435137,
                0.76214775, 0.59803587, 0.92255374
            ],
            [
                0.43390043, 0.18671373, 0.14004933, 0.37515614, 0.11509855, 0.58042267, 0.11006288,
                0.05430869, 0.71332922, 0.24697433
            ],
            [
                0.58181111, 0.88183055, 0.24270806, 0.16793567, 0.7600932, 0.50921425, 0.2787269,
                0.93662101, 0.55376449, 0.31955512
            ],
            [
                0.93811636, 0.80770214, 0.10565319, 0.67167309, 0.76066049, 0.09583076, 0.96722346,
                0.60165137, 0.71505777, 0.65955433
            ],
            [
                0.76611408, 0.71538682, 0.2819424, 0.6738613, 0.53042462, 0.13520858, 0.74697116,
                0.81467754, 0.30610739, 0.35754029
            ],
            [
                0.47058627, 0.36717632, 0.23220701, 0.26958194, 0.28030816, 0.18757097, 0.30671574,
                0.60501655, 0.75661963, 0.4542289
            ],
            [
                0.99071409, 0.03288648, 0.00421954, 0.63708898, 0.22448166, 0.2107704, 0.80958195,
                0.32154063, 0.77653179, 0.01871248
            ]
        ]
    ];

    let kernel36: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.21038549, 0.69589033, 0.09593545, 0.66940916, 0.43917, 0.33296861, 0.05693591,
            0.85656829, 0.80481585, 0.08220443, 0.2345118, 0.00728971, 0.06604451, 0.29232718,
            0.94244685, 0.1988695, 0.04567454, 0.62376173, 0.87467634, 0.81214133, 0.95465118,
            0.11050353, 0.13355136, 0.54039594, 0.74180703, 0.82956315, 0.68993077, 0.67526815,
            0.23764269, 0.51197405, 0.01912449, 0.69419598, 0.02211638, 0.28069869, 0.34628264,
            0.69162671, 0.94890168, 0.23571671, 0.92047055, 0.25998821, 0.4514327, 0.40940228,
            0.23183365, 0.840219, 0.84424554, 0.55466418, 0.07813972, 0.30506895, 0.24986074,
            0.49582243, 0.74963318, 0.99110266, 0.41972713, 0.18811015, 0.63797465, 0.70726824,
            0.30395796, 0.94166275, 0.76690634, 0.01694399, 0.10002703, 0.1212473, 0.56443172,
            0.79829948, 0.18014309, 0.21136971, 0.58878514, 0.58043234, 0.12894546, 0.07064668,
            0.51929955, 0.10532968, 0.45790268, 0.52164696, 0.15657824, 0.54787721, 0.40889722,
            0.57086658, 0.30341496, 0.15041436, 0.89146511, 0.55224741, 0.0050115, 0.9402614,
            0.24152992, 0.71857251, 0.00863769, 0.2743094, 0.63410505, 0.08953476, 0.57364606,
            0.16664151, 0.68964959, 0.41619235, 0.27443435, 0.65122761, 0.6696046, 0.593486,
            0.52092884, 0.90686868, 0.55810462, 0.50247654, 0.43946477, 0.25550802, 0.96864546,
            0.1257116, 0.0815046, 0.18553228, 0.21831155, 0.9865399, 0.90522244, 0.60721526,
            0.55744987, 0.9146937, 0.2556481, 0.55767896, 0.29845987, 0.04779868, 0.76187396,
            0.96774947, 0.12630945, 0.38485697, 0.44111733, 0.89598168, 0.1071836, 0.09080196,
            0.90344327, 0.7528657, 0.63789234, 0.37240831, 0.46620197, 0.5063144, 0.96460904,
            0.84366781, 0.63907084, 0.20822853, 0.61905735, 0.94941134, 0.04169853, 0.86925044,
            0.11364791, 0.76029861, 0.67724939, 0.43775169, 0.99396146, 0.7541355, 0.61089563,
            0.60583272, 0.81967237, 0.18524589,
        ],
    )
    .unwrap();
    let conv_layer36 = ConvolutionLayer::new(kernel36, 1, Padding::Valid);
    let target_output36 = array![
        [
            [
                13.88203448,
                14.17477523,
                15.98463646,
                15.74229996,
                16.3798901,
                16.71398536
            ],
            [
                16.42057958,
                14.58315792,
                14.51829386,
                14.99780685,
                17.68379478,
                15.8036344
            ],
            [
                14.4698654,
                13.95161984,
                15.33790859,
                15.07017415,
                15.70281292,
                15.15515377
            ],
            [
                14.93260729,
                15.71744501,
                15.76751396,
                15.43951554,
                17.23161385,
                15.98851673
            ],
            [
                15.15859678,
                14.90468021,
                15.14718085,
                17.19432439,
                16.4949409,
                15.89542322
            ],
            [
                14.86597568,
                14.82772414,
                14.28859604,
                15.77071197,
                16.16361695,
                15.73933716
            ],
            [
                16.06887019,
                15.05021956,
                14.68954904,
                15.03775987,
                15.41100936,
                15.84878813
            ],
            [
                18.43888404,
                16.28898301,
                16.01192009,
                15.41755269,
                15.74034527,
                14.52577541
            ],
            [
                18.65339693,
                16.77475906,
                17.29752377,
                17.03077104,
                16.7062632,
                16.1644308
            ],
            [
                17.84053383,
                16.21705072,
                16.06567158,
                16.28273166,
                17.03182633,
                16.47664633
            ],
            [
                16.81197227,
                16.62034702,
                14.86724933,
                16.15414257,
                17.11415972,
                16.47186062
            ]
        ],
        [
            [
                17.07637931,
                15.79777549,
                17.60086851,
                17.26460812,
                18.94410158,
                18.6522698
            ],
            [
                17.15764933,
                16.02681373,
                16.84951649,
                18.46649529,
                21.18773683,
                19.9480576
            ],
            [
                15.33277209,
                16.11801672,
                17.27559065,
                17.53179755,
                19.06990992,
                17.72697288
            ],
            [
                18.53793025,
                17.8146774,
                17.04942961,
                17.50731606,
                19.69416938,
                17.30852504
            ],
            [
                18.50644696,
                17.87823736,
                18.51444891,
                19.87031742,
                19.7250739,
                19.14089369
            ],
            [
                17.28367213,
                16.97147402,
                18.24531059,
                17.93325005,
                18.03699818,
                17.16562775
            ],
            [
                18.95081404,
                18.4747244,
                17.68166187,
                17.82145857,
                18.28245007,
                18.94840021
            ],
            [
                19.81224963,
                18.65711309,
                17.49679274,
                19.74402751,
                18.91069382,
                17.81153058
            ],
            [
                20.5925484,
                18.17869063,
                18.68157207,
                19.307233,
                18.49301937,
                19.49951101
            ],
            [
                20.1879946,
                18.55829131,
                17.51534244,
                17.51646056,
                20.59799716,
                18.03201712
            ],
            [
                20.01011597,
                19.23377012,
                17.1853259,
                19.87866298,
                20.36670646,
                18.92120415
            ]
        ]
    ];
    let current_output36 = conv_layer36.convolve(&test_input36);

    assert!(
        arr_allclose(&current_output36, &target_output36),
        "{:?} was not equal to {:?}",
        current_output36,
        target_output36
    );
}

// This file has been automatically generated by Jinja2 via the
// script generate_tests.py.
// Please do not change this file by hand.
use ml::convolutions::*;
use ml::transposed_convolutions::*;
use ndarray::{array, Array, Array3, Array4, Dimension};

fn arr_allclose<D: Dimension>(arr1: &Array<f32, D>, arr2: &Array<f32, D>) -> bool {
    (arr1 - arr2).map(|x| (*x as f32).abs()).sum() < 1e-3
}

#[test]
fn test_py_implementation_random_arrays_conv2d_transpose() {
    let test_input1 = array![[
        [0.25940374, 0.74904203, 0.26350108, 0.99580127, 0.41392356],
        [0.7190492, 0.5932102, 0.36214927, 0.7134346, 0.04343178],
        [0.01264012, 0.30633783, 0.7311494, 0.06306978, 0.63444036],
        [0.04783731, 0.13794519, 0.38289404, 0.72769856, 0.43036366],
        [0.43202257, 0.6176036, 0.55465347, 0.26971525, 0.37383646]
    ]];

    let kernel1: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.5103922, 0.9900095, 0.45440432, 0.5617109, 0.93941313, 0.03544521, 0.83329135,
            0.06244482, 0.5651197, 0.60774666, 0.5688352, 0.7743095, 0.51972485, 0.54574215,
            0.69407845, 0.38157287, 0.7421376, 0.48221946, 0.3769874, 0.38870603, 0.6971712,
            0.35903165, 0.8724074, 0.26511827, 0.19452758, 0.39895928, 0.7607782,
        ],
    )
    .unwrap();
    let conv_layer1 = TransposedConvolutionLayer::new(kernel1, 1, Padding::Same);
    let target_output1: Array3<f32> = array![
        [
            [1.6919137, 2.0979552, 2.3420343, 2.0863981, 1.0699228],
            [1.7757831, 1.8093607, 2.6668458, 2.0766175, 1.0716968],
            [0.7074727, 1.9171232, 2.142115, 1.9301609, 1.8527803],
            [0.87904716, 1.8518884, 2.2802896, 2.6417913, 0.94259953],
            [1.0816596, 1.3621867, 1.2488322, 1.0958444, 0.7945203]
        ],
        [
            [1.3018783, 1.5539566, 2.1143012, 1.5098306, 1.259717],
            [1.6826365, 2.5207794, 2.8940792, 2.5189009, 1.6744595],
            [1.2482569, 1.9540049, 2.445969, 2.4272273, 1.2685652],
            [0.9504279, 1.9363627, 2.1171553, 2.3927214, 1.5428929],
            [0.7271027, 1.3884704, 1.8102105, 1.7944291, 1.0538007]
        ],
        [
            [0.9992571, 1.3487676, 1.4301661, 1.4777321, 0.9127703],
            [1.5688951, 1.9128785, 2.5097558, 1.9408659, 1.4298971],
            [0.8034836, 1.7164629, 2.2679305, 1.5862633, 1.4290043],
            [0.7002134, 1.403708, 1.5637598, 2.315834, 1.0686445],
            [0.7258199, 1.2666665, 1.5489107, 1.386159, 1.1014576]
        ]
    ];
    let current_output1: Array3<f32> = conv_layer1.transposed_convolve(&test_input1);

    assert!(
        arr_allclose(&current_output1, &target_output1),
        "{:?} was not equal to {:?}",
        current_output1,
        target_output1
    );

    let test_input2 = array![[
        [0.8649758, 0.2564574, 0.93321526, 0.784176, 0.86321056],
        [0.9557799, 0.7198472, 0.54026544, 0.15434536, 0.09155878],
        [0.715203, 0.502141, 0.49909648, 0.6098034, 0.9002247],
        [0.95214695, 0.250633, 0.793483, 0.31241128, 0.16839387],
        [0.8495973, 0.77755684, 0.67304164, 0.62291604, 0.5917267]
    ]];

    let kernel2: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.5918919, 0.67114294, 0.49211782, 0.545842, 0.86454815, 0.7031715, 0.05703689,
            0.7596735, 0.9509948, 0.70248216, 0.53076035, 0.6234512, 0.21467632, 0.8135725,
            0.51520824, 0.8860448, 0.2597569, 0.77339244, 0.7110755, 0.73335916, 0.26292253,
            0.26781648, 0.7166568, 0.34538904, 0.97129184, 0.6837008, 0.3037366,
        ],
    )
    .unwrap();
    let conv_layer2 = TransposedConvolutionLayer::new(kernel2, 1, Padding::Same);
    let target_output2: Array3<f32> = array![
        [
            [1.8677092, 2.272356, 1.9552408, 2.1354904, 1.4007847],
            [2.7314725, 3.783485, 3.0655348, 3.363167, 2.075303],
            [2.649732, 3.6541724, 2.9949732, 2.4933686, 1.5624377],
            [2.6653857, 3.622655, 2.995078, 3.0609906, 1.9543657],
            [2.049233, 3.2415707, 2.5406804, 2.5041125, 1.4003003]
        ],
        [
            [1.5507011, 2.3095684, 2.1042883, 1.9147032, 1.0623919],
            [2.2714763, 3.5956848, 2.856928, 3.1839538, 1.899361],
            [2.17007, 3.7609582, 2.403323, 2.546429, 1.3703008],
            [2.3178139, 3.3878903, 3.1731722, 2.956826, 1.8325334],
            [1.7507167, 2.5707207, 1.877583, 1.8752955, 0.97159374]
        ],
        [
            [1.5758054, 2.9648561, 2.3728428, 2.4642653, 1.3292029],
            [2.1276574, 3.346273, 2.6539388, 2.6166046, 1.5408607],
            [1.8334042, 3.4520078, 2.27212, 2.6540341, 1.4891201],
            [2.025652, 3.446433, 2.8327813, 2.7301018, 1.5939312],
            [1.5738561, 2.2160854, 1.9031041, 1.7337122, 1.0030053]
        ]
    ];
    let current_output2: Array3<f32> = conv_layer2.transposed_convolve(&test_input2);

    assert!(
        arr_allclose(&current_output2, &target_output2),
        "{:?} was not equal to {:?}",
        current_output2,
        target_output2
    );

    let test_input3 = array![[
        [0.00554333, 0.00499232, 0.56012625, 0.04692093, 0.95133615],
        [0.4318458, 0.58763003, 0.0488642, 0.02556094, 0.17130233],
        [0.1298894, 0.5945981, 0.00256654, 0.8014985, 0.8908257],
        [0.2149228, 0.42144233, 0.49002212, 0.61149436, 0.47333992],
        [0.30657023, 0.46667865, 0.9132112, 0.40754157, 0.6353514]
    ]];

    let kernel3: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.5068442, 0.6828541, 0.12924373, 0.7795671, 0.07048018, 0.35233787, 0.85458857,
            0.8050948, 0.8008906, 0.90569776, 0.79006946, 0.6227516, 0.5276461, 0.7193077,
            0.04703298, 0.05200182, 0.5620368, 0.4826988, 0.14007695, 0.99515516, 0.92304647,
            0.1113743, 0.1785365, 0.89363664, 0.762922, 0.53197616, 0.24232654,
        ],
    )
    .unwrap();
    let conv_layer3 = TransposedConvolutionLayer::new(kernel3, 1, Padding::Same);
    let target_output3: Array3<f32> = array![
        [
            [0.63828945, 1.2392133, 0.62876743, 1.2523943, 0.26021188],
            [0.8369266, 1.0768836, 1.6177849, 1.8247274, 1.7848325],
            [1.0244339, 1.4680324, 2.5694404, 1.8725187, 1.6804719],
            [0.9010699, 1.9398631, 2.689388, 2.5805721, 2.3250358],
            [0.47047478, 1.2872517, 1.3075897, 1.8668804, 1.0294049]
        ],
        [
            [0.7680086, 0.8260189, 0.5222711, 1.2713602, 0.802391],
            [1.38533, 1.3785527, 1.2017771, 2.2760754, 0.71669817],
            [1.4445653, 1.4466097, 2.1054394, 2.190086, 1.3931993],
            [1.4483907, 1.9926311, 2.7339628, 2.520896, 1.4693735],
            [0.8617892, 1.6582162, 1.8484426, 1.8684447, 1.0034968]
        ],
        [
            [0.13636777, 0.963009, 0.606691, 1.3172, 0.23338872],
            [0.76920104, 1.0717776, 1.4580249, 1.47283, 1.6163964],
            [1.6262017, 1.132237, 1.7858045, 1.7320325, 1.2639395],
            [1.2222027, 1.656209, 2.3212514, 3.211141, 1.7817918],
            [1.1002254, 2.036205, 1.9213367, 2.292955, 0.90141106]
        ]
    ];
    let current_output3: Array3<f32> = conv_layer3.transposed_convolve(&test_input3);

    assert!(
        arr_allclose(&current_output3, &target_output3),
        "{:?} was not equal to {:?}",
        current_output3,
        target_output3
    );

    let test_input4 = array![[
        [0.9236824, 0.53568405, 0.99749255, 0.00387712, 0.27529702],
        [0.75773144, 0.68179756, 0.28086394, 0.14250895, 0.6985803],
        [0.00022103, 0.21589486, 0.17350982, 0.5402848, 0.9610416],
        [0.96504945, 0.0072373, 0.43020758, 0.8641754, 0.04885763],
        [0.94388, 0.6947651, 0.87142104, 0.6279961, 0.5023904]
    ]];

    let kernel4: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.7267018, 0.44753027, 0.65127283, 0.07885906, 0.75618976, 0.8271783, 0.5556593,
            0.93769234, 0.99851006, 0.558877, 0.5732958, 0.8117039, 0.4081002, 0.08493485,
            0.25913426, 0.6035262, 0.00626469, 0.8618429, 0.84487355, 0.59569603, 0.15069862,
            0.7081842, 0.4961406, 0.5828361, 0.02291553, 0.34156242, 0.64322954, 0.79177326,
            0.7627587, 0.09121816, 0.9557012, 0.40404552, 0.5220448, 0.5380306, 0.81690544,
            0.17207691, 0.42866695, 0.44563663, 0.4212565, 0.92375, 0.10720393, 0.26198116,
            0.6762277, 0.2696179, 0.21424311, 0.24767296, 0.40937588, 0.6868491, 0.37738028,
            0.08832248,
        ],
    )
    .unwrap();
    let conv_layer4 = TransposedConvolutionLayer::new(kernel4, 1, Padding::Same);
    let target_output4: Array3<f32> = array![
        [
            [2.9532976, 3.3906088, 4.0457497, 3.6155767, 2.2806082],
            [2.8931377, 5.193557, 4.787429, 4.646844, 2.6760287],
            [5.104823, 5.624966, 6.917931, 5.626601, 2.5319571],
            [3.242053, 4.2631764, 5.373402, 3.9474375, 2.9185991],
            [1.9792473, 4.1984115, 5.0128813, 3.0983918, 2.7384765]
        ],
        [
            [2.527651, 2.4706075, 3.6749935, 2.9674625, 1.5284705],
            [2.8730054, 3.4112918, 4.983357, 2.7043226, 1.9261857],
            [4.3496723, 5.12766, 5.802079, 3.6260486, 2.4877992],
            [3.5514526, 4.496833, 4.6758337, 3.387041, 2.9549062],
            [2.4042628, 3.4444125, 4.0172496, 3.4580653, 2.6818566]
        ]
    ];
    let current_output4: Array3<f32> = conv_layer4.transposed_convolve(&test_input4);

    assert!(
        arr_allclose(&current_output4, &target_output4),
        "{:?} was not equal to {:?}",
        current_output4,
        target_output4
    );

    let test_input5 = array![[
        [0.38654813, 0.82660556, 0.44084537, 0.07873131, 0.3027444],
        [0.2361903, 0.6197949, 0.0840907, 0.7234279, 0.5826194],
        [0.07743666, 0.7313229, 0.84478533, 0.15313673, 0.47405228],
        [0.4023571, 0.14101507, 0.92657286, 0.7040261, 0.4448773],
        [0.959898, 0.8641298, 0.55008173, 0.01467922, 0.02434788]
    ]];

    let kernel5: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.19218098, 0.2328489, 0.01929748, 0.8556409, 0.30623958, 0.32625732, 0.86521465,
            0.5052504, 0.8344676, 0.6601774, 0.7815407, 0.73509836, 0.4915577, 0.8464923,
            0.77338034, 0.57997584, 0.5407852, 0.2808581, 0.8482609, 0.22946075, 0.2641176,
            0.49239954, 0.40529284, 0.85380274, 0.16085505, 0.817841, 0.5260993, 0.7829005,
            0.39820364, 0.39185107, 0.521695, 0.07266373, 0.8044589, 0.6743304, 0.37191734,
            0.8807143, 0.08070045, 0.5458987, 0.05057609, 0.30998018, 0.2878109, 0.64759284,
            0.44109604, 0.87691706, 0.61349726, 0.10794181, 0.8929152, 0.58464706, 0.19428867,
            0.8452976,
        ],
    )
    .unwrap();
    let conv_layer5 = TransposedConvolutionLayer::new(kernel5, 1, Padding::Same);
    let target_output5: Array3<f32> = array![
        [
            [1.807091, 2.4852078, 3.1719215, 2.9944944, 1.8929374],
            [3.2499835, 4.017511, 4.941913, 4.9334593, 3.0710964],
            [3.963986, 5.9695363, 6.2391295, 5.082034, 3.4569972],
            [3.8845122, 4.629048, 5.221368, 4.5723863, 2.9712164],
            [2.9715378, 3.9968019, 4.2055287, 3.1406746, 2.5415785]
        ],
        [
            [2.470089, 2.860042, 3.5402057, 2.3771086, 1.6010919],
            [3.1354203, 3.3362336, 4.994024, 4.399308, 2.44252],
            [4.631623, 4.550261, 5.430194, 4.0872855, 3.4194367],
            [2.6582983, 3.6773963, 5.2873173, 4.5908837, 2.615666],
            [2.7612538, 3.262673, 3.1928186, 3.3112128, 2.116256]
        ]
    ];
    let current_output5: Array3<f32> = conv_layer5.transposed_convolve(&test_input5);

    assert!(
        arr_allclose(&current_output5, &target_output5),
        "{:?} was not equal to {:?}",
        current_output5,
        target_output5
    );

    let test_input6 = array![[
        [0.01543552, 0.14992481, 0.8171646, 0.6993185, 0.48973525],
        [0.09253296, 0.8918541, 0.33026117, 0.29813164, 0.2654364],
        [0.74838346, 0.10143464, 0.52032983, 0.56595635, 0.00287411],
        [0.2319383, 0.1188672, 0.6686508, 0.6501629, 0.09753594],
        [0.9598696, 0.1739428, 0.42068344, 0.3657551, 0.6347181]
    ]];

    let kernel6: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.0686802, 0.7894763, 0.54168904, 0.42295521, 0.9833499, 0.7196943, 0.9904965,
            0.7802309, 0.14502142, 0.7380395, 0.182635, 0.5330444, 0.05136959, 0.6681512,
            0.7563066, 0.75689566, 0.16207212, 0.86851645, 0.42064583, 0.55643153, 0.0252467,
            0.38962096, 0.7402797, 0.14667274, 0.8468133, 0.44718665, 0.597974, 0.3172121,
            0.7996001, 0.4073442, 0.45675537, 0.6777762, 0.9860008, 0.41964784, 0.9333005,
            0.6303612, 0.10027983, 0.8226135, 0.42008114, 0.2791868, 0.1241539, 0.12511984,
            0.6916787, 0.5186713, 0.8839261, 0.40952045, 0.5541298, 0.5439763, 0.91586626,
            0.56177837,
        ],
    )
    .unwrap();
    let conv_layer6 = TransposedConvolutionLayer::new(kernel6, 1, Padding::Same);
    let target_output6: Array3<f32> = array![
        [
            [1.9992732, 3.0887053, 2.454239, 2.5634081, 1.9979738],
            [2.3411953, 2.9270024, 3.9971154, 3.1998916, 2.081081],
            [2.7548153, 5.952014, 5.31568, 3.9820082, 3.500844],
            [3.270711, 3.9954927, 4.2480187, 3.7105274, 2.5888112],
            [2.020457, 3.3515942, 3.6830044, 2.5609853, 1.8561347]
        ],
        [
            [1.9817495, 2.3123012, 3.0928152, 2.9144576, 1.8631755],
            [2.7375064, 3.685729, 4.1739783, 3.0470831, 2.6965358],
            [3.411312, 4.66375, 5.5493555, 4.4918356, 3.538861],
            [2.7515469, 3.6272523, 5.1690187, 3.4997046, 2.5306656],
            [2.292085, 3.714525, 3.641022, 2.7596412, 2.7879188]
        ]
    ];
    let current_output6: Array3<f32> = conv_layer6.transposed_convolve(&test_input6);

    assert!(
        arr_allclose(&current_output6, &target_output6),
        "{:?} was not equal to {:?}",
        current_output6,
        target_output6
    );

    let test_input7 = array![[
        [
            0.5731157, 0.4358579, 0.27137834, 0.14918056, 0.31802374, 0.9757422, 0.2949725,
            0.4348753, 0.70853275, 0.7454982, 0.37029198, 0.29680613, 0.28866816, 0.9553692,
            0.95149356
        ],
        [
            0.2957575, 0.8888738, 0.2809244, 0.7104525, 0.37157902, 0.7104041, 0.19740541,
            0.09638681, 0.764724, 0.14113663, 0.9950774, 0.15779655, 0.83081424, 0.44410533,
            0.21194516
        ],
        [
            0.6029492, 0.3542944, 0.14831908, 0.20181699, 0.6767633, 0.949059, 0.13985753,
            0.06974182, 0.7253144, 0.9221244, 0.58538145, 0.49827084, 0.6502392, 0.35552603,
            0.6363158
        ],
        [
            0.34873846, 0.01343687, 0.34505466, 0.99399126, 0.37026688, 0.42950714, 0.36143672,
            0.13509372, 0.5956826, 0.401238, 0.10019378, 0.0810014, 0.87241244, 0.76771957,
            0.6475736
        ],
        [
            0.6556159, 0.69015765, 0.6500668, 0.5184107, 0.4006459, 0.90588063, 0.59132546,
            0.66226816, 0.16276368, 0.42727843, 0.9701243, 0.13313925, 0.6289585, 0.1889332,
            0.5428112
        ],
        [
            0.5622292, 0.91382736, 0.6736868, 0.4860561, 0.8699086, 0.73475546, 0.4251425,
            0.99310255, 0.467236, 0.10087194, 0.5142749, 0.6864343, 0.15279303, 0.7372749,
            0.7290007
        ],
        [
            0.52728593, 0.85484004, 0.76510906, 0.4333417, 0.36226064, 0.1400462, 0.6773251,
            0.25778285, 0.6407141, 0.6912219, 0.28540164, 0.78459144, 0.8770653, 0.05653322,
            0.5717394
        ],
        [
            0.56478137, 0.3264186, 0.9881788, 0.3343419, 0.7164926, 0.8258636, 0.56437534,
            0.48411915, 0.24941035, 0.14783211, 0.89537656, 0.33705255, 0.11622208, 0.04580417,
            0.5043883
        ],
        [
            0.5470566, 0.81575096, 0.4591416, 0.42085037, 0.8666776, 0.34056735, 0.995754,
            0.16796347, 0.68238664, 0.08120212, 0.68124425, 0.7541038, 0.6113899, 0.88313174,
            0.18507351
        ],
        [
            0.27922577, 0.55814683, 0.8857682, 0.49138483, 0.16211294, 0.3554634, 0.58112353,
            0.23521906, 0.48736006, 0.58191437, 0.7681655, 0.4520079, 0.03529088, 0.3398527,
            0.6077811
        ]
    ]];

    let kernel7: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.37353724, 0.2865596, 0.21426377, 0.95074916, 0.8565049, 0.0596006, 0.45011654,
            0.97451967, 0.483654, 0.04593647, 0.09514757, 0.26731008, 0.465489, 0.29808706,
            0.65945536, 0.62595254, 0.39318037, 0.14317591, 0.4661266, 0.8079113, 0.57168907,
            0.25229013, 0.16278361, 0.6434899, 0.9026008, 0.12466568, 0.02655451,
        ],
    )
    .unwrap();
    let conv_layer7 = TransposedConvolutionLayer::new(kernel7, 1, Padding::Same);
    let target_output7: Array3<f32> = array![
        [
            [
                1.2289944, 2.09275, 1.632504, 1.4240795, 1.6358038, 2.1465838, 1.8715948,
                1.3291143, 2.067452, 2.2852116, 2.1972518, 1.6060591, 1.837072, 2.2476163,
                2.1473908
            ],
            [
                1.3411752, 2.155007, 1.945242, 1.7084719, 2.603137, 2.5614958, 2.0578902,
                1.2146577, 2.2670882, 3.0395756, 2.6390119, 2.581697, 2.333389, 2.5195718,
                1.898104
            ],
            [
                1.1626182, 1.4883953, 1.8344116, 2.0078194, 2.526141, 2.4868503, 2.0280845,
                1.1825857, 1.85291, 2.9428957, 2.0102935, 2.3002503, 2.5180562, 2.9587197,
                2.0801435
            ],
            [
                1.2955213, 1.9888489, 1.9392587, 2.4576342, 2.7028122, 2.5086155, 2.4664788,
                1.8224567, 1.6438228, 2.3259392, 2.2520845, 1.6673496, 2.1305656, 2.8308198,
                2.1138034
            ],
            [
                1.658861, 3.0332556, 2.8513498, 2.5880957, 3.0230942, 2.8668363, 2.9431615,
                2.8107162, 2.0229697, 1.6343825, 2.2936068, 2.4210713, 1.7079039, 2.5788033,
                2.0839024
            ],
            [
                1.7510002, 3.3570385, 3.364535, 2.6449652, 2.4897966, 2.5225728, 2.7833247,
                2.5484335, 2.8018415, 2.053331, 1.9040368, 2.9468224, 2.36159, 2.0831416, 2.035639
            ],
            [
                1.5847899, 2.8696916, 3.4101546, 2.7920804, 2.3572595, 2.5412033, 2.4731228,
                2.2368593, 2.0381017, 2.2276626, 2.4131274, 2.2907379, 2.3104057, 1.6252847,
                1.444989
            ],
            [
                1.6166912, 2.77637, 2.773102, 2.8587046, 2.577986, 2.9818525, 2.7530239, 2.3791466,
                1.7934495, 1.6773119, 2.4929059, 2.8192546, 2.1355877, 2.0310633, 1.1115373
            ],
            [
                1.2798811, 2.854937, 2.8741531, 2.6340773, 2.1394832, 2.566314, 2.5700536,
                2.3322983, 1.8387066, 2.310614, 2.2369044, 2.751715, 2.0553317, 2.1382947,
                1.8021815
            ],
            [
                0.6064913, 1.4155747, 1.9554802, 1.7633733, 1.0477479, 1.2817891, 1.1715983,
                1.5452622, 0.9527106, 1.6743244, 1.5960051, 1.6512824, 1.158493, 0.88763356,
                1.2899213
            ]
        ],
        [
            [
                0.39081278, 0.99287826, 0.98625505, 0.7050509, 0.8966021, 1.016307, 1.0539445,
                0.5165854, 0.8759087, 1.1261257, 0.99052596, 0.9960201, 0.7995564, 1.2253267,
                1.0359073
            ],
            [
                0.96413034, 1.3991555, 1.0821524, 0.79770166, 1.4345495, 2.0163064, 1.4601742,
                0.8508476, 1.4317092, 2.0396163, 1.6699768, 1.4714733, 1.4710968, 2.0066478,
                1.5207853
            ],
            [
                0.80903655, 1.3008015, 0.9198399, 1.4866164, 1.7223198, 1.5850524, 1.1224364,
                0.7575256, 1.2674721, 1.6485515, 1.6045781, 1.0496706, 1.6048248, 1.8238593,
                1.3148112
            ],
            [
                0.9344428, 1.295077, 1.1636181, 1.4690549, 1.8235495, 1.7677718, 1.4089382,
                1.184854, 1.51359, 1.5771134, 1.5717384, 1.4308819, 1.3449205, 1.6377031,
                1.3363461
            ],
            [
                0.7983562, 1.4846355, 1.9175682, 1.9400281, 1.6536832, 1.822762, 1.6348532,
                1.4953275, 1.7127483, 1.0233817, 0.949083, 1.4303898, 1.584609, 1.6318702,
                1.5738956
            ],
            [
                1.1560915, 2.0434444, 2.1835892, 1.7318552, 1.5472223, 1.7373832, 1.6215874,
                1.645954, 1.3470728, 1.5630307, 1.5963562, 1.4003385, 1.7719026, 1.3105341,
                1.1937236
            ],
            [
                1.1314474, 1.9490069, 1.9901063, 1.9210895, 1.7120956, 1.8302051, 1.7344215,
                1.8348705, 1.2613099, 1.0220679, 1.4933828, 1.7193855, 1.2386119, 1.2362823,
                1.0424178
            ],
            [
                1.0677625, 2.0003757, 1.94118, 1.5716329, 1.444493, 1.6536369, 1.7590412,
                1.5610104, 1.34947, 1.3474128, 1.2565811, 2.0618262, 1.6745533, 1.2253195, 1.19244
            ],
            [
                0.85600615, 1.5374969, 2.0696735, 1.7325605, 1.59672, 1.6287249, 1.5703561,
                1.4688712, 0.9513108, 1.3410922, 1.7510598, 1.6252085, 1.0148937, 0.91112745,
                1.2372248
            ],
            [
                0.71515775, 1.099451, 1.0623194, 1.0851085, 0.998176, 0.83984256, 1.0856818,
                0.78071445, 0.788885, 0.77152455, 1.1632409, 1.1983895, 0.96780044, 0.8924045,
                0.56328595
            ]
        ],
        [
            [
                0.9343728, 0.9837994, 1.4233706, 0.92105633, 1.9248189, 1.0434245, 1.2569422,
                1.2389491, 1.1175667, 1.6985276, 0.8449999, 1.652929, 1.4148884, 1.920958,
                0.7283108
            ],
            [
                1.7015091, 1.5621028, 1.4532907, 1.2361345, 2.2847097, 2.0418856, 1.5873196,
                1.8327792, 1.8199666, 2.792645, 1.9470726, 2.1439843, 2.033032, 2.4867, 1.208946
            ],
            [
                1.1771116, 1.4721062, 1.4044039, 2.009976, 2.7569811, 1.5427513, 0.9402541,
                1.7572075, 1.9063447, 2.0790617, 1.7722794, 1.79988, 1.8989674, 2.3650084,
                1.1524019
            ],
            [
                1.1452689, 1.7221178, 2.109715, 1.928961, 2.5058618, 1.9825217, 1.6521288,
                1.7882379, 2.27172, 1.8747276, 1.5102766, 2.6408186, 1.7741842, 2.2351162,
                0.92750347
            ],
            [
                1.4642051, 1.986488, 2.6226885, 2.4857647, 2.3725932, 2.336715, 2.2988238,
                1.6021724, 2.1318202, 1.8918035, 0.98094684, 1.9128761, 2.2758474, 2.09883,
                1.3983924
            ],
            [
                2.1777437, 2.6445153, 2.5158868, 2.4145906, 2.133087, 2.1811779, 2.1637702,
                2.1021063, 1.364471, 2.2097688, 2.4242146, 1.6346714, 2.178174, 2.2490354,
                0.7601639
            ],
            [
                1.9553235, 2.863877, 2.016647, 2.5968354, 2.086372, 2.4722688, 2.3102863,
                2.3092976, 1.6483793, 1.4740698, 2.008984, 2.3619862, 1.1791941, 1.8272722,
                0.75739515
            ],
            [
                1.7019204, 2.8369904, 2.2827516, 2.1873276, 1.9074814, 2.4990146, 1.8098031,
                2.1600447, 1.3963044, 2.357467, 1.6837133, 2.3643801, 1.9620337, 1.676886,
                1.3010337
            ],
            [
                1.6287603, 2.1676357, 2.3084393, 2.4759743, 2.0608807, 2.347953, 1.57921,
                1.9829211, 1.0619981, 2.207067, 2.4327781, 1.8325754, 1.5922515, 1.0913136,
                0.9260967
            ],
            [
                1.3147678, 1.6432297, 1.168476, 1.0998625, 1.1384033, 1.3589972, 1.0747718,
                1.0291172, 1.0687846, 1.2359259, 1.4344147, 1.0507284, 1.2549903, 1.2410812,
                0.28384882
            ]
        ]
    ];
    let current_output7: Array3<f32> = conv_layer7.transposed_convolve(&test_input7);

    assert!(
        arr_allclose(&current_output7, &target_output7),
        "{:?} was not equal to {:?}",
        current_output7,
        target_output7
    );

    let test_input8 = array![[
        [
            0.9284596, 0.28528848, 0.8097526, 0.8703476, 0.42747614, 0.44829038, 0.49021396,
            0.03754933, 0.62726355, 0.36184156, 0.45796338, 0.36549965, 0.43468672, 0.18711746,
            0.8575485
        ],
        [
            0.08775862, 0.8700028, 0.3350561, 0.03511939, 0.08443703, 0.7526727, 0.0415243,
            0.40281492, 0.98840946, 0.04243748, 0.93224925, 0.10394991, 0.9566907, 0.9587394,
            0.52177525
        ],
        [
            0.10306507, 0.46772015, 0.52828556, 0.14868502, 0.75478184, 0.27904746, 0.60683715,
            0.9606596, 0.10455381, 0.67872083, 0.40994582, 0.03147708, 0.69280815, 0.8058963,
            0.12709932
        ],
        [
            0.8197433, 0.25094953, 0.19762492, 0.7833775, 0.78307074, 0.88419265, 0.34068453,
            0.11876318, 0.48846716, 0.8306075, 0.7171614, 0.12185705, 0.13819899, 0.73997694,
            0.9548553
        ],
        [
            0.8364324, 0.9176259, 0.8269318, 0.36162344, 0.5895506, 0.30270007, 0.4441798,
            0.5006856, 0.17880088, 0.22710325, 0.84239835, 0.01078446, 0.4714315, 0.2118137,
            0.19729383
        ],
        [
            0.71398526, 0.67336476, 0.46796006, 0.26652488, 0.37367153, 0.63627535, 0.41612744,
            0.8174639, 0.8537443, 0.30557197, 0.6554046, 0.59044445, 0.619802, 0.80633384,
            0.2173366
        ],
        [
            0.41819713, 0.44758892, 0.13972853, 0.2029929, 0.76329404, 0.55912036, 0.8325009,
            0.80420405, 0.18225673, 0.55844724, 0.5594949, 0.5360104, 0.77069366, 0.8203787,
            0.79309344
        ],
        [
            0.8654327, 0.81233406, 0.27575302, 0.07010028, 0.78707755, 0.02696148, 0.01000071,
            0.40216273, 0.6420056, 0.0386022, 0.06343126, 0.2840916, 0.48098558, 0.2663604,
            0.29327103
        ],
        [
            0.8104509, 0.40317488, 0.781834, 0.9905377, 0.00834513, 0.48237178, 0.9144721,
            0.86097515, 0.06681772, 0.32801142, 0.15094435, 0.7286456, 0.6105742, 0.74629104,
            0.67716974
        ],
        [
            0.4740316, 0.891449, 0.7097984, 0.83073014, 0.7552507, 0.6457845, 0.01439666,
            0.33885688, 0.45331198, 0.24960479, 0.20792788, 0.93337095, 0.43428713, 0.72489494,
            0.8455219
        ]
    ]];

    let kernel8: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.26748917, 0.7591103, 0.12753572, 0.29053396, 0.62417454, 0.33590943, 0.59470975,
            0.05421542, 0.27962413, 0.19960591, 0.7157561, 0.80618435, 0.5819793, 0.86186445,
            0.81091887, 0.1092851, 0.24810465, 0.966502, 0.8655158, 0.6715648, 0.18890017,
            0.8222466, 0.01988452, 0.3881491, 0.49758735, 0.73946494, 0.32713,
        ],
    )
    .unwrap();
    let conv_layer8 = TransposedConvolutionLayer::new(kernel8, 1, Padding::Same);
    let target_output8: Array3<f32> = array![
        [
            [
                1.0542994, 1.2376783, 1.8057221, 1.1437019, 0.9010573, 0.95511353, 0.926222,
                0.93229187, 1.2063113, 1.4570172, 0.90681446, 1.4234625, 1.0294025, 1.7784035,
                1.2671697
            ],
            [
                1.2185215, 1.5993524, 1.2171524, 1.2367563, 1.452462, 1.5308071, 1.26654,
                1.9016403, 1.7215853, 1.5121329, 1.4958894, 1.586192, 2.0382211, 2.0203023,
                1.2342395
            ],
            [
                0.8651067, 1.6713482, 1.2444736, 1.3652549, 1.7550834, 1.7712051, 2.055521,
                1.352638, 1.5173558, 1.8736848, 1.38977, 1.484273, 1.8291626, 1.8457617, 1.2838694
            ],
            [
                1.2848998, 1.5896358, 1.9415355, 2.14259, 2.0004609, 1.7925149, 1.198123,
                1.4265665, 1.7426136, 1.7964865, 1.299365, 1.0636301, 1.1989324, 2.0695293,
                1.0874448
            ],
            [
                1.9135783, 2.3299828, 1.6845828, 1.5920446, 1.649495, 1.6359007, 1.7685207,
                1.3831239, 1.4302988, 2.0698016, 1.5650845, 1.3964747, 1.3774024, 1.3775274,
                1.2049679
            ],
            [
                1.5960308, 1.8779502, 1.4724816, 1.2495253, 1.5604917, 1.8955404, 2.001979,
                2.273575, 1.7187942, 1.3885564, 1.8597577, 1.8684918, 1.9814856, 1.8388449,
                1.0231806
            ],
            [
                1.3952378, 1.7180874, 1.2270175, 1.3766346, 1.4706365, 1.8722115, 1.7088872,
                1.4798061, 1.5716382, 1.6181169, 1.2846719, 1.6595083, 1.9889448, 2.0696535,
                1.081594
            ],
            [
                1.6977005, 1.8566439, 1.199234, 1.6157707, 1.6205446, 0.96423453, 1.6344008,
                2.0769475, 1.4283315, 0.59237075, 1.1036282, 1.4454592, 1.8415604, 1.7682554,
                1.3338659
            ],
            [
                1.5824008, 2.1698945, 2.5490885, 1.7335265, 1.5987214, 1.8667679, 1.7915833,
                1.0857319, 1.0704049, 0.9212454, 1.1919734, 1.6119872, 2.1372643, 1.9693849,
                1.3128809
            ],
            [
                1.2962439, 1.5826985, 1.6236758, 1.6827359, 1.3479693, 0.7359517, 0.853095,
                1.1098399, 0.7958219, 0.48633042, 1.0871991, 1.2883677, 1.3759725, 1.6256312,
                1.0032024
            ]
        ],
        [
            [
                1.2291346, 1.6386139, 1.688719, 1.3309033, 1.1084468, 1.298854, 0.74742347,
                1.0392148, 1.4366488, 1.114074, 1.314022, 1.0931025, 1.358758, 1.6495812,
                1.1939536
            ],
            [
                1.8345877, 3.181846, 2.5520422, 2.301791, 2.6806784, 2.2372732, 1.9473319,
                2.7211385, 2.120163, 2.706201, 2.223193, 2.2965026, 2.9606562, 3.2704298,
                1.7258605
            ],
            [
                1.723314, 2.1423237, 2.1174572, 1.8536519, 2.314179, 2.255717, 2.684324, 2.420827,
                2.5023584, 3.3255327, 1.9575081, 2.5581834, 3.0723782, 3.7165337, 2.2958045
            ],
            [
                2.0167222, 2.2564185, 2.4473336, 2.9428449, 2.9259088, 2.9744456, 2.52579,
                2.3619432, 2.809516, 2.652163, 2.4424176, 1.5545805, 2.2387412, 2.9952462,
                2.0264843
            ],
            [
                2.7946768, 3.3086987, 2.6326842, 2.6772106, 3.293058, 2.967781, 2.5177627,
                2.1807141, 2.2685819, 2.96883, 2.805363, 1.9980643, 1.9731815, 2.52454, 1.9266974
            ],
            [
                2.8481014, 3.6457117, 2.7808995, 2.4668, 2.493227, 2.6872818, 2.8641376, 2.9937112,
                2.2747636, 2.436993, 2.46824, 2.8450313, 2.4921503, 2.5107193, 1.3032966
            ],
            [
                2.4684443, 2.8252864, 1.8851746, 1.9536525, 2.6530879, 2.583431, 3.1323116,
                3.1467652, 2.9103541, 2.6335914, 2.4050786, 3.0326126, 3.4718776, 3.1601734,
                2.0424314
            ],
            [
                2.5794234, 2.4712737, 1.8957236, 2.2707834, 2.1903527, 2.5521247, 2.923753,
                3.0266457, 2.254453, 1.5463462, 1.9622906, 2.7640162, 3.0640152, 3.2445488,
                2.2305343
            ],
            [
                2.7975755, 3.5379379, 3.2244263, 2.723341, 1.9851831, 2.3242311, 2.0290544,
                2.1593804, 1.7970747, 1.3465676, 1.3853782, 2.4345229, 2.619969, 2.834783,
                1.8353401
            ],
            [
                2.0288541, 3.1345072, 3.249752, 2.9982738, 2.6722605, 1.8907273, 2.3170497,
                2.2559688, 1.8041773, 0.92867905, 1.9360497, 2.3958666, 2.92573, 3.0789237,
                2.1789966
            ]
        ],
        [
            [
                1.0352122, 2.2850583, 1.5503547, 1.1718462, 1.6915009, 1.3510654, 1.1237658,
                1.99185, 1.3331215, 2.1121771, 1.3997579, 2.015215, 2.0727432, 2.6170177,
                1.0615033
            ],
            [
                1.4898443, 1.7677344, 2.041426, 2.0270343, 2.004561, 1.6419792, 2.641222,
                2.1782718, 1.821553, 2.7548735, 1.186941, 2.537209, 2.3462195, 2.5711133,
                1.6189086
            ],
            [
                1.4057928, 1.6552668, 1.8429003, 2.4599042, 2.2977557, 2.7103674, 2.0248702,
                1.5846474, 2.871337, 2.4287615, 2.0350037, 1.8717263, 1.9794438, 2.9009993,
                2.2679482
            ],
            [
                1.7951596, 2.9453692, 2.551264, 2.2797847, 2.5096502, 2.221974, 2.197854,
                1.9609275, 1.731109, 2.2392404, 1.9123936, 1.738809, 1.5975708, 1.9011123,
                1.1467601
            ],
            [
                2.168344, 2.9089658, 2.1951478, 2.3066566, 2.2002282, 2.4732606, 2.3791177,
                2.326451, 2.284886, 2.5634527, 1.9670211, 2.5958054, 1.8942047, 2.1576364,
                1.3531725
            ],
            [
                1.6956619, 2.338683, 1.8889892, 2.021609, 2.248678, 2.5227666, 3.0525513, 2.503974,
                2.1361308, 2.4174287, 2.240664, 2.6676178, 2.8274312, 2.6384907, 1.8067758
            ],
            [
                2.1279192, 2.3325446, 1.6139573, 1.823163, 1.5985789, 2.0049052, 1.8638793,
                2.260011, 2.3912666, 1.449408, 1.5671844, 2.184076, 2.3160558, 2.3877928,
                1.3442253
            ],
            [
                1.824961, 2.5896957, 2.5930545, 2.2132843, 1.4711299, 2.4055176, 2.6852994,
                2.286251, 1.5426381, 1.3337761, 1.639679, 2.114927, 2.5385113, 2.781831, 1.7071502
            ],
            [
                1.9375745, 3.3660796, 3.1111176, 2.5594683, 2.983406, 1.8189787, 1.6682097,
                1.6969945, 2.0036979, 1.0050493, 1.9288163, 2.004831, 2.831009, 2.7811832,
                1.8222148
            ],
            [
                0.9988273, 1.4142348, 1.8536699, 1.6904036, 1.4813936, 0.94369686, 1.3807737,
                0.967772, 0.79675984, 0.65749747, 1.1190602, 0.9115061, 1.8019748, 1.5207038,
                1.0598242
            ]
        ]
    ];
    let current_output8: Array3<f32> = conv_layer8.transposed_convolve(&test_input8);

    assert!(
        arr_allclose(&current_output8, &target_output8),
        "{:?} was not equal to {:?}",
        current_output8,
        target_output8
    );

    let test_input9 = array![[
        [
            0.7991005, 0.6593807, 0.89889675, 0.415085, 0.12250702, 0.5887431, 0.22207342,
            0.644659, 0.30018568, 0.14373119, 0.881029, 0.30654708, 0.24862175, 0.8328672,
            0.07759443
        ],
        [
            0.56863874, 0.67665124, 0.53734404, 0.5125205, 0.02690168, 0.6468591, 0.5583812,
            0.44018087, 0.05583533, 0.51150846, 0.1448351, 0.12172047, 0.5928812, 0.53741276,
            0.8541847
        ],
        [
            0.41209605, 0.6530522, 0.8863091, 0.90247834, 0.9463149, 0.69896984, 0.31295437,
            0.23667672, 0.6887115, 0.869446, 0.6344982, 0.37257317, 0.11054891, 0.21636334,
            0.8806015
        ],
        [
            0.29575008, 0.14654574, 0.3305842, 0.46961635, 0.89210135, 0.02785723, 0.97660416,
            0.69941694, 0.08753569, 0.7994179, 0.9647323, 0.57645196, 0.49391994, 0.02444519,
            0.66453207
        ],
        [
            0.0468762, 0.5292785, 0.20487691, 0.556727, 0.12054694, 0.7478523, 0.99887234,
            0.90311056, 0.30797803, 0.7328164, 0.7494256, 0.9097717, 0.77209693, 0.58004093,
            0.6996918
        ],
        [
            0.66169816, 0.16011967, 0.13766924, 0.97415125, 0.13525665, 0.04051598, 0.6182141,
            0.15653564, 0.5276679, 0.38979906, 0.38183665, 0.17276834, 0.37312877, 0.04687037,
            0.96584445
        ],
        [
            0.9005928, 0.6869039, 0.13710514, 0.93337166, 0.8309544, 0.8096441, 0.87477946,
            0.9536765, 0.14472677, 0.94398594, 0.9016371, 0.21545039, 0.5549044, 0.00089157,
            0.10562981
        ],
        [
            0.1370874, 0.8744713, 0.90893644, 0.812321, 0.93559456, 0.2864273, 0.38456902,
            0.6178664, 0.3135867, 0.40926057, 0.6465155, 0.7637001, 0.536408, 0.2028953, 0.4870808
        ],
        [
            0.85692894, 0.34825283, 0.47515213, 0.68894154, 0.31576025, 0.1009673, 0.39385104,
            0.21859388, 0.01500413, 0.10860183, 0.31928155, 0.23404567, 0.03587083, 0.15897873,
            0.24370667
        ],
        [
            0.5871911, 0.48492464, 0.9000558, 0.18147688, 0.50668, 0.9907827, 0.98931897,
            0.5002419, 0.85909706, 0.35466766, 0.2558577, 0.33284405, 0.6385993, 0.08002022,
            0.09679864
        ]
    ]];

    let kernel9: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.15957619, 0.705643, 0.96002513, 0.6359688, 0.09242705, 0.9851187, 0.13448747,
            0.0174145, 0.26730222, 0.296218, 0.29038337, 0.9788512, 0.9218144, 0.7899881,
            0.8714042, 0.28715158, 0.84299195, 0.36335424, 0.28589743, 0.77913636, 0.71632737,
            0.16807558, 0.29890266, 0.7680724, 0.5626856, 0.9403189, 0.3813984,
        ],
    )
    .unwrap();
    let conv_layer9 = TransposedConvolutionLayer::new(kernel9, 1, Padding::Same);
    let target_output9: Array3<f32> = array![
        [
            [
                1.0087597, 1.3017119, 0.90198815, 0.5429711, 0.6232534, 0.7173583, 0.9980272,
                0.6392217, 0.31672752, 0.99612904, 0.4805725, 0.41061276, 1.0952069, 0.6938834,
                0.6371859
            ],
            [
                2.3165545, 2.789926, 2.6788776, 1.686661, 2.099446, 1.9019284, 1.6993145,
                1.3749299, 1.5883634, 1.9649085, 1.8887208, 1.5482222, 1.717514, 1.9171593,
                0.97650874
            ],
            [
                1.9201623, 2.2131248, 2.237259, 1.9264406, 2.015856, 1.7759366, 2.0901165,
                1.7399169, 1.6223233, 1.8720754, 1.5459906, 1.4264657, 1.6974496, 2.3392618,
                1.4961934
            ],
            [
                1.2779263, 2.231939, 2.5688894, 3.1139648, 2.2256618, 2.6004276, 2.1865807,
                1.8792412, 2.5950525, 3.032963, 2.4453423, 1.8639557, 1.1950907, 2.1522555,
                1.5101682
            ],
            [
                1.2562215, 0.9478846, 1.5012227, 2.2071495, 1.8031482, 2.122146, 2.807188,
                1.6191801, 2.0207846, 2.7188063, 2.7643023, 2.1626573, 1.4286453, 1.5889795,
                1.3564992
            ],
            [
                1.410808, 1.4339337, 1.9092115, 1.6514473, 1.8267677, 2.9364824, 3.0366263,
                2.597168, 1.9458132, 2.6020484, 2.7063012, 2.4705305, 2.0132344, 2.233936,
                1.0017092
            ],
            [
                1.6002464, 1.362313, 2.6221795, 2.5894673, 1.8468724, 1.7455069, 1.9197221,
                1.5262398, 1.9798111, 2.0232408, 1.4860888, 1.7158911, 0.99064755, 1.4363303,
                1.3108336
            ],
            [
                2.776924, 2.1861806, 2.3461397, 3.0574074, 2.4576755, 2.3431838, 2.7691987,
                1.7917224, 1.6885493, 2.4557505, 2.208176, 1.6438432, 0.8908009, 0.76723164,
                0.32921946
            ],
            [
                1.7503251, 2.6840966, 3.1117184, 2.5534673, 2.030958, 2.050317, 2.0832365,
                1.6384499, 1.6190369, 1.7251858, 1.9395461, 1.840613, 1.5105842, 1.150378,
                0.63168305
            ],
            [
                1.5749642, 1.7184513, 1.4422631, 1.4988188, 1.3412783, 1.3604798, 1.0865204,
                1.0047027, 0.515856, 0.6458005, 0.8329431, 0.8361869, 0.37180743, 0.486988,
                0.29291567
            ]
        ],
        [
            [
                1.5473686, 2.4017663, 2.2279549, 1.7559656, 0.9812343, 1.4022704, 1.6897991,
                1.3662925, 1.151709, 1.152888, 1.2226303, 1.38648, 1.4373457, 1.8087399, 1.7051177
            ],
            [
                2.5608032, 3.8976374, 3.8447998, 3.0406523, 2.8135297, 2.4795158, 2.712, 2.2829952,
                2.1605976, 2.7771125, 2.6458979, 1.7794181, 2.1433036, 2.5564811, 2.3719525
            ],
            [
                1.9890777, 2.7608387, 3.2144725, 3.1951675, 3.5196311, 3.1319485, 3.1730964,
                2.242996, 2.2236829, 3.1072905, 3.0631998, 2.5550575, 2.1792235, 2.400888,
                2.4372635
            ],
            [
                1.4745295, 2.6095002, 2.919832, 3.5512292, 3.4379654, 3.3367794, 3.1594822,
                3.6058767, 3.1883962, 3.6003797, 4.0076885, 3.3580468, 2.471521, 2.6829975,
                2.2031016
            ],
            [
                1.2492828, 1.4542766, 2.0321424, 3.0276856, 2.173409, 2.5461578, 3.8554244,
                3.1730552, 2.9771645, 3.352862, 3.6844735, 3.2904418, 2.6165502, 2.5999742,
                2.5334644
            ],
            [
                2.1618154, 2.3354852, 2.0425253, 2.7483819, 3.2530243, 3.2428534, 3.9155307,
                3.422598, 2.6627278, 3.5265155, 3.6562982, 3.0094585, 2.5988216, 2.2943783,
                1.7206187
            ],
            [
                2.0296664, 2.9710772, 3.4196968, 3.412476, 3.3704088, 2.9303162, 2.9769542,
                3.183274, 2.6783576, 2.6935444, 3.153811, 2.7944727, 1.8279185, 2.1063406,
                1.4501292
            ],
            [
                2.7124746, 2.8381777, 3.7158813, 4.2212243, 3.8816366, 3.2907922, 3.171462,
                2.5129573, 2.3928587, 2.7321444, 2.8119261, 2.6806664, 1.8365352, 1.2887518,
                0.91850066
            ],
            [
                2.4384508, 3.719255, 3.7966194, 3.5662587, 3.063013, 2.778162, 2.8483713,
                2.4938524, 2.1666648, 1.9439921, 2.3076649, 2.4593856, 1.9232771, 1.3609,
                0.9369186
            ],
            [
                1.6923072, 2.2193842, 2.3874788, 2.1313133, 1.4652781, 2.0853531, 2.3558953,
                1.8269184, 1.4021727, 1.4913089, 1.144539, 1.0191404, 1.0802232, 1.019779,
                0.41405877
            ]
        ],
        [
            [
                1.0416279, 2.2361817, 1.8297031, 1.4609584, 1.3634858, 0.74769616, 1.705937,
                1.0395356, 1.2112044, 1.1704713, 0.98429835, 1.3852443, 1.333267, 1.2113274,
                1.2523159
            ],
            [
                2.03924, 3.205787, 3.2098923, 2.349784, 2.5348024, 2.0511281, 2.4885828, 1.9077806,
                1.9060317, 1.889294, 2.2725966, 1.8353261, 1.9049492, 2.5240986, 1.4076619
            ],
            [
                1.6450583, 2.6803238, 2.892361, 2.9783356, 2.7777174, 3.0355377, 2.3058822,
                2.1847756, 2.3198197, 2.3792014, 2.4677942, 2.1484923, 1.8530866, 2.5775213,
                1.4531553
            ],
            [
                1.1460965, 2.047033, 2.6702192, 3.0986872, 2.849011, 3.209155, 2.3864298,
                2.7919593, 3.3181927, 2.968619, 3.3734403, 2.866981, 1.8982425, 2.5606337,
                1.4244847
            ],
            [
                0.91551685, 1.2626709, 2.0306425, 1.8586648, 2.6089337, 2.4360187, 3.1386282,
                2.9465685, 2.7070775, 2.9025972, 3.4136379, 3.0932822, 2.3282514, 2.6216912,
                1.4630034
            ],
            [
                1.0854311, 2.0098925, 2.3851385, 1.5897019, 2.7249727, 2.8106134, 2.919463,
                3.028361, 2.5453806, 2.6252158, 2.8663871, 2.941278, 1.8807676, 2.7011786,
                1.1096628
            ],
            [
                1.7003617, 2.1169329, 3.155797, 2.868411, 2.9575348, 2.9150233, 2.77071, 2.3642828,
                2.9371037, 2.3249876, 2.4480088, 2.535686, 1.3330945, 1.949711, 0.9881588
            ],
            [
                2.1496701, 2.7443209, 3.2355494, 3.6643052, 3.3104436, 3.1376665, 2.7150242,
                2.2230744, 2.3012578, 2.4650173, 2.5616827, 2.390243, 1.728731, 1.3491124,
                0.54826367
            ],
            [
                1.4965068, 3.3243585, 3.095832, 3.2213306, 2.525009, 2.2207384, 2.0969908,
                2.1796126, 1.5915941, 1.8085554, 1.9173584, 1.9980167, 1.5207764, 1.3809172,
                0.7351283
            ],
            [
                1.460982, 2.3330376, 1.85769, 2.231923, 1.6716626, 2.0235097, 2.114718, 2.0780108,
                1.1761978, 1.4310312, 1.1236134, 1.1648645, 0.796902, 1.0101866, 0.3519965
            ]
        ]
    ];
    let current_output9: Array3<f32> = conv_layer9.transposed_convolve(&test_input9);

    assert!(
        arr_allclose(&current_output9, &target_output9),
        "{:?} was not equal to {:?}",
        current_output9,
        target_output9
    );

    let test_input10 = array![[
        [
            0.06548045, 0.00913408, 0.70435095, 0.0079826, 0.16893487, 0.2994439, 0.12247328,
            0.9436006, 0.38220185, 0.49785557, 0.971778, 0.5309402, 0.33132294, 0.84232026,
            0.19554895
        ],
        [
            0.5575562, 0.0331462, 0.9122167, 0.10038461, 0.24653083, 0.51758087, 0.73047906,
            0.9375122, 0.22341998, 0.10366005, 0.4745299, 0.38613924, 0.90140545, 0.9651903,
            0.56692433
        ],
        [
            0.588052, 0.84767175, 0.5959674, 0.2866427, 0.03601055, 0.07393303, 0.030159,
            0.2588559, 0.8322194, 0.00545016, 0.41427106, 0.05567308, 0.42005536, 0.68539166,
            0.7590018
        ],
        [
            0.72914267, 0.73239255, 0.13350256, 0.18356605, 0.57364017, 0.7293392, 0.6240103,
            0.00522454, 0.819302, 0.8974482, 0.45216465, 0.53980273, 0.3617102, 0.54837334,
            0.8865967
        ],
        [
            0.54260343, 0.95218647, 0.25225356, 0.5431582, 0.92152476, 0.8494782, 0.40292063,
            0.43419263, 0.3473035, 0.198992, 0.405328, 0.09138747, 0.3167587, 0.6579542,
            0.88842267
        ],
        [
            0.8801161, 0.9872532, 0.7886485, 0.06023429, 0.15067704, 0.48051065, 0.8836845,
            0.16770448, 0.5568461, 0.9588074, 0.6503601, 0.38752878, 0.01370966, 0.47450772,
            0.131128
        ],
        [
            0.8710908, 0.60229445, 0.9686877, 0.6557498, 0.2201561, 0.3033516, 0.31898144,
            0.20641702, 0.22301586, 0.31008193, 0.51116645, 0.8883562, 0.12446219, 0.38059878,
            0.869163
        ],
        [
            0.00304829, 0.6284961, 0.17905656, 0.1530777, 0.16238053, 0.3729522, 0.04563535,
            0.9729523, 0.5449087, 0.14030091, 0.7023443, 0.79208326, 0.08276343, 0.23013659,
            0.31907466
        ],
        [
            0.08286041, 0.82474613, 0.60721296, 0.32122356, 0.8801156, 0.58986837, 0.8918898,
            0.85137707, 0.59152985, 0.4391231, 0.1578612, 0.79528105, 0.74257547, 0.5136776,
            0.63454366
        ],
        [
            0.37134466, 0.48403764, 0.43673295, 0.32532635, 0.49307734, 0.83973193, 0.09708725,
            0.9363393, 0.853499, 0.57281685, 0.84261185, 0.05469608, 0.32877076, 0.56050265,
            0.19492267
        ]
    ]];

    let kernel10: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.01887928, 0.10205422, 0.2757238, 0.52168375, 0.39948624, 0.87144667, 0.52207935,
            0.2700299, 0.79887706, 0.4059171, 0.01968747, 0.6989364, 0.10295276, 0.27480727,
            0.2874788, 0.5693166, 0.43757635, 0.28292513, 0.7388033, 0.44464782, 0.28657752,
            0.0423444, 0.3307013, 0.12819706, 0.8338068, 0.66820425, 0.99603593, 0.89585435,
            0.13042457, 0.837917, 0.5180712, 0.33727205, 0.13548309, 0.24214873, 0.22271484,
            0.943824, 0.9806861, 0.11377525, 0.15501966, 0.9829669, 0.20942484, 0.48072004,
            0.45401686, 0.21222219, 0.94949806, 0.42705423, 0.4540586, 0.05547877, 0.8334055,
            0.90596604,
        ],
    )
    .unwrap();
    let conv_layer10 = TransposedConvolutionLayer::new(kernel10, 1, Padding::Same);
    let target_output10: Array3<f32> = array![
        [
            [
                1.4650404, 1.8417397, 1.8120745, 1.6042011, 1.3665259, 1.4607083, 2.06741,
                2.3641322, 1.6340338, 2.287457, 1.5882953, 2.4844892, 2.9382095, 2.7202384,
                1.7502989
            ],
            [
                2.2801125, 2.7924242, 2.451006, 2.6301188, 2.1612859, 2.469374, 2.7346346,
                3.4440897, 4.1410866, 3.7027223, 3.4167178, 3.710089, 3.8681574, 3.541234,
                2.629564
            ],
            [
                3.1641004, 3.4937212, 3.262645, 4.030529, 4.2523894, 4.3477283, 4.6669545,
                3.926228, 4.3510914, 5.0076823, 4.000494, 5.027602, 5.462141, 4.778906, 3.4602158
            ],
            [
                3.7921565, 4.628212, 4.5428324, 4.0905137, 4.3507867, 3.8843777, 3.9568608,
                4.6803718, 4.4278607, 4.3525157, 3.7120464, 4.06002, 4.865944, 4.2279053, 3.677514
            ],
            [
                3.760223, 5.1307397, 5.4165435, 4.5965924, 3.9995556, 3.7811468, 3.928959,
                4.1420016, 3.8265216, 4.624709, 4.971419, 3.4430375, 4.614858, 3.8740993,
                2.5200484
            ],
            [
                3.7495542, 3.9377427, 5.583058, 5.1002665, 4.285932, 3.527876, 4.784959, 4.4005594,
                4.163629, 4.2578516, 4.6683497, 4.5859733, 4.6290345, 3.8496044, 2.6637638
            ],
            [
                3.685004, 4.3165607, 4.81716, 5.257611, 4.2453537, 4.8011813, 5.0514836, 5.527834,
                4.8695965, 4.306264, 4.548781, 4.031179, 4.24734, 3.2756019, 2.2837229
            ],
            [
                3.4019334, 4.670679, 4.9588504, 5.056578, 4.8202705, 3.645487, 4.958973, 4.977198,
                5.1294518, 5.3947678, 4.4017434, 4.792805, 5.0699115, 3.3515213, 2.0383253
            ],
            [
                2.4337015, 2.7364163, 3.7532802, 3.5712132, 3.6568422, 3.5841653, 3.9283607,
                3.5783224, 4.2590837, 4.4779634, 3.6170106, 3.1584594, 3.6762428, 3.076138,
                1.6428494
            ],
            [
                1.6152922, 1.6189257, 2.4915707, 3.1978223, 2.467963, 3.3423629, 3.6082346,
                3.348336, 3.0757995, 3.755949, 3.1760724, 2.7119741, 3.2688205, 2.413023,
                1.1995186
            ]
        ],
        [
            [
                3.498651, 2.2650287, 2.8471518, 2.5884533, 2.2255673, 3.2133029, 2.994876,
                3.0785344, 4.05799, 2.6110234, 3.4283304, 4.065197, 4.2445464, 3.200472, 2.8915982
            ],
            [
                3.6023834, 3.293614, 3.0345707, 3.4995866, 3.4825125, 3.058516, 3.6951475,
                3.228727, 4.716298, 4.1586294, 4.429785, 4.767285, 5.2842684, 3.7465458, 3.4085808
            ],
            [
                3.8547006, 4.095705, 5.1433706, 5.2725654, 5.605278, 5.0875406, 6.0420666,
                5.7579284, 6.6299767, 6.5608974, 5.7632823, 6.8142834, 7.1686163, 5.284168,
                5.1658664
            ],
            [
                4.9693823, 5.269723, 6.937011, 6.518367, 6.5884643, 5.6956506, 6.391355, 6.568657,
                6.186051, 5.5886574, 5.5968704, 5.455107, 6.5903296, 4.905794, 4.8338323
            ],
            [
                5.753792, 6.37267, 8.028035, 6.5134063, 4.9340215, 4.0702114, 5.0695624, 4.76545,
                5.904285, 5.182824, 5.785799, 6.047375, 5.496102, 4.3695498, 4.066173
            ],
            [
                4.750074, 5.4413433, 6.249012, 6.3877463, 5.0925198, 5.0411615, 6.432124, 6.885772,
                5.794311, 6.71825, 6.0909343, 6.3911314, 5.871263, 3.9966629, 3.9688714
            ],
            [
                3.788199, 5.83951, 6.5825367, 7.081636, 6.3494725, 6.854126, 6.6631627, 6.5011697,
                6.534909, 6.0955114, 5.2499623, 6.181784, 6.491973, 3.9676561, 3.6807528
            ],
            [
                4.256257, 5.216485, 7.4979124, 6.81794, 6.6527247, 6.761116, 7.1128535, 7.4212475,
                7.508712, 7.2611303, 6.239609, 6.321154, 5.840293, 4.2049646, 2.7046306
            ],
            [
                3.605656, 3.971768, 5.5762362, 5.843846, 4.731377, 5.2448125, 4.514171, 4.9243493,
                4.7240524, 5.618879, 4.954734, 4.560218, 5.3124638, 3.6052966, 2.4522681
            ],
            [
                1.0838358, 1.6974812, 2.2523203, 3.475841, 1.9870808, 3.5472536, 3.8107357,
                3.4158757, 4.6232204, 4.069768, 3.1683257, 3.520639, 2.770494, 2.389612, 1.7282767
            ]
        ]
    ];
    let current_output10: Array3<f32> = conv_layer10.transposed_convolve(&test_input10);

    assert!(
        arr_allclose(&current_output10, &target_output10),
        "{:?} was not equal to {:?}",
        current_output10,
        target_output10
    );

    let test_input11 = array![[
        [
            0.28493765, 0.84425455, 0.2125586, 0.30355948, 0.7217841, 0.79734004, 0.6884602,
            0.49113187, 0.6179504, 0.34699434, 0.09748444, 0.27466017, 0.14281377, 0.23376207,
            0.29919705
        ],
        [
            0.37902007, 0.1770373, 0.48892596, 0.00818884, 0.26108363, 0.3512672, 0.31604382,
            0.12642981, 0.615995, 0.35579157, 0.47586012, 0.43474475, 0.6499928, 0.18429177,
            0.19589747
        ],
        [
            0.86887765, 0.21657656, 0.26640975, 0.9135543, 0.1351185, 0.55250746, 0.7244431,
            0.6438669, 0.94123846, 0.3052215, 0.19405146, 0.7915032, 0.2215864, 0.99354404,
            0.20575579
        ],
        [
            0.501861, 0.5988626, 0.61178064, 0.93854606, 0.34350866, 0.5022635, 0.8713325,
            0.55700094, 0.08640469, 0.2599684, 0.9166737, 0.28289968, 0.8386542, 0.01682584,
            0.31150645
        ],
        [
            0.11063476, 0.15751906, 0.7308883, 0.00140237, 0.27468005, 0.3958333, 0.8969025,
            0.9261527, 0.9761576, 0.30405822, 0.34184697, 0.5575465, 0.33684778, 0.34010285,
            0.820116
        ],
        [
            0.28057107, 0.1391191, 0.38748598, 0.8795178, 0.7206118, 0.5314377, 0.08748581,
            0.5352217, 0.22046958, 0.9980463, 0.19019943, 0.42354575, 0.7567667, 0.10538436,
            0.50140804
        ],
        [
            0.57955885, 0.05986565, 0.353253, 0.00311012, 0.7658407, 0.7513709, 0.9765607,
            0.58249015, 0.40999976, 0.26895264, 0.7003221, 0.6471233, 0.39382797, 0.40851805,
            0.05244604
        ],
        [
            0.11295627, 0.37395093, 0.05590766, 0.6881838, 0.2972861, 0.00232255, 0.64427334,
            0.6560295, 0.98811734, 0.77366877, 0.43098462, 0.22007245, 0.5114152, 0.42347395,
            0.25439575
        ],
        [
            0.78671193, 0.6732271, 0.03266731, 0.47595525, 0.09416258, 0.0019726, 0.1111431,
            0.6402252, 0.2728151, 0.900054, 0.12672469, 0.9421807, 0.6501031, 0.06410667,
            0.5950088
        ],
        [
            0.88287455, 0.14757425, 0.22814396, 0.79920477, 0.29192075, 0.6029976, 0.9898775,
            0.64544797, 0.2707395, 0.72904193, 0.7424345, 0.63698596, 0.64247257, 0.7216217,
            0.028181
        ]
    ]];

    let kernel11: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.5756966, 0.02473816, 0.66734326, 0.39896733, 0.56368285, 0.88647443, 0.7214182,
            0.2723632, 0.05544049, 0.8955956, 0.6995449, 0.90682906, 0.47001252, 0.9262923,
            0.36400232, 0.47457242, 0.5315045, 0.37097195, 0.8462814, 0.41523463, 0.10259873,
            0.98971355, 0.8958682, 0.4411347, 0.44968688, 0.73471594, 0.77696186, 0.4696229,
            0.33835453, 0.35865164, 0.17881688, 0.23639117, 0.42578194, 0.8850146, 0.06259882,
            0.6969156, 0.7169207, 0.50784355, 0.41480115, 0.9240281, 0.92042994, 0.44437408,
            0.9555307, 0.63262737, 0.3798239, 0.1719768, 0.6146268, 0.2091208, 0.94248736,
            0.12528607,
        ],
    )
    .unwrap();
    let conv_layer11 = TransposedConvolutionLayer::new(kernel11, 1, Padding::Same);
    let target_output11: Array3<f32> = array![
        [
            [
                1.9424168, 2.8038478, 3.4236012, 3.571685, 3.7673714, 3.6835027, 4.545781,
                4.5448947, 3.8766267, 3.5253408, 3.66464, 3.5892937, 3.4986968, 2.6383848,
                1.9123707
            ],
            [
                3.1330965, 4.1312532, 5.825806, 4.738506, 5.19208, 5.8764734, 5.8616967, 5.7418327,
                5.694005, 4.934114, 5.541763, 4.3109436, 4.158842, 3.911207, 2.5266302
            ],
            [
                3.7208333, 4.4943533, 6.2443986, 6.3206863, 6.4063363, 7.937979, 8.149901,
                7.502861, 6.801396, 6.499112, 5.943653, 5.753269, 5.982611, 4.9213057, 3.4492736
            ],
            [
                3.0772216, 5.049364, 5.3627143, 6.2576733, 6.68616, 6.0997443, 6.5377727,
                7.6071873, 8.451174, 7.136688, 6.8693976, 6.048246, 5.8750215, 5.3853493, 4.209527
            ],
            [
                3.0114582, 4.104499, 5.7746696, 6.5572443, 8.391804, 8.174003, 8.165562, 7.6813645,
                7.1519737, 7.070175, 7.1419573, 6.8685603, 6.5943937, 4.7331934, 3.6038952
            ],
            [
                2.9152195, 4.0240874, 5.8618646, 5.18298, 6.429131, 7.519385, 8.238211, 8.647101,
                8.282191, 7.6296983, 6.573933, 6.5500035, 6.071337, 4.5434804, 3.732185
            ],
            [
                3.0795133, 3.442535, 4.4576244, 4.9366164, 5.539491, 6.471554, 7.0068216,
                7.6806154, 8.087567, 8.174512, 7.762317, 6.2359223, 6.4561443, 5.1683702,
                3.4829957
            ],
            [
                3.3981621, 4.5173874, 5.8186593, 5.3924108, 5.588025, 6.751764, 7.0627103,
                6.8960586, 7.7451377, 7.2759686, 7.801675, 8.433831, 5.93259, 5.3128405, 3.5145931
            ],
            [
                2.0990167, 3.0224428, 4.3286476, 4.234779, 4.5015125, 5.7934327, 5.3982935,
                5.932039, 6.343004, 7.2322855, 6.1910663, 6.028619, 5.457879, 4.510511, 3.116261
            ],
            [
                1.7940279, 3.094462, 3.3867333, 2.5553372, 2.7961323, 3.741658, 3.1111317,
                4.661657, 4.749159, 4.875539, 4.1830807, 4.6268387, 4.109134, 2.9073114, 2.2471232
            ]
        ],
        [
            [
                2.1374462, 3.020885, 3.106464, 3.2314034, 3.795689, 3.4968257, 4.656739, 3.972203,
                3.8368285, 3.9026897, 3.062347, 3.0667505, 2.9879866, 2.243768, 2.1230078
            ],
            [
                3.2221932, 4.477774, 4.6528106, 5.8674417, 5.4695296, 5.554267, 6.031023, 5.989837,
                5.50249, 4.801389, 5.10685, 4.734841, 3.907444, 3.8338544, 1.9201188
            ],
            [
                3.1492395, 5.111415, 4.952005, 5.533412, 6.553766, 6.21893, 7.019034, 7.1608377,
                7.08678, 6.333576, 5.5809836, 5.1404176, 6.028519, 3.7854307, 3.9825804
            ],
            [
                3.1655734, 4.417047, 6.138915, 5.2924147, 6.8572574, 6.8688097, 6.521532,
                7.0992513, 6.9452405, 6.457678, 7.1893506, 5.380786, 6.427129, 4.8285456,
                3.1275468
            ],
            [
                3.532887, 4.436915, 5.5138893, 6.5267763, 6.5236244, 8.013009, 7.4919786, 7.778085,
                7.287519, 7.081072, 5.3809805, 6.655012, 5.8462963, 4.7130485, 3.6891687
            ],
            [
                2.4277077, 4.084894, 4.7160544, 5.3782034, 7.1346235, 6.3990145, 7.47696,
                7.7427425, 7.741425, 6.920362, 7.6988177, 5.2618833, 5.6456695, 4.8004003,
                2.9019258
            ],
            [
                2.1360211, 4.2606363, 4.7031713, 4.3630023, 5.302891, 6.3046327, 6.814991,
                7.265829, 7.3465815, 6.9841237, 6.73649, 6.547976, 5.886479, 4.3079767, 3.6868033
            ],
            [
                2.6205213, 4.678033, 4.3898616, 5.115892, 6.084198, 6.281511, 5.988104, 8.042958,
                6.766296, 8.147673, 7.139324, 6.61374, 6.2939672, 4.665699, 3.539275
            ],
            [
                2.6093051, 3.3116386, 4.031277, 3.1564243, 4.160567, 5.2126255, 4.929762,
                5.8178496, 6.3078904, 5.831559, 6.3100033, 5.7997513, 4.9163594, 3.8483152,
                2.3435266
            ],
            [
                1.6993712, 2.996689, 2.9104354, 2.72224, 2.8658493, 2.7777424, 3.3658233,
                3.9316392, 4.5286436, 4.237758, 4.649208, 4.3620024, 3.3817856, 3.607075,
                2.1982648
            ]
        ]
    ];
    let current_output11: Array3<f32> = conv_layer11.transposed_convolve(&test_input11);

    assert!(
        arr_allclose(&current_output11, &target_output11),
        "{:?} was not equal to {:?}",
        current_output11,
        target_output11
    );

    let test_input12 = array![[
        [
            0.93378943, 0.87571466, 0.3705673, 0.90004736, 0.32630125, 0.3536163, 0.16810241,
            0.42665592, 0.22195213, 0.89762414, 0.73626053, 0.96711236, 0.14636794, 0.634406,
            0.17075826
        ],
        [
            0.11598377, 0.22405057, 0.7753175, 0.45025635, 0.1127533, 0.45725664, 0.2769305,
            0.7246966, 0.8196202, 0.50384414, 0.25193858, 0.7090718, 0.10860251, 0.7267475,
            0.01785723
        ],
        [
            0.73000073, 0.6211034, 0.8582073, 0.83433443, 0.56744623, 0.9021496, 0.80780494,
            0.8969007, 0.71868527, 0.15416864, 0.3109594, 0.37281284, 0.35761753, 0.74799633,
            0.03544199
        ],
        [
            0.94523054, 0.2602464, 0.545365, 0.1384494, 0.01583813, 0.8098333, 0.14065732,
            0.39385346, 0.74254405, 0.56148314, 0.79519624, 0.13521732, 0.83143985, 0.42911455,
            0.23204546
        ],
        [
            0.898101, 0.8682528, 0.70681596, 0.36217734, 0.53928083, 0.35841224, 0.59799546,
            0.9620887, 0.9442291, 0.73375404, 0.3066293, 0.9712552, 0.8396209, 0.88084036,
            0.89714116
        ],
        [
            0.7529824, 0.7219895, 0.90715826, 0.48381475, 0.97088134, 0.81348956, 0.20165135,
            0.35108918, 0.23535109, 0.1987758, 0.55788106, 0.96563345, 0.31244108, 0.07823667,
            0.90779877
        ],
        [
            0.04468893, 0.00807871, 0.5142322, 0.56531453, 0.9476729, 0.3646428, 0.07726929,
            0.47914064, 0.7094641, 0.03051784, 0.98401845, 0.5092841, 0.33882263, 0.2072125,
            0.30427557
        ],
        [
            0.33484283, 0.04683242, 0.8137769, 0.5400542, 0.6123425, 0.3961748, 0.50771534,
            0.5570198, 0.76028925, 0.8973852, 0.7126607, 0.40452087, 0.36860222, 0.6658892,
            0.32224172
        ],
        [
            0.7616602, 0.1748469, 0.02260675, 0.6758181, 0.6891273, 0.00524846, 0.54603004,
            0.8228151, 0.6370315, 0.22467363, 0.35656846, 0.4183928, 0.6750586, 0.4910721,
            0.79399353
        ],
        [
            0.8604528, 0.6060834, 0.5752362, 0.55920976, 0.773592, 0.14374816, 0.5340704,
            0.66251427, 0.7518125, 0.4407047, 0.22500344, 0.53439796, 0.04389151, 0.2593799,
            0.18684314
        ]
    ]];

    let kernel12: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.364072, 0.7486223, 0.7264812, 0.8525112, 0.9707416, 0.91841763, 0.38936672,
            0.32220647, 0.37838978, 0.6008797, 0.27303654, 0.04175345, 0.22579135, 0.14077605,
            0.08313155, 0.76760066, 0.18255529, 0.45401564, 0.06547726, 0.34588438, 0.29941446,
            0.8504698, 0.36554414, 0.6702008, 0.55796266, 0.5358035, 0.08683414, 0.03629659,
            0.7383175, 0.973305, 0.01495373, 0.61129063, 0.9344323, 0.24671361, 0.01170023,
            0.04234208, 0.9250063, 0.8094783, 0.2621662, 0.18145515, 0.916499, 0.76867294,
            0.5188336, 0.8480724, 0.43531516, 0.88431466, 0.0618127, 0.51059407, 0.85750157,
            0.55303335,
        ],
    )
    .unwrap();
    let conv_layer12 = TransposedConvolutionLayer::new(kernel12, 1, Padding::Same);
    let target_output12: Array3<f32> = array![
        [
            [
                2.5169115, 3.8863173, 3.683805, 3.712843, 4.1604548, 3.9942172, 3.871521, 4.042815,
                3.2975593, 4.0987673, 3.1208298, 3.4666653, 2.8911123, 1.9013197, 1.2967856
            ],
            [
                3.0508013, 4.237955, 4.1845784, 4.526673, 4.4229026, 4.420533, 4.621553, 4.935693,
                4.6257915, 5.7983627, 4.0570717, 5.0417156, 3.3613958, 2.7263777, 1.6212234
            ],
            [
                4.5630827, 5.769714, 6.201285, 6.037314, 5.6872587, 5.9577227, 6.22178, 7.108208,
                6.405453, 6.8940005, 6.549892, 6.6800694, 5.7343507, 4.1907377, 2.8841295
            ],
            [
                4.7634506, 5.428124, 6.001507, 7.076713, 6.5155153, 6.363605, 7.0607533, 5.8297377,
                5.220542, 6.7088346, 6.851497, 6.097303, 5.175589, 4.244353, 2.472039
            ],
            [
                4.158007, 4.7449236, 6.6789026, 7.3511553, 6.616245, 6.245135, 6.8673415, 6.208699,
                5.369304, 6.9443393, 6.0933647, 5.6121726, 5.966281, 3.9162621, 2.650091
            ],
            [
                3.7042682, 4.562324, 5.853302, 6.277696, 5.5285277, 5.5800138, 6.9579663, 5.939261,
                6.079244, 7.1475134, 6.9294386, 5.9554615, 6.531581, 4.016448, 2.7811937
            ],
            [
                3.8395445, 4.3476987, 6.534429, 5.672584, 5.716532, 6.4179616, 6.981738, 5.8930535,
                6.109571, 7.062487, 6.3556566, 6.0852003, 6.7650223, 5.0229425, 2.7210393
            ],
            [
                3.6244721, 5.0518866, 7.1842394, 5.9034877, 5.0564623, 6.2600427, 6.7625256,
                4.9361224, 5.7210155, 6.594228, 5.8694773, 3.9441566, 5.643114, 3.5208952,
                2.030337
            ],
            [
                2.2136555, 3.3792782, 5.143144, 3.388192, 4.0535145, 4.971399, 5.6373873, 3.829986,
                4.667293, 5.0312195, 4.269857, 3.7788649, 3.995318, 2.4845536, 1.3634946
            ],
            [
                1.8460652, 2.9112356, 4.0196896, 2.5467296, 3.1197126, 4.04021, 4.215414, 3.36564,
                3.6399112, 3.7294235, 3.3501759, 3.1421201, 3.0593317, 1.6304059, 1.235124
            ]
        ],
        [
            [
                2.3992267, 3.536952, 4.833219, 4.6836276, 4.0526695, 3.646066, 3.7829823,
                3.9788437, 4.750264, 4.8019023, 4.185118, 3.636405, 3.3640559, 2.7429554,
                2.1272578
            ],
            [
                2.5314178, 5.452192, 6.315143, 5.710856, 5.074245, 4.7196226, 5.371161, 6.15582,
                5.4666805, 5.2592645, 5.4035687, 5.59235, 5.1266685, 4.099976, 2.9234848
            ],
            [
                3.9114373, 6.217504, 6.9331574, 6.7651997, 6.3875766, 6.808406, 6.612628, 7.234677,
                7.0746365, 8.623946, 6.6649423, 6.681792, 6.303984, 5.4906116, 3.8852642
            ],
            [
                4.736272, 6.3143044, 7.147314, 7.0803328, 6.9552174, 7.0252943, 7.546432, 7.551138,
                7.1456165, 7.898, 5.6559734, 6.5047264, 6.9771686, 5.6897144, 4.1102495
            ],
            [
                4.747836, 6.396698, 6.8567686, 7.26264, 6.8730655, 7.0972633, 7.4941278, 5.9992075,
                6.6477747, 6.68507, 7.0780907, 7.4688478, 6.6397324, 5.673068, 4.7010574
            ],
            [
                3.535816, 4.8868966, 6.5341854, 7.7603264, 7.4543037, 6.4967103, 6.4960847,
                6.301393, 6.350187, 7.117075, 8.617403, 7.8579803, 6.3296194, 5.479391, 4.7374487
            ],
            [
                2.424763, 4.761889, 7.276769, 6.945235, 6.9707885, 7.2768145, 6.747321, 5.9444613,
                6.379388, 8.474126, 7.2017875, 5.953751, 7.233721, 5.4409585, 4.023011
            ],
            [
                2.9328406, 4.458434, 6.6849127, 6.4997087, 6.541329, 6.901695, 6.7834544, 5.640694,
                6.9353604, 7.5902133, 5.6894617, 5.251082, 6.948236, 4.797178, 3.1502519
            ],
            [
                3.2059908, 3.6775067, 4.790674, 4.786832, 4.830831, 5.2745123, 5.797093, 5.212235,
                6.1636906, 5.4100714, 4.961485, 4.836706, 4.6523004, 3.508091, 2.9151838
            ],
            [
                2.3966105, 3.3806067, 4.2084694, 3.1797504, 3.8364441, 4.419096, 4.3098598,
                4.035141, 4.662063, 4.2202344, 4.031439, 3.4909723, 3.1803038, 2.444861, 2.0639114
            ]
        ]
    ];
    let current_output12: Array3<f32> = conv_layer12.transposed_convolve(&test_input12);

    assert!(
        arr_allclose(&current_output12, &target_output12),
        "{:?} was not equal to {:?}",
        current_output12,
        target_output12
    );

    let test_input13 = array![[
        [
            0.4100957, 0.23349695, 0.94077224, 0.550699, 0.81176674, 0.10928705, 0.3612262,
            0.83176976, 0.7887386, 0.19257349
        ],
        [
            0.5499223, 0.6020576, 0.01182431, 0.82526195, 0.87057257, 0.4918879, 0.8487137,
            0.5173628, 0.28413567, 0.99594164
        ],
        [
            0.3504231, 0.8329064, 0.511269, 0.0808953, 0.2005887, 0.13052976, 0.31688938,
            0.6378449, 0.10728794, 0.38428745
        ],
        [
            0.21822089, 0.6779479, 0.01925816, 0.6034686, 0.59955317, 0.627526, 0.19007124,
            0.53523797, 0.7917316, 0.39723003
        ],
        [
            0.01994821, 0.95703894, 0.03960026, 0.7725681, 0.75460905, 0.96137804, 0.76599175,
            0.14408278, 0.38372183, 0.5690531
        ],
        [
            0.65501195, 0.9368904, 0.6942764, 0.5075379, 0.94859546, 0.67054915, 0.2872205,
            0.8503378, 0.6936864, 0.5191393
        ],
        [
            0.17161214, 0.60783255, 0.8314718, 0.7780676, 0.9078848, 0.00837805, 0.9213724,
            0.8680424, 0.28711274, 0.92413175
        ],
        [
            0.5842536, 0.18172403, 0.8176909, 0.33601242, 0.9705583, 0.27681327, 0.3818515,
            0.43224367, 0.20357549, 0.4132522
        ],
        [
            0.43054482, 0.17652053, 0.2664922, 0.5115917, 0.6426764, 0.6019538, 0.05434526,
            0.20245807, 0.45893812, 0.6319473
        ],
        [
            0.1865494, 0.45349252, 0.00986793, 0.30004007, 0.6565686, 0.9366916, 0.9383834,
            0.42786607, 0.1657839, 0.8447114
        ],
        [
            0.09571899, 0.6194299, 0.53117514, 0.06176106, 0.11184933, 0.94375014, 0.4726875,
            0.7324799, 0.4130585, 0.16590115
        ],
        [
            0.47553223, 0.95835185, 0.70241493, 0.2533535, 0.1899997, 0.54406756, 0.24702379,
            0.52970946, 0.37160358, 0.00654423
        ],
        [
            0.7992172, 0.3744659, 0.74593586, 0.05065656, 0.4916111, 0.443751, 0.7229693,
            0.19321841, 0.7816357, 0.6820754
        ],
        [
            0.2713287, 0.347081, 0.46632323, 0.24111566, 0.27292952, 0.22054346, 0.04943878,
            0.35453218, 0.31998315, 0.76677155
        ],
        [
            0.76535696, 0.07973383, 0.59684074, 0.4759201, 0.79735076, 0.59453136, 0.03127723,
            0.32571086, 0.9687319, 0.05784191
        ]
    ]];

    let kernel13: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.23112701, 0.21375875, 0.48185337, 0.6969342, 0.04131768, 0.1001141, 0.89933884,
            0.10443968, 0.22237247, 0.04539814, 0.52683884, 0.72701544, 0.57144904, 0.12132035,
            0.8315424, 0.8288368, 0.4090705, 0.48474863, 0.13092747, 0.9594357, 0.00129573,
            0.12605824, 0.14914274, 0.25621372, 0.1270078, 0.25362593, 0.32486656,
        ],
    )
    .unwrap();
    let conv_layer13 = TransposedConvolutionLayer::new(kernel13, 1, Padding::Same);
    let target_output13: Array3<f32> = array![
        [
            [
                0.5892676, 1.17047, 0.9214085, 1.08153, 1.5770267, 1.4884254, 1.357585, 1.4302133,
                1.0541202, 1.0399723
            ],
            [
                0.7417133, 1.6665196, 1.7753214, 1.4394567, 0.7264138, 1.0027893, 1.1439524,
                1.4687312, 1.3726137, 0.6298094
            ],
            [
                0.8464558, 1.0417503, 1.4207294, 1.1808254, 1.6579384, 1.7663487, 1.4272478,
                1.1867762, 1.9015408, 1.1788529
            ],
            [
                0.8254549, 1.1566715, 1.5428398, 1.1220039, 1.765818, 1.8652499, 1.9876546,
                1.2752179, 1.039806, 0.9031198
            ],
            [
                1.2269591, 1.5782638, 2.1539533, 1.748312, 2.0865018, 1.9568272, 1.5790942,
                1.6565949, 1.9104177, 1.2650805
            ],
            [
                0.9505705, 1.14499, 2.1300342, 2.2458863, 2.2805436, 1.856609, 1.4738624,
                2.0830247, 1.767452, 1.1384681
            ],
            [
                1.1032276, 1.6358459, 1.5975292, 2.1692204, 1.6940836, 1.8626256, 1.4270779,
                1.3684331, 1.4348766, 0.74549186
            ],
            [
                0.7139121, 1.3148005, 1.1806337, 1.7517596, 1.4494406, 1.8511865, 1.275487,
                0.827441, 1.4569479, 1.0478671
            ],
            [
                0.43640533, 1.1374528, 0.9070535, 1.2392195, 1.4578446, 1.9913197, 2.011739,
                1.5188596, 1.1863908, 0.89848804
            ],
            [
                0.44268322, 0.9227081, 1.3658977, 1.1205299, 1.0784702, 1.4047986, 1.8123927,
                1.4356809, 1.61254, 0.7046397
            ],
            [
                0.92647225, 1.4986928, 1.7562263, 1.2827326, 1.2826236, 1.4508054, 1.5669684,
                1.1765347, 1.3846834, 0.5101861
            ],
            [
                1.1761122, 1.7308073, 1.2722988, 1.1224169, 1.1210315, 1.3607355, 1.7379959,
                1.4701089, 1.2324153, 1.3258594
            ],
            [
                0.89177775, 1.3922321, 1.1791381, 1.1087042, 0.9160118, 0.8505553, 0.8332181,
                0.90309715, 1.0754969, 1.0152677
            ],
            [
                0.89768493, 1.5988342, 0.8870801, 1.5775739, 1.4790335, 1.6889635, 0.9967848,
                1.123985, 1.6454675, 1.21873
            ],
            [
                0.24307257, 0.53059113, 0.37476873, 0.51178694, 0.3969471, 0.22111925, 0.35783333,
                0.42447156, 0.5667516, 0.25148404
            ]
        ],
        [
            [
                0.5143531, 1.4920992, 1.043011, 1.4002414, 1.5851613, 1.5768179, 1.4429176,
                1.6762065, 1.17379, 1.1506448
            ],
            [
                1.1327332, 2.170758, 2.964525, 2.5468364, 1.9113774, 1.8651662, 1.853042, 2.631841,
                2.577308, 1.0880573
            ],
            [
                1.5317894, 1.858716, 1.9473301, 2.0375612, 2.4790478, 2.5770626, 2.4012282,
                1.8110723, 2.6016166, 1.9396253
            ],
            [
                1.3354186, 1.9810576, 2.3362312, 1.3664582, 2.0663114, 2.0672886, 2.5933418,
                2.056448, 1.5666038, 1.3868527
            ],
            [
                1.597803, 1.938459, 2.7830129, 2.3630528, 3.1545627, 2.9619637, 2.1719925,
                2.4012706, 2.7366648, 1.8117259
            ],
            [
                1.4110885, 2.1089911, 2.8076568, 3.230568, 3.5409825, 3.1419275, 2.5377393,
                2.6289575, 2.433634, 1.7720132
            ],
            [
                1.9089748, 2.808544, 2.7930439, 3.2748752, 2.8008592, 3.064009, 2.221884,
                2.5568619, 2.736597, 1.4023985
            ],
            [
                1.0052756, 2.3547814, 2.2241008, 3.1390867, 2.3578506, 2.6278253, 2.3277552,
                1.8746519, 2.2093737, 1.7825553
            ],
            [
                0.8903708, 1.780953, 1.7815195, 2.100505, 2.4419727, 2.4648917, 2.457483, 2.01091,
                1.638401, 1.326843
            ],
            [
                0.83071864, 1.1431853, 1.8436326, 1.8887995, 2.0738647, 2.3816648, 2.292196,
                1.8805743, 2.4300501, 1.3554207
            ],
            [
                1.138022, 1.8425272, 2.0037537, 1.7509141, 2.2516997, 2.6682694, 2.990889,
                1.9553533, 2.0482259, 1.2836125
            ],
            [
                1.5662303, 2.5387807, 2.136526, 1.4778578, 1.5654552, 2.1503775, 2.7043767,
                2.2447352, 1.7221527, 1.5286092
            ],
            [
                1.5572135, 2.7478414, 2.0683074, 1.7962692, 1.356324, 1.7144233, 1.4524264,
                1.8194649, 1.6152632, 1.2914546
            ],
            [
                1.5935811, 2.3469036, 1.5929676, 1.9277703, 1.8809972, 2.2994034, 1.7651865,
                1.5672339, 2.6534872, 2.0059662
            ],
            [
                0.6128148, 1.3963602, 1.0870682, 1.3469355, 1.1088134, 0.7664157, 0.82436585,
                1.1140822, 1.2766322, 1.1960115
            ]
        ],
        [
            [
                0.4333362, 1.1887326, 0.9138965, 1.3190898, 0.6445537, 0.8524537, 1.1168197,
                1.1826249, 0.74527776, 0.39039958
            ],
            [
                0.9182512, 0.6513226, 1.444681, 1.5105084, 1.2507634, 1.4840524, 1.0168802,
                1.0312097, 1.7465343, 0.5882454
            ],
            [
                1.1093316, 1.1522481, 0.7323427, 0.7076169, 0.90184265, 0.9644634, 1.2439971,
                0.8823506, 1.0084301, 0.582635
            ],
            [
                0.90167326, 0.63120073, 1.3831829, 1.0584178, 1.2415056, 0.84435314, 1.0629802,
                1.3198493, 1.0113246, 0.51383114
            ],
            [
                1.1832163, 0.7226001, 1.4887865, 1.2872707, 1.8531746, 1.6681049, 0.9822693,
                1.0183237, 1.2804044, 0.69472027
            ],
            [
                1.1041427, 1.4309912, 1.4340568, 1.6962359, 1.5734822, 1.345621, 1.768375,
                1.4155104, 1.2305019, 0.67678034
            ],
            [
                0.87525064, 1.5898288, 1.6777313, 1.8280804, 0.9508405, 1.8040111, 1.404788,
                1.0803274, 1.7389416, 0.6469624
            ],
            [
                0.38363177, 1.2841955, 1.0249264, 1.841816, 1.2057523, 1.1167085, 0.891593,
                0.97124183, 1.0595424, 0.581265
            ],
            [
                0.46639273, 0.71078205, 0.9424545, 1.2385238, 1.4048395, 1.0159645, 0.83662236,
                0.91418517, 1.105061, 0.51020336
            ],
            [
                0.6666262, 0.4696451, 0.6843634, 0.9855639, 1.5498636, 1.7646865, 1.2731248,
                0.73744345, 1.2946877, 0.5524117
            ],
            [
                0.8423824, 1.076266, 0.6892561, 0.47819978, 1.3320843, 1.2021987, 1.7274995,
                1.1869236, 0.70409983, 0.4478111
            ],
            [
                1.1655022, 1.374326, 1.0765296, 0.7522497, 0.79104084, 0.8581198, 1.2844983,
                1.0584677, 0.7524275, 0.45717442
            ],
            [
                0.6811988, 1.514434, 0.8808945, 1.0871181, 0.7375139, 1.1548907, 0.7271405,
                1.2714256, 1.2730477, 0.5596662
            ],
            [
                0.68564314, 1.109937, 0.84942305, 0.91222835, 0.6952437, 0.6041981, 0.8552021,
                0.82966936, 1.3082871, 0.75452673
            ],
            [
                0.26061475, 0.95631313, 0.79839766, 1.2009847, 0.95858383, 0.46614337, 0.55272543,
                1.0932577, 0.4807369, 0.5547314
            ]
        ]
    ];
    let current_output13: Array3<f32> = conv_layer13.transposed_convolve(&test_input13);

    assert!(
        arr_allclose(&current_output13, &target_output13),
        "{:?} was not equal to {:?}",
        current_output13,
        target_output13
    );

    let test_input14 = array![[
        [
            0.62041426, 0.697295, 0.9369903, 0.23178808, 0.07347008, 0.87454647, 0.17515963,
            0.41914883, 0.15454182, 0.36946547
        ],
        [
            0.79976183, 0.07178256, 0.46134615, 0.70403695, 0.311498, 0.94000924, 0.5659397,
            0.93609524, 0.073363, 0.9303597
        ],
        [
            0.4324125, 0.47519296, 0.9012037, 0.1962483, 0.805305, 0.8238879, 0.48392892,
            0.37745702, 0.86567134, 0.85204846
        ],
        [
            0.12615952, 0.11317621, 0.04537176, 0.23528396, 0.10647685, 0.6699744, 0.21937414,
            0.17724377, 0.73926926, 0.44401154
        ],
        [
            0.50388384, 0.94392323, 0.48345914, 0.3287163, 0.6634121, 0.46625283, 0.9509837,
            0.68855166, 0.81077915, 0.42277807
        ],
        [
            0.95792127, 0.11384781, 0.90199846, 0.05767209, 0.17340712, 0.0322121, 0.6726343,
            0.24741997, 0.18859474, 0.43701664
        ],
        [
            0.21520379, 0.77168584, 0.01789387, 0.4761448, 0.86404794, 0.7532802, 0.44620237,
            0.5595725, 0.8530702, 0.73950565
        ],
        [
            0.63887656, 0.72841924, 0.42928135, 0.87943435, 0.4875559, 0.8769417, 0.49920833,
            0.5592682, 0.48188642, 0.08828494
        ],
        [
            0.5162344, 0.47625086, 0.1528102, 0.11186781, 0.66326326, 0.08997896, 0.5311464,
            0.55197066, 0.19109693, 0.08596
        ],
        [
            0.34851643, 0.796684, 0.68925637, 0.41194296, 0.24475926, 0.9287657, 0.26898536,
            0.00017125, 0.4337256, 0.875177
        ],
        [
            0.8124247, 0.84583837, 0.23242904, 0.8433852, 0.32513255, 0.83046263, 0.6866764,
            0.7849342, 0.22307974, 0.02804313
        ],
        [
            0.01699138, 0.657378, 0.24152313, 0.78862953, 0.72347564, 0.7809651, 0.00413024,
            0.55508566, 0.9583772, 0.51338005
        ],
        [
            0.91324073, 0.51398355, 0.7841788, 0.6492132, 0.62972444, 0.2367895, 0.5444091,
            0.98195267, 0.2812743, 0.74537945
        ],
        [
            0.41554296, 0.04450764, 0.33355126, 0.10750319, 0.94191694, 0.37232223, 0.40169755,
            0.7044588, 0.3049165, 0.22046074
        ],
        [
            0.4864949, 0.00569754, 0.41896838, 0.08973251, 0.23901314, 0.9181874, 0.3380357,
            0.5964413, 0.47192204, 0.06918518
        ]
    ]];

    let kernel14: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.43654358, 0.8875514, 0.06436663, 0.8708052, 0.41433588, 0.22069511, 0.03716711,
            0.6242032, 0.49542144, 0.987703, 0.20076574, 0.99377596, 0.4789202, 0.9898322,
            0.8125856, 0.16723853, 0.9405662, 0.4238018, 0.86250734, 0.50889605, 0.54473287,
            0.80337036, 0.2536878, 0.13558078, 0.50765884, 0.9764012, 0.6149867,
        ],
    )
    .unwrap();
    let conv_layer14 = TransposedConvolutionLayer::new(kernel14, 1, Padding::Same);
    let target_output14: Array3<f32> = array![
        [
            [
                1.6037179, 1.8014371, 1.7409596, 1.5123274, 1.6591052, 1.6408793, 1.9268928,
                1.2883846, 1.1584053, 1.062437
            ],
            [
                1.1608751, 2.2832782, 2.316097, 1.9321804, 2.658393, 2.285532, 2.7677894, 1.720043,
                2.8458123, 1.3635201
            ],
            [
                0.94131285, 1.8314742, 1.1733224, 2.0156395, 2.0593932, 2.3548987, 1.993957,
                2.2037058, 2.7345395, 1.5491847
            ],
            [
                1.1295882, 1.5947707, 1.3447952, 1.355758, 1.9070622, 1.9965241, 2.3517094,
                2.2341642, 2.1601014, 1.6606308
            ],
            [
                1.9655474, 1.753626, 1.9773675, 1.2674915, 1.2442814, 1.9941972, 2.3828714,
                2.116675, 1.7847133, 1.5330698
            ],
            [
                1.194184, 2.6225495, 1.343598, 1.8880863, 1.5746678, 2.0942266, 1.6644207,
                2.2413127, 2.2542098, 1.4694471
            ],
            [
                1.8671379, 1.8731652, 1.9556925, 2.4407098, 2.232783, 2.3834865, 2.0435097,
                2.3834288, 2.030378, 1.1235636
            ],
            [
                1.6658281, 1.860301, 2.0296023, 1.6272726, 2.6253686, 2.0686634, 2.4651213,
                1.9543159, 1.364658, 1.0051662
            ],
            [
                1.4757515, 2.1676936, 1.7817509, 1.659748, 1.6581357, 2.3252218, 1.6155955,
                1.3311032, 1.64887, 1.1913495
            ],
            [
                2.072795, 2.3983076, 2.027379, 1.8462389, 2.0674748, 2.1939993, 1.8601537,
                1.7566156, 1.5134196, 0.77970594
            ],
            [
                1.5173078, 2.1352391, 2.5251753, 2.242788, 2.716363, 2.2088075, 2.2940087,
                2.0149615, 1.8387198, 1.0415647
            ],
            [
                1.8438699, 1.9253215, 2.7203667, 2.3112338, 2.7040796, 1.63466, 2.5068982,
                2.6090753, 2.2459605, 1.5871758
            ],
            [
                1.2619249, 1.8478643, 1.9907395, 2.1748614, 2.4637177, 2.0400107, 2.3396192,
                1.9440495, 2.298544, 1.275822
            ],
            [
                0.8724379, 1.396157, 1.135113, 1.8591073, 1.8759794, 2.4540334, 1.913612, 2.055744,
                1.8215901, 0.6633123
            ],
            [
                0.30120224, 0.91504943, 0.35937503, 0.76043916, 1.2550826, 1.4043262, 1.5610209,
                1.2510917, 1.0597281, 0.5229579
            ]
        ],
        [
            [
                1.2080209, 2.0856636, 2.5581827, 1.8474828, 1.6616888, 2.0311882, 2.432928,
                1.2260857, 1.731989, 0.9689028
            ],
            [
                2.6795769, 3.8666246, 2.6576734, 2.8919072, 3.4185357, 3.26014, 3.3041334,
                3.1587465, 3.129525, 1.9084569
            ],
            [
                1.4168339, 2.0338645, 2.756398, 2.5061789, 3.3848374, 3.683726, 3.5104036,
                2.9277453, 3.586101, 2.7809749
            ],
            [
                2.1448421, 2.7186296, 2.0413895, 2.5321727, 2.8507268, 3.572575, 3.2138953,
                3.1918983, 3.6187787, 2.5321343
            ],
            [
                1.4744707, 2.801477, 2.259001, 1.5792648, 2.0360026, 2.7927556, 2.7283332,
                3.1277156, 3.2154698, 2.096008
            ],
            [
                3.183797, 3.0790246, 2.7389607, 3.156024, 2.611553, 2.8810964, 3.292751, 3.868886,
                3.1104603, 1.7939425
            ],
            [
                2.2849088, 3.2444117, 2.8736713, 2.2375968, 2.898436, 3.4106035, 3.006753, 2.64566,
                2.6230972, 2.092267
            ],
            [
                2.4380062, 2.609502, 2.3646903, 3.3595452, 3.5635517, 3.5271735, 3.4837527,
                3.153354, 2.9547172, 1.5762045
            ],
            [
                2.8034265, 3.3975239, 3.0233674, 2.322994, 3.523631, 2.986277, 2.338597, 2.7026672,
                2.5140684, 1.0324643
            ],
            [
                2.6222148, 2.782929, 3.037251, 2.683903, 2.608991, 3.215918, 3.401151, 1.9148732,
                1.3456229, 1.4758011
            ],
            [
                2.706336, 3.6843095, 3.5065916, 3.1214447, 3.8280077, 2.8905227, 2.9115891,
                3.2258906, 3.2458506, 1.5386949
            ],
            [
                2.5945687, 3.1511927, 3.5039237, 3.3240108, 3.7056277, 3.7057786, 3.8102698,
                2.7354064, 3.150735, 1.9309235
            ],
            [
                1.917211, 2.7268136, 2.9219272, 4.0063734, 3.816527, 2.6138892, 2.7951374,
                3.6514342, 3.35744, 1.9822618
            ],
            [
                1.911744, 2.5837588, 2.1840513, 2.4440408, 3.1667333, 3.1490192, 3.3123655,
                3.252801, 2.7882154, 1.3419603
            ],
            [
                0.864587, 1.0910841, 0.83481795, 1.695643, 1.6862758, 2.3024523, 2.5022383,
                2.0487597, 1.8074163, 0.820723
            ]
        ],
        [
            [
                1.2166601, 2.1210876, 2.0508087, 2.0795472, 2.1084335, 1.7841735, 2.8508995,
                1.4586164, 1.9730791, 1.0292904
            ],
            [
                1.4606202, 3.3989408, 2.3620374, 2.7450144, 3.3309095, 2.5778902, 3.4602675,
                2.371684, 3.508028, 1.5767624
            ],
            [
                0.6980244, 1.9483653, 1.5795199, 2.1922882, 2.585289, 2.650384, 2.9532752,
                2.4151118, 3.1810436, 1.9646553
            ],
            [
                1.6260262, 2.4273615, 1.9141848, 2.2593985, 2.3783514, 2.7877254, 3.1724901,
                3.1909583, 2.7657533, 2.233608
            ],
            [
                1.5547037, 2.450871, 2.2476757, 1.6646581, 1.4469936, 2.2198706, 2.3553514,
                2.7803714, 2.1982849, 1.8605676
            ],
            [
                1.7219256, 2.8690698, 2.0112538, 2.8237123, 2.2483597, 2.9376817, 2.3422637,
                3.3472, 2.882731, 1.8781145
            ],
            [
                1.7807163, 2.7906713, 2.697226, 2.5799317, 2.7384825, 3.1218345, 2.7078576,
                2.6800513, 2.3020966, 1.5113361
            ],
            [
                1.8078022, 2.050248, 2.4650707, 2.1761198, 2.9161916, 2.6962497, 3.0445354,
                2.567409, 2.0837445, 1.2838707
            ],
            [
                1.8238715, 2.839588, 2.8594098, 2.0558965, 2.6147485, 2.7338068, 2.1028779,
                1.9120023, 2.1919131, 1.4399936
            ],
            [
                2.2054844, 2.650877, 2.8804693, 2.4484718, 2.5503306, 2.745405, 3.0534577,
                2.1605818, 1.5696431, 0.9104659
            ],
            [
                1.698422, 2.5689814, 3.329791, 2.5995986, 3.7761984, 2.298802, 2.8708045,
                2.6594782, 2.8674421, 1.5092852
            ],
            [
                2.0867379, 2.6000848, 3.5664442, 2.7012568, 3.4058318, 2.5726995, 3.4819791,
                2.5906503, 2.9419768, 1.9485993
            ],
            [
                1.2258643, 2.1866899, 2.281072, 2.9684978, 3.0550647, 2.6287956, 2.7715654,
                2.556528, 2.9531536, 1.4546292
            ],
            [
                0.9276193, 2.2581697, 1.3757176, 2.2365336, 2.1765282, 3.0850384, 2.8304024,
                2.4050653, 2.667025, 0.9228449
            ],
            [
                0.20690168, 1.1329551, 0.28867006, 1.2862762, 1.0121466, 1.4868947, 1.9529791,
                1.2301754, 1.3319608, 0.6957465
            ]
        ]
    ];
    let current_output14: Array3<f32> = conv_layer14.transposed_convolve(&test_input14);

    assert!(
        arr_allclose(&current_output14, &target_output14),
        "{:?} was not equal to {:?}",
        current_output14,
        target_output14
    );

    let test_input15 = array![[
        [
            0.16097161, 0.43652695, 0.17749044, 0.85863024, 0.65317434, 0.8535275, 0.31870112,
            0.5426858, 0.19828886, 0.7709755
        ],
        [
            0.1067149, 0.5376704, 0.89802533, 0.5788682, 0.7348713, 0.7336796, 0.98734075,
            0.4771963, 0.01627225, 0.12886034
        ],
        [
            0.5318864, 0.34410888, 0.42659935, 0.48874858, 0.6241891, 0.8955023, 0.46432868,
            0.2898024, 0.05392339, 0.32702622
        ],
        [
            0.26965246, 0.6371434, 0.75393033, 0.76813185, 0.5162852, 0.8533213, 0.9542396,
            0.18988214, 0.45906848, 0.33289817
        ],
        [
            0.03320504, 0.11031762, 0.17383276, 0.3129896, 0.8559707, 0.9220503, 0.47989768,
            0.5442769, 0.6636685, 0.32367742
        ],
        [
            0.90966, 0.27162617, 0.6443874, 0.19808483, 0.66812706, 0.16283889, 0.70452964,
            0.31147507, 0.5187657, 0.9100076
        ],
        [
            0.6290827, 0.84165204, 0.20687214, 0.8623254, 0.39579085, 0.3352546, 0.48246926,
            0.7841352, 0.7743668, 0.20166141
        ],
        [
            0.6085826, 0.36106375, 0.65999043, 0.9062984, 0.12646432, 0.7171777, 0.7148895,
            0.19756947, 0.24275093, 0.02829744
        ],
        [
            0.7157591, 0.86293364, 0.88272506, 0.48441255, 0.6985572, 0.4710741, 0.18837613,
            0.5648491, 0.7189484, 0.9588915
        ],
        [
            0.3235977, 0.7131977, 0.1812861, 0.2607455, 0.95429844, 0.60492754, 0.13305853,
            0.43519333, 0.10764747, 0.3028979
        ],
        [
            0.59622556, 0.99331075, 0.32433406, 0.62541956, 0.10687612, 0.37056902, 0.01105776,
            0.87456894, 0.42201772, 0.3866705
        ],
        [
            0.32159325, 0.24344489, 0.16923992, 0.04785596, 0.84527344, 0.01050071, 0.6598645,
            0.3305712, 0.9055937, 0.4691476
        ],
        [
            0.4981539, 0.8642973, 0.26227382, 0.5329861, 0.9595665, 0.7396849, 0.85941637,
            0.97343796, 0.13750444, 0.9094289
        ],
        [
            0.4959437, 0.1819489, 0.17650132, 0.63172895, 0.03979215, 0.6403765, 0.20715363,
            0.6098088, 0.20690127, 0.70077306
        ],
        [
            0.19370347, 0.41493666, 0.52806395, 0.0175705, 0.67782885, 0.6033228, 0.1796121,
            0.89490646, 0.21748377, 0.9143094
        ]
    ]];

    let kernel15: Array4<f32> = Array::from_shape_vec(
        (3, 1, 3, 3),
        vec![
            0.13322055, 0.3065445, 0.6607921, 0.55148685, 0.565533, 0.6385681, 0.43889546,
            0.14746109, 0.8279241, 0.44854432, 0.92061514, 0.36675015, 0.76544756, 0.4375097,
            0.9218956, 0.12008844, 0.66456074, 0.95672625, 0.16496679, 0.08722926, 0.85512847,
            0.04930811, 0.88096887, 0.07710139, 0.49567017, 0.24437536, 0.56498146,
        ],
    )
    .unwrap();
    let conv_layer15 = TransposedConvolutionLayer::new(kernel15, 1, Padding::Same);
    let target_output15: Array3<f32> = array![
        [
            [
                0.35533032, 0.7880064, 1.2363033, 1.5232611, 1.514726, 1.5353923, 1.4025419,
                1.1133618, 0.66408235, 0.5434586
            ],
            [
                0.9555863, 1.604446, 2.2581275, 2.3518445, 3.095882, 2.9520278, 2.7693262,
                1.5326803, 1.4049475, 0.93578017
            ],
            [
                1.0633075, 1.9990726, 2.6406868, 2.9526837, 2.8684504, 3.2944813, 2.9627907,
                1.9664975, 1.0449587, 0.673726
            ],
            [
                0.94784904, 1.6717644, 1.822044, 2.144531, 2.794064, 3.1947877, 2.694955,
                1.5931431, 1.5281368, 0.9792175
            ],
            [
                1.1836584, 1.8837643, 2.2280142, 2.4019597, 2.8194845, 2.874584, 2.5170176,
                2.3467555, 1.7691678, 1.6031086
            ],
            [
                1.1508652, 1.4659115, 1.4727222, 1.9403443, 2.5133927, 2.4440405, 2.465097,
                2.369844, 2.50464, 1.7983739
            ],
            [
                1.7578655, 2.5387003, 1.9158919, 2.5473201, 1.7150656, 2.064806, 2.0885286,
                2.3320272, 2.0302048, 1.3609836
            ],
            [
                1.9224172, 2.5988736, 3.0331361, 2.379728, 2.2738316, 2.0954413, 2.0603073,
                2.1933947, 2.2241828, 1.6660502
            ],
            [
                1.5699949, 2.5941947, 2.541943, 2.1774752, 2.6372137, 2.2323997, 1.9268328,
                1.7587955, 1.4118322, 1.0816411
            ],
            [
                1.8900528, 3.0862472, 2.583986, 2.469986, 2.3047915, 1.7800039, 1.4666605,
                1.833855, 2.4463756, 1.7931901
            ],
            [
                1.5293802, 1.8901737, 1.6067067, 1.5947505, 1.9798161, 1.957702, 1.6149199,
                1.677352, 1.8223708, 1.2196406
            ],
            [
                1.6834682, 2.3094478, 2.1840284, 1.5865338, 2.1808772, 1.6088548, 2.296114,
                2.3407016, 2.5780005, 1.5570605
            ],
            [
                1.2106395, 1.5177122, 1.0417606, 1.7946304, 1.8188511, 2.3640463, 2.018546,
                2.529996, 2.137171, 2.0612092
            ],
            [
                1.3875768, 1.7519875, 2.031221, 1.9188089, 2.3166618, 2.9203553, 2.6860244,
                2.464172, 2.5509472, 1.7210779
            ],
            [
                0.6736665, 1.0685204, 1.0460002, 0.8714163, 1.5424602, 1.0749658, 1.5302936,
                1.2968841, 1.6352959, 1.1679324
            ]
        ],
        [
            [
                0.7951536, 1.2885385, 2.1698277, 1.9754926, 2.603261, 2.1936104, 2.264168, 1.12291,
                1.2847337, 0.5696742
            ],
            [
                1.4116509, 2.2730424, 2.7663798, 3.432833, 4.0564566, 4.2156653, 3.261239,
                2.0596144, 1.6503979, 1.2244556
            ],
            [
                1.3372598, 2.6821325, 3.4180098, 3.6443856, 3.7928605, 4.118816, 3.770293,
                2.3413672, 1.5595708, 0.6232213
            ],
            [
                1.3959842, 2.3009956, 2.6488702, 3.044426, 3.9997597, 4.211786, 3.2726758,
                2.6429605, 1.7989649, 1.1312561
            ],
            [
                1.4164848, 1.9584236, 2.6385524, 3.1879594, 3.5634027, 3.5655274, 3.7880774,
                2.9801052, 2.519689, 2.0876212
            ],
            [
                1.578167, 2.3263962, 1.6715996, 2.7612057, 2.557475, 3.5293798, 2.988667,
                3.2918487, 3.3003485, 1.923588
            ],
            [
                2.6160889, 2.979274, 3.3253474, 2.7529833, 2.4473717, 2.7864027, 2.7972512,
                2.8740013, 2.3777723, 1.9889032
            ],
            [
                2.4222262, 3.766078, 3.671845, 2.879725, 3.434885, 2.4495986, 2.4785018, 3.0309517,
                2.8498561, 1.9207895
            ],
            [
                2.368649, 3.4891093, 3.0332644, 3.6043882, 3.3410313, 2.5254188, 2.7028348,
                2.3866913, 2.2664056, 1.4004223
            ],
            [
                2.6764174, 3.475441, 3.258428, 3.2260094, 2.7510452, 2.4944882, 2.1376297,
                2.2026174, 2.7715333, 2.1225493
            ],
            [
                2.0905585, 2.4638484, 2.5031202, 1.7874665, 2.8120923, 2.1683385, 2.5718968,
                2.084956, 2.69182, 1.2997171
            ],
            [
                2.0477602, 2.9201736, 2.302203, 2.7075233, 2.3743606, 2.6886528, 2.4687755,
                3.2984655, 3.0454562, 2.2799368
            ],
            [
                1.8606222, 1.8228196, 2.0265942, 2.3295133, 2.6774359, 3.4007533, 3.0123332,
                2.9762578, 3.413422, 2.3494258
            ],
            [
                1.4950995, 2.5189903, 2.5057895, 1.9054196, 3.484163, 3.036245, 3.5459175,
                3.1691284, 3.2165787, 2.1400192
            ],
            [
                0.99068224, 1.5033624, 1.0914371, 1.7484827, 1.7395957, 1.5841757, 2.3306777,
                1.5473626, 2.5627682, 1.3885379
            ]
        ],
        [
            [
                0.27384856, 0.66693777, 0.7442188, 1.4516734, 1.3039024, 1.5026594, 1.0277535,
                1.0888779, 0.63314897, 0.7420818
            ],
            [
                0.60960364, 1.2054458, 2.2398, 1.8570731, 2.5389686, 2.0495744, 2.5761776,
                1.3078998, 1.3236234, 0.33182457
            ],
            [
                1.0850004, 1.6294636, 1.8502691, 2.2664247, 2.30551, 2.7534094, 2.0532238,
                1.5400995, 0.6995774, 0.5643674
            ],
            [
                0.6482355, 1.435374, 1.6470296, 1.9612466, 2.1564612, 2.3288257, 2.4257936,
                1.1455013, 1.2833081, 0.80605847
            ],
            [
                0.69416845, 1.5372319, 1.4814448, 1.7589407, 2.272478, 2.692242, 1.580472,
                2.0511396, 1.5033479, 1.0343735
            ],
            [
                1.0918353, 1.0811621, 1.5643567, 1.4549206, 2.1847625, 1.6255623, 2.0303226,
                1.7779955, 1.7080969, 1.7221524
            ],
            [
                1.0196018, 2.4275007, 1.1967022, 2.1881225, 1.4651017, 1.6426339, 1.4113662,
                2.1460593, 2.0001228, 0.8518691
            ],
            [
                1.5135096, 1.6645441, 2.5287569, 2.0692196, 1.5521116, 1.7876693, 2.055405,
                1.6049829, 1.4133927, 0.94094527
            ],
            [
                1.195123, 2.1736546, 2.4661338, 1.5144482, 2.18604, 1.8650069, 1.3378001,
                1.3382477, 1.2805756, 1.2280713
            ],
            [
                1.3336585, 2.3469791, 1.938096, 1.6999136, 2.0639703, 1.4428855, 1.3952023,
                1.3082942, 1.9402374, 1.0015221
            ],
            [
                1.3027447, 1.6412352, 1.3598236, 1.803821, 1.0846328, 1.5814762, 0.9930404,
                1.5035324, 1.4183302, 0.99995667
            ],
            [
                1.3670707, 1.3314122, 1.8630478, 0.7946849, 1.8692684, 1.0256605, 2.1404085,
                1.4626982, 2.416123, 1.0158533
            ],
            [
                0.8016916, 1.5351324, 0.8833774, 1.5646645, 1.5620401, 2.0892155, 1.7905103,
                2.419161, 1.524191, 1.5197053
            ],
            [
                1.3082777, 1.0728337, 1.4539745, 1.9873948, 1.3945909, 2.3213835, 2.1643014,
                1.4531174, 2.3358114, 0.96860963
            ],
            [
                0.40066898, 0.9041041, 1.2247566, 0.38610592, 1.5616547, 0.96181947, 1.2829696,
                1.1922307, 1.4497781, 1.0295517
            ]
        ]
    ];
    let current_output15: Array3<f32> = conv_layer15.transposed_convolve(&test_input15);

    assert!(
        arr_allclose(&current_output15, &target_output15),
        "{:?} was not equal to {:?}",
        current_output15,
        target_output15
    );

    let test_input16 = array![[
        [
            0.4136684, 0.8935469, 0.8386232, 0.5263492, 0.54115707, 0.9339751, 0.82197183,
            0.25728145, 0.12835145, 0.60473514
        ],
        [
            0.97797877, 0.5410458, 0.98580396, 0.5604931, 0.6352193, 0.16342546, 0.72779834,
            0.6951774, 0.28433612, 0.54881185
        ],
        [
            0.1912929, 0.87234914, 0.2699641, 0.68535745, 0.94819957, 0.13918376, 0.10763118,
            0.10393438, 0.22363693, 0.4814489
        ],
        [
            0.76189506, 0.95534325, 0.5359377, 0.46751156, 0.5256417, 0.5579358, 0.9816991,
            0.7613023, 0.24232449, 0.41208318
        ],
        [
            0.8834699, 0.46067682, 0.13800846, 0.36020854, 0.10404445, 0.8620727, 0.5145216,
            0.12440164, 0.5279104, 0.41590992
        ],
        [
            0.29517242, 0.70710874, 0.24709526, 0.1217574, 0.6515966, 0.4712269, 0.2523526,
            0.84618956, 0.5318919, 0.03532711
        ],
        [
            0.11363855, 0.8289518, 0.9873352, 0.9123356, 0.9491929, 0.02088014, 0.4174027,
            0.6389172, 0.38801014, 0.3914449
        ],
        [
            0.5332051, 0.30564278, 0.5088338, 0.09429541, 0.8243076, 0.59343904, 0.3554586,
            0.01728052, 0.3149185, 0.6463057
        ],
        [
            0.1773973, 0.10563535, 0.9957457, 0.83141977, 0.07924508, 0.6610247, 0.30809724,
            0.7254498, 0.78890646, 0.92907035
        ],
        [
            0.02664311, 0.0423031, 0.81839705, 0.7412857, 0.5599512, 0.29510012, 0.86310244,
            0.07239962, 0.11448776, 0.07260405
        ],
        [
            0.5729233, 0.30392584, 0.4336298, 0.22826639, 0.3717919, 0.3870818, 0.5891368,
            0.8010011, 0.03515592, 0.43047452
        ],
        [
            0.88590705, 0.9492649, 0.04157029, 0.83084995, 0.6477173, 0.8861909, 0.13245371,
            0.9442573, 0.5681286, 0.5451318
        ],
        [
            0.4209538, 0.58699656, 0.46091163, 0.06856077, 0.8246437, 0.83686614, 0.8089775,
            0.78756964, 0.3360227, 0.30177003
        ],
        [
            0.06824324, 0.33649302, 0.34435576, 0.6780542, 0.98894477, 0.75053316, 0.7147914,
            0.33843812, 0.84122545, 0.6135419
        ],
        [
            0.8405191, 0.30047426, 0.05456006, 0.41162473, 0.73265046, 0.9619764, 0.37300164,
            0.36128372, 0.26401687, 0.78292054
        ]
    ]];

    let kernel16: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.3113686, 0.97378665, 0.7915016, 0.9491195, 0.7977237, 0.651845, 0.33312482,
            0.7887627, 0.83173686, 0.0604596, 0.77457815, 0.04165471, 0.3056242, 0.02631989,
            0.5490322, 0.09713693, 0.813069, 0.7230678, 0.14105903, 0.80495673, 0.13341244,
            0.7144687, 0.36670473, 0.58845115, 0.24821945, 0.6641698, 0.5357271, 0.03655309,
            0.7467129, 0.65498686, 0.66267097, 0.60719943, 0.27294084, 0.30453217, 0.41659123,
            0.1920016, 0.96724224, 0.4988932, 0.83074075, 0.63144207, 0.69900095, 0.27700076,
            0.7080165, 0.20407276, 0.6525301, 0.11087482, 0.86433923, 0.6076395, 0.64478624,
            0.15407856,
        ],
    )
    .unwrap();
    let conv_layer16 = TransposedConvolutionLayer::new(kernel16, 1, Padding::Same);
    let target_output16: Array3<f32> = array![
        [
            [
                3.476797, 4.4258366, 4.943925, 5.178069, 5.1517315, 3.958744, 2.915784, 3.3671823,
                2.7950654, 1.5312122
            ],
            [
                4.9971676, 5.630758, 6.425783, 6.088125, 5.9390364, 6.003624, 4.6584926, 4.590698,
                3.3080087, 1.5341097
            ],
            [
                5.2211933, 5.8964047, 8.114991, 7.2481914, 7.0059233, 7.12253, 5.5609684, 5.663011,
                4.2996626, 2.4579391
            ],
            [
                4.8446198, 6.061227, 7.206157, 6.746086, 6.1650867, 5.7094646, 5.9228764,
                6.5911098, 3.903596, 2.1158164
            ],
            [
                3.863313, 5.442761, 7.4683013, 6.6640363, 6.25914, 6.222925, 5.8512297, 4.828824,
                3.6401763, 2.9822574
            ],
            [
                4.2975326, 4.85121, 6.831257, 6.623879, 7.0173573, 6.811204, 5.759512, 5.59338,
                4.267995, 2.7963686
            ],
            [
                4.059306, 5.1921024, 7.0406556, 7.1232862, 5.133945, 5.7829084, 6.8285046,
                5.9234076, 3.7211504, 3.08093
            ],
            [
                4.1535254, 5.507406, 6.381022, 6.6516848, 6.1382017, 6.6967206, 6.2016864,
                5.0641723, 3.8688684, 2.805628
            ],
            [
                4.166046, 5.196793, 6.03138, 6.4997416, 7.7093105, 5.772797, 5.4071207, 6.2580676,
                4.3922315, 2.4693983
            ],
            [
                4.3093133, 5.5649176, 5.650094, 6.0397305, 6.8653016, 6.7139487, 5.4335437,
                6.4916196, 3.9742157, 2.528991
            ],
            [
                3.714612, 5.743345, 6.1028166, 6.6160536, 6.7812195, 7.740317, 6.705286, 5.855387,
                4.5858045, 3.3673077
            ],
            [
                3.4432049, 4.2626047, 6.789143, 7.4810877, 7.685265, 7.3795547, 7.1817646,
                6.096667, 5.0059724, 3.0118701
            ],
            [
                3.8017876, 4.0336647, 6.529512, 7.4798183, 6.9239616, 8.1059885, 7.756269,
                7.4164653, 4.547674, 3.369218
            ],
            [
                2.2607765, 4.498261, 6.144947, 6.7744765, 6.1248574, 7.005183, 6.8108883,
                6.4080496, 4.0647416, 2.93507
            ],
            [
                1.7798616, 2.7605605, 4.5380383, 4.6858554, 4.5408263, 4.846323, 4.9968767,
                4.9465675, 3.134544, 1.5282865
            ]
        ],
        [
            [
                3.077614, 3.6151743, 5.8619037, 4.4750557, 4.4028325, 3.9413743, 3.7882915,
                3.3954895, 2.7871666, 2.0196571
            ],
            [
                3.9082508, 5.536545, 6.4617853, 6.9636636, 6.371254, 5.557307, 4.9088345, 4.506304,
                3.6904361, 2.5423677
            ],
            [
                5.4101696, 6.313101, 7.8066015, 7.4152827, 7.9429703, 6.8879027, 6.9360943,
                5.87499, 4.088935, 3.5155115
            ],
            [
                4.67278, 5.848504, 7.1587667, 6.717985, 5.6312585, 6.2961097, 6.037446, 5.856104,
                4.753186, 3.1199975
            ],
            [
                4.6307616, 6.0844245, 7.5056553, 6.5827904, 6.1609054, 6.35006, 5.776943, 5.820748,
                4.134158, 3.335586
            ],
            [
                4.341747, 5.8902907, 6.770009, 7.3448467, 6.3603516, 6.3794403, 6.3700404,
                5.9997797, 4.6135154, 3.3619583
            ],
            [
                3.5435917, 4.9306307, 5.662702, 6.7457294, 6.979405, 5.71875, 6.6047974, 5.766654,
                4.778945, 3.7055764
            ],
            [
                3.4408195, 5.450644, 6.785613, 6.42512, 7.0013547, 6.9449816, 5.800913, 5.895807,
                4.355269, 3.718197
            ],
            [
                3.2228036, 4.5151772, 6.8998017, 6.422813, 7.554807, 6.136409, 5.5136986, 4.966422,
                4.76659, 3.0345588
            ],
            [
                3.572888, 4.372272, 6.2219453, 6.137442, 6.596227, 6.9472756, 6.4312162, 6.410157,
                4.6433287, 3.9030366
            ],
            [
                4.070462, 5.0609846, 6.387373, 7.585582, 6.690296, 7.28503, 7.104614, 6.87663,
                5.3159547, 3.9508958
            ],
            [
                3.6406832, 4.476822, 6.7151747, 6.7538986, 7.858518, 7.4905844, 7.3126907,
                7.0830374, 4.477206, 4.0699773
            ],
            [
                3.067099, 5.0890436, 5.885232, 7.344536, 6.6992106, 8.165293, 7.8335967, 7.931586,
                5.79143, 3.9567592
            ],
            [
                3.0178525, 3.6161733, 5.1409698, 5.6709275, 6.3361053, 7.1293983, 6.625853,
                6.3465705, 4.6901183, 3.9375296
            ],
            [
                1.7318723, 2.5618453, 3.5411363, 3.699995, 4.425542, 5.0266547, 5.2686253,
                4.2465944, 3.219942, 2.2278008
            ]
        ]
    ];
    let current_output16: Array3<f32> = conv_layer16.transposed_convolve(&test_input16);

    assert!(
        arr_allclose(&current_output16, &target_output16),
        "{:?} was not equal to {:?}",
        current_output16,
        target_output16
    );

    let test_input17 = array![[
        [
            0.8016741, 0.86261696, 0.7954708, 0.64605474, 0.05995506, 0.9807167, 0.8921567,
            0.2898572, 0.66831106, 0.50166804
        ],
        [
            0.70505136, 0.80674213, 0.44505036, 0.67376214, 0.45553896, 0.88837534, 0.9566226,
            0.6476962, 0.20270044, 0.28030363
        ],
        [
            0.22960758, 0.72196466, 0.21384446, 0.53872055, 0.91090715, 0.70740473, 0.47642905,
            0.46838176, 0.57517195, 0.66118985
        ],
        [
            0.77817184, 0.8586358, 0.27843636, 0.5360412, 0.71417475, 0.75883436, 0.5165504,
            0.66596746, 0.16817366, 0.11748104
        ],
        [
            0.13227384, 0.95457476, 0.03376469, 0.7347739, 0.515693, 0.02647051, 0.6987516,
            0.56806874, 0.9742489, 0.04654682
        ],
        [
            0.0333183, 0.34091827, 0.738161, 0.1581235, 0.55792224, 0.68412864, 0.4111251,
            0.77551204, 0.20818521, 0.7692539
        ],
        [
            0.4709155, 0.74194837, 0.38542065, 0.17033957, 0.18400495, 0.07596095, 0.9137559,
            0.6551212, 0.78268474, 0.09378912
        ],
        [
            0.79123646, 0.8989737, 0.9056562, 0.46766227, 0.12010345, 0.94773036, 0.40417555,
            0.9171418, 0.19337696, 0.5100263
        ],
        [
            0.420959, 0.04445668, 0.70967996, 0.834394, 0.93230313, 0.7748583, 0.95655316,
            0.30799982, 0.29142946, 0.7788677
        ],
        [
            0.8405465, 0.8001422, 0.8848049, 0.24018444, 0.42975077, 0.21906808, 0.18688926,
            0.84739804, 0.942533, 0.6681535
        ],
        [
            0.4622333, 0.96831536, 0.13454512, 0.7119674, 0.10851607, 0.24261515, 0.34147784,
            0.18652019, 0.8795614, 0.8344357
        ],
        [
            0.66578376, 0.01294852, 0.7240502, 0.6016285, 0.17695533, 0.43573812, 0.0102322,
            0.9228925, 0.18716797, 0.28005707
        ],
        [
            0.14532647, 0.3943177, 0.15734959, 0.63961166, 0.50983715, 0.63043636, 0.5031585,
            0.2069102, 0.44692338, 0.27018595
        ],
        [
            0.9117209, 0.3642911, 0.69016, 0.6502609, 0.0944013, 0.9535295, 0.07374734, 0.41383052,
            0.7335253, 0.7283538
        ],
        [
            0.72061443, 0.31086606, 0.8423357, 0.22034271, 0.27988735, 0.44744346, 0.24040897,
            0.76424694, 0.06748126, 0.96815175
        ]
    ]];

    let kernel17: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.6182161, 0.43435308, 0.16651273, 0.04372919, 0.7047529, 0.69322646, 0.9504424,
            0.86605227, 0.30986252, 0.8063971, 0.8690156, 0.25764176, 0.02262197, 0.85024196,
            0.93472266, 0.9636931, 0.03737255, 0.04802335, 0.9055894, 0.13240665, 0.6309176,
            0.7395734, 0.62679535, 0.37828344, 0.3716973, 0.9284846, 0.03397404, 0.5529969,
            0.9943206, 0.4156047, 0.50239325, 0.672305, 0.50070584, 0.58630747, 0.64933586,
            0.4474458, 0.18986748, 0.6716382, 0.68489236, 0.76187724, 0.9169488, 0.34488037,
            0.5100098, 0.7890328, 0.09755067, 0.46884784, 0.9260492, 0.08584987, 0.11251308,
            0.40765193,
        ],
    )
    .unwrap();
    let conv_layer17 = TransposedConvolutionLayer::new(kernel17, 1, Padding::Same);
    let target_output17: Array3<f32> = array![
        [
            [
                2.871604, 3.1343124, 4.5989375, 4.6129565, 5.4910417, 5.637979, 4.138114,
                4.6204457, 3.7831953, 2.2083206
            ],
            [
                4.054265, 4.9362206, 6.646757, 6.836028, 5.98066, 6.5489383, 6.4471793, 5.7340536,
                4.5434537, 2.786031
            ],
            [
                5.4756026, 5.9857106, 7.4849243, 8.051194, 7.195709, 7.941979, 8.157488, 7.4101596,
                5.942702, 3.5350256
            ],
            [
                4.5367503, 4.519908, 6.407054, 7.800305, 6.9592285, 8.589755, 8.06775, 6.6683054,
                5.170621, 4.044909
            ],
            [
                4.5377865, 5.311769, 6.014035, 6.6980786, 6.2807317, 6.996829, 7.5584035, 7.337945,
                5.886237, 3.8049123
            ],
            [
                5.309249, 6.2665915, 6.344141, 7.3253665, 6.958443, 6.911407, 7.0668883, 6.6731133,
                5.7710247, 3.7759843
            ],
            [
                4.08787, 5.189276, 6.131807, 7.1820784, 7.689368, 7.984583, 8.003855, 7.359711,
                5.820726, 3.9388804
            ],
            [
                4.7117796, 6.4658227, 7.6877217, 6.5151553, 7.037902, 6.3847146, 6.7623224,
                7.714708, 7.198449, 5.129836
            ],
            [
                4.9847007, 6.746653, 7.290904, 6.1165533, 5.8669925, 5.991524, 7.371957, 7.3092413,
                6.620761, 4.1397057
            ],
            [
                5.497849, 5.775721, 6.4132457, 7.039706, 6.487044, 7.1606846, 6.607149, 7.2453604,
                5.283265, 3.869231
            ],
            [
                3.797497, 5.227892, 7.712741, 6.651619, 6.8552732, 6.585162, 5.9104757, 6.252997,
                5.5578685, 4.35905
            ],
            [
                4.852324, 6.4262357, 7.145598, 5.8956914, 5.7546678, 5.2041354, 6.0248394,
                6.5726185, 5.542961, 5.0749273
            ],
            [
                4.5238466, 5.450921, 6.238928, 6.000074, 5.5004816, 5.0409727, 4.765758, 7.143702,
                5.870845, 3.7894213
            ],
            [
                2.6937013, 3.4130642, 4.5781956, 3.4290965, 4.69941, 4.133259, 3.9129136,
                4.7832146, 3.2256181, 2.470583
            ],
            [
                1.9087402, 3.15098, 3.3187008, 3.5645158, 3.684039, 3.1263838, 3.2228143,
                2.6125977, 3.1294525, 2.3328962
            ]
        ],
        [
            [
                2.7656069, 3.6034298, 4.865518, 4.7410345, 4.582795, 5.045189, 5.0296955, 4.648275,
                3.5030565, 2.468445
            ],
            [
                4.5436907, 5.942636, 6.218712, 7.0877542, 6.615045, 6.73411, 7.062059, 5.7976003,
                3.9134595, 2.527426
            ],
            [
                4.8384547, 6.4515476, 7.889757, 7.3917456, 8.017329, 8.412642, 7.8093147,
                6.8823066, 5.272645, 3.6455138
            ],
            [
                4.6852837, 4.973791, 6.8762136, 7.9656596, 6.862955, 8.612841, 7.2513266,
                6.7865596, 4.992877, 3.448174
            ],
            [
                3.8332431, 5.6587834, 5.9532857, 6.2724056, 7.140426, 6.589307, 7.2670727,
                6.4937696, 5.5337954, 3.6186023
            ],
            [
                4.7991357, 5.9303894, 6.8858843, 7.0803747, 6.444317, 7.0333223, 6.8802705,
                6.740204, 5.31416, 3.6612582
            ],
            [
                4.2472405, 5.548424, 6.5284147, 7.1226826, 7.4387307, 7.2944846, 7.632805,
                7.9257765, 5.6725106, 3.4318438
            ],
            [
                4.9102154, 6.2578726, 6.7401614, 5.913831, 6.494732, 7.4606566, 7.7135954,
                7.4529023, 6.1928906, 4.292078
            ],
            [
                5.2134933, 6.86018, 7.047786, 7.154966, 6.6241527, 6.126332, 7.1776953, 6.990047,
                5.3565187, 4.222125
            ],
            [
                5.757469, 6.6913714, 7.255414, 7.346232, 6.5361643, 7.224475, 5.7154922, 6.9631557,
                5.3394914, 3.9456983
            ],
            [
                4.007763, 5.920447, 7.050135, 5.857902, 6.514398, 6.0259066, 6.7350173, 6.3908854,
                5.3206215, 4.6691465
            ],
            [
                4.9296274, 6.426166, 6.0444846, 6.0096073, 5.189792, 4.9203987, 6.292201,
                7.1747017, 5.237513, 4.185282
            ],
            [
                4.3045993, 5.79178, 5.835706, 6.158482, 5.420591, 5.5889707, 4.795756, 6.3024487,
                5.145298, 3.2959528
            ],
            [
                2.8545938, 4.2041306, 4.803219, 4.5807953, 4.7080307, 3.9747565, 4.396639,
                4.1481323, 3.327681, 2.9824584
            ],
            [
                3.061872, 3.82261, 3.2338824, 4.282688, 3.150883, 3.4641156, 3.5919425, 3.7129023,
                2.9459832, 2.2082486
            ]
        ]
    ];
    let current_output17: Array3<f32> = conv_layer17.transposed_convolve(&test_input17);

    assert!(
        arr_allclose(&current_output17, &target_output17),
        "{:?} was not equal to {:?}",
        current_output17,
        target_output17
    );

    let test_input18 = array![[
        [
            0.17353919, 0.33252022, 0.25156298, 0.7678708, 0.89477503, 0.9611603, 0.2584334,
            0.77774405, 0.47068268, 0.85400444
        ],
        [
            0.9144536, 0.61077875, 0.8785097, 0.7574408, 0.4954274, 0.47404, 0.4781282, 0.23264736,
            0.39994144, 0.28322014
        ],
        [
            0.6595697, 0.6695507, 0.26484334, 0.07841692, 0.26816803, 0.80713356, 0.41487375,
            0.65040874, 0.7694563, 0.7382574
        ],
        [
            0.41042215, 0.13615583, 0.27915764, 0.7944226, 0.26580366, 0.73352826, 0.74481,
            0.83931226, 0.23283575, 0.53357714
        ],
        [
            0.40468675, 0.31377843, 0.8417058, 0.9437492, 0.9073558, 0.06908223, 0.04756542,
            0.46796426, 0.19377978, 0.8793519
        ],
        [
            0.33400342, 0.49993458, 0.01247511, 0.74934983, 0.6188354, 0.4234197, 0.9426475,
            0.37172455, 0.20224409, 0.08899162
        ],
        [
            0.83086103, 0.0117837, 0.84677, 0.19534236, 0.8178868, 0.44404784, 0.49013674,
            0.19165154, 0.98517054, 0.6858654
        ],
        [
            0.3838873, 0.2697825, 0.95347905, 0.5210683, 0.31000102, 0.49730715, 0.7098068,
            0.3898303, 0.54669076, 0.42960298
        ],
        [
            0.6042778, 0.25360516, 0.21147917, 0.0578304, 0.61881435, 0.19406554, 0.28450665,
            0.38654825, 0.83438194, 0.15709557
        ],
        [
            0.9120065, 0.19315188, 0.76291627, 0.66323906, 0.93848145, 0.9691808, 0.2608721,
            0.1898083, 0.1404447, 0.8704932
        ],
        [
            0.80305505, 0.01738684, 0.5236315, 0.5286083, 0.5420976, 0.82708055, 0.76773685,
            0.10310049, 0.31399414, 0.24261041
        ],
        [
            0.93551165, 0.99139625, 0.82426167, 0.9217408, 0.87250656, 0.5906818, 0.19400844,
            0.8361353, 0.34580576, 0.38326237
        ],
        [
            0.22822227, 0.2997108, 0.12596802, 0.42147854, 0.69587576, 0.3810742, 0.5245919,
            0.79646397, 0.01983257, 0.9454492
        ],
        [
            0.21176444, 0.4242356, 0.4732979, 0.34714478, 0.21170487, 0.18608356, 0.8557056,
            0.4311561, 0.17854515, 0.89127535
        ],
        [
            0.65434945, 0.5596335, 0.4344192, 0.584112, 0.95443475, 0.06028856, 0.24475269,
            0.04049677, 0.34307075, 0.4399609
        ]
    ]];

    let kernel18: Array4<f32> = Array::from_shape_vec(
        (2, 1, 5, 5),
        vec![
            0.5071757, 0.7518163, 0.90593505, 0.8473352, 0.7044217, 0.48675612, 0.5187626,
            0.2478143, 0.76889366, 0.73484224, 0.28900972, 0.03879812, 0.75820905, 0.88520765,
            0.11304509, 0.07477583, 0.2748425, 0.7407, 0.11028086, 0.7625566, 0.49100062,
            0.05269502, 0.3763243, 0.8828995, 0.26070574, 0.6489643, 0.79309964, 0.71815443,
            0.762946, 0.1583295, 0.37510982, 0.32861403, 0.46441203, 0.73681784, 0.72865117,
            0.7512636, 0.8596665, 0.3967431, 0.07021335, 0.20876752, 0.570997, 0.981881,
            0.14502364, 0.27177867, 0.61020744, 0.8037078, 0.90339637, 0.43053117, 0.01441014,
            0.7898905,
        ],
    )
    .unwrap();
    let conv_layer18 = TransposedConvolutionLayer::new(kernel18, 1, Padding::Same);
    let target_output18: Array3<f32> = array![
        [
            [
                2.1055403, 2.8503761, 3.1434176, 3.813694, 3.5099373, 3.8901691, 3.4788296,
                3.9832208, 2.3274875, 2.0122526
            ],
            [
                3.1615431, 4.214324, 5.14554, 6.186324, 5.6593833, 6.049366, 5.536854, 5.894102,
                3.4818418, 2.9511938
            ],
            [
                4.363634, 5.85682, 7.4505377, 6.864944, 6.6326003, 6.9413013, 6.846236, 6.1822963,
                4.8631935, 3.1602232
            ],
            [
                4.249437, 5.902269, 5.9873867, 6.569445, 6.0870585, 6.6866584, 5.8180423, 6.890271,
                4.6401362, 2.938533
            ],
            [
                3.5618107, 4.7411184, 6.671238, 6.02277, 6.863414, 6.8741055, 5.9898233, 6.6554637,
                4.4089184, 3.5097954
            ],
            [
                3.4450433, 5.820762, 6.5878334, 6.0707016, 7.431665, 6.307219, 6.290844, 6.131936,
                4.2166576, 2.6907144
            ],
            [
                4.2369075, 5.0155725, 6.3405113, 6.2590446, 6.052122, 6.0244207, 6.4137025,
                5.004815, 4.276217, 2.6053717
            ],
            [
                4.1562023, 4.1249866, 7.3476686, 5.822173, 7.2808833, 5.714533, 6.505649,
                6.2845435, 4.3893085, 2.6346128
            ],
            [
                3.9821239, 5.335832, 6.3271184, 6.0190043, 6.391784, 5.652107, 5.895252, 5.917637,
                4.554631, 2.7727046
            ],
            [
                4.857743, 5.621189, 6.8237114, 7.2317915, 6.9558907, 5.869963, 6.1650147,
                5.7769427, 3.2251, 2.6232247
            ],
            [
                4.539505, 5.1173263, 7.2113132, 6.9103894, 6.4849577, 6.4788504, 6.1824727,
                5.7189007, 3.5224102, 2.9835227
            ],
            [
                4.418887, 6.184975, 7.780139, 7.4276347, 7.555917, 7.4808154, 5.5352726, 5.7106376,
                4.7471104, 2.0235293
            ],
            [
                4.388645, 5.8759327, 7.0457835, 6.828266, 6.9813986, 6.753591, 5.447096, 6.559501,
                3.462923, 2.7196977
            ],
            [
                3.290888, 4.6012692, 5.901107, 5.264479, 4.95116, 5.0524383, 4.798032, 5.2994456,
                3.56761, 3.1510813
            ],
            [
                2.2778382, 3.200151, 4.2007723, 3.322535, 4.150645, 4.2178054, 3.4885132,
                3.5210745, 3.578757, 2.1219008
            ]
        ],
        [
            [
                3.0060587, 4.167595, 5.359645, 5.5670285, 4.7359715, 4.8403506, 4.775465, 5.187462,
                3.4644737, 3.104988
            ],
            [
                3.2641351, 4.4979396, 5.70458, 5.8830404, 5.2058945, 5.926263, 5.9647937, 6.504927,
                4.777608, 3.655734
            ],
            [
                3.8526044, 5.1742215, 6.281685, 7.046187, 7.5135655, 7.5956154, 7.0531573,
                7.467372, 5.2805414, 4.4892044
            ],
            [
                3.5084136, 5.48997, 6.921238, 7.330725, 8.053135, 7.9958405, 6.3590956, 6.1633463,
                4.485984, 3.2141504
            ],
            [
                3.5598235, 5.216188, 7.0337677, 5.9036784, 7.2966146, 6.5661597, 7.2723365,
                6.858486, 5.565539, 3.6714194
            ],
            [
                3.9026093, 5.247827, 7.4165077, 6.102869, 7.204312, 6.7236304, 7.016944, 6.44461,
                5.976781, 3.94055
            ],
            [
                3.6521573, 4.4285345, 7.118557, 6.2271476, 7.3332644, 6.0015864, 6.614936,
                5.280857, 4.9171963, 3.3989284
            ],
            [
                4.134638, 4.7243876, 6.8661137, 6.1384645, 6.526678, 6.888278, 6.816362, 6.4589243,
                4.646267, 3.362071
            ],
            [
                4.180903, 5.558062, 6.960931, 6.7510347, 7.6954656, 6.982738, 7.31955, 6.739995,
                4.0948057, 2.9319642
            ],
            [
                4.5387263, 6.0704193, 8.053735, 7.9552326, 7.9977794, 7.387361, 6.874327, 6.913721,
                4.2904, 3.189424
            ],
            [
                3.9849374, 6.109646, 7.9119763, 8.039869, 7.236682, 7.127038, 6.120552, 6.4203224,
                4.7040157, 3.9215868
            ],
            [
                3.3641188, 5.5399523, 6.748507, 6.9052916, 7.6134567, 7.160844, 6.2527733,
                6.8066454, 4.7314234, 3.7532268
            ],
            [
                3.6887221, 5.4460907, 7.105097, 6.1748433, 6.69699, 6.3010883, 5.8478565, 6.099325,
                4.522055, 3.0674906
            ],
            [
                3.0930555, 4.419555, 6.377539, 5.4960747, 5.742496, 5.463914, 4.7098536, 3.901626,
                3.5530233, 2.3515174
            ],
            [
                1.8060175, 1.9994382, 2.8675573, 2.4482923, 2.6228688, 2.9370697, 2.824758,
                2.581407, 2.8438559, 1.1976576
            ]
        ]
    ];
    let current_output18: Array3<f32> = conv_layer18.transposed_convolve(&test_input18);

    assert!(
        arr_allclose(&current_output18, &target_output18),
        "{:?} was not equal to {:?}",
        current_output18,
        target_output18
    );

    let test_input19 = array![
        [
            [0.5355124, 0.84630895, 0.49395442, 0.3147789, 0.6582433, 0.784836],
            [0.1510672, 0.4232979, 0.16708443, 0.98063123, 0.34932786, 0.85616636],
            [0.6583108, 0.60454917, 0.59448457, 0.49652183, 0.19938153, 0.7128695],
            [0.76311034, 0.12619635, 0.459534, 0.73609304, 0.4552275, 0.27430528],
            [0.42199707, 0.60537076, 0.22874044, 0.17153989, 0.18029414, 0.5190589],
            [0.36979613, 0.22644468, 0.56790537, 0.0774854, 0.54487514, 0.52285326]
        ],
        [
            [0.28804025, 0.9463059, 0.4528455, 0.67754716, 0.5196255, 0.3579118],
            [0.40998468, 0.01620401, 0.9176275, 0.62317073, 0.6095291, 0.53925425],
            [0.99580085, 0.1331574, 0.7353108, 0.349883, 0.58402663, 0.57381994],
            [0.08381489, 0.71979916, 0.2610332, 0.7119416, 0.96576446, 0.6926377],
            [0.8609173, 0.7492103, 0.8629023, 0.6507571, 0.00374019, 0.43869576],
            [0.48209462, 0.13357504, 0.3744447, 0.9231667, 0.25001043, 0.96148133]
        ],
        [
            [0.6287099, 0.48406196, 0.6336668, 0.59469455, 0.9272982, 0.54603785],
            [0.13363586, 0.38365367, 0.33317754, 0.54434067, 0.9275121, 0.5489717],
            [0.07616951, 0.06364463, 0.5037747, 0.118681, 0.7910732, 0.8923332],
            [0.05960295, 0.43817315, 0.50985104, 0.65321445, 0.09364624, 0.2547052],
            [0.6622652, 0.21316499, 0.09515282, 0.25465712, 0.89676255, 0.5403188],
            [0.19572686, 0.13148713, 0.2641501, 0.81448007, 0.07326905, 0.12440559]
        ]
    ];

    let kernel19: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.60326093, 0.50336874, 0.732334, 0.67789745, 0.14069028, 0.32648215, 0.8716004,
            0.7169897, 0.69570976, 0.64410526, 0.60836405, 0.06947965, 0.6603661, 0.3958578,
            0.51584345, 0.7992338, 0.9854483, 0.52205783, 0.67180043, 0.9368436, 0.51900643,
            0.02719556, 0.15868023, 0.6585252, 0.9973709, 0.4708774, 0.3785762, 0.37369972,
            0.8820694, 0.3584239, 0.46797603, 0.33649433, 0.5825495, 0.23564331, 0.8616439,
            0.9941346, 0.9191673, 0.28123403, 0.6585091, 0.43712795, 0.18253075, 0.9981349,
            0.8245835, 0.22564544, 0.601965, 0.1018929, 0.9844645, 0.95680404, 0.35278338,
            0.06435335, 0.6966015, 0.95331305, 0.09583493, 0.6981093,
        ],
    )
    .unwrap();
    let conv_layer19 = TransposedConvolutionLayer::new(kernel19, 1, Padding::Same);
    let target_output19: Array3<f32> = array![
        [
            [2.64464, 4.468503, 6.0958443, 6.550718, 6.5360737, 4.42754],
            [4.0604687, 7.338644, 7.1906343, 8.937914, 8.83118, 5.9056163],
            [3.2112966, 6.135779, 6.824254, 8.377257, 9.481346, 5.3039217],
            [4.1892743, 7.345431, 7.299734, 6.476841, 7.3129683, 5.24565],
            [3.0522914, 6.434539, 6.8230863, 6.7312417, 7.480894, 4.099128],
            [2.2163699, 3.694214, 3.7680736, 3.7039158, 4.398579, 2.3639073]
        ],
        [
            [2.2716393, 4.0436335, 4.4028745, 5.3183494, 5.0801573, 3.4370427],
            [4.4419994, 7.501785, 7.894052, 8.545433, 8.528085, 5.940572],
            [3.3295336, 5.55905, 7.349389, 8.784552, 9.603219, 5.0764475],
            [4.560845, 7.895682, 6.8891773, 6.481072, 7.2793036, 5.0916767],
            [3.4781375, 5.751285, 6.4144063, 6.9522448, 8.298025, 3.7727616],
            [3.0725563, 4.8118157, 4.64023, 4.1344347, 3.9062953, 2.8165352]
        ]
    ];
    let current_output19: Array3<f32> = conv_layer19.transposed_convolve(&test_input19);

    assert!(
        arr_allclose(&current_output19, &target_output19),
        "{:?} was not equal to {:?}",
        current_output19,
        target_output19
    );

    let test_input20 = array![
        [
            [0.2069652, 0.07376958, 0.2294709, 0.31579313, 0.33869487, 0.47575933],
            [0.5857147, 0.04753572, 0.18346356, 0.5360474, 0.1858467, 0.64365137],
            [0.40849307, 0.7097346, 0.24728718, 0.3482015, 0.8173877, 0.36227778],
            [0.25395742, 0.20914847, 0.30944657, 0.31628296, 0.5160818, 0.50329995],
            [0.59146863, 0.7246801, 0.68792254, 0.33808804, 0.82763827, 0.7930527],
            [0.18008628, 0.35312355, 0.50524455, 0.21019965, 0.5517429, 0.5169359]
        ],
        [
            [0.5598076, 0.34688076, 0.39895424, 0.7609961, 0.9798868, 0.7951257],
            [0.13564406, 0.896192, 0.8122176, 0.19600911, 0.84066534, 0.83936906],
            [0.57498974, 0.80389476, 0.60667425, 0.37596557, 0.391024, 0.99213],
            [0.58918345, 0.79533595, 0.5658129, 0.0528274, 0.860633, 0.9990544],
            [0.18699598, 0.6060259, 0.47798222, 0.478308, 0.72988236, 0.6658512],
            [0.44785, 0.9226123, 0.6595738, 0.4751475, 0.07560957, 0.7602587]
        ],
        [
            [0.8904679, 0.1950909, 0.5793283, 0.21419428, 0.6157237, 0.14621958],
            [0.91224444, 0.71360004, 0.5201434, 0.48371077, 0.5511993, 0.51028204],
            [0.6851414, 0.73975414, 0.90205777, 0.15398078, 0.3985273, 0.9173873],
            [0.03889621, 0.29210058, 0.5723887, 0.66059166, 0.07154161, 0.5272695],
            [0.59904164, 0.01829243, 0.15631115, 0.653627, 0.5682244, 0.48060027],
            [0.04548458, 0.93498045, 0.8845066, 0.23969702, 0.40285116, 0.31280544]
        ]
    ];

    let kernel20: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.39572206, 0.5420097, 0.8969547, 0.7713848, 0.0354443, 0.915543, 0.55883676,
            0.59411937, 0.66782856, 0.83422446, 0.7984579, 0.90230983, 0.24819307, 0.45509672,
            0.18927146, 0.2588136, 0.39415058, 0.10628951, 0.19552688, 0.09579732, 0.6022107,
            0.36422288, 0.07335182, 0.5573934, 0.8595751, 0.579735, 0.9395968, 0.7526419,
            0.72409564, 0.9120392, 0.5658694, 0.5170288, 0.71761036, 0.5085142, 0.73565096,
            0.9019915, 0.74037707, 0.9558753, 0.24229282, 0.28037116, 0.5831479, 0.66420245,
            0.2615744, 0.95551175, 0.01882877, 0.38997126, 0.65857524, 0.40820357, 0.59943014,
            0.5404266, 0.22976574, 0.2188059, 0.88535124, 0.3082493,
        ],
    )
    .unwrap();
    let conv_layer20 = TransposedConvolutionLayer::new(kernel20, 1, Padding::Same);
    let target_output20: Array3<f32> = array![
        [
            [2.3867643, 4.050506, 3.1998286, 4.308417, 4.39515, 3.019768],
            [4.0510197, 7.1437974, 6.0716815, 6.76659, 7.185109, 4.5403814],
            [4.9349184, 6.60028, 5.839981, 6.894645, 7.4004173, 4.56728],
            [5.2452965, 7.286652, 5.981614, 6.982705, 8.226592, 5.2830935],
            [3.8341298, 5.7717867, 6.1402893, 6.746977, 7.2997828, 4.297902],
            [3.3498206, 4.6046457, 4.516157, 4.876815, 5.156762, 3.262593]
        ],
        [
            [3.3220394, 4.9315495, 4.1152306, 5.418162, 5.835062, 3.8597083],
            [5.4127727, 7.460607, 6.706828, 7.234272, 8.070487, 5.58111],
            [5.1504855, 7.9101377, 7.021369, 6.91001, 8.105486, 5.4636154],
            [5.323937, 7.204676, 6.840305, 7.7314296, 8.324702, 6.0499773],
            [4.5080757, 7.0418253, 6.80368, 6.8149652, 8.269386, 5.5987177],
            [3.633732, 5.860859, 6.0660496, 5.589216, 5.4804754, 3.7716715]
        ]
    ];
    let current_output20: Array3<f32> = conv_layer20.transposed_convolve(&test_input20);

    assert!(
        arr_allclose(&current_output20, &target_output20),
        "{:?} was not equal to {:?}",
        current_output20,
        target_output20
    );

    let test_input21 = array![
        [
            [0.16071312, 0.8359468, 0.22708985, 0.17599846, 0.14375284, 0.47631565],
            [0.2219139, 0.7007634, 0.62529135, 0.48909205, 0.4368913, 0.87737215],
            [0.8384918, 0.42826146, 0.2898846, 0.5985889, 0.70642775, 0.18215495],
            [0.8972815, 0.3877185, 0.90388066, 0.25849035, 0.27922356, 0.49311087],
            [0.3743787, 0.6541616, 0.17897265, 0.3831441, 0.7947806, 0.93560797],
            [0.582576, 0.54394794, 0.8609891, 0.19722052, 0.6163345, 0.5712354]
        ],
        [
            [0.5698664, 0.16279562, 0.12920256, 0.80265045, 0.4588713, 0.76312065],
            [0.30019793, 0.93926424, 0.8790254, 0.4823586, 0.5178633, 0.73625135],
            [0.8000134, 0.4544799, 0.26245162, 0.5131253, 0.38167936, 0.58934385],
            [0.3973784, 0.90141284, 0.03582105, 0.7948809, 0.32727262, 0.8275953],
            [0.95427305, 0.6115196, 0.11641497, 0.06941804, 0.05837393, 0.07343166],
            [0.5192801, 0.9167956, 0.21110035, 0.12763414, 0.42576945, 0.66916054]
        ],
        [
            [0.4924433, 0.53892326, 0.49379313, 0.460959, 0.7899721, 0.98074603],
            [0.94376725, 0.81427413, 0.4311838, 0.36272493, 0.5307518, 0.9816929],
            [0.04264403, 0.20135687, 0.9447678, 0.68336105, 0.67224157, 0.23696877],
            [0.34307224, 0.3005919, 0.24676771, 0.43225858, 0.7255951, 0.97501826],
            [0.97740525, 0.21789329, 0.29735002, 0.34527642, 0.9022015, 0.44412678],
            [0.5395859, 0.04653481, 0.6597161, 0.91931397, 0.6154949, 0.33268866]
        ]
    ];

    let kernel21: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.14686015, 0.4400883, 0.87996227, 0.20377532, 0.7939284, 0.5523168, 0.8613178,
            0.26729274, 0.82922995, 0.24622782, 0.8705143, 0.54647285, 0.16327019, 0.99609417,
            0.7862259, 0.12706757, 0.5417015, 0.2662801, 0.6055667, 0.32932517, 0.47560593,
            0.93928057, 0.79730123, 0.7368128, 0.3724561, 0.7301535, 0.7797681, 0.08497322,
            0.8564069, 0.48347974, 0.8502782, 0.21730231, 0.23967233, 0.52442354, 0.6364945,
            0.19164596, 0.09752543, 0.07949329, 0.05948856, 0.737559, 0.12181213, 0.01710567,
            0.32955936, 0.62790686, 0.7460198, 0.59271806, 0.30180663, 0.5777245, 0.2925438,
            0.02286196, 0.6774598, 0.42358264, 0.10448513, 0.94677526,
        ],
    )
    .unwrap();
    let conv_layer21 = TransposedConvolutionLayer::new(kernel21, 1, Padding::Same);
    let target_output21: Array3<f32> = array![
        [
            [3.582929, 4.552932, 4.4482017, 4.363945, 5.410754, 4.644914],
            [5.240677, 8.265332, 8.440431, 7.44998, 8.325394, 6.7038226],
            [5.749065, 8.020729, 7.8522115, 8.254972, 8.725995, 6.211588],
            [5.8093014, 6.673435, 6.8769298, 7.2348595, 8.057301, 6.3729477],
            [6.000701, 7.755844, 5.9246716, 6.9884157, 7.2335033, 5.95113],
            [5.1534443, 5.6849756, 4.420452, 4.779687, 5.970444, 4.509939]
        ],
        [
            [2.3270793, 3.6154773, 3.752325, 2.9020362, 3.7399747, 2.881878],
            [3.649543, 5.4322343, 5.204624, 5.4943733, 6.481861, 4.310805],
            [3.7625053, 6.3030086, 5.843473, 5.606726, 5.5418115, 4.6133804],
            [2.8920774, 5.853756, 4.7120214, 5.1283903, 5.346825, 3.7579625],
            [2.9629662, 5.442708, 5.420601, 4.440924, 5.7959504, 4.4375486],
            [2.0016892, 4.226569, 3.034183, 3.2149124, 3.1125083, 2.5136158]
        ]
    ];
    let current_output21: Array3<f32> = conv_layer21.transposed_convolve(&test_input21);

    assert!(
        arr_allclose(&current_output21, &target_output21),
        "{:?} was not equal to {:?}",
        current_output21,
        target_output21
    );

    let test_input22 = array![
        [
            [0.9687379, 0.92322344, 0.60917634, 0.9451985, 0.12409528, 0.6812841],
            [0.5716734, 0.501514, 0.22860546, 0.9221216, 0.44406584, 0.1542127],
            [0.16333881, 0.31131622, 0.7971575, 0.0189157, 0.22067957, 0.02669689],
            [0.59391546, 0.28938228, 0.6689486, 0.10160481, 0.6331741, 0.9803588],
            [0.5083739, 0.39784452, 0.23936197, 0.9575394, 0.6997954, 0.06163376],
            [0.6812974, 0.09791847, 0.5789042, 0.49879333, 0.3944524, 0.16723302]
        ],
        [
            [0.60669833, 0.5102383, 0.10125823, 0.66658473, 0.1792789, 0.30907264],
            [0.44471934, 0.20939837, 0.66946924, 0.8369222, 0.6604057, 0.74435735],
            [0.7769598, 0.9543384, 0.6829271, 0.0882941, 0.56812716, 0.00912788],
            [0.10915067, 0.3165255, 0.3737754, 0.5552311, 0.05621141, 0.16548331],
            [0.6846804, 0.25819537, 0.25772732, 0.53556776, 0.74136716, 0.6659698],
            [0.21283951, 0.02755238, 0.02189583, 0.67465585, 0.17141949, 0.78575313]
        ],
        [
            [0.6642049, 0.82216424, 0.9923351, 0.8543546, 0.82711905, 0.75170994],
            [0.5878099, 0.96511394, 0.8062506, 0.06538053, 0.5246861, 0.60359323],
            [0.04742145, 0.78252214, 0.75249714, 0.8335061, 0.4894486, 0.34004328],
            [0.600422, 0.40922362, 0.33826628, 0.14599253, 0.01791885, 0.7154418],
            [0.79670423, 0.76947504, 0.2814904, 0.67518514, 0.16034362, 0.9039926],
            [0.916309, 0.60018504, 0.53243697, 0.09806427, 0.00361243, 0.03235233]
        ]
    ];

    let kernel22: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.49200818, 0.3681149, 0.4396438, 0.95787215, 0.37022108, 0.90955853, 0.7056481,
            0.94783515, 0.8709594, 0.0721623, 0.91794163, 0.4659121, 0.15807042, 0.25671938,
            0.8856532, 0.2866567, 0.1975345, 0.48577997, 0.5902187, 0.8441279, 0.30328888,
            0.65129435, 0.3838251, 0.503942, 0.7598821, 0.23319262, 0.33190218, 0.5771382,
            0.31263727, 0.8175318, 0.80775326, 0.43170336, 0.4284459, 0.03569735, 0.12867416,
            0.9735616, 0.9887694, 0.7418273, 0.59953535, 0.99280035, 0.96741843, 0.37950197,
            0.35676008, 0.7895384, 0.75115925, 0.00821835, 0.814918, 0.5029724, 0.05695754,
            0.0843627, 0.2776464, 0.21576555, 0.6059579, 0.91037863, 0.96805364, 0.4876096,
            0.98833585, 0.59050095, 0.6782531, 0.46523637, 0.4099195, 0.5774845, 0.6141412,
            0.3716726, 0.79557914, 0.63609415, 0.7390209, 0.55386215, 0.77087414, 0.2666803,
            0.5302896, 0.93095535, 0.5577804, 0.7150617, 0.01458837, 0.5968529, 0.62382996,
            0.8447329, 0.4376318, 0.22782494, 0.40684053, 0.49241364, 0.4328468, 0.6973759,
            0.6630231, 0.5579211, 0.97683, 0.57523775, 0.43330702, 0.50330186, 0.8386838,
            0.58163697, 0.27874267, 0.9037382, 0.4729931, 0.10366911, 0.9334202, 0.5304671,
            0.99518436, 0.3447581, 0.10565407, 0.22962275, 0.9931405, 0.06514844, 0.53949547,
            0.7968866, 0.8797577, 0.25976428, 0.6619676, 0.08208053, 0.1369592, 0.2905277,
            0.4928286, 0.92351884, 0.19423583, 0.57817715, 0.6706675, 0.8414798, 0.26107648,
            0.85904396, 0.23807348, 0.33510026, 0.17900766, 0.0149483, 0.4646882, 0.08069148,
            0.70345616, 0.5307771, 0.4637487, 0.75979483, 0.9077784, 0.10171497, 0.29441157,
            0.42988262, 0.78537357, 0.40416926, 0.3542382, 0.64398175, 0.19943954, 0.28054148,
            0.5139561, 0.69631606, 0.07927214, 0.92005235, 0.10094947, 0.19631697, 0.9928459,
            0.875254, 0.34130776, 0.01140268,
        ],
    )
    .unwrap();
    let conv_layer22 = TransposedConvolutionLayer::new(kernel22, 1, Padding::Same);
    let target_output22: Array3<f32> = array![
        [
            [9.563608, 12.470879, 14.407964, 13.210915, 10.494987, 7.327014],
            [11.734943, 15.421508, 18.06157, 17.021004, 14.4844, 8.531069],
            [14.244809, 19.176865, 20.926283, 21.313002, 16.351753, 11.1257925],
            [13.084437, 15.971161, 18.889553, 18.619678, 15.137781, 11.156407],
            [9.60317, 12.49345, 15.573365, 14.050529, 10.25563, 7.067531],
            [6.402725, 9.491284, 10.112414, 9.783398, 7.135173, 6.64776]
        ],
        [
            [7.9116364, 11.0416565, 12.953979, 13.287649, 8.989695, 6.6064787],
            [10.403535, 13.644496, 15.870217, 16.048574, 12.652571, 8.63133],
            [12.093348, 16.000757, 20.01348, 17.416916, 14.843343, 10.063272],
            [11.286362, 14.410977, 16.106083, 16.58678, 13.396301, 8.943224],
            [7.949127, 11.768621, 14.720537, 13.008116, 9.6305065, 6.8036804],
            [5.788094, 7.54632, 8.606353, 8.846181, 8.456155, 5.5874324]
        ]
    ];
    let current_output22: Array3<f32> = conv_layer22.transposed_convolve(&test_input22);

    assert!(
        arr_allclose(&current_output22, &target_output22),
        "{:?} was not equal to {:?}",
        current_output22,
        target_output22
    );

    let test_input23 = array![
        [
            [0.57378316, 0.3978036, 0.00894329, 0.95121753, 0.26556554, 0.31038958],
            [0.02006488, 0.0167818, 0.8011431, 0.27580708, 0.4036131, 0.647578],
            [0.21416464, 0.7100218, 0.6356436, 0.39986217, 0.29731515, 0.50205034],
            [0.85981417, 0.85585725, 0.41005793, 0.00723796, 0.7881943, 0.9269198],
            [0.67294294, 0.06005982, 0.28755462, 0.2801387, 0.26798776, 0.3655915],
            [0.5372859, 0.8672521, 0.59903365, 0.21001084, 0.338777, 0.44548306]
        ],
        [
            [0.03939145, 0.265257, 0.05252068, 0.5745077, 0.27857375, 0.3941208],
            [0.17461438, 0.86797476, 0.6799679, 0.1374418, 0.2982574, 0.83746237],
            [0.44603807, 0.9126053, 0.04259554, 0.8214694, 0.39432475, 0.98196006],
            [0.57031125, 0.05324613, 0.9366997, 0.7745202, 0.88745564, 0.67198616],
            [0.83665967, 0.6227557, 0.4144875, 0.9889559, 0.49827063, 0.00932433],
            [0.11335411, 0.79387134, 0.13115895, 0.84061015, 0.57639503, 0.35614994]
        ],
        [
            [0.77315617, 0.35688344, 0.9027217, 0.35503748, 0.18704538, 0.98550254],
            [0.34441966, 0.8424507, 0.4218309, 0.9367238, 0.7043813, 0.7972546],
            [0.91564775, 0.8028246, 0.49614033, 0.31249228, 0.32670668, 0.07912182],
            [0.14225736, 0.5957417, 0.3907613, 0.50603217, 0.09007598, 0.07867004],
            [0.40808585, 0.34830773, 0.36845306, 0.84361774, 0.21418521, 0.7987592],
            [0.75509876, 0.22608207, 0.7696166, 0.30132967, 0.8467232, 0.3984558]
        ]
    ];

    let kernel23: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.72078145, 0.5422503, 0.7265613, 0.9449979, 0.9388161, 0.20417753, 0.3299318,
            0.29291362, 0.06538389, 0.6309051, 0.78194743, 0.00438614, 0.05666028, 0.39072883,
            0.58886516, 0.6912619, 0.51930904, 0.17292291, 0.5107088, 0.31410694, 0.673674,
            0.5234678, 0.6583543, 0.5012681, 0.8998384, 0.2960091, 0.9895524, 0.61777544,
            0.87203765, 0.3580352, 0.29113078, 0.47970802, 0.90885913, 0.28738904, 0.49291477,
            0.36322668, 0.06341909, 0.1109254, 0.47537884, 0.80177516, 0.11030616, 0.7467514,
            0.22475418, 0.35865468, 0.9424798, 0.8376077, 0.25179783, 0.9279907, 0.06837399,
            0.96478903, 0.5302926, 0.5030183, 0.6273661, 0.19461104, 0.4704893, 0.35097706,
            0.43067837, 0.89469916, 0.7061013, 0.8726035, 0.5427727, 0.33890912, 0.13253067,
            0.7725708, 0.45061612, 0.00021298, 0.39972392, 0.3454603, 0.80978477, 0.9330243,
            0.64806753, 0.8174442, 0.98913914, 0.51185113, 0.7539409, 0.03361223, 0.1607636,
            0.42308962, 0.5613359, 0.63550866, 0.40730718, 0.7931528, 0.81707263, 0.43318188,
            0.93504876, 0.23084438, 0.68584394, 0.90050024, 0.1622558, 0.08571842, 0.41576296,
            0.07737487, 0.28837258, 0.613803, 0.47933865, 0.38214803, 0.5083258, 0.7406926,
            0.26731372, 0.66795844, 0.45487657, 0.45981997, 0.8567295, 0.14175497, 0.75072694,
            0.53907275, 0.06353179, 0.4592296, 0.23109664, 0.74539214, 0.31188768, 0.31985107,
            0.7629673, 0.19242898, 0.70321196, 0.43082848, 0.9605078, 0.29373446, 0.59216505,
            0.30148822, 0.7075394, 0.86070013, 0.04281424, 0.709181, 0.289797, 0.04958678,
            0.8853549, 0.86111635, 0.18919271, 0.13910359, 0.26363587, 0.19965523, 0.3381435,
            0.29912385, 0.74661124, 0.20746636, 0.39719838, 0.5423199, 0.2512377, 0.73317564,
            0.48384893, 0.02170124, 0.7818736, 0.40785405, 0.8742294, 0.87134856, 0.50870156,
            0.9553, 0.6247392, 0.35094658,
        ],
    )
    .unwrap();
    let conv_layer23 = TransposedConvolutionLayer::new(kernel23, 1, Padding::Same);
    let target_output23: Array3<f32> = array![
        [
            [5.906399, 7.2825546, 9.524943, 11.405381, 7.6609683, 6.061602],
            [8.434703, 11.525937, 13.94925, 14.88628, 11.758429, 7.984178],
            [11.126684, 13.7126465, 18.338255, 20.33587, 13.705657, 11.975053],
            [11.024083, 15.784645, 20.210548, 19.951698, 15.204449, 10.978865],
            [9.477303, 12.6404705, 18.279095, 15.822308, 11.033359, 9.0970545],
            [7.447608, 8.981825, 12.755136, 12.8081255, 10.224989, 7.1312046]
        ],
        [
            [5.054368, 7.727569, 10.640165, 12.2122, 8.062438, 6.480781],
            [6.5337358, 10.525494, 13.185059, 13.191551, 11.72512, 9.528943],
            [9.534617, 14.182752, 16.620678, 17.270626, 14.663237, 11.542817],
            [10.722937, 14.200645, 17.736605, 18.587914, 15.431123, 11.406286],
            [9.773618, 12.331207, 14.457677, 14.336609, 11.48746, 8.54213],
            [6.97665, 9.531826, 12.384118, 11.81525, 9.435076, 6.1500645]
        ]
    ];
    let current_output23: Array3<f32> = conv_layer23.transposed_convolve(&test_input23);

    assert!(
        arr_allclose(&current_output23, &target_output23),
        "{:?} was not equal to {:?}",
        current_output23,
        target_output23
    );

    let test_input24 = array![
        [
            [0.9096759, 0.59524554, 0.13351306, 0.8133232, 0.42631584, 0.0035931],
            [0.07048251, 0.07519514, 0.18939982, 0.8736979, 0.00128342, 0.8981391],
            [0.97424996, 0.5796633, 0.70005023, 0.0112594, 0.9865017, 0.27214438],
            [0.91399616, 0.07878154, 0.24984077, 0.55183935, 0.3543122, 0.97273964],
            [0.60836136, 0.33572474, 0.52165455, 0.567703, 0.58089966, 0.43531328],
            [0.8277691, 0.22593151, 0.6303966, 0.8334527, 0.30903128, 0.94089687]
        ],
        [
            [0.13178279, 0.79426324, 0.05114055, 0.594996, 0.27465257, 0.67343456],
            [0.03731679, 0.12771852, 0.940126, 0.8357028, 0.85512394, 0.59624237],
            [0.29097712, 0.39612383, 0.12540145, 0.6958595, 0.21010889, 0.39966926],
            [0.9526364, 0.8174806, 0.5361725, 0.53385806, 0.62478775, 0.27644822],
            [0.8986958, 0.8549616, 0.8508748, 0.89033234, 0.03586937, 0.33968535],
            [0.06124673, 0.23250894, 0.08375615, 0.47954947, 0.9184073, 0.21943197]
        ],
        [
            [0.97475976, 0.8461902, 0.8810762, 0.1246982, 0.47207135, 0.688163],
            [0.7791489, 0.7964227, 0.9467356, 0.9090393, 0.10962847, 0.48698908],
            [0.55631065, 0.2088539, 0.56366587, 0.5418821, 0.83182925, 0.8036135],
            [0.12046539, 0.7298577, 0.24096292, 0.89423, 0.34455788, 0.18728091],
            [0.95869124, 0.4204625, 0.83280027, 0.6314244, 0.67809236, 0.05008886],
            [0.17358086, 0.2537514, 0.60347784, 0.15238366, 0.37940994, 0.84772724]
        ]
    ];

    let kernel24: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.61506605, 0.27299848, 0.8665764, 0.15441248, 0.429654, 0.08137494, 0.9534532,
            0.5234881, 0.34545556, 0.5784351, 0.89669985, 0.24445513, 0.4170717, 0.93946743,
            0.78209144, 0.23775001, 0.38504902, 0.36374742, 0.21875483, 0.47269264, 0.9555733,
            0.77991635, 0.8595208, 0.3726802, 0.6696404, 0.18707228, 0.40029573, 0.9097728,
            0.84473497, 0.74008673, 0.112744, 0.13137567, 0.42235526, 0.4836344, 0.1666113,
            0.16497025, 0.1174771, 0.6549797, 0.9515421, 0.79927915, 0.9032787, 0.3930657,
            0.7766521, 0.16238345, 0.7309077, 0.41990882, 0.96651787, 0.65133095, 0.31202802,
            0.05357829, 0.73473597, 0.45420194, 0.65854716, 0.21718247, 0.10660966, 0.2043015,
            0.98762506, 0.22064202, 0.03183809, 0.15887743, 0.42301863, 0.8130194, 0.6702645,
            0.8258193, 0.71007705, 0.28611487, 0.43596107, 0.51239777, 0.9934618, 0.6050966,
            0.6482389, 0.10052492, 0.8149423, 0.15624358, 0.04961722, 0.85466176, 0.9878965,
            0.92365694, 0.40704548, 0.24627322, 0.24340186, 0.03939323, 0.47447434, 0.2189054,
            0.11656966, 0.21967725, 0.02515282, 0.5530279, 0.4057702, 0.40748626, 0.1371414,
            0.6736236, 0.3678535, 0.83786595, 0.19096765, 0.6285995, 0.69250244, 0.09926207,
            0.2851542, 0.41492537, 0.97928363, 0.3445191, 0.53325635, 0.87375444, 0.0385802,
            0.804422, 0.98545736, 0.62279546, 0.6187529, 0.84817797, 0.72456354, 0.67168516,
            0.5784683, 0.18871792, 0.8038459, 0.60516614, 0.95890117, 0.4241779, 0.1409927,
            0.26719815, 0.686263, 0.66120476, 0.2230379, 0.32365033, 0.5511397, 0.5052595,
            0.47469518, 0.790473, 0.3932542, 0.00149018, 0.22568692, 0.2683659, 0.3262361,
            0.2636732, 0.6932469, 0.3835996, 0.7274605, 0.6373402, 0.70937157, 0.64033484,
            0.16753767, 0.72674286, 0.7646558, 0.41193017, 0.7958821, 0.45439622, 0.5681183,
            0.40350485, 0.06510133, 0.80012435,
        ],
    )
    .unwrap();
    let conv_layer24 = TransposedConvolutionLayer::new(kernel24, 1, Padding::Same);
    let target_output24: Array3<f32> = array![
        [
            [7.2430735, 9.218537, 13.302147, 10.4354105, 9.994257, 7.3192487],
            [8.884219, 13.5919075, 15.140311, 17.34889, 11.935404, 11.5791235],
            [10.904754, 16.07382, 22.29924, 19.47254, 15.515318, 12.005513],
            [11.102232, 15.163349, 19.376425, 19.987196, 15.644912, 14.061239],
            [10.348097, 13.36408, 16.237947, 14.53932, 13.778217, 9.988529],
            [7.924859, 10.348501, 11.964097, 11.458445, 9.600841, 7.835347]
        ],
        [
            [7.1484118, 10.361364, 12.168188, 12.714963, 9.670025, 6.870391],
            [9.467993, 13.770262, 16.431288, 15.898136, 11.285464, 9.074648],
            [13.459657, 18.388824, 20.637543, 19.452482, 14.456551, 10.712539],
            [10.83093, 16.825275, 20.550732, 19.75981, 15.780133, 12.06218],
            [9.052666, 12.40336, 14.323187, 14.285182, 11.771011, 9.02947],
            [7.6422276, 8.813618, 10.334228, 10.944795, 8.033397, 6.2566786]
        ]
    ];
    let current_output24: Array3<f32> = conv_layer24.transposed_convolve(&test_input24);

    assert!(
        arr_allclose(&current_output24, &target_output24),
        "{:?} was not equal to {:?}",
        current_output24,
        target_output24
    );

    let test_input25 = array![
        [
            [
                0.77948046, 0.93170303, 0.3018518, 0.61924046, 0.31023443, 0.19631852, 0.07390053,
                0.8327572, 0.25700969, 0.65307343, 0.731802, 0.18586361, 0.8078716, 0.77839166,
                0.7349751
            ],
            [
                0.35845023, 0.43633965, 0.01972343, 0.71083087, 0.4260922, 0.3943683, 0.5186383,
                0.21679398, 0.10449901, 0.22839932, 0.6627642, 0.61925805, 0.206714, 0.6037294,
                0.41963074
            ],
            [
                0.3004147, 0.30532262, 0.9047769, 0.11101993, 0.57444376, 0.4119178, 0.9063808,
                0.40659422, 0.2529742, 0.24030283, 0.5665967, 0.6342405, 0.327252, 0.06076881,
                0.52967036
            ],
            [
                0.8789925, 0.11439145, 0.95893174, 0.73697186, 0.5900436, 0.9111167, 0.2819696,
                0.49504948, 0.7536799, 0.5165421, 0.05161112, 0.856834, 0.2743121, 0.9010445,
                0.6805351
            ],
            [
                0.87542033, 0.28038403, 0.9116701, 0.39215884, 0.29668352, 0.5338379, 0.5007001,
                0.89529955, 0.98473877, 0.55281353, 0.7348554, 0.580077, 0.01270174, 0.39543778,
                0.287917
            ],
            [
                0.7878496, 0.03362276, 0.18134156, 0.6886493, 0.9617242, 0.6216149, 0.38977638,
                0.57814896, 0.54499733, 0.14547525, 0.540897, 0.3162914, 0.82115626, 0.8540837,
                0.09731764
            ],
            [
                0.4435639, 0.8118447, 0.01860107, 0.8171573, 0.65403223, 0.98040396, 0.9361756,
                0.42911106, 0.559747, 0.45448932, 0.06660813, 0.17935576, 0.31223232, 0.96262074,
                0.45731342
            ],
            [
                0.6785347, 0.3219252, 0.96741146, 0.82334906, 0.4106805, 0.8092846, 0.5255855,
                0.5850067, 0.87130636, 0.3815737, 0.1387001, 0.5686804, 0.59814084, 0.3574539,
                0.9413668
            ],
            [
                0.7884669, 0.39215145, 0.9935366, 0.2017725, 0.9118434, 0.18399727, 0.7931529,
                0.5731924, 0.15304144, 0.69954604, 0.15864603, 0.01925668, 0.64654654, 0.7288052,
                0.8716531
            ],
            [
                0.7925001, 0.8617005, 0.2165383, 0.9245013, 0.06162249, 0.29544893, 0.18815497,
                0.20450824, 0.36479506, 0.20395003, 0.0257373, 0.4699501, 0.32352778, 0.17628226,
                0.7551755
            ]
        ],
        [
            [
                0.5817777, 0.7335039, 0.02051142, 0.854811, 0.8348987, 0.54642886, 0.8382655,
                0.18735091, 0.48078325, 0.6732103, 0.6883737, 0.5239251, 0.299573, 0.79630405,
                0.6451068
            ],
            [
                0.4581535, 0.8218086, 0.5519298, 0.97240615, 0.65610653, 0.43312448, 0.50740767,
                0.9478802, 0.6320926, 0.6555593, 0.6705222, 0.41575047, 0.8746799, 0.31176648,
                0.9357744
            ],
            [
                0.18032381, 0.7166489, 0.44238764, 0.199159, 0.11978984, 0.57909614, 0.27895957,
                0.98695445, 0.72039455, 0.6292799, 0.94756454, 0.01166608, 0.3857887, 0.7644724,
                0.6837064
            ],
            [
                0.20654403, 0.9150392, 0.2062981, 0.84316546, 0.21242656, 0.01205953, 0.92620313,
                0.8864653, 0.52352715, 0.9176399, 0.4291862, 0.05985525, 0.00024094, 0.69274825,
                0.595463
            ],
            [
                0.7777278, 0.3091539, 0.84452283, 0.9459252, 0.9832551, 0.11121994, 0.6877935,
                0.22960067, 0.6129221, 0.9180997, 0.94702023, 0.3274046, 0.5657129, 0.47996786,
                0.9425162
            ],
            [
                0.7003329, 0.3997942, 0.15328309, 0.81132424, 0.8381855, 0.7851491, 0.43648005,
                0.12495397, 0.5491995, 0.40107632, 0.9502184, 0.80036694, 0.49411505, 0.5461849,
                0.9864137
            ],
            [
                0.6798719, 0.11575048, 0.88862413, 0.15026839, 0.75693697, 0.69985366, 0.8854023,
                0.5875399, 0.5476677, 0.07530271, 0.47854483, 0.35159734, 0.6252774, 0.10202076,
                0.34306985
            ],
            [
                0.7712403, 0.2953802, 0.59345067, 0.06315541, 0.3545377, 0.87512225, 0.9179339,
                0.62673444, 0.52161974, 0.7253228, 0.367339, 0.55982345, 0.8980033, 0.93233985,
                0.11013599
            ],
            [
                0.37744504, 0.22905608, 0.84281206, 0.3367692, 0.0845728, 0.0307896, 0.8524521,
                0.27665535, 0.04007195, 0.05185039, 0.74104065, 0.08161648, 0.20229144, 0.50537777,
                0.37232295
            ],
            [
                0.50409347, 0.17126255, 0.49172163, 0.4937435, 0.8924454, 0.67569476, 0.89285487,
                0.6072924, 0.73902696, 0.3202701, 0.6253716, 0.07189014, 0.7228063, 0.42314526,
                0.6267999
            ]
        ],
        [
            [
                0.4918857, 0.6864143, 0.20318979, 0.58106905, 0.16232036, 0.88596267, 0.86273426,
                0.5007842, 0.97483325, 0.32025233, 0.65470874, 0.7650533, 0.547536, 0.15410115,
                0.2843736
            ],
            [
                0.08146472, 0.04487986, 0.14390907, 0.86931247, 0.64853597, 0.00243695, 0.9890189,
                0.45077148, 0.797346, 0.61402696, 0.812481, 0.5079942, 0.882206, 0.17137863,
                0.45257562
            ],
            [
                0.11896311, 0.0099988, 0.1687195, 0.58499974, 0.5743171, 0.03170383, 0.47689345,
                0.60207045, 0.27565098, 0.7215461, 0.378682, 0.1862373, 0.97069764, 0.4059111,
                0.85430926
            ],
            [
                0.5425173, 0.7453459, 0.39831474, 0.6350503, 0.19837748, 0.9995681, 0.6204455,
                0.24860583, 0.08589319, 0.4956853, 0.6328064, 0.7516146, 0.66608727, 0.06317678,
                0.7468042
            ],
            [
                0.38840514, 0.23738277, 0.2260869, 0.43724543, 0.35188743, 0.42919478, 0.16846193,
                0.1564787, 0.5877074, 0.6165641, 0.3676801, 0.4739107, 0.80465794, 0.85045826,
                0.8187974
            ],
            [
                0.83058876, 0.3700184, 0.7031775, 0.19160417, 0.17675605, 0.83527124, 0.1693727,
                0.5882173, 0.11069718, 0.9919517, 0.03902764, 0.80868846, 0.25444192, 0.29574174,
                0.663218
            ],
            [
                0.27567437, 0.45301217, 0.44179404, 0.23022331, 0.3070388, 0.9661292, 0.71897376,
                0.6525357, 0.45338178, 0.4378793, 0.12205274, 0.90195817, 0.5385283, 0.6187316,
                0.68955016
            ],
            [
                0.7116035, 0.2429764, 0.46655852, 0.45732534, 0.8184314, 0.21347605, 0.2425075,
                0.78325397, 0.2786527, 0.86849695, 0.28503793, 0.01219704, 0.54079705, 0.39422444,
                0.15862207
            ],
            [
                0.67054975, 0.63199353, 0.7837504, 0.44444096, 0.6533876, 0.567272, 0.54298073,
                0.67955005, 0.45691183, 0.4339906, 0.13047415, 0.16629538, 0.17998669, 0.05238211,
                0.8922111
            ],
            [
                0.14670761, 0.1604777, 0.7004159, 0.48388445, 0.96036434, 0.58228344, 0.38652715,
                0.5193411, 0.1170715, 0.370591, 0.94307476, 0.33282563, 0.46358395, 0.48457426,
                0.29540315
            ]
        ]
    ];

    let kernel25: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.3597477, 0.79552317, 0.9386723, 0.745768, 0.26802924, 0.8211709, 0.8766882,
            0.61748743, 0.8996168, 0.2774931, 0.47996837, 0.7129595, 0.22661544, 0.35529518,
            0.2529621, 0.9818257, 0.8697446, 0.9333845, 0.5281327, 0.95338374, 0.22356904,
            0.21109125, 0.15210754, 0.8481183, 0.01707013, 0.18659416, 0.8373624, 0.9006268,
            0.41175643, 0.87932724, 0.29970515, 0.90173733, 0.2713924, 0.36127892, 0.61516434,
            0.14357714, 0.6835671, 0.8742684, 0.79999286, 0.5905615, 0.72201145, 0.12478102,
            0.3157006, 0.04205429, 0.67278105, 0.6795324, 0.25841942, 0.9202294, 0.6226681,
            0.17438059, 0.53142226, 0.4418243, 0.4029075, 0.21003468,
        ],
    )
    .unwrap();
    let conv_layer25 = TransposedConvolutionLayer::new(kernel25, 1, Padding::Same);
    let target_output25: Array3<f32> = array![
        [
            [
                3.035175, 3.6603744, 5.262344, 3.7759824, 5.3612976, 4.8844657, 4.5011644,
                4.741728, 4.4128337, 4.786381, 4.996086, 5.5330844, 4.160384, 4.80379, 3.1302872
            ],
            [
                4.41501, 6.372927, 9.106693, 7.0856943, 6.8391137, 7.650284, 8.115936, 8.252617,
                8.553409, 8.647487, 7.96297, 9.523696, 7.521118, 8.03367, 5.3112507
            ],
            [
                3.7495039, 5.707482, 7.7024865, 7.7603273, 8.164989, 7.549184, 7.6181035, 7.79928,
                8.676535, 8.352046, 8.143306, 8.519111, 6.666019, 8.154573, 5.50704
            ],
            [
                4.0483885, 7.26417, 7.4266973, 7.7557464, 8.073565, 7.229835, 7.3096275, 8.600217,
                8.888123, 8.665289, 8.764908, 7.7077603, 6.495891, 7.5218573, 5.5524035
            ],
            [
                4.5684056, 8.45374, 7.762223, 8.11755, 9.522366, 8.636613, 8.0032835, 8.26499,
                8.25749, 7.9263988, 8.281804, 8.041077, 8.484048, 8.213263, 5.9360294
            ],
            [
                4.045917, 8.478039, 6.4002056, 8.198314, 9.134871, 9.295056, 8.574892, 8.28164,
                8.128744, 8.403035, 7.730481, 7.70642, 7.3714514, 8.533724, 5.739208
            ],
            [
                4.620664, 7.5256605, 6.867182, 8.560659, 9.222778, 9.701893, 9.665166, 8.5939045,
                7.346024, 7.0879, 6.582155, 7.377101, 8.765999, 8.286945, 5.5616426
            ],
            [
                4.2630453, 8.600643, 6.9992046, 8.86212, 7.6954956, 9.355313, 9.974222, 9.700949,
                7.5358367, 5.821178, 4.82084, 6.023827, 6.836371, 8.501515, 6.005992
            ],
            [
                4.5732775, 9.563599, 7.0915103, 9.204201, 7.6669526, 8.080169, 7.718111, 8.198425,
                7.3682547, 6.317264, 5.4528313, 5.9086676, 5.9964156, 8.33732, 5.204159
            ],
            [
                3.318885, 6.5952253, 5.802474, 6.6087265, 5.1985774, 5.9080462, 5.138476, 5.426226,
                4.4556875, 4.554175, 3.154809, 3.8966856, 3.657809, 5.3445005, 3.7752204
            ]
        ],
        [
            [
                3.8249693, 3.8333516, 5.109468, 5.291429, 4.869154, 4.512778, 4.4598494, 4.9379015,
                4.9599366, 5.8091235, 5.4108577, 5.099348, 5.1219463, 5.5115147, 3.1049945
            ],
            [
                5.203494, 5.550599, 6.4689903, 6.3237987, 6.577228, 7.2099905, 7.3397074, 7.891445,
                6.8107424, 7.8096504, 7.1968474, 7.67238, 6.789657, 7.591997, 4.2345676
            ],
            [
                4.4150743, 5.9872313, 7.724706, 6.668945, 6.6245227, 7.277658, 8.033391, 7.7125154,
                7.337301, 7.4488897, 7.369936, 6.6705556, 6.539865, 7.5935245, 3.7496781
            ],
            [
                4.682969, 6.711548, 6.924209, 7.4040937, 6.0828953, 6.5878077, 7.877125, 7.085304,
                8.222762, 8.465599, 6.2819924, 6.4317117, 6.6418743, 8.321706, 4.8969507
            ],
            [
                5.6587687, 6.8077507, 8.236642, 7.535811, 7.900156, 7.0870385, 6.6645913, 6.738263,
                8.069799, 7.8109226, 8.1241665, 6.946608, 6.8423634, 7.207762, 4.5899134
            ],
            [
                4.8974915, 6.2941375, 6.2313385, 7.665203, 8.621003, 8.723988, 7.09986, 7.5994005,
                7.0926356, 6.570642, 7.048041, 6.829247, 7.7499337, 8.246735, 4.194703
            ],
            [
                4.682845, 6.968671, 6.5173182, 6.9485955, 8.978305, 8.538338, 8.683557, 7.4955683,
                6.7520375, 6.18309, 6.037812, 6.510341, 7.2555165, 7.269888, 3.723827
            ],
            [
                5.1374063, 7.858644, 6.384551, 7.716218, 7.306744, 9.542727, 8.373054, 7.2578416,
                6.7554455, 5.1229796, 4.6148405, 5.854554, 6.6915846, 7.2775626, 3.7268124
            ],
            [
                4.6557627, 7.4993343, 7.4415007, 7.3227024, 6.9902463, 7.279239, 7.648238,
                6.808051, 5.9331393, 5.6284127, 5.351096, 5.1902432, 5.973097, 7.1769533, 4.007806
            ],
            [
                3.3772604, 5.4445148, 4.202036, 5.4423933, 4.177283, 4.8355026, 4.202989,
                3.7887862, 3.459773, 3.0077271, 1.9363892, 3.3892703, 3.3707428, 4.3412395,
                2.7193255
            ]
        ]
    ];
    let current_output25: Array3<f32> = conv_layer25.transposed_convolve(&test_input25);

    assert!(
        arr_allclose(&current_output25, &target_output25),
        "{:?} was not equal to {:?}",
        current_output25,
        target_output25
    );

    let test_input26 = array![
        [
            [
                0.37795687, 0.7397618, 0.2915209, 0.16516899, 0.8854313, 0.29453322, 0.24924065,
                0.6498583, 0.3119929, 0.09449384, 0.3505385, 0.49503767, 0.8601228, 0.47424415,
                0.5037468
            ],
            [
                0.14023665, 0.67529225, 0.9934833, 0.4064606, 0.58576417, 0.260517, 0.43190235,
                0.3524189, 0.20151226, 0.7262781, 0.02336918, 0.9906754, 0.19271493, 0.6349119,
                0.9702864
            ],
            [
                0.80085796, 0.6622489, 0.25438032, 0.6169923, 0.7179867, 0.05094215, 0.8696046,
                0.463182, 0.3642487, 0.9020227, 0.35879987, 0.85177696, 0.69111156, 0.13240816,
                0.7032708
            ],
            [
                0.57562184, 0.13603641, 0.97879845, 0.42628527, 0.08654373, 0.79104024, 0.11414032,
                0.52094257, 0.3767257, 0.5305581, 0.42280748, 0.02939593, 0.9269707, 0.46382493,
                0.24367185
            ],
            [
                0.03454055, 0.9100273, 0.43184423, 0.06645539, 0.13082688, 0.827009, 0.24779269,
                0.90801483, 0.62532705, 0.2569422, 0.64241296, 0.60634, 0.5169471, 0.31174046,
                0.18764913
            ],
            [
                0.7799279, 0.61078006, 0.8457061, 0.01477505, 0.89572597, 0.8366325, 0.33544055,
                0.8236426, 0.14947781, 0.75764847, 0.35848397, 0.2764536, 0.24928959, 0.8487974,
                0.40229416
            ],
            [
                0.4180667, 0.13404034, 0.06558784, 0.03085664, 0.39431462, 0.48906583, 0.0031025,
                0.52604854, 0.11154372, 0.47536328, 0.05275596, 0.49369687, 0.07469027, 0.08895482,
                0.04548356
            ],
            [
                0.60533017, 0.89718825, 0.48850778, 0.36350024, 0.39925045, 0.49241906, 0.0844234,
                0.52778643, 0.80248684, 0.15037163, 0.6288416, 0.64277416, 0.33921772, 0.98352855,
                0.24540758
            ],
            [
                0.7802269, 0.01093329, 0.5999349, 0.29644915, 0.8308351, 0.33316183, 0.9135188,
                0.95643896, 0.5889905, 0.15597685, 0.48510948, 0.8632328, 0.5890138, 0.90591913,
                0.6381281
            ],
            [
                0.58600503, 0.56674844, 0.85589916, 0.6244334, 0.5306959, 0.33156252, 0.7865877,
                0.8094903, 0.33466303, 0.29148757, 0.5460533, 0.21405107, 0.16774108, 0.32707232,
                0.79562056
            ]
        ],
        [
            [
                0.6275061, 0.8995309, 0.10109619, 0.759103, 0.57118434, 0.5722274, 0.17762062,
                0.9863101, 0.4401673, 0.8446909, 0.85321164, 0.65877384, 0.92638326, 0.56713396,
                0.18707249
            ],
            [
                0.22550605, 0.8576274, 0.17081456, 0.15443878, 0.6851468, 0.7343027, 0.80016196,
                0.8770217, 0.37050524, 0.95259154, 0.01791185, 0.04022788, 0.9481965, 0.18247107,
                0.61226696
            ],
            [
                0.7892941, 0.47345075, 0.45825642, 0.9099435, 0.39965236, 0.9811297, 0.9377779,
                0.44797823, 0.88840216, 0.68153185, 0.818187, 0.16285369, 0.8437409, 0.56898326,
                0.01979256
            ],
            [
                0.57616323, 0.44407007, 0.26750982, 0.18059246, 0.7161268, 0.93292457, 0.20866849,
                0.5414302, 0.9598927, 0.8042043, 0.84862006, 0.6563523, 0.6555888, 0.79106796,
                0.97036445
            ],
            [
                0.14605665, 0.70265037, 0.17763206, 0.01948182, 0.5092674, 0.32226926, 0.8841952,
                0.11162107, 0.907682, 0.33781505, 0.18866146, 0.215027, 0.8515643, 0.8555637,
                0.02192051
            ],
            [
                0.14473191, 0.16521506, 0.15874846, 0.15952839, 0.15017168, 0.033431, 0.06685378,
                0.1321782, 0.2602501, 0.08857261, 0.01795984, 0.20759478, 0.5570829, 0.85914624,
                0.46305147
            ],
            [
                0.04267943, 0.12947068, 0.57634246, 0.8822585, 0.21484314, 0.53445196, 0.34005705,
                0.7629966, 0.2389641, 0.2247379, 0.30354246, 0.11336972, 0.8955315, 0.3087756,
                0.00263487
            ],
            [
                0.67948425, 0.87571096, 0.63241166, 0.9197351, 0.55860317, 0.6545289, 0.00942481,
                0.87496084, 0.89108163, 0.01391788, 0.12946972, 0.96581, 0.92361313, 0.51143277,
                0.55520946
            ],
            [
                0.6802029, 0.73177844, 0.6603002, 0.9036345, 0.5783319, 0.9876822, 0.4276256,
                0.46510607, 0.2126677, 0.11585392, 0.78192335, 0.58290756, 0.37158108, 0.726355,
                0.28860244
            ],
            [
                0.22664766, 0.8077195, 0.79720664, 0.42433542, 0.33046588, 0.5036039, 0.88482267,
                0.02115386, 0.2648333, 0.6145991, 0.03568472, 0.1747803, 0.3250612, 0.20470206,
                0.8852776
            ]
        ],
        [
            [
                0.13831533, 0.4756759, 0.7037309, 0.40850815, 0.12494645, 0.888359, 0.8799648,
                0.5599958, 0.21339297, 0.78180987, 0.12930349, 0.10274391, 0.11252328, 0.28057012,
                0.23030733
            ],
            [
                0.91341, 0.23894764, 0.09381516, 0.63682294, 0.9199933, 0.37913528, 0.24169779,
                0.13757731, 0.2003077, 0.1797884, 0.02051936, 0.7060428, 0.516206, 0.08848825,
                0.616822
            ],
            [
                0.59445983, 0.30716178, 0.94546497, 0.04403141, 0.09278882, 0.7104126, 0.8815557,
                0.9511468, 0.37324885, 0.7808158, 0.7509265, 0.8677786, 0.97972065, 0.20773627,
                0.92097485
            ],
            [
                0.5542235, 0.0774203, 0.68609905, 0.17041783, 0.38146913, 0.21643132, 0.54004043,
                0.12459709, 0.61065817, 0.97269845, 0.22782129, 0.01601223, 0.07167336, 0.11644867,
                0.07912476
            ],
            [
                0.06837665, 0.2847552, 0.4541781, 0.79337156, 0.02366205, 0.99759454, 0.962434,
                0.196343, 0.1390149, 0.96638346, 0.13656646, 0.21054715, 0.9781035, 0.5923028,
                0.32155102
            ],
            [
                0.20603529, 0.36755773, 0.09377635, 0.9964789, 0.6860238, 0.54771584, 0.7457267,
                0.46809426, 0.745403, 0.76704353, 0.5570713, 0.3703494, 0.16359222, 0.34129494,
                0.93402785
            ],
            [
                0.7697356, 0.04660734, 0.83558244, 0.1445088, 0.5937149, 0.77863055, 0.63499135,
                0.00469752, 0.21350855, 0.8305853, 0.17677878, 0.29164183, 0.81703573, 0.966858,
                0.00914962
            ],
            [
                0.50467277, 0.38642973, 0.30208895, 0.5049, 0.936565, 0.78432876, 0.3863848,
                0.67018366, 0.31134087, 0.3724549, 0.5168428, 0.19782987, 0.34174147, 0.23697898,
                0.76220804
            ],
            [
                0.66204363, 0.7407999, 0.93850553, 0.63198227, 0.7933011, 0.16897064, 0.77646863,
                0.2792867, 0.87025857, 0.39426565, 0.00268238, 0.6654137, 0.19902447, 0.9754361,
                0.20468038
            ],
            [
                0.3585688, 0.4343024, 0.06737733, 0.19180125, 0.6848106, 0.81364197, 0.4841047,
                0.76538724, 0.32961446, 0.65133744, 0.57655895, 0.64931536, 0.68721706, 0.3820035,
                0.42994824
            ]
        ]
    ];

    let kernel26: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.44826564, 0.24958962, 0.4425475, 0.06080529, 0.5830187, 0.1854798, 0.21089083,
            0.21620868, 0.8958531, 0.05753588, 0.03029133, 0.42973348, 0.9085912, 0.64174664,
            0.7216628, 0.9778384, 0.03201354, 0.7864656, 0.80218786, 0.28006926, 0.39917237,
            0.665741, 0.49331632, 0.70910794, 0.6806853, 0.34553644, 0.36778808, 0.15987425,
            0.72313744, 0.07239398, 0.7122985, 0.03320818, 0.2692755, 0.8717944, 0.9014395,
            0.1117594, 0.90189725, 0.10556608, 0.37192693, 0.16559757, 0.6948119, 0.44701603,
            0.32377523, 0.25664157, 0.15209688, 0.04241126, 0.40773836, 0.24595653, 0.32552642,
            0.9365702, 0.54885113, 0.49345592, 0.3323053, 0.98101616,
        ],
    )
    .unwrap();
    let conv_layer26 = TransposedConvolutionLayer::new(kernel26, 1, Padding::Same);
    let target_output26: Array3<f32> = array![
        [
            [
                2.4016461, 4.047369, 3.237423, 3.4370985, 3.889223, 4.332803, 3.6953053, 4.0229383,
                3.2357512, 2.8861551, 3.556767, 2.3423817, 3.8410745, 3.7767487, 2.1434999
            ],
            [
                4.195475, 7.0736537, 6.2463875, 5.9405246, 6.2000694, 7.5239697, 7.964362,
                6.7674017, 7.004836, 6.9230633, 6.8238473, 6.990779, 6.7457294, 7.2029114,
                4.2019973
            ],
            [
                4.207698, 6.22038, 5.222167, 5.821708, 5.5717225, 7.0971465, 6.7412763, 5.9173026,
                7.2697144, 6.6960993, 6.859792, 5.5133104, 6.3904862, 5.791348, 4.699505
            ],
            [
                3.6637886, 5.755622, 6.34954, 4.55154, 5.8900995, 7.361717, 7.4414577, 7.1445303,
                7.1327124, 7.4971113, 6.8226185, 5.9569845, 6.831787, 7.248404, 3.9608903
            ],
            [
                2.5675135, 5.134994, 4.4556403, 5.088606, 5.7281466, 5.703315, 6.5070014,
                5.0039473, 7.0544286, 6.6273756, 5.409909, 4.75663, 5.4940405, 7.0301967, 4.782056
            ],
            [
                2.5698369, 4.1710596, 5.001608, 5.52318, 5.807386, 6.264554, 6.7453055, 5.4928694,
                5.978801, 5.5145025, 4.498103, 4.5446653, 6.65608, 6.932615, 3.7601244
            ],
            [
                3.3372245, 5.4119687, 5.302368, 6.8076043, 6.3338404, 6.476896, 5.6787863,
                5.0315027, 6.114942, 4.9845467, 4.083643, 4.4188304, 6.4896283, 6.2019987,
                4.924284
            ],
            [
                3.9318345, 6.7800016, 6.3405356, 7.441317, 6.701075, 7.1893826, 6.1855145,
                5.8393292, 5.8132386, 3.892015, 4.8678885, 5.433324, 6.9021406, 6.006946,
                3.8838124
            ],
            [
                4.4676924, 6.7668324, 7.4344597, 7.275956, 7.2028365, 7.0115337, 7.3693666,
                6.5308867, 5.9028616, 5.5896745, 5.198915, 5.837442, 6.652075, 6.4695106, 5.239685
            ],
            [
                2.6716151, 5.034248, 4.44758, 4.7891607, 4.382077, 4.921816, 4.951892, 4.2634277,
                3.722987, 3.3381143, 3.1041665, 3.7228324, 4.21393, 3.9055808, 3.6667027
            ]
        ],
        [
            [
                2.7281132, 3.8148882, 4.143, 4.430344, 3.9271336, 5.201459, 4.489737, 3.7239068,
                3.929412, 3.3324995, 3.0379534, 3.8003094, 3.90153, 4.175485, 2.6782677
            ],
            [
                4.0969863, 5.863434, 5.67675, 6.1328135, 6.33013, 6.0638304, 6.2147603, 6.857383,
                5.760736, 5.368687, 6.1064696, 5.196424, 6.7967777, 4.6670957, 3.6502602
            ],
            [
                3.963782, 5.7637644, 5.1759434, 5.5782495, 5.4663143, 6.7969556, 6.2818832,
                6.1022263, 6.1271825, 6.1869316, 6.522593, 5.549875, 6.400184, 6.541025, 3.3710735
            ],
            [
                3.171991, 5.2418866, 4.861716, 5.066254, 4.426665, 5.429028, 6.794779, 6.499986,
                6.9827456, 6.537388, 5.745976, 6.3165936, 5.940988, 5.6971803, 3.5081012
            ],
            [
                2.8346403, 4.397978, 4.7054276, 4.4852552, 4.6298804, 5.660838, 6.3388777,
                4.9591002, 5.632379, 6.240554, 5.2255406, 4.4349575, 5.5502462, 5.510241,
                3.7030814
            ],
            [
                2.1333869, 4.4280996, 3.9179513, 5.162965, 4.970321, 5.535461, 6.788346, 4.6611333,
                5.2396765, 4.203638, 4.6515946, 4.074215, 5.0801387, 5.324107, 3.9821994
            ],
            [
                3.135522, 4.6932364, 5.355193, 4.86892, 5.8921924, 5.3350387, 5.6376963, 4.6054735,
                5.1079655, 4.5583587, 5.0167737, 4.688564, 5.8538365, 5.4307837, 3.535773
            ],
            [
                4.064182, 6.1121054, 5.9898915, 6.662306, 6.748099, 6.303358, 5.9673133, 6.0612392,
                4.884667, 5.254259, 4.339803, 5.283436, 6.9712276, 5.6445503, 5.3034725
            ],
            [
                4.1443853, 7.3415475, 6.278331, 6.9642935, 6.2885013, 7.48389, 6.1097045, 6.714739,
                6.193308, 3.9721837, 4.746391, 5.5186076, 5.3805413, 6.190748, 4.2865925
            ],
            [
                2.5176344, 4.5195475, 4.4065504, 4.580767, 4.3900485, 4.772503, 4.2199426,
                4.1431813, 3.3688285, 3.7483244, 3.0042598, 3.129281, 3.5900278, 3.4434392,
                3.100333
            ]
        ]
    ];
    let current_output26: Array3<f32> = conv_layer26.transposed_convolve(&test_input26);

    assert!(
        arr_allclose(&current_output26, &target_output26),
        "{:?} was not equal to {:?}",
        current_output26,
        target_output26
    );

    let test_input27 = array![
        [
            [
                0.82688344, 0.58248127, 0.7544629, 0.7458529, 0.5209097, 0.16575688, 0.44608647,
                0.8034291, 0.03440544, 0.7831754, 0.26010162, 0.40536037, 0.96071, 0.6424637,
                0.8089435
            ],
            [
                0.02527964, 0.57334673, 0.14951943, 0.6378281, 0.33237478, 0.2926194, 0.23334782,
                0.546391, 0.37769938, 0.19193114, 0.30370447, 0.2059106, 0.6207128, 0.81840694,
                0.68744314
            ],
            [
                0.52467763, 0.88781667, 0.31891412, 0.5491171, 0.0237066, 0.77914923, 0.888555,
                0.71280414, 0.7588111, 0.35433736, 0.7016267, 0.22968955, 0.1301967, 0.9185681,
                0.5373421
            ],
            [
                0.7638238, 0.02344197, 0.12567212, 0.1292863, 0.75359905, 0.6772266, 0.42152083,
                0.7915856, 0.95793355, 0.39981195, 0.6343762, 0.49055186, 0.29662892, 0.7417504,
                0.20728986
            ],
            [
                0.47967318, 0.2839333, 0.9448144, 0.15156074, 0.8318724, 0.9782483, 0.2436357,
                0.89796305, 0.9951993, 0.38747677, 0.4652494, 0.16026023, 0.54492414, 0.25081876,
                0.6642706
            ],
            [
                0.1113514, 0.38591126, 0.5643351, 0.4771902, 0.21879652, 0.30729502, 0.22057395,
                0.37933102, 0.6846383, 0.6235146, 0.7604671, 0.62654954, 0.50220084, 0.7923531,
                0.9908856
            ],
            [
                0.42682472, 0.82755, 0.7140182, 0.43480647, 0.49034768, 0.72713345, 0.960606,
                0.11285039, 0.480432, 0.83266145, 0.87951493, 0.42723286, 0.6653556, 0.57117724,
                0.16757834
            ],
            [
                0.68018556, 0.66937584, 0.18654908, 0.14417607, 0.27395776, 0.4841953, 0.40319073,
                0.7822808, 0.06646068, 0.6039549, 0.4939349, 0.9707106, 0.22841802, 0.34100583,
                0.7631656
            ],
            [
                0.9836221, 0.12849247, 0.40886244, 0.29058558, 0.6443919, 0.5582479, 0.96385306,
                0.72632265, 0.4767025, 0.81263256, 0.8312883, 0.35596776, 0.20116615, 0.3840827,
                0.1266189
            ],
            [
                0.43126488, 0.8104131, 0.5394832, 0.59545696, 0.24013516, 0.9025673, 0.11772668,
                0.7615653, 0.03378446, 0.1619906, 0.66089565, 0.40856043, 0.51406205, 0.9905056,
                0.06775481
            ]
        ],
        [
            [
                0.39971557, 0.72250974, 0.95678425, 0.8440907, 0.14843525, 0.84027195, 0.14924687,
                0.9697322, 0.923701, 0.66152495, 0.7025283, 0.9760755, 0.8275557, 0.7565572,
                0.13057262
            ],
            [
                0.6553745, 0.1310051, 0.550075, 0.03573983, 0.9452659, 0.20338611, 0.33698198,
                0.03989459, 0.53521657, 0.5200098, 0.67105424, 0.77762866, 0.01753597, 0.38843843,
                0.9398104
            ],
            [
                0.01065648, 0.34669802, 0.58483016, 0.4035074, 0.62355834, 0.33805928, 0.6767775,
                0.38985527, 0.65302986, 0.31221408, 0.79567075, 0.85889065, 0.07739386, 0.97936594,
                0.0775787
            ],
            [
                0.09888739, 0.47735122, 0.17827183, 0.12922777, 0.42643288, 0.49927196, 0.62646806,
                0.23585345, 0.41761714, 0.09500003, 0.9994908, 0.1670571, 0.49163583, 0.98983413,
                0.7413314
            ],
            [
                0.94691145, 0.1053163, 0.58996093, 0.640451, 0.9135182, 0.26407224, 0.64379567,
                0.23944081, 0.6647975, 0.5258686, 0.00668735, 0.55749786, 0.8073101, 0.75044197,
                0.23981997
            ],
            [
                0.78645307, 0.1712584, 0.8948728, 0.1780468, 0.30240452, 0.76599663, 0.9176574,
                0.2339646, 0.54762, 0.18364938, 0.12599571, 0.38194448, 0.6815987, 0.625544,
                0.7012009
            ],
            [
                0.32246166, 0.7120575, 0.9332956, 0.4907121, 0.8423877, 0.7068862, 0.3037602,
                0.22079949, 0.8414488, 0.8396358, 0.7155849, 0.7934042, 0.4762381, 0.18088572,
                0.78911585
            ],
            [
                0.7005145, 0.29562467, 0.53553075, 0.21978132, 0.83805525, 0.3837122, 0.13018785,
                0.12840837, 0.21173449, 0.18783508, 0.79273003, 0.49953455, 0.21326533, 0.3103626,
                0.9372224
            ],
            [
                0.45619473, 0.8366536, 0.7562276, 0.80820394, 0.33659637, 0.08216117, 0.8894684,
                0.3752628, 0.8935992, 0.39055565, 0.02040852, 0.01812589, 0.4611082, 0.865646,
                0.93671024
            ],
            [
                0.41400406, 0.35889435, 0.19520377, 0.03328433, 0.51722217, 0.08536235, 0.64397997,
                0.84666073, 0.25180593, 0.04745248, 0.40402666, 0.9993822, 0.41303217, 0.2993108,
                0.5193821
            ]
        ],
        [
            [
                0.5596352, 0.68012905, 0.17374654, 0.25033656, 0.6483185, 0.8741792, 0.963613,
                0.93363297, 0.2429601, 0.8079961, 0.78451616, 0.1656064, 0.816739, 0.5770123,
                0.23647761
            ],
            [
                0.35383785, 0.46875703, 0.73632693, 0.13271599, 0.0811053, 0.44705516, 0.95582426,
                0.4086529, 0.4170544, 0.14643013, 0.32334185, 0.7258692, 0.7955117, 0.84256065,
                0.71449274
            ],
            [
                0.66725147, 0.7695028, 0.09751261, 0.82022357, 0.43093318, 0.08507466, 0.33988428,
                0.1262919, 0.4553589, 0.5080898, 0.3072609, 0.8682646, 0.5401004, 0.3854512,
                0.5709279
            ],
            [
                0.4147855, 0.7860748, 0.34907386, 0.50597256, 0.12329532, 0.41619205, 0.9329879,
                0.58009934, 0.29878962, 0.24184026, 0.02598915, 0.2865987, 0.35510612, 0.07561034,
                0.34710956
            ],
            [
                0.33699453, 0.55373836, 0.7656746, 0.6156644, 0.13011694, 0.06010303, 0.6083183,
                0.17862077, 0.3308746, 0.5026278, 0.14146422, 0.64076066, 0.48090568, 0.9789585,
                0.6682556
            ],
            [
                0.20614247, 0.16689017, 0.5747893, 0.04157939, 0.08523397, 0.40889814, 0.664855,
                0.54764134, 0.40198413, 0.12718134, 0.7348048, 0.34777096, 0.23616308, 0.87368935,
                0.47155297
            ],
            [
                0.8827609, 0.17957127, 0.38464943, 0.45216265, 0.2190491, 0.37326434, 0.19080913,
                0.16157833, 0.5605025, 0.59512323, 0.07219929, 0.87486494, 0.35757762, 0.7926968,
                0.37903345
            ],
            [
                0.50261426, 0.17502521, 0.46825427, 0.14853953, 0.22394064, 0.5983089, 0.23588571,
                0.2843473, 0.5036854, 0.03650436, 0.90267634, 0.39498106, 0.43872166, 0.55697274,
                0.05620179
            ],
            [
                0.845199, 0.6274929, 0.7503419, 0.45198432, 0.40451953, 0.6801111, 0.42570132,
                0.2975695, 0.735166, 0.12862578, 0.8068416, 0.18190542, 0.73744017, 0.8160992,
                0.19002475
            ],
            [
                0.5376836, 0.00046573, 0.5981654, 0.8644044, 0.4253033, 0.54187083, 0.4271245,
                0.5590328, 0.07657997, 0.7959168, 0.2706652, 0.90806615, 0.28685412, 0.45481336,
                0.14749219
            ]
        ]
    ];

    let kernel27: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.69113797, 0.04432987, 0.84585464, 0.6582025, 0.5692328, 0.54193175, 0.6127437,
            0.09859947, 0.06338396, 0.9900282, 0.7284932, 0.98708487, 0.4688427, 0.9003879,
            0.32614702, 0.974816, 0.00522763, 0.2678839, 0.2118759, 0.44928706, 0.4792269,
            0.64054424, 0.51471543, 0.90980005, 0.57766384, 0.8873412, 0.81692207, 0.36663312,
            0.9359342, 0.13942754, 0.5851482, 0.626126, 0.5465896, 0.00545988, 0.07321159,
            0.24611686, 0.5601726, 0.67574924, 0.8305265, 0.5974724, 0.20322645, 0.20985058,
            0.90631443, 0.42977262, 0.9940165, 0.55413437, 0.28697443, 0.7165074, 0.27121913,
            0.50980794, 0.21154375, 0.00298325, 0.8554652, 0.62107426,
        ],
    )
    .unwrap();
    let conv_layer27 = TransposedConvolutionLayer::new(kernel27, 1, Padding::Same);
    let target_output27: Array3<f32> = array![
        [
            [
                3.1522133, 5.1226606, 4.8876357, 4.727012, 3.790744, 4.9334383, 4.905607,
                6.0374494, 4.8236523, 4.957714, 5.282214, 5.539697, 6.101845, 6.079312, 3.9966812
            ],
            [
                5.6351395, 7.9734955, 7.621444, 6.7483673, 7.0907154, 7.076104, 8.6741295, 8.93889,
                7.747093, 8.230766, 8.392992, 8.238332, 9.301286, 8.395783, 6.3424907
            ],
            [
                4.1477923, 6.4940166, 5.888556, 6.248864, 5.605931, 6.8293796, 7.272496, 8.092858,
                6.2831416, 7.0272493, 6.9709225, 7.143938, 8.297224, 9.132287, 5.4500837
            ],
            [
                5.1894794, 7.755091, 6.781851, 7.344586, 7.456558, 8.058676, 7.098595, 8.325556,
                6.9677835, 7.075222, 6.9386063, 5.775766, 8.536065, 8.228089, 5.009394
            ],
            [
                4.3741593, 6.248211, 6.601543, 6.9902134, 6.4590216, 6.877402, 7.2380757, 8.643443,
                6.6534686, 6.4265304, 5.7403884, 6.638834, 8.574955, 8.581035, 5.76221
            ],
            [
                4.8918443, 8.171127, 8.075428, 8.248968, 7.094573, 7.660989, 6.8612413, 7.5636144,
                7.2250133, 7.3795805, 7.413339, 8.217752, 8.5506525, 8.551449, 6.0649033
            ],
            [
                4.5940785, 8.194783, 6.0178895, 5.962882, 5.8769193, 6.656655, 6.182157, 6.0230365,
                6.45584, 7.194407, 8.273049, 7.9579535, 7.67147, 8.421166, 5.698855
            ],
            [
                6.6815724, 8.855666, 7.2433553, 7.4293556, 7.1819434, 7.416764, 6.104938, 7.342497,
                7.221142, 8.610365, 7.5692554, 7.325429, 6.7824316, 7.8042197, 5.4567914
            ],
            [
                6.0369515, 7.4487834, 6.3589764, 6.8761516, 5.9848747, 6.674932, 7.7746954,
                6.3603854, 5.895491, 6.388939, 7.0505047, 7.5294013, 7.6345143, 8.247654,
                4.6539965
            ],
            [
                3.8786454, 4.981658, 4.4678645, 4.722277, 4.303275, 5.246401, 5.2787867, 5.168356,
                4.003101, 3.7273586, 4.6145005, 4.4201164, 4.80652, 4.916888, 2.5548682
            ]
        ],
        [
            [
                3.1585274, 4.878932, 4.0972233, 3.7835667, 3.578653, 4.248385, 4.8306704, 4.256672,
                4.156366, 4.2049046, 4.8773856, 5.292455, 5.3371086, 5.0236487, 3.035972
            ],
            [
                4.3523726, 5.968787, 6.4232645, 6.7812304, 5.5318284, 5.820445, 7.21017, 7.2156587,
                6.6824164, 6.744914, 6.8763885, 7.1821203, 8.36418, 7.6833963, 5.1308193
            ],
            [
                4.0378237, 5.6233892, 4.50161, 5.120817, 5.067927, 7.2119317, 5.5387406, 6.7792745,
                4.6993585, 6.060756, 6.1185846, 5.7442427, 7.5464683, 7.132186, 4.855853
            ],
            [
                4.0809283, 5.521192, 5.8509865, 5.9564023, 6.131727, 6.8712144, 5.8470774,
                8.001323, 5.969508, 6.177815, 5.76182, 5.338675, 7.5677133, 6.1624045, 4.2691865
            ],
            [
                3.5701923, 6.067486, 5.5055165, 5.6367755, 5.7706833, 6.582982, 6.214505, 7.723481,
                5.337053, 5.5580544, 4.6034155, 5.6320148, 6.5984235, 7.600055, 5.239942
            ],
            [
                3.399075, 7.1685395, 6.3815904, 6.6114717, 5.6080046, 6.937679, 5.1206, 6.7352505,
                6.502698, 6.5217137, 7.029344, 6.3479595, 7.661006, 7.45162, 4.889806
            ],
            [
                4.1360526, 7.4255867, 4.538786, 5.948802, 5.624295, 6.41352, 5.1685715, 5.485652,
                4.8576183, 7.099703, 6.5529256, 6.5696583, 6.6208134, 6.479855, 4.71074
            ],
            [
                4.9649663, 6.9398894, 6.064027, 6.559931, 5.945805, 5.99028, 6.00121, 5.889776,
                5.4901857, 7.369094, 7.164554, 5.8803325, 6.1867447, 6.7962904, 3.9562254
            ],
            [
                4.23851, 6.8241754, 5.475778, 5.838042, 5.0205135, 6.55886, 5.98395, 6.0811167,
                4.8269067, 6.202158, 5.4501104, 6.534963, 6.230201, 5.974619, 3.4968731
            ],
            [
                3.6039762, 4.8802824, 4.5537367, 4.553325, 4.6249933, 4.5191417, 4.505138,
                5.0682597, 3.291339, 4.3887653, 4.15781, 4.1202083, 4.98667, 4.2919965, 2.581227
            ]
        ]
    ];
    let current_output27: Array3<f32> = conv_layer27.transposed_convolve(&test_input27);

    assert!(
        arr_allclose(&current_output27, &target_output27),
        "{:?} was not equal to {:?}",
        current_output27,
        target_output27
    );

    let test_input28 = array![
        [
            [
                0.9236024, 0.43601507, 0.4338689, 0.154061, 0.43424633, 0.6329985, 0.1501227,
                0.8239435, 0.10845271, 0.38491207, 0.46830684, 0.9130998, 0.73020744, 0.58451164,
                0.9968212
            ],
            [
                0.3848365, 0.6105253, 0.9930404, 0.39893615, 0.52141625, 0.14956462, 0.61849576,
                0.06813567, 0.82221067, 0.6523569, 0.32278818, 0.84579414, 0.18556745, 0.95414525,
                0.20767286
            ],
            [
                0.15578295, 0.15946275, 0.46103275, 0.73575515, 0.81041634, 0.02958763, 0.35078365,
                0.17020473, 0.86231124, 0.86052555, 0.87824446, 0.95700806, 0.53297186, 0.35722274,
                0.55112064
            ],
            [
                0.6125483, 0.7967779, 0.7679128, 0.1915737, 0.7624124, 0.97710234, 0.8184034,
                0.18577828, 0.08516511, 0.66965115, 0.2010773, 0.53281647, 0.40985718, 0.6742502,
                0.8675815
            ],
            [
                0.30551153, 0.57150465, 0.6235693, 0.96995336, 0.02986461, 0.93990296, 0.13516724,
                0.01436975, 0.71162206, 0.12800713, 0.5134128, 0.3202989, 0.55969507, 0.41986147,
                0.9384196
            ],
            [
                0.9837114, 0.1353216, 0.45188782, 0.00924854, 0.16833772, 0.87602216, 0.9986705,
                0.19169663, 0.6779187, 0.00443609, 0.3774687, 0.9506623, 0.7094468, 0.58767784,
                0.03172767
            ],
            [
                0.6285938, 0.98233837, 0.03557209, 0.83148056, 0.75442624, 0.38569495, 0.25909922,
                0.95153046, 0.8117266, 0.88158226, 0.07801159, 0.5813491, 0.7766183, 0.24579029,
                0.36638218
            ],
            [
                0.593045, 0.11644165, 0.88262135, 0.387658, 0.77495795, 0.25623822, 0.5845634,
                0.81630516, 0.49439427, 0.41682282, 0.16960712, 0.37704077, 0.22635967, 0.20513158,
                0.84864706
            ],
            [
                0.6610441, 0.89163846, 0.32323685, 0.04870174, 0.49266648, 0.03915601, 0.8964746,
                0.69952846, 0.5327131, 0.7900404, 0.59835905, 0.6082029, 0.94017506, 0.05741822,
                0.42909053
            ],
            [
                0.67005056, 0.28204504, 0.85819334, 0.0209764, 0.20048927, 0.01390582, 0.46196643,
                0.15762445, 0.499617, 0.17955706, 0.5053907, 0.08512774, 0.7657655, 0.89461756,
                0.46455798
            ]
        ],
        [
            [
                0.4190012, 0.9426482, 0.06247951, 0.9380578, 0.67081356, 0.7296007, 0.99668366,
                0.13935266, 0.8814927, 0.71436095, 0.46699953, 0.7036942, 0.8610916, 0.5170714,
                0.10468922
            ],
            [
                0.10358261, 0.68282384, 0.09809778, 0.36897844, 0.10924568, 0.6669035, 0.99931854,
                0.4570658, 0.0053557, 0.63773346, 0.38177422, 0.78964704, 0.22144185, 0.25461558,
                0.29020688
            ],
            [
                0.02204337, 0.01328652, 0.20315678, 0.89128757, 0.7233385, 0.6103354, 0.64626336,
                0.43063965, 0.89974195, 0.81109744, 0.7737425, 0.5617421, 0.13211827, 0.7181885,
                0.7370741
            ],
            [
                0.76509213, 0.25061274, 0.52416605, 0.5912433, 0.749399, 0.06644251, 0.86116064,
                0.87452865, 0.37337267, 0.32470486, 0.8629337, 0.32300463, 0.59494466, 0.5109057,
                0.19303699
            ],
            [
                0.5384057, 0.34216973, 0.10760719, 0.19907883, 0.89787817, 0.4034518, 0.5977899,
                0.5956558, 0.8714083, 0.816772, 0.936788, 0.75164974, 0.75292015, 0.3562423,
                0.6503287
            ],
            [
                0.44359317, 0.4586769, 0.73844457, 0.32330677, 0.07823598, 0.5714621, 0.4948407,
                0.1610259, 0.02523749, 0.649029, 0.8270277, 0.6149189, 0.93847483, 0.64382327,
                0.4919873
            ],
            [
                0.91097987, 0.00277769, 0.29285988, 0.16027041, 0.65083206, 0.995763, 0.97108686,
                0.39584368, 0.51881033, 0.08690485, 0.6064633, 0.5634319, 0.9112924, 0.30895233,
                0.46832308
            ],
            [
                0.70290804, 0.71988064, 0.6040845, 0.3930759, 0.50462973, 0.23936176, 0.6665472,
                0.28772652, 0.7927953, 0.13527313, 0.58754164, 0.21439199, 0.30696237, 0.6196051,
                0.04181933
            ],
            [
                0.73775756, 0.02812541, 0.98431385, 0.9063345, 0.42185846, 0.9276109, 0.15007965,
                0.55021775, 0.289677, 0.1833292, 0.30842447, 0.49076864, 0.96669614, 0.04084129,
                0.35507885
            ],
            [
                0.01814007, 0.7479788, 0.8905423, 0.18131162, 0.19868158, 0.04090299, 0.65749747,
                0.57093877, 0.31510696, 0.64917904, 0.25859907, 0.2167227, 0.6037249, 0.85155624,
                0.5934248
            ]
        ],
        [
            [
                0.45086634, 0.77940005, 0.8736465, 0.5989253, 0.8286887, 0.15409155, 0.50362885,
                0.2859167, 0.6136074, 0.26522028, 0.9713908, 0.79893595, 0.64536715, 0.29538262,
                0.10122196
            ],
            [
                0.60875165, 0.30008334, 0.14871117, 0.00413612, 0.2107808, 0.5432134, 0.02036078,
                0.69118625, 0.96890044, 0.35667476, 0.91332984, 0.07994127, 0.48464364, 0.53717005,
                0.8391672
            ],
            [
                0.03976207, 0.36710665, 0.9463259, 0.8534573, 0.56128335, 0.64364487, 0.3926361,
                0.4170473, 0.47033504, 0.70935535, 0.5794653, 0.7614045, 0.20673601, 0.02936963,
                0.43874255
            ],
            [
                0.81053114, 0.7479541, 0.50848794, 0.43798095, 0.13376763, 0.41153213, 0.827404,
                0.39059168, 0.07979204, 0.61979955, 0.504084, 0.6290239, 0.32398036, 0.3937467,
                0.89219904
            ],
            [
                0.23442265, 0.6643951, 0.85124665, 0.4903241, 0.96387124, 0.1122576, 0.3203506,
                0.3523639, 0.6533742, 0.18329354, 0.3261788, 0.6063784, 0.7675587, 0.44953194,
                0.6804148
            ],
            [
                0.86294836, 0.72663987, 0.22153868, 0.8682497, 0.5259329, 0.84534544, 0.18415472,
                0.34274703, 0.04164672, 0.45520982, 0.10496355, 0.2327848, 0.35637233, 0.46164095,
                0.58657897
            ],
            [
                0.37128884, 0.5974109, 0.41323513, 0.44130582, 0.7376491, 0.71878195, 0.9567159,
                0.1044322, 0.16972984, 0.35110536, 0.49803263, 0.034162, 0.13330385, 0.8390908,
                0.52084947
            ],
            [
                0.09820733, 0.9408774, 0.6671149, 0.5558139, 0.89639056, 0.7375653, 0.14148174,
                0.94796795, 0.01578032, 0.7108884, 0.09141636, 0.6177631, 0.96225774, 0.7895638,
                0.43049824
            ],
            [
                0.2672367, 0.21532029, 0.80645573, 0.26337162, 0.94534796, 0.1460291, 0.14453587,
                0.08474472, 0.4046785, 0.26673344, 0.6523437, 0.45077804, 0.8720595, 0.36576104,
                0.04412812
            ],
            [
                0.9061917, 0.52903134, 0.788834, 0.542214, 0.9633163, 0.6659382, 0.71387595,
                0.24455306, 0.68463975, 0.8682564, 0.36915916, 0.58109003, 0.7836765, 0.7414806,
                0.29041967
            ]
        ]
    ];

    let kernel28: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.27071622, 0.30966452, 0.43780544, 0.28946808, 0.04104009, 0.95437837, 0.14940616,
            0.26448897, 0.2837005, 0.7370394, 0.20896952, 0.57508224, 0.3794778, 0.8640644,
            0.94915074, 0.642038, 0.35661012, 0.73098284, 0.7336554, 0.86937773, 0.9386434,
            0.62070507, 0.9777092, 0.83098185, 0.7334, 0.653738, 0.8729656, 0.24981211, 0.72182435,
            0.35535765, 0.3482671, 0.5836978, 0.16817525, 0.37823164, 0.13544826, 0.943128,
            0.6893849, 0.17785989, 0.6745226, 0.40073133, 0.6776065, 0.6604207, 0.68245,
            0.83328646, 0.53185767, 0.95012033, 0.71586764, 0.08795565, 0.8579466, 0.62508,
            0.086858, 0.74366426, 0.69963, 0.28912175, 0.69418097, 0.3045057, 0.37725106,
            0.21402417, 0.99095803, 0.9444469, 0.9641975, 0.7854417, 0.2906773, 0.27387303,
            0.49124828, 0.93768966, 0.05329061, 0.58051914, 0.13008866, 0.43624556, 0.3100783,
            0.2068124, 0.87948585, 0.39172128, 0.7916404, 0.00728843, 0.56209844, 0.21866381,
            0.07425722, 0.6886099, 0.6087829, 0.25238475, 0.34377146, 0.2867535, 0.4734937,
            0.401071, 0.24293931, 0.9401134, 0.5180471, 0.88465524, 0.6262082, 0.5640479,
            0.6939464, 0.3965446, 0.26370257, 0.2780351, 0.00836088, 0.14558306, 0.26807052,
            0.4794361, 0.9650063, 0.34639996, 0.74213487, 0.14086223, 0.94934595, 0.8577047,
            0.88866836, 0.5409814, 0.7848356, 0.6680133, 0.05912417, 0.0251855, 0.02245575,
            0.8910452, 0.957759, 0.25694835, 0.8063335, 0.57868785, 0.8156854, 0.32308507,
            0.6050338, 0.6664156, 0.10564744, 0.49661636, 0.78163576, 0.28800976, 0.5074585,
            0.01879729, 0.6606498, 0.07793587, 0.32657915, 0.85818803, 0.5134029, 0.6786498,
            0.8853166, 0.5262063, 0.6153344, 0.96728045, 0.749388, 0.08317637, 0.08443606,
            0.05819454, 0.9016847, 0.142612, 0.00963548, 0.5942677, 0.5428937, 0.15533587,
            0.20150587, 0.71967244,
        ],
    )
    .unwrap();
    let conv_layer28 = TransposedConvolutionLayer::new(kernel28, 1, Padding::Same);
    let target_output28: Array3<f32> = array![
        [
            [
                4.391198, 7.028557, 10.862957, 11.604218, 12.330409, 12.297991, 12.210323,
                11.925796, 13.070892, 13.491332, 14.127348, 13.45092, 13.138937, 10.854382,
                7.291576
            ],
            [
                8.756512, 12.934181, 16.941849, 16.627552, 16.778614, 15.855879, 17.553272,
                17.168518, 17.320553, 17.088854, 18.61764, 17.976854, 17.544348, 13.736857,
                11.304141
            ],
            [
                11.024119, 15.184922, 19.990028, 19.66811, 22.659224, 19.982344, 20.922672,
                20.864428, 20.539072, 22.272684, 22.331055, 22.893202, 23.05773, 19.551804,
                14.161863
            ],
            [
                9.455943, 15.095545, 19.23581, 19.727844, 20.947268, 19.083092, 19.23896,
                21.407856, 21.149525, 20.183506, 22.790722, 22.193073, 23.044422, 18.35538,
                14.5364685
            ],
            [
                11.760117, 14.816237, 20.631306, 20.66373, 22.01562, 22.619509, 21.59759,
                19.884485, 20.24363, 19.669495, 22.339634, 21.102053, 20.900805, 18.80581,
                14.693212
            ],
            [
                11.28948, 17.408993, 21.990313, 21.687868, 21.884525, 21.756367, 22.069262,
                19.888985, 19.992947, 17.730959, 19.658459, 18.868004, 20.526936, 19.436806,
                14.472628
            ],
            [
                12.501583, 15.752483, 22.545889, 21.497425, 20.727852, 20.507448, 19.451542,
                19.084455, 18.03256, 17.90503, 19.77177, 20.934036, 20.723043, 18.319836,
                13.899531
            ],
            [
                12.519668, 16.819912, 21.664562, 20.683636, 21.122496, 20.107468, 19.37154,
                19.41715, 18.424746, 18.604864, 18.532572, 19.457518, 20.832453, 17.627308,
                14.708981
            ],
            [
                11.076367, 12.157215, 17.28229, 16.488281, 17.239983, 13.917303, 16.512272,
                14.240911, 16.872005, 14.075827, 14.623369, 15.283516, 15.191849, 12.855664,
                10.444447
            ],
            [
                7.319547, 10.0892935, 13.600396, 13.721038, 12.611778, 10.317478, 11.80583,
                11.248824, 11.241737, 10.829291, 12.040044, 12.012763, 10.94526, 9.768264, 9.22687
            ]
        ],
        [
            [
                5.473233, 7.5929937, 10.31676, 9.714638, 10.560007, 10.00389, 9.345175, 11.928784,
                10.685206, 11.483252, 12.007737, 11.83084, 11.960723, 8.459566, 5.324386
            ],
            [
                8.7399845, 12.110366, 14.706259, 12.735712, 14.501718, 14.961424, 13.55531,
                14.006638, 15.799024, 16.283304, 15.494068, 14.643114, 13.993602, 11.410899,
                8.059133
            ],
            [
                9.855176, 13.415007, 18.123056, 19.031984, 18.40223, 18.775867, 18.64796,
                18.014467, 19.124416, 20.246716, 20.559998, 20.07046, 19.694939, 14.946854,
                10.878111
            ],
            [
                10.58813, 14.992251, 16.477457, 17.46468, 17.66681, 17.290634, 17.491709,
                17.938848, 17.273165, 19.50048, 18.804516, 19.961647, 17.868351, 15.535423,
                10.744764
            ],
            [
                9.810164, 14.423647, 18.058554, 19.567726, 19.979763, 18.443136, 18.174767,
                17.295305, 18.961267, 18.47638, 18.161285, 19.016472, 18.546103, 16.327444,
                10.9858
            ],
            [
                12.630569, 15.805079, 18.088865, 17.84699, 19.846403, 19.391014, 18.847485,
                16.94548, 17.219835, 16.620005, 16.414791, 17.839945, 18.08015, 15.7900915,
                10.394211
            ],
            [
                12.081272, 16.884825, 17.753813, 19.514452, 18.105852, 18.053164, 17.735607,
                16.812828, 15.256389, 16.70357, 18.217531, 18.050097, 18.48771, 15.088807,
                11.310664
            ],
            [
                12.602452, 14.785944, 17.742449, 16.850857, 19.85412, 17.495596, 17.103668,
                16.43859, 16.277092, 14.930902, 15.930745, 18.763565, 18.020395, 15.413745,
                10.654909
            ],
            [
                10.872542, 13.395695, 14.84033, 16.283241, 15.25546, 14.631334, 13.913084,
                14.278856, 14.382934, 13.312131, 14.22128, 15.058695, 15.114274, 11.395934,
                7.672049
            ],
            [
                9.271163, 10.036175, 12.419241, 11.460612, 11.775125, 9.579101, 11.129603,
                9.450605, 10.222071, 9.316097, 10.1388035, 11.041974, 10.838005, 9.087918,
                6.5274663
            ]
        ]
    ];
    let current_output28: Array3<f32> = conv_layer28.transposed_convolve(&test_input28);

    assert!(
        arr_allclose(&current_output28, &target_output28),
        "{:?} was not equal to {:?}",
        current_output28,
        target_output28
    );

    let test_input29 = array![
        [
            [
                0.72830147, 0.12628911, 0.21088025, 0.49349034, 0.43138954, 0.34552416, 0.7450954,
                0.97053164, 0.46846384, 0.6232328, 0.7043483, 0.6836244, 0.31152937, 0.94308263,
                0.43000144
            ],
            [
                0.33454096, 0.14056973, 0.611405, 0.27392066, 0.4327331, 0.64145637, 0.89486116,
                0.67937464, 0.02869601, 0.42724633, 0.35241675, 0.04600743, 0.78698754, 0.5448518,
                0.3284605
            ],
            [
                0.49451345, 0.21562184, 0.44458547, 0.25720897, 0.1242256, 0.6427825, 0.34415206,
                0.6128491, 0.37608314, 0.1440366, 0.38643095, 0.4101457, 0.3221297, 0.34485012,
                0.33282575
            ],
            [
                0.0460793, 0.2533245, 0.44446903, 0.6419525, 0.5014819, 0.40299276, 0.30419075,
                0.22077623, 0.93352777, 0.37332574, 0.11432823, 0.67092514, 0.67013305, 0.22819203,
                0.02291649
            ],
            [
                0.15169823, 0.47379535, 0.5134847, 0.9957515, 0.18616559, 0.34876946, 0.04149048,
                0.9083124, 0.26675963, 0.46418855, 0.40885165, 0.5329374, 0.01732482, 0.939109,
                0.8124446
            ],
            [
                0.78512514, 0.71074295, 0.71019447, 0.7923134, 0.9993663, 0.54635274, 0.8527194,
                0.34598657, 0.32072914, 0.14892793, 0.543864, 0.33485237, 0.7944636, 0.5738517,
                0.11753287
            ],
            [
                0.48184916, 0.27829847, 0.26945496, 0.00687684, 0.32211357, 0.40955108, 0.7453399,
                0.10542034, 0.10177517, 0.19647941, 0.6590129, 0.54292524, 0.581209, 0.97207654,
                0.38797417
            ],
            [
                0.7705313, 0.03351595, 0.11553944, 0.2804876, 0.69780874, 0.41498303, 0.54379225,
                0.63825154, 0.489764, 0.5235754, 0.5119365, 0.07972992, 0.7766281, 0.24890615,
                0.4379786
            ],
            [
                0.8254111, 0.7851793, 0.41174975, 0.71481776, 0.574494, 0.6071982, 0.0409529,
                0.5377346, 0.9360621, 0.3381931, 0.35035086, 0.09973033, 0.29451317, 0.36838105,
                0.29073936
            ],
            [
                0.9291736, 0.6620522, 0.7491774, 0.39614668, 0.86199474, 0.31398645, 0.83245677,
                0.91986793, 0.50500655, 0.86213195, 0.15356342, 0.46905828, 0.20415573, 0.76482034,
                0.07480988
            ]
        ],
        [
            [
                0.4810423, 0.34039715, 0.9782196, 0.63296366, 0.832524, 0.19085021, 0.40025955,
                0.0326517, 0.8186835, 0.7325834, 0.41122815, 0.6526222, 0.36910674, 0.7136264,
                0.25965685
            ],
            [
                0.53819305, 0.11709321, 0.58894736, 0.6138686, 0.28326783, 0.6653923, 0.41513366,
                0.4295241, 0.09743366, 0.58706856, 0.93710643, 0.49820793, 0.66467035, 0.84335977,
                0.44126457
            ],
            [
                0.623791, 0.79868734, 0.9941017, 0.76568323, 0.43892092, 0.5885675, 0.61389095,
                0.41979283, 0.55150396, 0.73826283, 0.42829567, 0.87643564, 0.77321035, 0.16042678,
                0.45909578
            ],
            [
                0.15327883, 0.5644814, 0.09073992, 0.32729542, 0.8538341, 0.821377, 0.6152581,
                0.01471354, 0.19805598, 0.9826014, 0.69645983, 0.15713291, 0.30370897, 0.06043342,
                0.8925899
            ],
            [
                0.04033276, 0.90393054, 0.15386185, 0.9615689, 0.6203435, 0.7905859, 0.88237697,
                0.32635626, 0.29856467, 0.5456311, 0.47385228, 0.00915442, 0.53801316, 0.71369445,
                0.1414952
            ],
            [
                0.65815043, 0.87843835, 0.9155266, 0.7197181, 0.14472856, 0.09964891, 0.50462043,
                0.9706875, 0.5687808, 0.63791186, 0.76876044, 0.45858192, 0.84355897, 0.9146345,
                0.90978503
            ],
            [
                0.2965426, 0.8341575, 0.29191148, 0.67013, 0.81577414, 0.5692431, 0.16895083,
                0.8106494, 0.33738822, 0.60443205, 0.20035183, 0.5940091, 0.66140157, 0.69123244,
                0.65821964
            ],
            [
                0.91230327, 0.01167769, 0.85134035, 0.3706558, 0.25848427, 0.32535982, 0.21403822,
                0.46848047, 0.8125153, 0.14009006, 0.24669136, 0.9933974, 0.9334011, 0.02075709,
                0.7062211
            ],
            [
                0.9753566, 0.75037724, 0.10823289, 0.81256217, 0.34410152, 0.2658827, 0.19256027,
                0.44302413, 0.8819447, 0.39127982, 0.12908751, 0.766889, 0.7112464, 0.40134144,
                0.91092515
            ],
            [
                0.6483908, 0.72450227, 0.7959583, 0.22098504, 0.6806006, 0.47037923, 0.6456751,
                0.4129692, 0.10004628, 0.99257857, 0.9943822, 0.2298542, 0.3710484, 0.7948807,
                0.0218896
            ]
        ],
        [
            [
                0.29747528, 0.66862303, 0.7027586, 0.28309256, 0.12966096, 0.2102668, 0.00434357,
                0.8537074, 0.6384537, 0.28613988, 0.07200554, 0.9220898, 0.29156443, 0.20230392,
                0.12076156
            ],
            [
                0.9262169, 0.4685829, 0.54507136, 0.63722897, 0.22608623, 0.8070677, 0.6588202,
                0.09731943, 0.66976017, 0.44286728, 0.5556714, 0.7296178, 0.3757277, 0.9153033,
                0.30326086
            ],
            [
                0.9373011, 0.82334846, 0.6013252, 0.17847821, 0.933161, 0.43297368, 0.34233874,
                0.05711227, 0.31655025, 0.8154832, 0.15421379, 0.5095584, 0.63099545, 0.05136881,
                0.58640176
            ],
            [
                0.2841808, 0.17580464, 0.24830963, 0.22112615, 0.14183968, 0.1538982, 0.40688464,
                0.6403477, 0.5033122, 0.32590672, 0.2776557, 0.55745614, 0.58164865, 0.8386445,
                0.10407941
            ],
            [
                0.9322462, 0.44768435, 0.9392266, 0.62725556, 0.6381474, 0.1170303, 0.19262674,
                0.7731976, 0.44253886, 0.45300108, 0.34005156, 0.76790696, 0.75952363, 0.0758354,
                0.09234454
            ],
            [
                0.04076992, 0.76872426, 0.9909418, 0.20562991, 0.7001826, 0.62174463, 0.985399,
                0.556648, 0.6482777, 0.39525425, 0.6316854, 0.18450475, 0.76438385, 0.76688606,
                0.8842339
            ],
            [
                0.51201636, 0.8625359, 0.8994167, 0.7224541, 0.904941, 0.92042744, 0.7610599,
                0.44392368, 0.01097407, 0.9967803, 0.86405486, 0.8574425, 0.08438116, 0.9640647,
                0.3194906
            ],
            [
                0.62963116, 0.7570701, 0.7373254, 0.49274814, 0.2724401, 0.5140253, 0.5354187,
                0.05470186, 0.6003584, 0.03887321, 0.8792441, 0.07487831, 0.27293208, 0.20637059,
                0.51803577
            ],
            [
                0.39701787, 0.72405595, 0.79549944, 0.7749441, 0.2867524, 0.20061469, 0.8169241,
                0.55709773, 0.7601233, 0.5019855, 0.42288148, 0.08264151, 0.07166909, 0.276497,
                0.47881734
            ],
            [
                0.6850887, 0.56579995, 0.19379972, 0.4292294, 0.74686694, 0.28073508, 0.89885855,
                0.9140157, 0.18914956, 0.76787716, 0.8754045, 0.3814875, 0.06747322, 0.53072727,
                0.8520588
            ]
        ]
    ];

    let kernel29: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.50530857, 0.9750424, 0.9426884, 0.8974862, 0.07379336, 0.44949004, 0.07702624,
            0.58448553, 0.9419923, 0.92478794, 0.74485207, 0.02757184, 0.5473436, 0.4095134,
            0.34430748, 0.57895464, 0.3646808, 0.702094, 0.42561463, 0.7240333, 0.3525894,
            0.8684342, 0.05176349, 0.4534876, 0.29978636, 0.6813054, 0.6195228, 0.9412474,
            0.49756896, 0.6434084, 0.43305027, 0.49434406, 0.78730005, 0.02698292, 0.742061,
            0.83714837, 0.63883966, 0.22828956, 0.60320866, 0.19989622, 0.4069967, 0.23004848,
            0.33230868, 0.5754259, 0.9209239, 0.24726972, 0.2871842, 0.01286999, 0.47823748,
            0.7681336, 0.70387655, 0.76817197, 0.2309508, 0.6904621, 0.97214407, 0.45720655,
            0.98188174, 0.76853514, 0.55286586, 0.93719435, 0.31309557, 0.35013178, 0.9241995,
            0.01397916, 0.33568096, 0.21494278, 0.00972885, 0.71777475, 0.8066913, 0.20298374,
            0.14742629, 0.7454754, 0.29411134, 0.8339385, 0.58989936, 0.29956096, 0.83461505,
            0.32731465, 0.12421638, 0.35614854, 0.02120854, 0.9336216, 0.22670202, 0.74599475,
            0.79463094, 0.9929924, 0.13419491, 0.09957198, 0.21009064, 0.5540474, 0.65914136,
            0.933098, 0.20652905, 0.3130356, 0.62718195, 0.93904084, 0.92252886, 0.30511644,
            0.1139876, 0.11635401, 0.31261826, 0.19285402, 0.280705, 0.5620004, 0.01224133,
            0.7102519, 0.49543428, 0.6244645, 0.8195261, 0.12662244, 0.9543515, 0.68265325,
            0.41329095, 0.10928836, 0.9265891, 0.3915789, 0.92095965, 0.7615438, 0.1821485,
            0.813764, 0.36687315, 0.7539482, 0.5598573, 0.20492053, 0.04716022, 0.77011496,
            0.03941628, 0.80579597, 0.99227834, 0.38292918, 0.44932705, 0.297381, 0.7108874,
            0.40025625, 0.76151, 0.3181267, 0.91652894, 0.5665076, 0.06015028, 0.2746252,
            0.5510717, 0.02963078, 0.6115425, 0.3630788, 0.360078, 0.50875646, 0.6378897,
            0.05874534, 0.89963144, 0.983706,
        ],
    )
    .unwrap();
    let conv_layer29 = TransposedConvolutionLayer::new(kernel29, 1, Padding::Same);
    let target_output29: Array3<f32> = array![
        [
            [
                8.835194, 10.228428, 11.542209, 10.74483, 10.879693, 9.954845, 9.288264, 12.241865,
                11.808928, 11.125305, 11.569678, 11.868858, 10.977063, 6.9632983, 5.0001535
            ],
            [
                9.82762, 11.536268, 13.996778, 15.152721, 15.533686, 14.473514, 14.27635,
                13.628962, 14.527879, 15.652072, 15.800181, 15.200644, 14.12016, 10.814566,
                7.085066
            ],
            [
                12.642229, 17.36763, 17.377989, 18.856361, 19.125977, 19.190035, 18.804533,
                18.370888, 16.735598, 18.63918, 20.426262, 18.483047, 17.262552, 13.365274,
                10.061968
            ],
            [
                12.81321, 17.674854, 20.179218, 20.713053, 20.455605, 19.658535, 19.022057,
                19.046238, 18.328093, 18.078514, 18.505726, 20.138887, 19.861923, 14.99089,
                9.661642
            ],
            [
                13.981738, 18.522007, 21.220936, 20.889448, 21.27148, 18.554962, 18.591597,
                19.267326, 18.845045, 17.779675, 19.809458, 20.821894, 19.738598, 14.494005,
                11.105653
            ],
            [
                13.2271805, 17.381319, 20.188248, 19.817015, 20.032106, 20.260952, 19.3375,
                19.095617, 19.78931, 18.454918, 18.799643, 20.56874, 20.319845, 15.600822,
                9.847386
            ],
            [
                15.778528, 18.720266, 23.549793, 21.554003, 21.317524, 20.275864, 19.706057,
                18.357464, 19.422882, 18.054346, 20.203018, 19.343412, 19.609179, 13.699014,
                12.026739
            ],
            [
                15.489515, 19.50573, 21.879257, 21.459305, 21.282608, 22.460138, 20.49047,
                20.190613, 20.325525, 19.530758, 19.290369, 20.580677, 20.441507, 14.62343,
                10.306765
            ],
            [
                11.863487, 14.110725, 18.858456, 17.199524, 16.395102, 16.742935, 16.794773,
                15.831186, 17.12869, 17.149256, 13.783436, 15.174334, 15.683117, 11.435826,
                7.1247206
            ],
            [
                9.928174, 12.694616, 12.705311, 12.388412, 12.541806, 12.639946, 12.290657,
                12.952018, 13.072084, 12.6897745, 11.270626, 10.166343, 10.039294, 8.176359,
                5.688039
            ]
        ],
        [
            [
                7.534791, 9.481178, 12.112937, 11.411227, 10.933056, 11.632076, 10.429698,
                11.238346, 11.330604, 10.429394, 11.498092, 12.098945, 11.087963, 9.282321,
                6.982416
            ],
            [
                8.060826, 11.100111, 12.295084, 13.828546, 15.034921, 13.492699, 13.922349,
                12.469249, 13.331431, 15.610873, 14.310167, 14.567118, 13.735601, 11.299003,
                8.563578
            ],
            [
                9.942959, 14.624673, 17.136599, 18.915749, 18.607233, 18.187279, 16.553484,
                17.107662, 16.010902, 18.776236, 18.935026, 17.676884, 16.050125, 14.859469,
                9.532503
            ],
            [
                11.662383, 14.40153, 19.811275, 19.03373, 19.80416, 18.934515, 19.697317,
                18.842651, 17.050756, 15.797435, 18.241774, 18.581627, 18.740623, 15.762677,
                11.644953
            ],
            [
                11.548491, 16.30158, 21.199926, 21.026949, 19.848993, 18.2967, 17.808943,
                17.961111, 18.36856, 16.577505, 16.986708, 19.349316, 18.159298, 15.558071,
                12.40832
            ],
            [
                11.308604, 14.228183, 19.354824, 17.00078, 18.712172, 18.217302, 17.842073,
                16.194517, 17.038113, 17.900154, 18.165876, 18.620922, 18.748817, 15.542483,
                12.623352
            ],
            [
                13.0661955, 17.383545, 21.260754, 20.19105, 19.776043, 19.246067, 18.590837,
                17.073427, 18.79073, 17.443174, 18.610987, 17.571781, 18.117933, 15.0332575,
                11.99639
            ],
            [
                13.707646, 18.483105, 22.708035, 21.3861, 20.060484, 18.291494, 18.925104,
                18.913296, 19.719933, 19.585583, 17.301805, 18.736435, 17.994143, 15.444076,
                10.755151
            ],
            [
                9.776016, 13.511634, 15.682551, 15.355897, 15.194582, 14.759788, 15.305514,
                14.46809, 14.674765, 14.137371, 13.712009, 13.885961, 13.864046, 11.213215,
                7.9942865
            ],
            [
                7.457559, 8.776027, 10.455425, 9.930943, 10.317989, 10.110828, 9.481658, 10.421288,
                10.780935, 9.12715, 8.515165, 9.157316, 9.577764, 6.3059506, 4.2725635
            ]
        ]
    ];
    let current_output29: Array3<f32> = conv_layer29.transposed_convolve(&test_input29);

    assert!(
        arr_allclose(&current_output29, &target_output29),
        "{:?} was not equal to {:?}",
        current_output29,
        target_output29
    );

    let test_input30 = array![
        [
            [
                0.5667618, 0.47099027, 0.47917756, 0.45727775, 0.27296266, 0.3946846, 0.6628078,
                0.03331716, 0.49148887, 0.59586257, 0.01606598, 0.9504296, 0.7124893, 0.15454087,
                0.12836388
            ],
            [
                0.7521275, 0.11432698, 0.60128045, 0.86433274, 0.17594509, 0.28163853, 0.99160874,
                0.7874973, 0.80251557, 0.32389107, 0.95163566, 0.15414724, 0.38786727, 0.22434442,
                0.36910075
            ],
            [
                0.6870394, 0.2364627, 0.35967445, 0.4150253, 0.97400707, 0.3257614, 0.276526,
                0.9512516, 0.23454542, 0.09603767, 0.59679747, 0.41278225, 0.52654785, 0.38265473,
                0.64929485
            ],
            [
                0.38452545, 0.92784274, 0.7618796, 0.8277444, 0.16376635, 0.53257054, 0.7229681,
                0.6112262, 0.44207692, 0.23045352, 0.16744782, 0.0356647, 0.3767027, 0.821366,
                0.7706346
            ],
            [
                0.3181389, 0.64781266, 0.6104085, 0.1566584, 0.06507342, 0.9880099, 0.45063683,
                0.7074567, 0.33940628, 0.47413573, 0.00417143, 0.5115043, 0.5595756, 0.28336376,
                0.20063439
            ],
            [
                0.1948837, 0.5315253, 0.59695166, 0.357809, 0.12895541, 0.6529207, 0.9782477,
                0.89964604, 0.9498012, 0.6019669, 0.0485845, 0.5627219, 0.12700436, 0.2938843,
                0.34907413
            ],
            [
                0.8361791, 0.9286944, 0.11734205, 0.57116467, 0.45399174, 0.00822227, 0.7424489,
                0.70879227, 0.36706752, 0.12790425, 0.2808679, 0.65706384, 0.60008967, 0.55780596,
                0.40614346
            ],
            [
                0.9670991, 0.02119358, 0.76233196, 0.1335385, 0.5544648, 0.84080833, 0.5056472,
                0.61273175, 0.82810396, 0.02627662, 0.6991408, 0.8764322, 0.2854147, 0.95856047,
                0.54751694
            ],
            [
                0.27424163, 0.58757967, 0.53866595, 0.12254146, 0.67245907, 0.34793955, 0.19376805,
                0.506725, 0.22224124, 0.16964851, 0.11521567, 0.3380149, 0.32355502, 0.7983169,
                0.8318989
            ],
            [
                0.38369516, 0.26684988, 0.26137856, 0.8601494, 0.76127535, 0.5854671, 0.49431488,
                0.23544747, 0.97814244, 0.20782107, 0.75460297, 0.86213845, 0.6136204, 0.1428586,
                0.74553275
            ]
        ],
        [
            [
                0.0615097, 0.20476887, 0.07993042, 0.667372, 0.35334712, 0.54035354, 0.5921841,
                0.97238636, 0.10852766, 0.23591948, 0.14727278, 0.7882729, 0.40342537, 0.9172967,
                0.67827153
            ],
            [
                0.0885525, 0.13105007, 0.71030563, 0.8489956, 0.34692028, 0.5237413, 0.98716795,
                0.16775067, 0.76060826, 0.4847811, 0.08279882, 0.91985404, 0.8013939, 0.45085528,
                0.26740268
            ],
            [
                0.58077246, 0.5733173, 0.04986718, 0.93287325, 0.05021113, 0.77452326, 0.4646726,
                0.754572, 0.3516655, 0.9564967, 0.9254513, 0.36499265, 0.1969826, 0.8125049,
                0.00992131
            ],
            [
                0.5704238, 0.42519063, 0.53880835, 0.96389097, 0.7187758, 0.9441945, 0.31255576,
                0.4034218, 0.0014252, 0.75604063, 0.06046879, 0.05295985, 0.06846811, 0.20416068,
                0.05742439
            ],
            [
                0.42463785, 0.97875047, 0.571192, 0.760323, 0.98050976, 0.56514394, 0.3479823,
                0.72981095, 0.3247372, 0.81740284, 0.09636249, 0.03579908, 0.620937, 0.1778051,
                0.7737135
            ],
            [
                0.93435144, 0.89571637, 0.08518936, 0.3685996, 0.95145816, 0.23018053, 0.72776824,
                0.20666201, 0.45572925, 0.20725566, 0.5647976, 0.7174395, 0.5364489, 0.6196746,
                0.46438593
            ],
            [
                0.5979005, 0.5177032, 0.74731666, 0.12481042, 0.31901592, 0.04100234, 0.00186503,
                0.5806271, 0.8394702, 0.01636839, 0.40118745, 0.50362355, 0.15961704, 0.42394295,
                0.02571392
            ],
            [
                0.6550488, 0.22493349, 0.88472325, 0.47986633, 0.5717081, 0.12507369, 0.96629083,
                0.29380217, 0.9209699, 0.20907214, 0.45186043, 0.71682435, 0.8384509, 0.48852056,
                0.44777775
            ],
            [
                0.0653377, 0.69151664, 0.7626047, 0.46192428, 0.67224646, 0.677549, 0.8786855,
                0.39687312, 0.03901054, 0.5827172, 0.8120747, 0.4156933, 0.53191704, 0.08031714,
                0.11900131
            ],
            [
                0.5701323, 0.93563837, 0.23327391, 0.7704617, 0.15995595, 0.24310802, 0.7719216,
                0.27448082, 0.95520747, 0.23724665, 0.63934964, 0.02262862, 0.06705096, 0.62448984,
                0.4417019
            ]
        ],
        [
            [
                0.5930892, 0.5991312, 0.73476076, 0.22280538, 0.717532, 0.25907314, 0.6727529,
                0.897963, 0.4837477, 0.5108879, 0.6134764, 0.6153182, 0.7833414, 0.54200786,
                0.9240969
            ],
            [
                0.85558444, 0.31820816, 0.1011515, 0.07551479, 0.9777943, 0.6836994, 0.5013383,
                0.761889, 0.41748646, 0.9538053, 0.84875965, 0.33436137, 0.810466, 0.9302773,
                0.3075985
            ],
            [
                0.44584537, 0.07434042, 0.7434859, 0.39288393, 0.05018714, 0.6373778, 0.03931054,
                0.05808247, 0.58985513, 0.50732195, 0.51649344, 0.8596193, 0.92285204, 0.6455111,
                0.3299486
            ],
            [
                0.34296578, 0.81074446, 0.40738177, 0.9192294, 0.5966109, 0.40765414, 0.4672099,
                0.17243455, 0.7998316, 0.1655954, 0.53781074, 0.8058298, 0.36791065, 0.11123637,
                0.22371608
            ],
            [
                0.7862877, 0.2244199, 0.83121973, 0.14220245, 0.6843492, 0.00031969, 0.07502594,
                0.0637355, 0.8543445, 0.58337855, 0.09831745, 0.41955474, 0.47344962, 0.90437984,
                0.9870612
            ],
            [
                0.6497555, 0.7180505, 0.23386012, 0.44216573, 0.38779065, 0.78058594, 0.04839599,
                0.18846695, 0.6188481, 0.01519543, 0.547898, 0.95779073, 0.5743346, 0.49206603,
                0.2684415
            ],
            [
                0.1387522, 0.3020447, 0.13914646, 0.03782934, 0.9697794, 0.9211447, 0.91893643,
                0.55230945, 0.03046237, 0.12353099, 0.5072917, 0.6198439, 0.18660152, 0.24114372,
                0.972636
            ],
            [
                0.31776157, 0.37243053, 0.02969686, 0.27061638, 0.14747076, 0.43885142, 0.26169124,
                0.30070016, 0.4919067, 0.03301751, 0.5209841, 0.21731514, 0.18078178, 0.6365186,
                0.7119963
            ],
            [
                0.4620669, 0.90874195, 0.15252946, 0.70473915, 0.45243505, 0.2812947, 0.5906247,
                0.28510863, 0.12205662, 0.7733135, 0.8664189, 0.39632502, 0.17231515, 0.8710543,
                0.74207234
            ],
            [
                0.66105676, 0.26450387, 0.80925, 0.8750729, 0.19343476, 0.22950833, 0.10453979,
                0.86698735, 0.00974295, 0.1181128, 0.19300883, 0.36536372, 0.5372932, 0.28143153,
                0.48863336
            ]
        ]
    ];

    let kernel30: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.9492269, 0.41179124, 0.8240807, 0.9112588, 0.5609045, 0.24533413, 0.27897462,
            0.19164045, 0.253367, 0.00792358, 0.43128836, 0.4048867, 0.10464846, 0.34664157,
            0.5441599, 0.10855968, 0.48210514, 0.96567094, 0.28461906, 0.70336026, 0.20942406,
            0.6900196, 0.69849616, 0.06679389, 0.45182633, 0.02423215, 0.9698898, 0.8125508,
            0.39074138, 0.2604667, 0.01168756, 0.09931149, 0.42283416, 0.33630532, 0.63446504,
            0.26917827, 0.79411626, 0.02465508, 0.5339084, 0.629768, 0.82886267, 0.4574871,
            0.09085662, 0.4393573, 0.2174027, 0.8552803, 0.21284348, 0.06316733, 0.9976707,
            0.42789793, 0.87520766, 0.7474987, 0.40441403, 0.76325786, 0.22450493, 0.5149799,
            0.5347564, 0.24169366, 0.42965254, 0.6642891, 0.7857891, 0.32416475, 0.27693877,
            0.7954661, 0.2456079, 0.546903, 0.11924994, 0.441892, 0.7871177, 0.66094375, 0.59043,
            0.5696462, 0.6763457, 0.07601654, 0.86751133, 0.5821612, 0.91824734, 0.7703309,
            0.92340004, 0.50115365, 0.22094135, 0.3861505, 0.93935686, 0.79677016, 0.48681432,
            0.2103115, 0.43076044, 0.3705898, 0.9633035, 0.09928917, 0.6016384, 0.34939328,
            0.981366, 0.6474216, 0.5910735, 0.4376617, 0.9752736, 0.3686795, 0.4676291, 0.48972946,
            0.05696018, 0.7972886, 0.7225226, 0.43851712, 0.8518784, 0.29709867, 0.47002542,
            0.6460705, 0.81212074, 0.2202636, 0.80249757, 0.36786792, 0.86260915, 0.19603604,
            0.9847158, 0.04300088, 0.85541666, 0.6850494, 0.40122688, 0.4459377, 0.20637396,
            0.5421798, 0.23370974, 0.05460319, 0.11931613, 0.16595952, 0.8852037, 0.4792622,
            0.14420728, 0.3877008, 0.87728816, 0.676638, 0.6441912, 0.0105973, 0.64494216,
            0.10876061, 0.50505143, 0.7889577, 0.27715787, 0.05322019, 0.05595717, 0.86899227,
            0.6531775, 0.13865112, 0.09313866, 0.03322331, 0.4860762, 0.80292696, 0.7346686,
            0.34085482,
        ],
    )
    .unwrap();
    let conv_layer30 = TransposedConvolutionLayer::new(kernel30, 1, Padding::Same);
    let target_output30: Array3<f32> = array![
        [
            [
                5.082411, 6.9811363, 10.027658, 9.57787, 10.46628, 9.8102045, 10.015021, 10.248083,
                10.161158, 11.834526, 12.150054, 11.928099, 11.957726, 7.963248, 6.031499
            ],
            [
                7.89163, 12.772153, 12.26267, 13.146941, 14.750043, 15.209052, 14.423099, 15.1156,
                13.951931, 14.567548, 14.299169, 14.680938, 12.711654, 9.576388, 7.3331294
            ],
            [
                9.80438, 14.083446, 16.633265, 18.037737, 18.091417, 19.375528, 17.728834,
                17.121855, 16.86522, 16.665894, 16.476858, 16.24236, 15.2911005, 14.239261,
                10.941451
            ],
            [
                10.226805, 14.839565, 18.224195, 18.706987, 16.687016, 17.902708, 17.257078,
                17.675611, 16.882648, 16.232199, 16.764765, 17.498068, 17.410564, 12.40915,
                10.081617
            ],
            [
                9.882958, 13.941566, 17.690111, 17.435726, 18.302626, 16.651226, 16.552183,
                15.653195, 14.460227, 16.018044, 15.600674, 15.282634, 15.566906, 11.793052,
                8.669733
            ],
            [
                10.648142, 11.940095, 17.713345, 18.923874, 16.978788, 16.926466, 16.577637,
                15.147805, 15.6183605, 16.67903, 14.007189, 13.558556, 15.03503, 12.506828,
                9.94994
            ],
            [
                10.259666, 13.077326, 17.351362, 16.71898, 15.938491, 15.928691, 18.364063,
                15.202786, 15.728148, 15.667491, 14.191853, 16.099447, 18.064621, 13.721187,
                10.344514
            ],
            [
                9.9502945, 13.345238, 17.471512, 16.980734, 16.785025, 16.14274, 16.641321,
                14.678906, 14.877789, 16.666895, 15.620586, 14.56039, 17.134977, 11.237475,
                9.214677
            ],
            [
                7.913786, 10.675219, 12.6374655, 12.163793, 12.535171, 12.674665, 13.614522,
                10.6778555, 13.5146055, 11.584822, 11.045906, 11.760009, 12.837036, 10.042121,
                8.251965
            ],
            [
                5.7266493, 8.0515785, 9.996235, 8.769979, 10.272368, 9.96069, 10.173191, 8.925026,
                9.439714, 9.553573, 8.48087, 9.96301, 11.350155, 7.894602, 6.3957305
            ]
        ],
        [
            [
                6.070893, 9.325675, 10.71299, 10.510324, 12.537209, 13.39825, 12.408892, 13.226499,
                13.130566, 13.10679, 14.031836, 12.934733, 13.373107, 10.391796, 7.1570797
            ],
            [
                8.640232, 12.391059, 15.147044, 14.729462, 16.528109, 15.592535, 16.14902,
                15.847806, 15.193512, 17.001625, 15.889814, 16.608412, 15.482687, 11.212918,
                8.555954
            ],
            [
                10.675723, 16.888338, 17.87263, 19.831036, 19.373737, 19.56024, 18.337095,
                19.591705, 17.368929, 17.547205, 17.571297, 17.706156, 17.15683, 13.693368,
                9.553771
            ],
            [
                12.773457, 15.768946, 19.664806, 20.687868, 21.190536, 18.894135, 18.883251,
                18.626741, 16.743952, 17.185137, 16.755648, 16.420935, 16.40738, 12.579479,
                9.506773
            ],
            [
                12.024183, 17.500933, 19.288418, 19.787493, 18.973057, 18.365389, 17.923016,
                16.808897, 16.701103, 16.055782, 16.670204, 15.307456, 15.75582, 14.768312,
                9.565917
            ],
            [
                13.049295, 14.821481, 19.273668, 18.94822, 18.65974, 19.023983, 19.244062,
                16.842583, 15.52914, 16.27844, 15.168354, 14.617903, 16.123337, 13.200782,
                8.795879
            ],
            [
                11.938253, 13.987234, 18.03146, 16.550175, 17.017994, 18.168125, 19.128769,
                18.17746, 16.345547, 17.097271, 15.682838, 14.895513, 18.105854, 14.065004,
                9.565775
            ],
            [
                12.015319, 15.79626, 17.156822, 16.728416, 17.084219, 16.089699, 19.402435,
                17.096786, 16.768772, 17.364586, 16.703093, 17.129005, 18.959318, 13.896597,
                9.831763
            ],
            [
                10.356002, 13.6458845, 16.58885, 15.707012, 14.705585, 16.249453, 15.124283,
                13.144169, 14.846281, 14.452044, 14.365159, 14.317395, 15.806097, 12.262725,
                8.305461
            ],
            [
                7.4423466, 9.861062, 11.832259, 11.3345175, 11.644127, 10.430543, 11.359026,
                9.6463785, 9.751432, 10.896851, 9.171242, 10.227472, 11.727559, 9.02467, 6.153448
            ]
        ]
    ];
    let current_output30: Array3<f32> = conv_layer30.transposed_convolve(&test_input30);

    assert!(
        arr_allclose(&current_output30, &target_output30),
        "{:?} was not equal to {:?}",
        current_output30,
        target_output30
    );

    let test_input31 = array![
        [
            [
                0.22366413, 0.9559822, 0.39359123, 0.918766, 0.24713755, 0.97354287, 0.30031595,
                0.646846, 0.86100614, 0.5927307
            ],
            [
                0.77701443, 0.7353488, 0.75909895, 0.15749992, 0.7252042, 0.418599, 0.29734525,
                0.04394295, 0.08683281, 0.56033915
            ],
            [
                0.89778495, 0.9356391, 0.5804607, 0.11317083, 0.5891579, 0.16632994, 0.13378483,
                0.4193809, 0.87546384, 0.70123386
            ],
            [
                0.388572, 0.28411996, 0.9058133, 0.7571178, 0.07648814, 0.00579745, 0.9926477,
                0.4134118, 0.72972006, 0.4035367
            ],
            [
                0.20193496, 0.5787671, 0.7442694, 0.36564475, 0.34799758, 0.6537169, 0.2493377,
                0.11057585, 0.15321027, 0.04929706
            ],
            [
                0.15874591, 0.918223, 0.5326479, 0.28466523, 0.18983062, 0.15093486, 0.63706064,
                0.2486271, 0.15147327, 0.23015541
            ],
            [
                0.0564075, 0.4164076, 0.0494167, 0.39736766, 0.6188377, 0.4857325, 0.6075087,
                0.38294655, 0.55927306, 0.7458996
            ],
            [
                0.37258524, 0.8335672, 0.54759806, 0.23857857, 0.3967958, 0.2904877, 0.0599105,
                0.6656314, 0.60404164, 0.53209305
            ],
            [
                0.6138407, 0.02453119, 0.24123603, 0.50096637, 0.75515634, 0.8553617, 0.76883376,
                0.5821534, 0.71071154, 0.34048933
            ],
            [
                0.11938792, 0.3079397, 0.5842305, 0.52923065, 0.70045173, 0.9220782, 0.9644087,
                0.58591944, 0.9706946, 0.93834573
            ],
            [
                0.82625586, 0.94433635, 0.6039389, 0.7857832, 0.2540799, 0.1222535, 0.7650698,
                0.6288214, 0.65616584, 0.4953644
            ],
            [
                0.9476699, 0.6121849, 0.04060835, 0.29578766, 0.284898, 0.9302907, 0.02829796,
                0.6076401, 0.36120784, 0.20330453
            ],
            [
                0.92832136, 0.69648266, 0.09161747, 0.3310522, 0.13664949, 0.49587065, 0.59203154,
                0.12048566, 0.2960291, 0.6490305
            ],
            [
                0.05182126, 0.4350942, 0.6826126, 0.29358104, 0.11258401, 0.90331846, 0.5695029,
                0.95304704, 0.89367306, 0.56095284
            ],
            [
                0.28479084, 0.04034042, 0.5622987, 0.62318027, 0.0669603, 0.46665603, 0.7837567,
                0.9197783, 0.25997233, 0.8822558
            ]
        ],
        [
            [
                0.47500426, 0.45390588, 0.91328347, 0.11114157, 0.58130014, 0.42161283, 0.22435202,
                0.6786595, 0.626042, 0.9052745
            ],
            [
                0.49089828, 0.8323424, 0.43142703, 0.30292293, 0.10168498, 0.609412, 0.5929657,
                0.4279403, 0.35090572, 0.64152
            ],
            [
                0.73762673, 0.71849394, 0.90201443, 0.96666175, 0.22773704, 0.58568764, 0.54191947,
                0.26351038, 0.81138736, 0.17099197
            ],
            [
                0.17488658, 0.36350128, 0.83560824, 0.31047368, 0.5966721, 0.78727365, 0.8525677,
                0.27676636, 0.03707253, 0.984327
            ],
            [
                0.08750063, 0.00369101, 0.01803041, 0.82741547, 0.3706341, 0.25904298, 0.7400234,
                0.06362636, 0.38593334, 0.8089435
            ],
            [
                0.35067967, 0.30580634, 0.9946834, 0.9228978, 0.91575414, 0.8869554, 0.8201089,
                0.0423787, 0.78767794, 0.14608072
            ],
            [
                0.51388735, 0.4259362, 0.99256146, 0.15876527, 0.9118279, 0.8744923, 0.98620844,
                0.81160706, 0.75233644, 0.00490773
            ],
            [
                0.8807022, 0.8256639, 0.79418176, 0.329496, 0.62387276, 0.9289905, 0.6164567,
                0.849313, 0.68667865, 0.6887567
            ],
            [
                0.45732895, 0.72385156, 0.33933628, 0.47798294, 0.6244013, 0.26071766, 0.6311077,
                0.11611937, 0.743333, 0.10704688
            ],
            [
                0.77574754, 0.28960332, 0.83815664, 0.9637926, 0.43227807, 0.5886029, 0.59747726,
                0.08082705, 0.810778, 0.18842922
            ],
            [
                0.48358884, 0.12607653, 0.35534695, 0.01038352, 0.17007513, 0.7482836, 0.6340702,
                0.6211811, 0.3572904, 0.29816568
            ],
            [
                0.94198835, 0.20344801, 0.3009928, 0.03229383, 0.8006004, 0.6669905, 0.04867727,
                0.1637364, 0.96934605, 0.3863808
            ],
            [
                0.9509189, 0.9466293, 0.05188827, 0.5583917, 0.5731704, 0.38338074, 0.70773387,
                0.11791705, 0.82375497, 0.1516157
            ],
            [
                0.80213976, 0.05162181, 0.6980587, 0.9240648, 0.7232044, 0.80369216, 0.133951,
                0.40795344, 0.43683323, 0.05010282
            ],
            [
                0.98390937, 0.84939843, 0.5150759, 0.05771473, 0.5700691, 0.49431023, 0.13318005,
                0.156198, 0.04104833, 0.78385925
            ]
        ],
        [
            [
                0.95769644, 0.25668707, 0.2761353, 0.32087892, 0.95667416, 0.55994195, 0.2624386,
                0.02422112, 0.05377948, 0.97354597
            ],
            [
                0.06656002, 0.70389223, 0.906086, 0.07507769, 0.602866, 0.57158166, 0.13600525,
                0.37787154, 0.9256403, 0.08165248
            ],
            [
                0.19910416, 0.22040464, 0.36501738, 0.73497313, 0.83711267, 0.8543377, 0.67837054,
                0.05674714, 0.70366615, 0.1903114
            ],
            [
                0.37970832, 0.47569475, 0.20422158, 0.4512527, 0.49025434, 0.20219064, 0.12852822,
                0.489442, 0.24683714, 0.40804845
            ],
            [
                0.5806486, 0.04441526, 0.45377526, 0.29813927, 0.9863059, 0.85976017, 0.7014735,
                0.8611803, 0.3185324, 0.5267829
            ],
            [
                0.7408705, 0.8760827, 0.98305225, 0.17809792, 0.730012, 0.35616568, 0.42846882,
                0.06058928, 0.4942951, 0.76039433
            ],
            [
                0.24494596, 0.778694, 0.21488863, 0.6724097, 0.67360795, 0.33566442, 0.6073431,
                0.39084828, 0.9535504, 0.8367833
            ],
            [
                0.34418702, 0.49005046, 0.9856048, 0.4078945, 0.28375405, 0.01750298, 0.25805417,
                0.70511657, 0.69059175, 0.13958348
            ],
            [
                0.6194952, 0.50355273, 0.15333778, 0.16799726, 0.7873509, 0.88734746, 0.02828593,
                0.5065261, 0.24965903, 0.67713153
            ],
            [
                0.11988577, 0.26481518, 0.74598974, 0.28146774, 0.360051, 0.55963814, 0.8876333,
                0.65505904, 0.37980556, 0.6438038
            ],
            [
                0.7719998, 0.21507289, 0.15550959, 0.9577405, 0.18271948, 0.82106525, 0.4061971,
                0.26731092, 0.59189594, 0.13568456
            ],
            [
                0.6588675, 0.9234072, 0.78579336, 0.36487818, 0.99638426, 0.3489711, 0.10377744,
                0.39401644, 0.9245878, 0.5651285
            ],
            [
                0.9824996, 0.13688357, 0.45855844, 0.624398, 0.65771365, 0.33799142, 0.90286547,
                0.5191975, 0.3587865, 0.26316375
            ],
            [
                0.43393332, 0.79580677, 0.18941753, 0.22869922, 0.41520792, 0.23490934, 0.9884497,
                0.8521515, 0.3087069, 0.39243168
            ],
            [
                0.7749384, 0.10794633, 0.6287581, 0.15465102, 0.52933854, 0.29298806, 0.30647522,
                0.6366538, 0.51852053, 0.26033267
            ]
        ]
    ];

    let kernel31: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.15431552, 0.41460785, 0.44530493, 0.18466088, 0.05273763, 0.13751565, 0.4870255,
            0.81449026, 0.18555306, 0.25868818, 0.97848636, 0.10551307, 0.41106373, 0.43838975,
            0.38703176, 0.7458957, 0.59377575, 0.25400713, 0.3142866, 0.70387006, 0.8802785,
            0.34916332, 0.6303323, 0.37520495, 0.5006404, 0.11340645, 0.9073929, 0.0667114,
            0.526894, 0.8616351, 0.0950383, 0.67262703, 0.98851466, 0.08098584, 0.1521318,
            0.2783208, 0.9388406, 0.02375988, 0.25068945, 0.3667564, 0.5584027, 0.37249002,
            0.82559234, 0.20341769, 0.47021034, 0.28686064, 0.44204348, 0.09638841, 0.6163964,
            0.65711486, 0.44769377, 0.56713086, 0.87605196, 0.20373636,
        ],
    )
    .unwrap();
    let conv_layer31 = TransposedConvolutionLayer::new(kernel31, 1, Padding::Same);
    let target_output31: Array3<f32> = array![
        [
            [
                2.763404, 4.2503476, 4.479516, 4.1908784, 4.0602493, 3.2730925, 3.8626657,
                3.1281366, 4.394466, 3.2840185
            ],
            [
                4.1244245, 7.17305, 6.333848, 6.0750594, 6.114858, 5.9450283, 4.8159328, 4.8577633,
                5.286209, 3.5611482
            ],
            [
                3.662636, 6.570944, 6.714719, 7.0150585, 5.469802, 5.6444573, 4.7530327, 5.610939,
                4.6199236, 3.935921
            ],
            [
                2.6951575, 4.8138847, 4.8750315, 6.6093802, 6.5900993, 6.40959, 5.3323603,
                5.942833, 4.790118, 3.64294
            ],
            [
                2.4653502, 4.438072, 6.154331, 6.4105287, 6.0202084, 6.366592, 5.4072423, 4.978546,
                4.247178, 3.3145194
            ],
            [
                3.2287498, 5.848557, 5.916065, 7.044004, 6.817544, 7.568533, 6.083962, 6.3857713,
                5.4644666, 3.8784835
            ],
            [
                4.2153006, 7.06779, 6.587079, 7.3079586, 5.5077033, 7.054174, 6.0807295, 6.6094694,
                6.361621, 4.2117434
            ],
            [
                4.2024646, 6.0728903, 6.376011, 5.528111, 5.8042345, 6.4606085, 6.4853973,
                6.871863, 6.7551475, 4.3434625
            ],
            [
                3.6956139, 5.9428406, 5.2512035, 6.4472704, 5.919182, 5.998376, 5.8739195,
                6.8475666, 5.5779138, 4.588691
            ],
            [
                2.9106557, 5.696776, 5.3691235, 5.596501, 6.559096, 6.5038643, 6.8416877,
                6.3350863, 5.681668, 3.8863711
            ],
            [
                3.4004827, 5.92713, 5.2913585, 5.39188, 5.787406, 6.661291, 6.0861597, 5.92009,
                6.0984435, 3.985821
            ],
            [
                4.495424, 7.043721, 5.343985, 4.467924, 6.285219, 4.8987827, 5.6371784, 6.006447,
                5.010072, 3.7072675
            ],
            [
                5.066972, 6.211285, 5.945215, 5.76606, 5.9034953, 6.1079216, 5.6490893, 5.916317,
                5.215305, 3.7560782
            ],
            [
                3.8013117, 6.5555243, 4.9802427, 5.7355537, 5.6882186, 5.7896137, 6.4904103,
                5.6419725, 5.210271, 3.150446
            ],
            [
                3.238776, 4.0561733, 3.3055575, 3.4005451, 3.671591, 3.7926452, 4.2855425,
                4.144494, 4.6506915, 1.6498564
            ]
        ],
        [
            [
                3.0002813, 4.4165306, 4.298635, 3.3660436, 3.8807297, 4.2474685, 3.295641,
                3.229082, 3.9276655, 3.0099359
            ],
            [
                4.6266737, 7.0866456, 7.1340785, 6.422135, 6.526363, 6.314909, 5.2230453, 5.351154,
                5.4380445, 4.974733
            ],
            [
                4.476739, 6.535577, 5.8808775, 6.0345907, 6.1046, 6.0342712, 4.939507, 4.450245,
                5.544751, 3.6946363
            ],
            [
                3.7000709, 5.1097145, 5.7956805, 5.352103, 5.6340404, 5.7554054, 5.369612,
                5.7372775, 5.8545637, 4.17239
            ],
            [
                3.091985, 6.1908793, 6.480979, 7.040917, 6.127581, 7.153369, 6.2754703, 5.7451425,
                4.4825726, 3.918001
            ],
            [
                3.6596854, 6.58632, 6.1450195, 6.558294, 6.25286, 7.1971097, 5.9966316, 5.3251257,
                4.5309105, 4.0229297
            ],
            [
                4.1730247, 6.7802644, 6.9002323, 6.173106, 6.127413, 6.32836, 6.42277, 6.1939163,
                6.4378667, 4.66009
            ],
            [
                3.9750638, 5.897914, 5.5914025, 5.7496424, 5.5634837, 6.244371, 5.3137255,
                6.586931, 6.287904, 4.7901053
            ],
            [
                3.8891091, 6.4451523, 5.9780045, 5.8040457, 6.3045845, 6.148098, 6.200892,
                6.4689655, 6.162885, 4.2070293
            ],
            [
                3.1588776, 4.4115267, 4.4891076, 5.7483616, 6.5980725, 7.388384, 7.3955975,
                6.616104, 6.2401686, 4.006419
            ],
            [
                4.091232, 6.3221593, 5.6210456, 6.1649995, 6.4409876, 6.6644425, 6.514601, 6.53297,
                6.4040403, 5.1579237
            ],
            [
                6.557548, 6.838454, 5.861415, 5.344924, 5.4725223, 6.3972144, 5.33473, 6.179793,
                5.5258574, 4.1057205
            ],
            [
                5.3734894, 6.8746524, 4.449996, 5.1226606, 6.505528, 6.0551376, 5.7442784,
                5.4215484, 5.1686187, 3.4853408
            ],
            [
                5.6092143, 6.3580074, 5.0282335, 4.5131187, 4.7719803, 5.927064, 5.641179,
                5.6884646, 5.8634195, 3.3979306
            ],
            [
                2.3481774, 4.148204, 3.5843275, 3.1889193, 3.4721909, 4.296932, 4.739059,
                4.7139397, 4.215259, 2.9702458
            ]
        ]
    ];
    let current_output31: Array3<f32> = conv_layer31.transposed_convolve(&test_input31);

    assert!(
        arr_allclose(&current_output31, &target_output31),
        "{:?} was not equal to {:?}",
        current_output31,
        target_output31
    );

    let test_input32 = array![
        [
            [
                0.27123895, 0.25475976, 0.7668864, 0.06911059, 0.45762166, 0.19771431, 0.17999981,
                0.40458816, 0.972418, 0.819918
            ],
            [
                0.93044525, 0.5533685, 0.915383, 0.52413076, 0.9805537, 0.1704253, 0.6239171,
                0.79693216, 0.86265326, 0.14754385
            ],
            [
                0.32911998, 0.8814643, 0.7971674, 0.7874321, 0.5561277, 0.0177031, 0.69646716,
                0.39157388, 0.93268543, 0.30876377
            ],
            [
                0.9142243, 0.248937, 0.1819684, 0.23486935, 0.2616802, 0.6910845, 0.25471523,
                0.6702204, 0.88759524, 0.8780723
            ],
            [
                0.47314036, 0.3108467, 0.9182288, 0.5054496, 0.039055, 0.15108511, 0.41170537,
                0.8625353, 0.89946556, 0.62739766
            ],
            [
                0.07177842, 0.44464004, 0.7037295, 0.52959424, 0.5185303, 0.39385682, 0.73444235,
                0.02605194, 0.58722204, 0.39850044
            ],
            [
                0.9898502, 0.30054072, 0.16408822, 0.42462426, 0.6369996, 0.00571945, 0.7980156,
                0.9595356, 0.08723956, 0.8790287
            ],
            [
                0.48867705, 0.1475966, 0.22570877, 0.15296295, 0.06758836, 0.78658974, 0.5537949,
                0.8844764, 0.42971602, 0.5247655
            ],
            [
                0.61579454, 0.48401225, 0.48021862, 0.38902783, 0.7585289, 0.92196393, 0.90806067,
                0.8295269, 0.7281513, 0.18144435
            ],
            [
                0.4230671, 0.6462305, 0.82973695, 0.13372117, 0.87873155, 0.37426913, 0.195186,
                0.9915115, 0.42578653, 0.7674461
            ],
            [
                0.2525376, 0.28738716, 0.6772665, 0.29977328, 0.535126, 0.8777898, 0.94740194,
                0.4741776, 0.8412827, 0.1506396
            ],
            [
                0.9066022, 0.73523605, 0.11790983, 0.26490995, 0.49443927, 0.19714476, 0.29334283,
                0.75289166, 0.12610584, 0.179585
            ],
            [
                0.66034126, 0.38383448, 0.38457966, 0.22543585, 0.0418756, 0.1392253, 0.35778308,
                0.9635798, 0.32928565, 0.47363353
            ],
            [
                0.1019657, 0.7203892, 0.77843887, 0.0080448, 0.6507068, 0.2871554, 0.7735961,
                0.78987485, 0.15095101, 0.6358644
            ],
            [
                0.59458697, 0.41322803, 0.7278109, 0.91400963, 0.7838595, 0.77705055, 0.76024026,
                0.23231152, 0.5922765, 0.3126562
            ]
        ],
        [
            [
                0.9607619, 0.983338, 0.44375485, 0.665888, 0.77717453, 0.77929264, 0.04950647,
                0.1850834, 0.03639585, 0.09267449
            ],
            [
                0.644489, 0.23740663, 0.5369513, 0.28598788, 0.9428632, 0.70666295, 0.91217923,
                0.34603307, 0.10483617, 0.4023382
            ],
            [
                0.16371936, 0.63196856, 0.8880791, 0.01381858, 0.0446909, 0.65969557, 0.74194556,
                0.9471765, 0.67107606, 0.1345869
            ],
            [
                0.5712843, 0.507226, 0.0287422, 0.86885494, 0.14450896, 0.40538365, 0.24959959,
                0.5014529, 0.43695837, 0.02603532
            ],
            [
                0.07244907, 0.9323446, 0.03978212, 0.06027399, 0.54818183, 0.61008984, 0.59623903,
                0.05084841, 0.82102305, 0.30075985
            ],
            [
                0.47476912, 0.35447294, 0.6985968, 0.32269332, 0.40450978, 0.907821, 0.710614,
                0.14398162, 0.6175431, 0.29263958
            ],
            [
                0.964957, 0.4804398, 0.4989776, 0.12305231, 0.44949692, 0.9140025, 0.53750366,
                0.13389887, 0.19339295, 0.92975616
            ],
            [
                0.40155312, 0.3647061, 0.36595654, 0.21548177, 0.39905995, 0.64136934, 0.6230772,
                0.8146392, 0.9206014, 0.5132561
            ],
            [
                0.7618259, 0.44664624, 0.33466795, 0.35649163, 0.07579028, 0.95911914, 0.06404968,
                0.9165393, 0.9715886, 0.33618838
            ],
            [
                0.6761609, 0.46713153, 0.31858218, 0.12114368, 0.28284693, 0.75696725, 0.5034896,
                0.18458705, 0.16303097, 0.4472077
            ],
            [
                0.8889562, 0.5961231, 0.3268385, 0.74607325, 0.46747229, 0.36873224, 0.4077575,
                0.78699714, 0.9511882, 0.48872462
            ],
            [
                0.05987948, 0.05762041, 0.12035189, 0.27911294, 0.8656328, 0.9083505, 0.780367,
                0.9256634, 0.768983, 0.53749615
            ],
            [
                0.8450462, 0.93648154, 0.9222405, 0.7700224, 0.72640055, 0.23352703, 0.9066492,
                0.29917085, 0.11980063, 0.33431748
            ],
            [
                0.41759512, 0.5235781, 0.5172183, 0.9793158, 0.11866722, 0.04391732, 0.02646681,
                0.7037069, 0.6249741, 0.19993573
            ],
            [
                0.4845189, 0.03120568, 0.5665192, 0.91825485, 0.3182168, 0.2717065, 0.37213528,
                0.96494824, 0.1932289, 0.89616364
            ]
        ],
        [
            [
                0.16238886, 0.04934809, 0.9135156, 0.5677089, 0.29084718, 0.9057272, 0.6802563,
                0.20875117, 0.689319, 0.2170015
            ],
            [
                0.9447457, 0.38960552, 0.28745595, 0.9677098, 0.580868, 0.64819175, 0.30875158,
                0.9653903, 0.60774714, 0.36109188
            ],
            [
                0.65511143, 0.35166883, 0.40624502, 0.6254737, 0.39857358, 0.30847135, 0.37874323,
                0.84163564, 0.28955427, 0.13427325
            ],
            [
                0.22238751, 0.29856753, 0.9007672, 0.20906866, 0.82730114, 0.25606984, 0.9925987,
                0.28031978, 0.41000587, 0.88746536
            ],
            [
                0.81454617, 0.0052199, 0.43335876, 0.80474705, 0.00935874, 0.57530177, 0.10368044,
                0.798089, 0.19485743, 0.03557918
            ],
            [
                0.2854216, 0.08789179, 0.01423985, 0.85818416, 0.84441495, 0.5679285, 0.8891067,
                0.24644253, 0.6723672, 0.75610113
            ],
            [
                0.52620494, 0.56677306, 0.04310033, 0.39450356, 0.6773871, 0.29729494, 0.9032164,
                0.19710934, 0.7033385, 0.8341241
            ],
            [
                0.11669488, 0.58224946, 0.47142735, 0.7758087, 0.82671463, 0.54548323, 0.06253681,
                0.6328484, 0.04127725, 0.03063479
            ],
            [
                0.18519482, 0.95941216, 0.04606932, 0.86761034, 0.12376603, 0.9258042, 0.33137134,
                0.16955227, 0.34692582, 0.9604976
            ],
            [
                0.90859586, 0.09133177, 0.5517924, 0.48548946, 0.01102468, 0.9636853, 0.4018344,
                0.94968534, 0.27293482, 0.9915102
            ],
            [
                0.06216944, 0.03845026, 0.5041107, 0.12539351, 0.53750044, 0.09209576, 0.31733656,
                0.04715738, 0.02350844, 0.48797405
            ],
            [
                0.14698328, 0.6172863, 0.44762006, 0.4434177, 0.72442734, 0.2774803, 0.59072083,
                0.6255086, 0.90352964, 0.20770459
            ],
            [
                0.45572537, 0.4143518, 0.79592943, 0.2494421, 0.08886264, 0.53222513, 0.65777683,
                0.39593858, 0.09867492, 0.3797314
            ],
            [
                0.7212747, 0.04400805, 0.16879582, 0.05517174, 0.60318696, 0.21645352, 0.37806734,
                0.20714076, 0.6139957, 0.6862453
            ],
            [
                0.7124935, 0.32159683, 0.6417801, 0.5377332, 0.9861572, 0.02837782, 0.8200725,
                0.57431704, 0.0464029, 0.7266059
            ]
        ]
    ];

    let kernel32: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.62417084, 0.06128551, 0.32178354, 0.15175515, 0.5686399, 0.14021157, 0.91652805,
            0.2873413, 0.5916964, 0.75519174, 0.74532473, 0.8001121, 0.23278458, 0.96737164,
            0.708869, 0.84120214, 0.77216756, 0.14788179, 0.806601, 0.6719679, 0.88025, 0.6814531,
            0.84228605, 0.7553685, 0.04224503, 0.67281544, 0.7357494, 0.17175993, 0.36744106,
            0.10604992, 0.40809688, 0.85877997, 0.23185539, 0.39392674, 0.9427737, 0.4785206,
            0.4339624, 0.42408308, 0.8512973, 0.39602843, 0.3661058, 0.3174971, 0.11389459,
            0.05309011, 0.83804965, 0.50632894, 0.17152104, 0.36011708, 0.02909578, 0.65161824,
            0.05278487, 0.7654076, 0.23484991, 0.9945197,
        ],
    )
    .unwrap();
    let conv_layer32 = TransposedConvolutionLayer::new(kernel32, 1, Padding::Same);
    let target_output32: Array3<f32> = array![
        [
            [
                3.7760756, 6.106637, 5.8893447, 7.0429735, 6.063407, 6.737302, 5.127057, 5.001885,
                4.152466, 2.7765946
            ],
            [
                6.020484, 8.004134, 8.2467575, 9.287292, 8.714625, 8.444114, 8.177556, 8.594945,
                6.5222626, 4.5487404
            ],
            [
                4.873116, 8.461652, 8.022883, 7.4814157, 8.08899, 7.5027485, 9.264497, 8.4510355,
                8.464951, 4.8940735
            ],
            [
                5.1557226, 6.987345, 7.6169, 6.548874, 6.2319283, 6.941231, 7.54722, 8.854636,
                6.827017, 4.957299
            ],
            [
                4.1245937, 6.149047, 6.733134, 7.820211, 7.032513, 7.8802814, 7.2653465, 8.122672,
                7.0119333, 5.134536
            ],
            [
                4.415587, 6.9284554, 5.677546, 7.254298, 7.9088063, 8.521526, 8.0144825, 7.2540836,
                8.428509, 4.5601406
            ],
            [
                4.8475337, 6.5003443, 5.7939863, 6.845758, 8.510274, 8.822968, 8.569903, 8.262135,
                7.4922724, 5.9073772
            ],
            [
                5.447324, 7.1098013, 6.1979065, 6.3662257, 8.176787, 8.888991, 8.683239, 8.466049,
                9.3415365, 5.9525747
            ],
            [
                5.2140827, 7.1164, 6.8907433, 6.475979, 7.8638616, 8.093386, 9.320833, 7.6619625,
                9.082559, 4.7467566
            ],
            [
                5.181219, 7.2623158, 6.989714, 5.8158855, 7.8943143, 7.9305086, 8.556373, 8.364673,
                8.040007, 5.9964314
            ],
            [
                4.6827393, 6.6729946, 6.03144, 6.642748, 7.006366, 7.9825583, 8.7383995, 7.72258,
                9.061625, 4.706444
            ],
            [
                4.4043674, 7.011274, 6.4474387, 7.081047, 6.8386497, 8.194612, 7.8542905, 8.669225,
                7.7414837, 4.2420726
            ],
            [
                5.168147, 7.4087744, 7.9305587, 7.9260073, 6.715583, 7.3300242, 7.6722183,
                8.234607, 7.66531, 3.8829865
            ],
            [
                5.036261, 8.4523, 8.177041, 8.071634, 6.9141374, 6.2432456, 7.394024, 6.702525,
                7.305286, 4.406008
            ],
            [
                3.216239, 4.4295645, 4.9374847, 6.1207952, 4.326103, 4.422236, 4.8025827, 5.413315,
                5.556882, 3.3900714
            ]
        ],
        [
            [
                2.2673576, 3.6124873, 3.967369, 4.0505657, 4.093696, 3.7559648, 3.3638666,
                2.9520261, 4.001952, 3.0070415
            ],
            [
                4.1017714, 6.819036, 6.2514577, 7.1116986, 6.802576, 5.854296, 5.8557196, 5.771229,
                5.2727013, 3.7319086
            ],
            [
                3.3128424, 6.6427946, 5.540189, 6.564732, 5.810046, 6.66001, 5.6470876, 6.72708,
                6.1253695, 3.778658
            ],
            [
                3.1240644, 5.837441, 4.84219, 4.531088, 5.0895395, 4.2857437, 6.1840234, 5.866481,
                6.7686725, 4.689422
            ],
            [
                2.9452527, 4.478021, 5.071043, 5.4242945, 5.0790343, 5.5046597, 4.6314363,
                6.531925, 5.685607, 4.1836267
            ],
            [
                3.1029723, 4.537506, 4.583924, 4.9350667, 5.9966745, 5.829315, 5.2256045,
                5.6624346, 5.3763275, 4.587394
            ],
            [
                3.360908, 4.7868915, 4.0010834, 4.5744405, 6.3608074, 6.525198, 6.3094287,
                6.4884796, 5.527129, 4.3129673
            ],
            [
                3.4812436, 5.1080704, 4.778174, 3.6002061, 5.8902826, 6.089888, 6.394364, 7.076029,
                6.1620474, 3.4667244
            ],
            [
                3.0698214, 5.5181856, 4.520878, 4.697752, 6.0804977, 6.450326, 7.673702, 6.2546983,
                7.297345, 3.9431024
            ],
            [
                3.610078, 4.858864, 5.5350933, 4.522064, 5.613235, 5.4963307, 6.6444597, 6.193001,
                6.41139, 4.377215
            ],
            [
                2.669467, 4.9139147, 4.464397, 4.9811397, 5.410686, 5.8045955, 6.8441753,
                6.1292706, 6.122253, 3.5805209
            ],
            [
                3.4921458, 5.9495206, 4.864304, 5.2123117, 4.79147, 5.09465, 5.430866, 6.187002,
                5.573489, 2.8528254
            ],
            [
                2.970173, 5.0995903, 5.0350213, 4.7574625, 3.7017784, 5.4271708, 5.6238246,
                6.612592, 5.840061, 3.9024246
            ],
            [
                3.339954, 6.380067, 6.4669805, 6.6752915, 4.4972043, 5.656492, 5.154803, 6.0855045,
                5.4931903, 2.7727108
            ],
            [
                2.1047745, 3.9825351, 4.570182, 4.607365, 4.1202245, 3.6939688, 4.0248814, 4.11864,
                3.5586188, 3.1033564
            ]
        ]
    ];
    let current_output32: Array3<f32> = conv_layer32.transposed_convolve(&test_input32);

    assert!(
        arr_allclose(&current_output32, &target_output32),
        "{:?} was not equal to {:?}",
        current_output32,
        target_output32
    );

    let test_input33 = array![
        [
            [
                0.54633784, 0.24511012, 0.9777492, 0.6905099, 0.2797765, 0.9065494, 0.57515925,
                0.24321787, 0.5326352, 0.07565403
            ],
            [
                0.05434246, 0.26618788, 0.72318465, 0.43516472, 0.99268717, 0.43552542, 0.68551266,
                0.6469373, 0.7697901, 0.63241166
            ],
            [
                0.29845408, 0.5382067, 0.66399103, 0.4663914, 0.7911451, 0.48233855, 0.6357511,
                0.40660447, 0.92244613, 0.49206445
            ],
            [
                0.80571663, 0.8278725, 0.80693966, 0.90912676, 0.2609274, 0.95664334, 0.29978433,
                0.02473691, 0.6012541, 0.60070926
            ],
            [
                0.78243107, 0.6001007, 0.44357088, 0.8526611, 0.675747, 0.8272415, 0.20722397,
                0.59975284, 0.5042818, 0.12529624
            ],
            [
                0.7655628, 0.3496852, 0.9199585, 0.5156608, 0.20966068, 0.7887671, 0.57592297,
                0.7850614, 0.205856, 0.7079952
            ],
            [
                0.30424088, 0.44280463, 0.11662215, 0.35319197, 0.46881175, 0.8605951, 0.63319755,
                0.59271556, 0.42732623, 0.98056245
            ],
            [
                0.40943378, 0.08736204, 0.71414953, 0.02837266, 0.8155253, 0.02289614, 0.7672376,
                0.1173388, 0.82497203, 0.5301501
            ],
            [
                0.7377907, 0.627198, 0.7086393, 0.73161113, 0.8728959, 0.20523417, 0.71212703,
                0.6858213, 0.24446411, 0.6046341
            ],
            [
                0.189422, 0.95210284, 0.01657294, 0.5572547, 0.95109934, 0.38959226, 0.28407174,
                0.9520966, 0.40447855, 0.7150173
            ],
            [
                0.5900238, 0.9806, 0.11093972, 0.01488827, 0.13965634, 0.23179671, 0.58850366,
                0.96796346, 0.07589323, 0.49488765
            ],
            [
                0.7547149, 0.42257422, 0.46737376, 0.56865, 0.66625124, 0.05517857, 0.1638003,
                0.46145922, 0.15882404, 0.02506812
            ],
            [
                0.35248876, 0.80154353, 0.9135202, 0.7249793, 0.60175127, 0.347363, 0.28637487,
                0.6757847, 0.7833403, 0.88746303
            ],
            [
                0.34994328, 0.5026418, 0.9554077, 0.67426574, 0.58840275, 0.11392497, 0.366732,
                0.50156933, 0.07588513, 0.6532609
            ],
            [
                0.99176913, 0.33047232, 0.77538633, 0.7875826, 0.03383781, 0.19371769, 0.4553452,
                0.8912126, 0.8920094, 0.979078
            ]
        ],
        [
            [
                0.14136378, 0.6861281, 0.4226991, 0.57890964, 0.23714265, 0.87804097, 0.6716795,
                0.18069328, 0.72638977, 0.11987385
            ],
            [
                0.2922865, 0.54633164, 0.02802026, 0.5052602, 0.75106454, 0.8818202, 0.93242604,
                0.35120466, 0.5854956, 0.4499466
            ],
            [
                0.53175735, 0.701881, 0.37155065, 0.35350096, 0.83142114, 0.69990206, 0.7134566,
                0.72049415, 0.24144432, 0.6842528
            ],
            [
                0.99164754, 0.74371606, 0.3821699, 0.4923922, 0.7530739, 0.9082559, 0.624427,
                0.581291, 0.32334334, 0.01425953
            ],
            [
                0.90228397, 0.57870275, 0.1959726, 0.17998803, 0.01473868, 0.699676, 0.5045319,
                0.10049864, 0.41223645, 0.36699277
            ],
            [
                0.12324516, 0.8283531, 0.99595505, 0.22217043, 0.8672128, 0.0572455, 0.00227537,
                0.54678285, 0.9886113, 0.6952886
            ],
            [
                0.4457745, 0.08733197, 0.07807443, 0.73419356, 0.95236826, 0.9412735, 0.6357206,
                0.33092293, 0.50407684, 0.96704507
            ],
            [
                0.13291514, 0.11796268, 0.85688275, 0.326896, 0.7342845, 0.2260136, 0.07261418,
                0.62869817, 0.8849945, 0.5912526
            ],
            [
                0.17175686, 0.75578225, 0.658764, 0.45672348, 0.7817569, 0.40402797, 0.8669946,
                0.528545, 0.5491973, 0.39217445
            ],
            [
                0.43886226, 0.87633145, 0.9895572, 0.8110191, 0.850195, 0.15625101, 0.9932123,
                0.3661569, 0.23434374, 0.5843306
            ],
            [
                0.75917476, 0.5770703, 0.21508744, 0.01203728, 0.1035213, 0.8008967, 0.7377146,
                0.27955082, 0.5298586, 0.21775989
            ],
            [
                0.28608978, 0.09119173, 0.36885205, 0.365238, 0.9055306, 0.06103494, 0.47982118,
                0.8399245, 0.47333172, 0.86444044
            ],
            [
                0.30405685, 0.6097887, 0.27184126, 0.4393666, 0.25087377, 0.08844221, 0.6088337,
                0.9107224, 0.6323396, 0.3550113
            ],
            [
                0.05707325, 0.28812405, 0.30072555, 0.12395685, 0.4421845, 0.03757849, 0.19107571,
                0.16689722, 0.23344702, 0.65167964
            ],
            [
                0.07916018, 0.8445427, 0.33082816, 0.15329789, 0.5568766, 0.7349376, 0.51132643,
                0.20894305, 0.8198042, 0.9797531
            ]
        ],
        [
            [
                0.42908755, 0.8672759, 0.17690784, 0.70560384, 0.76196206, 0.13069929, 0.1367545,
                0.09911298, 0.58084834, 0.9296323
            ],
            [
                0.1004836, 0.11953732, 0.3421989, 0.20040871, 0.47369164, 0.7954574, 0.44925165,
                0.5006503, 0.77092147, 0.5057388
            ],
            [
                0.16627122, 0.4073689, 0.85948235, 0.77469367, 0.07748227, 0.3250212, 0.99115264,
                0.49979937, 0.03903624, 0.45098576
            ],
            [
                0.40630326, 0.35183752, 0.82211554, 0.14105703, 0.227326, 0.8314124, 0.6910738,
                0.00025815, 0.37125576, 0.26917788
            ],
            [
                0.15205021, 0.78528625, 0.18507507, 0.11155976, 0.72963226, 0.55972415, 0.02126993,
                0.31910166, 0.8008331, 0.00567722
            ],
            [
                0.41979992, 0.27020735, 0.6819613, 0.5684952, 0.52824944, 0.6201668, 0.58644366,
                0.19804583, 0.9037264, 0.24526173
            ],
            [
                0.25416794, 0.1574701, 0.88019973, 0.03448753, 0.57768595, 0.19106585, 0.9647604,
                0.10343831, 0.37371257, 0.98782563
            ],
            [
                0.11502933, 0.5707253, 0.22614865, 0.7236386, 0.7593015, 0.6334889, 0.8536877,
                0.99785626, 0.5144859, 0.949248
            ],
            [
                0.87518567, 0.31102133, 0.8540344, 0.10243613, 0.75013846, 0.16738603, 0.8054281,
                0.45326027, 0.3040733, 0.87454516
            ],
            [
                0.5942815, 0.12408072, 0.85938895, 0.58185947, 0.914551, 0.7105373, 0.44424602,
                0.21789879, 0.2950855, 0.5933014
            ],
            [
                0.23873305, 0.89336336, 0.5027665, 0.4189281, 0.34902763, 0.6593175, 0.7045003,
                0.31841913, 0.81208944, 0.50125504
            ],
            [
                0.5200031, 0.03721511, 0.5660436, 0.40087107, 0.2064183, 0.24329998, 0.6048647,
                0.26063502, 0.69902617, 0.85722697
            ],
            [
                0.86291224, 0.44850218, 0.6379301, 0.6336739, 0.634028, 0.86558163, 0.898741,
                0.8664854, 0.54153246, 0.43470186
            ],
            [
                0.69931704, 0.32786557, 0.41515502, 0.0913713, 0.3648534, 0.90767926, 0.24020903,
                0.2732031, 0.00529139, 0.5243373
            ],
            [
                0.5149024, 0.17749023, 0.35303733, 0.04551869, 0.08317022, 0.41465417, 0.17218769,
                0.7172096, 0.5745436, 0.22950321
            ]
        ]
    ];

    let kernel33: Array4<f32> = Array::from_shape_vec(
        (2, 3, 3, 3),
        vec![
            0.6020403, 0.27022606, 0.63083196, 0.30292657, 0.9680943, 0.819106, 0.7977705,
            0.16225311, 0.00457407, 0.60750896, 0.46640408, 0.6880967, 0.4374607, 0.6081899,
            0.81660295, 0.47694278, 0.9496088, 0.9980203, 0.9993323, 0.33134598, 0.6684787,
            0.9229204, 0.36808705, 0.23564495, 0.9076603, 0.72902995, 0.3656918, 0.38004756,
            0.7341688, 0.50158226, 0.4102875, 0.45120648, 0.2656112, 0.6146266, 0.35742876,
            0.33983812, 0.00899099, 0.15988262, 0.60277045, 0.44374642, 0.9180864, 0.4332918,
            0.60934186, 0.04837284, 0.42185226, 0.6789883, 0.4041995, 0.26418263, 0.1565183,
            0.3212239, 0.4388435, 0.31449166, 0.6109589, 0.86979145,
        ],
    )
    .unwrap();
    let conv_layer33 = TransposedConvolutionLayer::new(kernel33, 1, Padding::Same);
    let target_output33: Array3<f32> = array![
        [
            [
                2.2951193, 3.5277998, 5.180533, 5.3739896, 5.99887, 7.0598955, 5.898039, 5.6884546,
                5.3372545, 4.136259
            ],
            [
                4.138277, 6.5803847, 8.9688225, 8.072705, 8.745077, 9.819694, 9.327703, 8.789901,
                7.5779095, 5.384785
            ],
            [
                4.5666456, 8.060171, 8.318093, 8.133384, 10.036563, 9.864146, 9.912859, 8.686045,
                7.2465453, 4.747812
            ],
            [
                6.302195, 9.295862, 8.48503, 7.6863823, 8.690746, 9.502608, 8.614783, 7.149765,
                6.8704033, 4.2216463
            ],
            [
                6.546203, 10.029704, 8.51215, 8.287669, 8.364455, 8.855036, 7.524497, 7.3838434,
                7.1485186, 4.633046
            ],
            [
                5.2549887, 7.07634, 7.5025954, 7.9604144, 7.454454, 8.710833, 7.426838, 7.8434296,
                7.5989976, 6.4921255
            ],
            [
                3.6525621, 6.861137, 7.098834, 9.064642, 8.036699, 10.059922, 7.982391, 9.668678,
                9.32461, 8.087597
            ],
            [
                4.159012, 6.989361, 6.7569237, 8.956814, 8.772256, 10.368116, 8.419646, 8.476404,
                10.04999, 6.933727
            ],
            [
                4.7821317, 7.7102537, 9.214171, 10.49398, 9.057201, 9.326888, 8.128314, 8.241365,
                9.158414, 5.866623
            ],
            [
                6.0154743, 9.425509, 8.66281, 8.8714, 8.11152, 9.242726, 8.705557, 9.202061,
                7.748737, 5.209435
            ],
            [
                5.071769, 8.847355, 7.38173, 8.242605, 6.935978, 7.4404783, 7.778468, 8.707576,
                7.3446364, 5.6136827
            ],
            [
                6.374861, 8.109661, 6.7725077, 6.924553, 7.079694, 7.906095, 8.94146, 9.654415,
                8.29664, 5.621224
            ],
            [
                4.403641, 7.4022994, 6.9460692, 7.793314, 6.8611097, 6.6154423, 6.5315785,
                7.4838166, 8.469444, 5.158205
            ],
            [
                4.6748257, 7.960194, 7.3509707, 6.464182, 6.045815, 5.650319, 7.343758, 8.361086,
                8.954577, 5.9727025
            ],
            [
                2.9723587, 4.1168847, 4.473665, 3.9169302, 3.0348516, 3.2393882, 3.9195993,
                3.8563643, 4.970922, 4.3963547
            ]
        ],
        [
            [
                1.5092984, 3.4612067, 3.624262, 3.8079689, 4.3200264, 4.9042764, 4.023445,
                3.822743, 3.7536643, 2.6338403
            ],
            [
                2.6884372, 5.5772905, 5.831972, 5.8618264, 6.858487, 7.5396714, 6.33862, 6.033953,
                5.576473, 4.4104843
            ],
            [
                3.4222891, 6.025759, 5.6068554, 6.2240405, 7.0083647, 7.459189, 6.870339, 6.641584,
                5.33984, 4.1025953
            ],
            [
                4.9683642, 6.6201043, 6.196372, 6.4358177, 6.603753, 6.161188, 6.2292237, 5.906057,
                4.3987913, 2.930492
            ],
            [
                4.617545, 6.5493255, 6.6082864, 6.204465, 6.167557, 6.3373394, 5.749685, 4.9924507,
                4.512422, 3.6828015
            ],
            [
                3.2530072, 6.0007944, 5.2626567, 4.6585417, 6.2410393, 6.512452, 5.8035355,
                5.4230657, 6.0303307, 4.6201115
            ],
            [
                2.8846903, 4.5386357, 4.7963586, 6.8680305, 5.998853, 6.9532814, 5.7570286,
                6.111794, 7.1609173, 5.7596006
            ],
            [
                2.3314931, 4.711851, 5.3492413, 6.702862, 6.1409426, 7.235456, 5.7311573, 7.101202,
                7.266911, 4.6743526
            ],
            [
                2.780705, 6.377147, 6.2924833, 7.5312805, 6.5039024, 6.74507, 6.0058737, 6.8405027,
                6.867162, 4.257991
            ],
            [
                4.676097, 7.0208936, 6.489943, 6.4969583, 5.3655124, 6.229737, 6.79915, 6.351652,
                5.688255, 3.6824512
            ],
            [
                4.457691, 5.843707, 5.3115993, 5.4758596, 5.226345, 6.564728, 5.7328143, 5.4973664,
                5.671327, 3.4635172
            ],
            [
                3.8054614, 5.5933485, 5.6801524, 5.132942, 5.2861447, 4.791115, 5.8931293,
                6.5208673, 6.005724, 4.615249
            ],
            [
                3.1066015, 5.812188, 5.170853, 6.350461, 5.15008, 4.5239377, 5.234544, 5.7045975,
                6.100522, 3.9563146
            ],
            [
                3.2510195, 6.427423, 5.7675657, 5.2305946, 4.7614646, 4.500623, 6.2453613,
                5.8096185, 6.5185013, 4.788295
            ],
            [
                2.0719333, 4.3428965, 3.2363818, 2.9106593, 2.485792, 2.9821322, 3.6199665,
                3.0549827, 4.5358605, 2.9393487
            ]
        ]
    ];
    let current_output33: Array3<f32> = conv_layer33.transposed_convolve(&test_input33);

    assert!(
        arr_allclose(&current_output33, &target_output33),
        "{:?} was not equal to {:?}",
        current_output33,
        target_output33
    );

    let test_input34 = array![
        [
            [
                0.24347919, 0.40963668, 0.6304639, 0.75179946, 0.8096951, 0.2812572, 0.11798964,
                0.49123767, 0.73792547, 0.22850095
            ],
            [
                0.62749547, 0.89611953, 0.31128857, 0.8062872, 0.21004042, 0.3544465, 0.8088834,
                0.85645074, 0.46399203, 0.20020892
            ],
            [
                0.08549125, 0.3563401, 0.03540009, 0.77337724, 0.70889044, 0.09217655, 0.87673545,
                0.9426528, 0.5829162, 0.30130407
            ],
            [
                0.16301909, 0.0944681, 0.23441528, 0.9079704, 0.9014528, 0.24369994, 0.2838537,
                0.32066756, 0.79607785, 0.567766
            ],
            [
                0.5004142, 0.34351262, 0.8709751, 0.2584685, 0.073712, 0.9854414, 0.60836834,
                0.4639875, 0.9652458, 0.62289315
            ],
            [
                0.37371808, 0.30079424, 0.4531115, 0.25970122, 0.9429725, 0.41643038, 0.69547594,
                0.73089415, 0.09059329, 0.03334849
            ],
            [
                0.29520318, 0.5661227, 0.87598383, 0.9390756, 0.4125033, 0.8897755, 0.4284044,
                0.9207873, 0.7342988, 0.31191635
            ],
            [
                0.24273862, 0.6901393, 0.79549044, 0.2834623, 0.1116256, 0.9433393, 0.4317456,
                0.2534262, 0.9799719, 0.59608305
            ],
            [
                0.01020594, 0.17467396, 0.4059711, 0.09651362, 0.7509326, 0.93793654, 0.6906772,
                0.5134812, 0.06181999, 0.32160863
            ],
            [
                0.8390193, 0.83502746, 0.6537029, 0.43052903, 0.09720925, 0.3353281, 0.98038,
                0.07002939, 0.6730996, 0.03085073
            ],
            [
                0.32178712, 0.4738019, 0.5692656, 0.14488117, 0.51752585, 0.23400442, 0.800499,
                0.9399675, 0.17341074, 0.03602418
            ],
            [
                0.9897537, 0.8234171, 0.05961503, 0.73146343, 0.06353119, 0.03754231, 0.6379037,
                0.6027391, 0.49273726, 0.2512326
            ],
            [
                0.19610797, 0.09570289, 0.04465344, 0.78414184, 0.1981256, 0.97743475, 0.62677187,
                0.94379324, 0.988714, 0.78618205
            ],
            [
                0.02465102, 0.48378265, 0.24973847, 0.567762, 0.50358063, 0.20003982, 0.8403241,
                0.54944956, 0.64089584, 0.22300935
            ],
            [
                0.2446707, 0.6178353, 0.8582606, 0.77554786, 0.5126941, 0.0230855, 0.9588296,
                0.45325497, 0.683872, 0.7553553
            ]
        ],
        [
            [
                0.90468353, 0.6072258, 0.48729265, 0.01828734, 0.55155873, 0.02171726, 0.5597964,
                0.39773065, 0.6287727, 0.34299508
            ],
            [
                0.13617095, 0.22381137, 0.89989185, 0.28058094, 0.624826, 0.68141174, 0.7336805,
                0.21469766, 0.35325027, 0.04351308
            ],
            [
                0.8361425, 0.44486797, 0.2680516, 0.24527767, 0.6857393, 0.12456267, 0.3058073,
                0.6044848, 0.42652366, 0.7003077
            ],
            [
                0.83405674, 0.08900488, 0.30584645, 0.343853, 0.06450015, 0.33126375, 0.5983181,
                0.77379525, 0.54153734, 0.58397645
            ],
            [
                0.68535024, 0.7196932, 0.9673323, 0.27877972, 0.4104945, 0.8011087, 0.3660854,
                0.17686932, 0.60172474, 0.4990743
            ],
            [
                0.8994119, 0.1879712, 0.10839786, 0.7990956, 0.00780931, 0.65771896, 0.7426427,
                0.06487332, 0.57531947, 0.2183497
            ],
            [
                0.82032317, 0.39532876, 0.13500708, 0.24393125, 0.24904966, 0.6434753, 0.39092496,
                0.8579016, 0.7112044, 0.2590078
            ],
            [
                0.6726562, 0.39667857, 0.4619479, 0.04589476, 0.9661501, 0.6690506, 0.19752927,
                0.7646045, 0.17361285, 0.75835556
            ],
            [
                0.73965275, 0.548008, 0.11726482, 0.4329183, 0.20413886, 0.3040567, 0.42594293,
                0.15392463, 0.639942, 0.08576126
            ],
            [
                0.15898854, 0.01823248, 0.07116336, 0.5692232, 0.73808074, 0.19046576, 0.30617487,
                0.50203353, 0.5407328, 0.69176406
            ],
            [
                0.00428627, 0.65561724, 0.6140609, 0.02854472, 0.47540662, 0.29656565, 0.7237789,
                0.820194, 0.7997054, 0.4111267
            ],
            [
                0.948125, 0.40705785, 0.31219292, 0.61573523, 0.39289418, 0.44004992, 0.23984882,
                0.14184482, 0.51329166, 0.7444566
            ],
            [
                0.67951566, 0.22880991, 0.758515, 0.11000468, 0.1739437, 0.7859312, 0.35241285,
                0.21768595, 0.3737861, 0.91304195
            ],
            [
                0.24466188, 0.56357545, 0.8981035, 0.38986933, 0.2216244, 0.27213955, 0.21961822,
                0.17127731, 0.27279264, 0.6340001
            ],
            [
                0.5128393, 0.27180222, 0.7078004, 0.4603395, 0.01668165, 0.07096933, 0.7827301,
                0.8978265, 0.8005617, 0.18399844
            ]
        ],
        [
            [
                0.4731425, 0.86921245, 0.95562977, 0.04734821, 0.42094678, 0.6352105, 0.9649235,
                0.28408015, 0.79151297, 0.19306876
            ],
            [
                0.13554665, 0.16333279, 0.7631569, 0.84441453, 0.5387772, 0.05251975, 0.7933793,
                0.7517392, 0.06500999, 0.4385012
            ],
            [
                0.6981625, 0.6846752, 0.34605652, 0.9654616, 0.22902155, 0.03259082, 0.91854364,
                0.7168777, 0.44551405, 0.74946475
            ],
            [
                0.28756073, 0.08960919, 0.15046561, 0.00027517, 0.9060549, 0.15447485, 0.61860234,
                0.804493, 0.3270114, 0.6793661
            ],
            [
                0.5214441, 0.02228682, 0.94790417, 0.17437272, 0.10160466, 0.905918, 0.8720237,
                0.11822663, 0.29906487, 0.736521
            ],
            [
                0.6750893, 0.02313892, 0.21913241, 0.21096338, 0.872183, 0.9518478, 0.03589433,
                0.5236388, 0.70597607, 0.95876527
            ],
            [
                0.15409674, 0.698223, 0.5774724, 0.07672973, 0.20543933, 0.12059071, 0.22073089,
                0.6251803, 0.5649595, 0.14152616
            ],
            [
                0.6504859, 0.82848394, 0.6407677, 0.5254845, 0.4276438, 0.87510544, 0.1761435,
                0.1872986, 0.66374147, 0.52372974
            ],
            [
                0.31344926, 0.43795347, 0.5838512, 0.61369354, 0.40753573, 0.22222173, 0.35040122,
                0.18531, 0.34900957, 0.61408454
            ],
            [
                0.42606664, 0.17143779, 0.86827123, 0.01832453, 0.6736357, 0.8572632, 0.30173767,
                0.5006929, 0.6550149, 0.9672847
            ],
            [
                0.51000434, 0.9622777, 0.42686778, 0.42617896, 0.93278277, 0.43877956, 0.14248393,
                0.22887371, 0.24376215, 0.6312397
            ],
            [
                0.58244145, 0.48135027, 0.9692609, 0.5126237, 0.67349476, 0.4486914, 0.48540264,
                0.11459019, 0.28885737, 0.62988746
            ],
            [
                0.49702555, 0.8447347, 0.2107247, 0.15507112, 0.78666896, 0.8684265, 0.26662722,
                0.40488556, 0.12784363, 0.60226464
            ],
            [
                0.5126809, 0.73620856, 0.83027625, 0.51128656, 0.16209526, 0.19405387, 0.5287593,
                0.09636498, 0.4948525, 0.70122975
            ],
            [
                0.7504649, 0.24232137, 0.28558207, 0.4491812, 0.4269658, 0.85322416, 0.6897798,
                0.16423886, 0.1453211, 0.7012008
            ]
        ]
    ];

    let kernel34: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.24273652, 0.6796871, 0.18765943, 0.99651706, 0.88996416, 0.86496955, 0.01413134,
            0.18041472, 0.92680913, 0.67749166, 0.7398175, 0.96671593, 0.10672154, 0.93596464,
            0.7295096, 0.6889019, 0.9459864, 0.4755696, 0.47170237, 0.34875944, 0.1234179,
            0.9846611, 0.45740375, 0.8353028, 0.44633842, 0.0870765, 0.40952957, 0.25765672,
            0.2592585, 0.5355902, 0.9537134, 0.01269416, 0.09122106, 0.62964725, 0.76467896,
            0.99306196, 0.34219164, 0.49390668, 0.50514805, 0.5770512, 0.40260163, 0.7413898,
            0.479669, 0.4261414, 0.3335815, 0.46910307, 0.14822806, 0.7267334, 0.21819024,
            0.16026212, 0.642094, 0.71613216, 0.84836876, 0.12422563, 0.16952077, 0.69457865,
            0.15433823, 0.03430253, 0.12812127, 0.6940372, 0.33373702, 0.9608874, 0.09232028,
            0.3147696, 0.7905569, 0.9712384, 0.34256575, 0.9667018, 0.67973113, 0.20387095,
            0.59346557, 0.48344153, 0.6194623, 0.78040874, 0.14745255, 0.79790366, 0.8170525,
            0.18386856, 0.47463322, 0.84008336, 0.64186555, 0.38952333, 0.95664144, 0.58203894,
            0.22674556, 0.6319144, 0.1253313, 0.31589505, 0.20299436, 0.888212, 0.3207359,
            0.26933622, 0.18764928, 0.40689033, 0.01249406, 0.04439951, 0.91816515, 0.45398694,
            0.76417685, 0.6421627, 0.5182728, 0.34041366, 0.51581156, 0.38103896, 0.626012,
            0.05526076, 0.91771805, 0.3109327, 0.32282108, 0.95785975, 0.08613525, 0.7216501,
            0.89460874, 0.9595187, 0.07959402, 0.4220791, 0.9588787, 0.8535497, 0.35312378,
            0.23533817, 0.9434602, 0.95725596, 0.12951232, 0.75168854, 0.75669426, 0.564987,
            0.9338638, 0.3909451, 0.895922, 0.07432933, 0.4815645, 0.07481741, 0.95235693,
            0.5852072, 0.71022034, 0.31448707, 0.69144875, 0.17468196, 0.9779038, 0.19466852,
            0.59434766, 0.72717535, 0.85805035, 0.85533476, 0.10377402, 0.19074684, 0.70653355,
            0.40852475, 0.9053724, 0.79482585,
        ],
    )
    .unwrap();
    let conv_layer34 = TransposedConvolutionLayer::new(kernel34, 1, Padding::Same);
    let target_output34: Array3<f32> = array![
        [
            [
                6.269784, 8.413156, 11.88655, 11.828037, 11.784342, 10.5545435, 11.42993,
                11.833282, 10.35606, 7.9102917
            ],
            [
                6.844102, 10.613953, 13.445748, 13.502968, 15.031048, 15.26261, 14.642892,
                16.015728, 15.151653, 10.696945
            ],
            [
                10.972642, 16.364754, 17.004402, 15.958876, 20.438671, 19.84181, 18.798782,
                19.410225, 16.586786, 12.3525505
            ],
            [
                9.740402, 12.594392, 17.965721, 17.579016, 17.24655, 20.926477, 20.776176,
                19.156075, 15.931276, 12.476978
            ],
            [
                10.192249, 12.82421, 16.602154, 17.015625, 17.577974, 17.330786, 21.231253,
                21.420002, 16.484297, 12.569186
            ],
            [
                10.486116, 14.8844595, 17.054123, 18.183125, 18.237104, 18.641308, 21.2038,
                21.240562, 16.88538, 13.143931
            ],
            [
                11.3804455, 13.50396, 17.442108, 17.917522, 17.510866, 19.568222, 18.96869,
                17.462881, 14.158289, 11.751301
            ],
            [
                10.0736885, 13.178275, 16.981339, 18.932825, 18.706976, 18.016777, 20.104572,
                19.457178, 13.811611, 12.191946
            ],
            [
                11.774119, 15.291017, 18.02135, 18.47971, 17.681759, 17.794846, 19.966072,
                19.928223, 15.106407, 10.4284525
            ],
            [
                12.162173, 13.823486, 17.990383, 18.512857, 18.410961, 17.273582, 16.989788,
                18.193167, 14.452189, 11.073826
            ],
            [
                10.400508, 14.101878, 18.483889, 17.32777, 17.943657, 16.865757, 17.94138,
                17.002571, 15.345148, 11.548758
            ],
            [
                10.566545, 14.855351, 17.703089, 17.802126, 17.392633, 18.052744, 17.833391,
                18.642532, 14.539257, 12.084521
            ],
            [
                11.037093, 15.132964, 18.80537, 17.310495, 16.665169, 17.007065, 18.482176,
                18.952047, 15.377275, 11.191403
            ],
            [
                8.18679, 11.295201, 13.310668, 14.46773, 14.6820755, 13.420451, 13.760564,
                15.240564, 12.312402, 10.239627
            ],
            [
                5.1053157, 8.057754, 8.858137, 10.362408, 11.065579, 10.282638, 10.035127,
                11.292792, 9.59462, 6.7115974
            ]
        ],
        [
            [
                6.5202427, 9.979179, 11.861676, 11.171409, 12.667241, 12.60118, 11.467056,
                12.217351, 8.76059, 6.4184265
            ],
            [
                8.853324, 12.506066, 17.033411, 14.849585, 15.701965, 16.678188, 16.860516,
                15.0487795, 14.3093405, 10.142714
            ],
            [
                11.065221, 13.970624, 19.117544, 16.981148, 19.526924, 20.292408, 20.567234,
                20.611374, 17.174574, 11.390535
            ],
            [
                10.925738, 14.715351, 17.456509, 19.441853, 19.642878, 20.333277, 20.275291,
                20.752829, 17.034426, 11.925253
            ],
            [
                9.761951, 13.532016, 18.766785, 16.27583, 16.917923, 20.77803, 21.246078,
                20.343945, 16.92517, 13.072851
            ],
            [
                11.004427, 14.221207, 17.074495, 18.644066, 18.921206, 17.952412, 22.564602,
                20.45665, 16.119656, 12.9876375
            ],
            [
                12.034989, 14.087945, 17.829021, 19.661366, 19.515717, 19.234232, 20.349745,
                20.453018, 15.457808, 10.993636
            ],
            [
                11.730985, 14.010301, 18.062737, 16.511192, 19.05586, 17.797031, 18.312931,
                19.827808, 13.877155, 10.875993
            ],
            [
                11.954449, 13.302687, 17.736607, 19.589354, 19.53696, 18.550037, 19.250109,
                19.208763, 13.869289, 11.996536
            ],
            [
                11.542321, 14.6291065, 17.663763, 19.499857, 18.35696, 17.702574, 18.3907,
                18.754448, 15.162401, 10.614482
            ],
            [
                10.634706, 12.659841, 19.699955, 18.79382, 18.919176, 18.9333, 18.756899,
                19.195765, 14.614283, 11.008121
            ],
            [
                11.207661, 15.764245, 18.781214, 18.650562, 18.497847, 17.46363, 18.930702,
                18.597126, 14.983131, 10.880243
            ],
            [
                13.248663, 14.802297, 19.465504, 19.299868, 19.870419, 17.839664, 18.390385,
                17.399715, 15.069956, 11.6539345
            ],
            [
                9.730714, 12.962331, 16.202332, 15.105626, 14.820911, 15.386683, 14.597824,
                17.015778, 13.431568, 9.6774025
            ],
            [
                6.7419844, 9.275193, 10.263882, 11.83732, 11.173949, 10.668148, 10.609896,
                12.749309, 10.888546, 6.7011733
            ]
        ]
    ];
    let current_output34: Array3<f32> = conv_layer34.transposed_convolve(&test_input34);

    assert!(
        arr_allclose(&current_output34, &target_output34),
        "{:?} was not equal to {:?}",
        current_output34,
        target_output34
    );

    let test_input35 = array![
        [
            [
                0.07687633, 0.562379, 0.37210396, 0.32402095, 0.8602053, 0.53920454, 0.08114164,
                0.7433678, 0.25469407, 0.35685664
            ],
            [
                0.86973363, 0.53688055, 0.3689936, 0.10202847, 0.66700953, 0.94219905, 0.49954033,
                0.66072565, 0.8268658, 0.8766563
            ],
            [
                0.93275625, 0.21397021, 0.06444389, 0.205756, 0.3270908, 0.66181034, 0.91093796,
                0.39366162, 0.04630919, 0.3708943
            ],
            [
                0.29092696, 0.05031264, 0.2996979, 0.74127114, 0.20186162, 0.8974939, 0.10420715,
                0.86447024, 0.73982954, 0.20779297
            ],
            [
                0.11139946, 0.76284266, 0.9708438, 0.0490358, 0.4903692, 0.64358395, 0.19578648,
                0.43352267, 0.5136744, 0.786625
            ],
            [
                0.65377945, 0.17670311, 0.17367327, 0.00233923, 0.00231021, 0.00389791, 0.6429485,
                0.08434474, 0.33114251, 0.81666934
            ],
            [
                0.3382682, 0.12183399, 0.33545557, 0.5468584, 0.84521246, 0.9941385, 0.12511869,
                0.26069343, 0.8564248, 0.00879662
            ],
            [
                0.5979157, 0.09688276, 0.7828029, 0.2738516, 0.92959046, 0.7858451, 0.8323144,
                0.20524552, 0.01878213, 0.71677077
            ],
            [
                0.1588798, 0.40059456, 0.6643946, 0.6478827, 0.7751252, 0.76628643, 0.7391135,
                0.69836235, 0.39738613, 0.6233648
            ],
            [
                0.54919857, 0.3634999, 0.8054252, 0.8365926, 0.36451012, 0.5051893, 0.5404216,
                0.9121254, 0.71555644, 0.01313191
            ],
            [
                0.49326825, 0.6549261, 0.07114062, 0.3699674, 0.14404187, 0.8123709, 0.06082704,
                0.20571426, 0.39945284, 0.9213286
            ],
            [
                0.2104344, 0.37812722, 0.7624879, 0.895442, 0.90565294, 0.75942206, 0.9338465,
                0.6887853, 0.6172757, 0.05089346
            ],
            [
                0.18379262, 0.22028615, 0.14761166, 0.29403457, 0.64421535, 0.47628883, 0.9976808,
                0.61404985, 0.8834381, 0.353661
            ],
            [
                0.7358049, 0.5680527, 0.41924086, 0.99446476, 0.05723348, 0.19985354, 0.6427157,
                0.04568462, 0.31229603, 0.7553471
            ],
            [
                0.75325525, 0.00187753, 0.309647, 0.22865261, 0.90302867, 0.9885033, 0.82844293,
                0.37859115, 0.18685542, 0.5619539
            ]
        ],
        [
            [
                0.633839, 0.2505139, 0.98390645, 0.1387982, 0.20664348, 0.18246314, 0.01311236,
                0.99554473, 0.89341885, 0.6555033
            ],
            [
                0.13707118, 0.5791843, 0.11910439, 0.42623383, 0.40042326, 0.945366, 0.63565254,
                0.18806016, 0.5436802, 0.1023385
            ],
            [
                0.7247788, 0.05042625, 0.5168907, 0.2186272, 0.29398298, 0.05802479, 0.65191025,
                0.47664133, 0.39239797, 0.80301845
            ],
            [
                0.51822144, 0.57412094, 0.67280203, 0.06715751, 0.90230054, 0.17326476, 0.701824,
                0.9209419, 0.8824029, 0.41356802
            ],
            [
                0.50792736, 0.86763877, 0.22796531, 0.3306306, 0.42940366, 0.52140737, 0.34581757,
                0.06805818, 0.6986198, 0.6633621
            ],
            [
                0.4603176, 0.4801953, 0.50815964, 0.49503893, 0.49589577, 0.5984174, 0.02095615,
                0.87332976, 0.5110638, 0.79257405
            ],
            [
                0.10385484, 0.63126826, 0.11150351, 0.27857724, 0.9448783, 0.9493709, 0.4788634,
                0.8467018, 0.380214, 0.05884617
            ],
            [
                0.5415833, 0.41261145, 0.54442054, 0.60545826, 0.41381994, 0.8702629, 0.818602,
                0.46709782, 0.40898377, 0.62087363
            ],
            [
                0.5875957, 0.0388279, 0.6322429, 0.27584866, 0.25958148, 0.2702102, 0.24461499,
                0.00961369, 0.8730841, 0.8494242
            ],
            [
                0.3442888, 0.5952094, 0.9447504, 0.3976604, 0.78973585, 0.07774603, 0.39311472,
                0.34959215, 0.56123126, 0.2203316
            ],
            [
                0.50574416, 0.470598, 0.6311813, 0.83281696, 0.50045645, 0.9317255, 0.9687418,
                0.5818574, 0.5338905, 0.08471105
            ],
            [
                0.6194616, 0.8411948, 0.19904476, 0.5292038, 0.50989914, 0.40828153, 0.4772575,
                0.23428045, 0.2594804, 0.3212595
            ],
            [
                0.40714148, 0.4023985, 0.69953793, 0.22782035, 0.60896635, 0.30122298, 0.14788271,
                0.49422115, 0.22982639, 0.7442435
            ],
            [
                0.16851175, 0.8650144, 0.48694533, 0.4772659, 0.2898016, 0.29526737, 0.32476526,
                0.23135523, 0.76617146, 0.54947746
            ],
            [
                0.00431055, 0.5009392, 0.7176595, 0.26999855, 0.6046516, 0.34861085, 0.0269638,
                0.8493065, 0.01711699, 0.6910144
            ]
        ],
        [
            [
                0.00019201, 0.52309215, 0.54265, 0.31141326, 0.91818535, 0.4625155, 0.9630007,
                0.8533415, 0.42821297, 0.3230595
            ],
            [
                0.6207659, 0.28923175, 0.29709435, 0.16611195, 0.85863435, 0.7436211, 0.20855807,
                0.12420983, 0.9195261, 0.94560367
            ],
            [
                0.6450301, 0.91203785, 0.90902174, 0.7086605, 0.7481681, 0.28084424, 0.79666317,
                0.9200906, 0.8273928, 0.23791489
            ],
            [
                0.29862002, 0.5545178, 0.30733633, 0.5033659, 0.30773363, 0.6186373, 0.2794753,
                0.33497575, 0.23553869, 0.10877129
            ],
            [
                0.0074059, 0.25183305, 0.74742633, 0.22444084, 0.7311145, 0.47786355, 0.06713644,
                0.38374987, 0.82775855, 0.6082418
            ],
            [
                0.22622706, 0.11856116, 0.82261455, 0.12131448, 0.94247264, 0.6971509, 0.2832979,
                0.42199442, 0.8818394, 0.81624496
            ],
            [
                0.78333485, 0.08888702, 0.2163541, 0.9009415, 0.13213386, 0.7827681, 0.88790584,
                0.9359108, 0.78930384, 0.435518
            ],
            [
                0.54510885, 0.5737916, 0.2948703, 0.05387269, 0.34582293, 0.08032885, 0.2825168,
                0.7120441, 0.7445493, 0.9028417
            ],
            [
                0.22379005, 0.22507085, 0.6998699, 0.6868782, 0.60622376, 0.31198406, 0.68357366,
                0.50696224, 0.38162777, 0.21361107
            ],
            [
                0.34874114, 0.3197598, 0.25752735, 0.70165557, 0.75739884, 0.00322214, 0.4226255,
                0.43170354, 0.42811546, 0.3539806
            ],
            [
                0.6795413, 0.6909227, 0.6033119, 0.16861577, 0.40303022, 0.46866208, 0.40683198,
                0.41161722, 0.27997676, 0.87613356
            ],
            [
                0.3869692, 0.11339175, 0.75498724, 0.01799585, 0.03165611, 0.11710421, 0.9853062,
                0.33407968, 0.2763068, 0.10566978
            ],
            [
                0.41321653, 0.95684916, 0.5413685, 0.26203886, 0.05826038, 0.41444728, 0.8756506,
                0.15835214, 0.7757501, 0.13757224
            ],
            [
                0.6104301, 0.96306026, 0.25118008, 0.22126025, 0.3210225, 0.23228435, 0.8946457,
                0.8776359, 0.37358907, 0.13714333
            ],
            [
                0.47440106, 0.23950769, 0.9768618, 0.10685845, 0.83712214, 0.03419947, 0.34246588,
                0.08168512, 0.74862325, 0.88137543
            ]
        ]
    ];

    let kernel35: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.18473074, 0.98918116, 0.11134233, 0.13754722, 0.8988782, 0.30941918, 0.9647047,
            0.76521933, 0.7244534, 0.5936923, 0.10347938, 0.00596059, 0.46408173, 0.35232717,
            0.2175819, 0.5370642, 0.5802638, 0.47013968, 0.43169782, 0.5803729, 0.45881143,
            0.9857342, 0.14545082, 0.58244896, 0.7034106, 0.76931155, 0.1425278, 0.80080473,
            0.56033, 0.4510186, 0.45594713, 0.919209, 0.4904178, 0.6672297, 0.16251512, 0.4277592,
            0.16341151, 0.16981454, 0.5828709, 0.7705816, 0.06189989, 0.5973773, 0.01001601,
            0.7339751, 0.08388381, 0.6090771, 0.63557667, 0.5274246, 0.9724405, 0.9171884,
            0.83102775, 0.50172466, 0.27221084, 0.241416, 0.92517185, 0.322965, 0.13749518,
            0.28644225, 0.54031545, 0.5457834, 0.73527724, 0.96255356, 0.35702974, 0.8798423,
            0.30499902, 0.22845407, 0.55339915, 0.82495195, 0.8550814, 0.31527686, 0.8087375,
            0.9033453, 0.13617618, 0.73329574, 0.67739195, 0.96404636, 0.03399309, 0.30864337,
            0.7582445, 0.33783555, 0.59522337, 0.5528465, 0.5066147, 0.8637635, 0.25140095,
            0.09224023, 0.8053905, 0.79440796, 0.6462248, 0.40517598, 0.5820068, 0.26597038,
            0.9985896, 0.94154567, 0.39119187, 0.73835415, 0.6929583, 0.13366044, 0.46008274,
            0.96175927, 0.17908163, 0.9568281, 0.834809, 0.53836745, 0.21015689, 0.08070394,
            0.6906587, 0.51967305, 0.40612924, 0.05469618, 0.00813945, 0.39472166, 0.6443447,
            0.3365193, 0.6512147, 0.16662635, 0.02011058, 0.32754743, 0.546235, 0.07961486,
            0.8874147, 0.8103422, 0.6358667, 0.34002563, 0.2497398, 0.17590073, 0.2236522,
            0.66177195, 0.19450006, 0.83005303, 0.75825053, 0.18694969, 0.5125578, 0.24576004,
            0.32921043, 0.763694, 0.92903197, 0.770093, 0.04474735, 0.15989853, 0.13125397,
            0.7176921, 0.6770817, 0.9314477, 0.5473823, 0.80075836, 0.42184463, 0.5656662,
            0.59004676, 0.8201525,
        ],
    )
    .unwrap();
    let conv_layer35 = TransposedConvolutionLayer::new(kernel35, 1, Padding::Same);
    let target_output35: Array3<f32> = array![
        [
            [
                6.4992695, 6.497097, 10.699198, 9.619067, 11.043934, 11.071797, 13.194522,
                12.761332, 9.27029, 6.762269
            ],
            [
                7.1036735, 10.408511, 13.363398, 14.438372, 15.417276, 14.965879, 16.588007,
                15.383319, 14.31075, 10.69388
            ],
            [
                9.899458, 11.88618, 16.732609, 18.044004, 18.159525, 18.998507, 20.999151,
                20.045685, 15.152344, 12.861994
            ],
            [
                10.57368, 11.420745, 18.052011, 18.496464, 18.23587, 16.689213, 20.943209,
                21.667564, 16.349354, 11.735237
            ],
            [
                9.237333, 11.334671, 17.333977, 16.858881, 18.70848, 18.366331, 20.41296,
                19.538801, 16.373857, 12.757879
            ],
            [
                9.250618, 11.831167, 15.816218, 18.7247, 17.573055, 18.069157, 21.286373,
                20.418613, 15.104211, 13.513358
            ],
            [
                9.607407, 12.115645, 16.616562, 18.811522, 19.630333, 17.229897, 19.716331,
                20.269302, 16.714605, 12.360028
            ],
            [
                9.056755, 12.572718, 16.978745, 17.94802, 20.308731, 19.61692, 20.150326,
                20.977114, 16.07479, 12.180423
            ],
            [
                9.532633, 14.820013, 18.124632, 19.552338, 20.795414, 20.594988, 21.049355,
                19.977652, 15.151332, 11.941815
            ],
            [
                10.42891, 12.6861105, 18.633099, 18.07121, 20.250893, 17.842262, 18.759855,
                19.931807, 15.173082, 10.187734
            ],
            [
                11.716888, 13.794058, 19.326096, 18.312355, 20.929487, 18.703403, 19.010475,
                16.770458, 15.409856, 10.197021
            ],
            [
                10.464816, 15.020462, 18.83336, 18.92864, 19.291523, 18.341112, 19.577995,
                17.648603, 15.556275, 9.958549
            ],
            [
                11.05149, 13.522642, 18.902948, 17.155703, 17.513968, 16.743446, 17.561563,
                20.370562, 15.0373745, 9.577279
            ],
            [
                8.775111, 11.217437, 15.104996, 14.720955, 15.780615, 13.815997, 15.570044,
                14.12343, 13.298496, 8.218925
            ],
            [
                6.652449, 7.8206253, 10.191701, 10.450979, 10.358975, 10.523627, 10.247474,
                10.8257265, 8.863204, 6.992865
            ]
        ],
        [
            [
                6.445433, 7.6914797, 11.120232, 10.629007, 12.308166, 12.37256, 12.4641905,
                12.3347645, 11.113387, 8.058819
            ],
            [
                8.164474, 10.090718, 13.690569, 14.250628, 14.248922, 16.093296, 17.50785,
                15.633282, 14.032677, 11.107281
            ],
            [
                10.531914, 11.780456, 16.79543, 17.573154, 18.229183, 18.355425, 21.56649,
                20.939459, 15.024844, 12.370743
            ],
            [
                7.9258285, 11.454923, 15.982212, 16.29414, 17.84754, 16.208054, 18.824596,
                19.758945, 15.900376, 12.25254
            ],
            [
                9.253772, 10.9513, 18.049128, 17.183666, 15.928599, 18.142101, 20.908274,
                19.114567, 15.8330965, 14.288757
            ],
            [
                9.593884, 10.971465, 15.293668, 18.056974, 17.07449, 17.19081, 18.829542, 20.78119,
                15.20614, 13.300332
            ],
            [
                8.679567, 11.797739, 15.22729, 17.625885, 19.150097, 19.093931, 20.147669,
                19.047155, 15.321703, 12.745843
            ],
            [
                8.739765, 11.873438, 16.707474, 17.704174, 19.531773, 18.873306, 20.742443,
                19.021154, 15.088652, 12.386312
            ],
            [
                9.252685, 13.310702, 17.79879, 18.340607, 20.192862, 18.975428, 19.194498,
                19.841148, 15.28655, 11.13715
            ],
            [
                10.429322, 14.02938, 18.982986, 18.469187, 20.08846, 19.587933, 19.248644,
                17.850573, 15.231703, 11.120523
            ],
            [
                10.565459, 13.6469145, 17.997602, 17.976145, 19.421658, 19.436398, 19.472162,
                17.457108, 15.339167, 10.747753
            ],
            [
                10.101262, 14.157301, 17.785885, 17.274467, 17.9235, 16.99722, 18.142256,
                17.479813, 14.826534, 9.731949
            ],
            [
                10.236665, 13.683173, 17.708382, 18.66773, 17.755896, 16.679045, 17.919317,
                19.257948, 15.100343, 10.10376
            ],
            [
                8.564835, 10.486196, 13.297511, 13.475749, 15.2711315, 13.670382, 14.6111355,
                14.892188, 12.175236, 10.005795
            ],
            [
                6.4030643, 8.164193, 10.712306, 9.949627, 10.711661, 9.5243225, 9.921985,
                11.063437, 9.05865, 7.545923
            ]
        ]
    ];
    let current_output35: Array3<f32> = conv_layer35.transposed_convolve(&test_input35);

    assert!(
        arr_allclose(&current_output35, &target_output35),
        "{:?} was not equal to {:?}",
        current_output35,
        target_output35
    );

    let test_input36 = array![
        [
            [
                0.14744335, 0.27474907, 0.24179934, 0.8682364, 0.56367075, 0.07044671, 0.29423887,
                0.87814265, 0.32037255, 0.3620402
            ],
            [
                0.04796435, 0.97183305, 0.76150626, 0.34112373, 0.31838858, 0.49590603, 0.92035383,
                0.79724616, 0.651372, 0.7487701
            ],
            [
                0.49727458, 0.32119304, 0.8463964, 0.13675515, 0.68881863, 0.46670306, 0.01120028,
                0.8543715, 0.6945534, 0.33060712
            ],
            [
                0.4555225, 0.13203587, 0.9005182, 0.8270161, 0.9527902, 0.7580725, 0.49412045,
                0.20060162, 0.15141632, 0.24051304
            ],
            [
                0.16673861, 0.7391523, 0.20078433, 0.7891549, 0.3015661, 0.74811155, 0.7854318,
                0.3505642, 0.680326, 0.58793133
            ],
            [
                0.5155471, 0.75134015, 0.41742912, 0.12312055, 0.4320033, 0.73915005, 0.16522276,
                0.19335277, 0.15157908, 0.07246574
            ],
            [
                0.96423316, 0.76062286, 0.88389367, 0.5157158, 0.52317566, 0.14464663, 0.10081305,
                0.42420647, 0.27160275, 0.02735503
            ],
            [
                0.6543318, 0.23541763, 0.200245, 0.6501877, 0.6285768, 0.86092526, 0.26301193,
                0.8023518, 0.1087136, 0.5576734
            ],
            [
                0.9438549, 0.42205876, 0.48934633, 0.41629243, 0.6270179, 0.76865804, 0.53023434,
                0.8911174, 0.7841888, 0.73013425
            ],
            [
                0.50025976, 0.5086839, 0.9078541, 0.9309513, 0.2881168, 0.82237065, 0.4813319,
                0.49489418, 0.98279464, 0.8067512
            ],
            [
                0.79999334, 0.9367564, 0.9931557, 0.7494803, 0.5609142, 0.5778548, 0.86057985,
                0.86176527, 0.65635675, 0.22974117
            ],
            [
                0.13721496, 0.12129743, 0.20838259, 0.62454134, 0.2613133, 0.6823734, 0.6880129,
                0.3385653, 0.74370384, 0.3974338
            ],
            [
                0.5271246, 0.6003864, 0.23537809, 0.42321116, 0.43368894, 0.860833, 0.4974183,
                0.5028833, 0.92872775, 0.26821068
            ],
            [
                0.89416933, 0.8258276, 0.48346463, 0.1432244, 0.33314273, 0.9155206, 0.8578849,
                0.03859916, 0.23407574, 0.84823865
            ],
            [
                0.932644, 0.38202414, 0.94571847, 0.05046099, 0.48662594, 0.06154156, 0.8783807,
                0.95873827, 0.11859933, 0.5042171
            ]
        ],
        [
            [
                0.44881725, 0.5931673, 0.40400937, 0.28658122, 0.89329517, 0.02320533, 0.03034396,
                0.7540206, 0.14406462, 0.45788714
            ],
            [
                0.00839418, 0.59410405, 0.9186821, 0.9230268, 0.6097287, 0.79199237, 0.2791606,
                0.27122402, 0.8222872, 0.73517805
            ],
            [
                0.45182157, 0.520041, 0.58354145, 0.3963224, 0.71153677, 0.16250566, 0.92856133,
                0.91238993, 0.16039994, 0.19652618
            ],
            [
                0.375968, 0.6541034, 0.1783998, 0.06927952, 0.70495504, 0.72366524, 0.5080878,
                0.85203177, 0.74189144, 0.9748558
            ],
            [
                0.8749136, 0.35329154, 0.9820577, 0.26745334, 0.97681504, 0.40532887, 0.7912286,
                0.7863078, 0.306065, 0.54949427
            ],
            [
                0.5570144, 0.8649087, 0.68969446, 0.9205499, 0.9991251, 0.6686811, 0.58346087,
                0.00113209, 0.47074103, 0.19266835
            ],
            [
                0.3852438, 0.2573702, 0.90755767, 0.31581315, 0.63644826, 0.09872102, 0.79017717,
                0.65233284, 0.48419538, 0.40488294
            ],
            [
                0.44561166, 0.5290324, 0.42656752, 0.39578637, 0.62058884, 0.7099823, 0.64892846,
                0.9732401, 0.42929164, 0.64263624
            ],
            [
                0.97280717, 0.47910935, 0.0154238, 0.3099561, 0.16241977, 0.46165013, 0.52038246,
                0.5611795, 0.54011285, 0.01210845
            ],
            [
                0.4283894, 0.14862853, 0.81590325, 0.4824363, 0.18747853, 0.69892484, 0.01179654,
                0.9137055, 0.09571361, 0.95533603
            ],
            [
                0.40565214, 0.2903195, 0.9482382, 0.19820046, 0.6695129, 0.42051715, 0.5803834,
                0.6643568, 0.28484774, 0.84491366
            ],
            [
                0.8515355, 0.02146405, 0.4323668, 0.53697425, 0.15343292, 0.15163149, 0.92080355,
                0.31300077, 0.8318911, 0.6885318
            ],
            [
                0.25830105, 0.7909103, 0.3331658, 0.41191933, 0.15103391, 0.7639756, 0.5321874,
                0.6720827, 0.65136, 0.11634088
            ],
            [
                0.23144175, 0.4127522, 0.29944476, 0.19735679, 0.40494955, 0.06145637, 0.43546274,
                0.84339786, 0.08275017, 0.3285514
            ],
            [
                0.00890028, 0.71842843, 0.07065999, 0.8262481, 0.40715668, 0.69790584, 0.8458694,
                0.00000332, 0.8514133, 0.46330082
            ]
        ],
        [
            [
                0.24589908, 0.7479366, 0.6341247, 0.0549946, 0.68832874, 0.61294067, 0.5338761,
                0.89421654, 0.24979177, 0.12588894
            ],
            [
                0.7116272, 0.12240925, 0.83907366, 0.5178171, 0.23339207, 0.32547936, 0.67288977,
                0.2876534, 0.09377953, 0.7564726
            ],
            [
                0.22432509, 0.51384735, 0.9836249, 0.8633966, 0.03329961, 0.63557297, 0.9559139,
                0.37260452, 0.16305639, 0.13237825
            ],
            [
                0.5918, 0.03602529, 0.1194161, 0.39272583, 0.08259113, 0.78851074, 0.91774833,
                0.75968784, 0.9022951, 0.56193227
            ],
            [
                0.8495099, 0.50477576, 0.88879174, 0.88052094, 0.58644974, 0.19650131, 0.9203509,
                0.5945867, 0.47080988, 0.75337565
            ],
            [
                0.2608314, 0.3283828, 0.77941394, 0.26333272, 0.3450901, 0.10943655, 0.27528194,
                0.46809962, 0.6463718, 0.12866788
            ],
            [
                0.69210666, 0.57007235, 0.9193569, 0.03087827, 0.11762659, 0.16121963, 0.742333,
                0.6336863, 0.02730842, 0.52676916
            ],
            [
                0.9274803, 0.13649084, 0.7212588, 0.4059104, 0.05442869, 0.94360787, 0.05971876,
                0.5568312, 0.6870902, 0.587034
            ],
            [
                0.78791344, 0.28771716, 0.13252011, 0.39844674, 0.07239222, 0.3024033, 0.244513,
                0.2908769, 0.15943104, 0.5253588
            ],
            [
                0.9150655, 0.2018939, 0.14664388, 0.99723715, 0.56759685, 0.94873554, 0.21085006,
                0.9172242, 0.71209496, 0.9426647
            ],
            [
                0.3840625, 0.67782235, 0.41096005, 0.6776439, 0.8240437, 0.8656738, 0.39080778,
                0.8798289, 0.76532114, 0.27110547
            ],
            [
                0.8300527, 0.77389467, 0.08493471, 0.1904791, 0.46803957, 0.7159368, 0.3787137,
                0.42343214, 0.21949036, 0.8248272
            ],
            [
                0.5192152, 0.6592848, 0.28158224, 0.7244593, 0.8091769, 0.8269938, 0.14482398,
                0.4898261, 0.6574756, 0.82749605
            ],
            [
                0.99097866, 0.41747054, 0.2559259, 0.42734137, 0.17804484, 0.5143955, 0.94073284,
                0.2315761, 0.19056651, 0.6487747
            ],
            [
                0.06861266, 0.5607521, 0.39927632, 0.69513595, 0.5128271, 0.7744788, 0.425522,
                0.23811352, 0.08004551, 0.97199184
            ]
        ]
    ];

    let kernel36: Array4<f32> = Array::from_shape_vec(
        (2, 3, 5, 5),
        vec![
            0.44189274, 0.35273224, 0.34018835, 0.99794286, 0.7277374, 0.06306537, 0.6950592,
            0.16330826, 0.10098691, 0.79675776, 0.84824985, 0.861038, 0.16946438, 0.64684975,
            0.8300856, 0.62681603, 0.73975146, 0.90003186, 0.7530212, 0.66171366, 0.7185569,
            0.18436821, 0.9811672, 0.00093033, 0.2571168, 0.38397154, 0.89225876, 0.8851492,
            0.71530974, 0.88996905, 0.8043537, 0.80481124, 0.28081727, 0.5045869, 0.6516086,
            0.7360286, 0.87077284, 0.30737343, 0.5349817, 0.9852458, 0.34672758, 0.1468601,
            0.8044841, 0.99494183, 0.8727728, 0.5704518, 0.8621303, 0.2889688, 0.87345356,
            0.64978987, 0.24831195, 0.83349985, 0.34462538, 0.7214515, 0.9424734, 0.01238921,
            0.819498, 0.32281056, 0.08497369, 0.0071336, 0.05203346, 0.660841, 0.10108794,
            0.56165093, 0.80708337, 0.2838076, 0.8790584, 0.5866165, 0.06800676, 0.0775333,
            0.00274038, 0.7469552, 0.4439209, 0.89197814, 0.41484535, 0.2299751, 0.77702886,
            0.8629795, 0.19322978, 0.5069561, 0.0514909, 0.29257268, 0.9823384, 0.9021486,
            0.1891498, 0.6727526, 0.6708445, 0.03340911, 0.38762635, 0.5331132, 0.2987317,
            0.9958155, 0.26465672, 0.18809871, 0.36512852, 0.6477993, 0.3548672, 0.8266181,
            0.6171406, 0.45104527, 0.8682947, 0.6613541, 0.24762909, 0.9624131, 0.3236712,
            0.2818011, 0.18014109, 0.02249233, 0.7238061, 0.49854496, 0.302695, 0.5325474,
            0.41782996, 0.06027863, 0.07938977, 0.03492576, 0.534174, 0.265856, 0.11348119,
            0.29946154, 0.951536, 0.4251115, 0.9249329, 0.7118818, 0.5969804, 0.0197016,
            0.82848436, 0.8956191, 0.64954203, 0.48776895, 0.43345734, 0.12409458, 0.31419477,
            0.57764804, 0.9237117, 0.5839586, 0.00156582, 0.9518597, 0.3726825, 0.16136307,
            0.9429895, 0.16060303, 0.7139142, 0.5569445, 0.41990465, 0.83710754, 0.6891252,
            0.41190583, 0.8463119, 0.3182748,
        ],
    )
    .unwrap();
    let conv_layer36 = TransposedConvolutionLayer::new(kernel36, 1, Padding::Same);
    let target_output36: Array3<f32> = array![
        [
            [
                6.912862, 9.473118, 12.228191, 11.499873, 11.67977, 12.60236, 11.07018, 11.226957,
                10.068752, 7.412219
            ],
            [
                9.057782, 12.030875, 15.537855, 17.181725, 18.233429, 16.73097, 16.085968,
                15.714001, 12.774562, 9.766556
            ],
            [
                11.314471, 15.154692, 20.655722, 21.498495, 23.66915, 22.826601, 21.90278,
                22.662058, 16.678118, 13.746842
            ],
            [
                14.539037, 17.60553, 23.737127, 22.907804, 24.426731, 24.500164, 22.81681,
                22.199257, 17.61218, 12.6937895
            ],
            [
                14.364473, 17.695976, 22.464706, 22.506744, 21.655994, 21.603645, 20.266022,
                19.391453, 15.677516, 10.621147
            ],
            [
                13.87367, 18.039555, 22.234694, 22.11559, 22.561237, 21.611113, 22.63032,
                20.503748, 15.535054, 12.54808
            ],
            [
                14.856365, 17.727005, 22.651743, 21.41938, 22.80815, 21.790867, 21.481012,
                20.114532, 15.156993, 12.143706
            ],
            [
                14.023407, 17.385857, 20.966919, 19.31418, 20.18963, 19.792374, 18.950308,
                18.111933, 14.98475, 11.845274
            ],
            [
                13.825436, 18.552557, 23.041485, 20.485252, 21.019114, 22.132965, 20.684126,
                23.119432, 17.45771, 15.404003
            ],
            [
                12.901991, 16.743303, 20.416607, 20.991795, 20.377827, 23.987612, 22.951773,
                24.037247, 18.210684, 14.692547
            ],
            [
                12.7223425, 16.170069, 19.311247, 20.673523, 18.884712, 22.496922, 22.504122,
                23.793377, 18.165903, 14.942411
            ],
            [
                12.939503, 18.09023, 19.538961, 22.090462, 20.296106, 22.413698, 22.584944,
                25.008242, 16.884335, 14.662905
            ],
            [
                12.652102, 17.003994, 20.411903, 19.786222, 20.476528, 20.994751, 22.138388,
                22.611298, 16.465628, 13.567069
            ],
            [
                8.433232, 13.481667, 15.412413, 17.21225, 15.81741, 17.145046, 17.820028,
                19.902752, 14.300136, 9.693722
            ],
            [
                6.4446926, 9.483086, 11.485752, 12.29198, 11.935443, 11.684909, 12.51212,
                13.196303, 9.557176, 7.5231547
            ]
        ],
        [
            [
                5.868987, 7.6265845, 12.504238, 11.073505, 12.375177, 12.285017, 11.487221,
                10.960942, 8.561286, 7.4703083
            ],
            [
                9.479091, 9.177946, 13.525752, 15.354565, 15.433532, 16.283695, 16.08999,
                15.835702, 12.507008, 10.166309
            ],
            [
                11.386902, 14.65663, 18.398108, 20.576805, 20.808807, 19.551777, 20.54114,
                18.57832, 14.82618, 11.187259
            ],
            [
                10.5433235, 15.393977, 18.43954, 19.200233, 21.660427, 19.004988, 19.23198,
                18.797354, 14.642131, 10.580626
            ],
            [
                11.994039, 14.362922, 20.7174, 18.4641, 21.20628, 18.320568, 18.9446, 17.14179,
                13.961677, 9.855361
            ],
            [
                12.13156, 13.080476, 19.488424, 18.70262, 20.438757, 18.861639, 17.669363,
                17.841671, 14.091366, 10.37805
            ],
            [
                12.294287, 14.803877, 19.13061, 17.668808, 17.364925, 17.074295, 16.731318,
                16.390965, 12.357665, 9.792909
            ],
            [
                11.826754, 14.599973, 18.249237, 17.602047, 16.750721, 18.69855, 17.068731,
                18.106031, 13.326279, 12.32247
            ],
            [
                11.613241, 14.716268, 19.106623, 19.010017, 18.331392, 19.260231, 19.207123,
                20.152641, 14.603184, 12.939545
            ],
            [
                10.62765, 14.482967, 18.484724, 17.541843, 18.5827, 19.96963, 19.571053, 21.300232,
                15.188877, 12.757026
            ],
            [
                9.895958, 13.893181, 18.148397, 18.320908, 19.2702, 20.544361, 20.082174,
                21.241621, 15.75852, 13.363586
            ],
            [
                10.267936, 14.670376, 18.780746, 17.887478, 18.009863, 19.542667, 20.856514,
                20.442778, 15.451771, 12.128302
            ],
            [
                9.249529, 13.154991, 18.1028, 18.638062, 18.933424, 18.546637, 19.027222,
                20.773148, 14.97844, 10.160073
            ],
            [
                8.563354, 10.075472, 12.359704, 14.415254, 14.81432, 13.689915, 13.631359,
                16.880936, 11.764186, 7.311416
            ],
            [
                6.288355, 7.763593, 9.692638, 10.883265, 10.835492, 11.801555, 10.430899,
                10.424822, 9.471313, 5.7911916
            ]
        ]
    ];
    let current_output36: Array3<f32> = conv_layer36.transposed_convolve(&test_input36);

    assert!(
        arr_allclose(&current_output36, &target_output36),
        "{:?} was not equal to {:?}",
        current_output36,
        target_output36
    );
}
